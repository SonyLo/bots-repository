import{_ as B,a as A,b as Y,c as T,d as pe,e as be,f as fe}from"./MailingTable-25e33de7.js";import{R as V,q as l,t as n,v as e,B as f,O as g,D as m,H as c,J as h,F as v,C as y,y as u,A as r,T as k,P as S,G as C,x as b,K as $,L as I,z as se,u as M,Z as Q,M as oe,S as q,k as ge,g as K,o as ve,a8 as $e,$ as ye,a9 as ke,aa as G,a7 as Fe}from"./index.es-bac3219e.js";import"./SlugForm-22049f3c.js";import{V as le,T as ne}from"./TelegramChannelHelper-73aab52f.js";import{_ as z,B as J}from"./BotMediaList-166fc8f2.js";import{P as j}from"./Pagination-fa992967.js";import{_ as H}from"./GlobalSlugList-c3ba807f.js";import{_ as D,a as ie}from"./InlineInjectionsHelper.vue_vue_type_style_index_0_lang-cc00f49a.js";import{_ as we}from"./BotForm-ef8c790e.js";import{_ as U}from"./_plugin-vue_export-helper-c27b6911.js";import{K as ae}from"./main-f2e340c9.js";import{v as Ce}from"./v4-4a60fe23.js";const Se={class:"row"},je={class:"col-12 mb-3"},Ve={class:"form-label",id:"service-title"},qe=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),ze=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),Pe={class:"col-12 mb-3"},Ue={key:0},Oe=["onClick"],Ae={class:"form-label",id:"service-category"},Ie=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),Qe=e("div",null,"Категория услуги (используется для группировки) ",-1),Te=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),Be={class:"col-12 mb-3"},Re={class:"form-label",id:"service-description"},Me=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),De=e("div",null," Краткая информация об оказываемой услуге ",-1),Ee=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),Le={key:0,class:"text-gray-400 ml-3",style:{"font-size":"10px"}},Ke={class:"col-12 col-md-6 mb-3"},Ne={class:"form-label",id:"service-title"},Je=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),He=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),Ye={class:"col-12 col-md-6 mb-3"},Ge={class:"form-label",id:"service-title"},We=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),Xe=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),Ze={class:"col-12 mb-3"},xe={class:"form-check"},et=e("label",{class:"form-check-label",for:"need_images"}," Необходимо добавить изображения к сервиус ",-1),tt={key:0,class:"col-12 mb-3"},st={class:"form-label",id:"service-images"},ot=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),lt=e("div",null," Изображение, которое видит пользователь при выборе услуги ",-1),nt=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),it={class:"col-12 mb-3"},at={class:"form-check"},dt=e("label",{class:"form-check-label",for:"need_prepayment"}," Необходима предоплата ",-1),rt={class:"row"},ct={class:"col-12"},ut={type:"submit",class:"btn btn-outline-success w-100 p-3"},mt={key:0},_t={key:1},ht={props:["eventId","bot","service"],data(){return{load:!1,need_reset:!1,need_images:!1,categories:[],serviceForm:{id:null,title:null,appointment_event_id:null,description:null,category:null,images:[],need_prepayment:!1,price:0,discount_price:0}}},watch:{serviceForm:{handler(o){this.need_reset=!0},deep:!0}},mounted(){this.loadAppointmentServiceCategories(),console.log("Service form",this.service),this.service&&this.$nextTick(()=>{this.serviceForm={id:this.service.id||null,appointment_event_id:this.service.appointment_event_id||null,title:this.service.title||null,category:this.service.category||null,description:this.service.description||null,images:this.service.images||[],need_prepayment:this.service.need_prepayment||!1,price:this.service.price||0,discount_price:this.service.discount_price||0}})},methods:{loadAppointmentServiceCategories(){this.$store.dispatch("loadAppointmentServiceCategories",{dataObject:{bot_id:this.bot.id||null,event_id:this.eventId||null}}).then(o=>{this.categories=o})},selectPhotos(o){this.serviceForm.images||(this.serviceForm.images=[]);let t=this.serviceForm.images.indexOf(o.file_id);t!==-1?this.serviceForm.images.splice(t,1):this.serviceForm.images.push(o.file_id)},resetForm(){},submitForm(){let o=new FormData;Object.keys(this.serviceForm).forEach(t=>{const s=this.serviceForm[t]||"";typeof s=="object"?o.append(t,JSON.stringify(s)):o.append(t,s)}),o.append("bot_id",this.bot.id),o.append("appointment_event_id",this.eventId),this.$store.dispatch(this.serviceForm.id===null?"addAppointmentService":"updateAppointmentService",{appointmentServiceForm:o}).then(t=>{this.$emit("callback",t.data),this.$notify("Услуги успешно создано")}).catch(t=>{this.$notify("Услуги создания события")})}}},pt=Object.assign(ht,{__name:"AppointmentServiceForm",setup(o){return(t,s)=>{const a=V("Popper");return l(),n("form",{onSubmit:s[7]||(s[7]=S((...i)=>t.submitForm&&t.submitForm(...i),["prevent"]))},[e("div",Se,[e("div",je,[e("label",Ve,[f(a,{content:"Название оказываемой услуги"},{default:g(()=>[qe]),_:1}),m(" Название услуги "),ze]),c(e("input",{type:"text",class:"form-control",placeholder:"Название","aria-label":"Название","onUpdate:modelValue":s[0]||(s[0]=i=>t.serviceForm.title=i),maxlength:"255","aria-describedby":"service-title",required:""},null,512),[[h,t.serviceForm.title]])]),e("div",Pe,[t.categories?(l(),n("p",Ue,[m(" Ранее созданные категории: "),(l(!0),n(v,null,y(t.categories,i=>(l(),n("span",{onClick:d=>t.serviceForm.category=i,class:"badge bg-primary mr-1 cursor-pointer"},u(i),9,Oe))),256))])):r("",!0),e("label",Ae,[f(a,null,{content:g(()=>[Qe]),default:g(()=>[Ie]),_:1}),m(" Категория услуги "),Te]),c(e("input",{type:"text",class:"form-control",placeholder:"Категория услуги","aria-label":"Категория услуги","onUpdate:modelValue":s[1]||(s[1]=i=>t.serviceForm.category=i),maxlength:"255","aria-describedby":"service-category",required:""},null,512),[[h,t.serviceForm.category]])]),e("div",Be,[e("label",Re,[f(a,null,{content:g(()=>[De]),default:g(()=>[Me]),_:1}),m(" Описание услуги "),Ee,t.serviceForm.description?(l(),n("small",Le," Длина текста "+u(t.serviceForm.description.length)+" / 255",1)):r("",!0)]),c(e("textarea",{type:"text",class:"form-control",placeholder:"Описание услуги","aria-label":"Описание услуги",maxlength:"255","onUpdate:modelValue":s[2]||(s[2]=i=>t.serviceForm.description=i),"aria-describedby":"service-description",required:""},`
                    `,512),[[h,t.serviceForm.description]])]),e("div",Ke,[e("label",Ne,[f(a,{content:"Цена оказываемой услуги"},{default:g(()=>[Je]),_:1}),m(" Цена услуги, руб "),He]),c(e("input",{type:"number",class:"form-control",placeholder:"Цена","aria-label":"Цена",min:"0","onUpdate:modelValue":s[3]||(s[3]=i=>t.serviceForm.price=i),"aria-describedby":"price",required:""},null,512),[[h,t.serviceForm.price]])]),e("div",Ye,[e("label",Ge,[f(a,{content:"Цена скидки на оказываемую услугу"},{default:g(()=>[We]),_:1}),m(" Цена скидки на услугу, руб "),Xe]),c(e("input",{type:"number",class:"form-control",placeholder:"Цена","aria-label":"Цена",min:"0","onUpdate:modelValue":s[4]||(s[4]=i=>t.serviceForm.discount_price=i),"aria-describedby":"price",required:""},null,512),[[h,t.serviceForm.discount_price]])]),e("div",Ze,[e("div",xe,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[5]||(s[5]=i=>t.need_images=i),type:"checkbox",id:"need_images"},null,512),[[k,t.need_images]]),et])]),t.need_images?(l(),n("div",tt,[e("label",st,[f(a,null,{content:g(()=>[lt]),default:g(()=>[ot]),_:1}),m(" Изображение к услуге "),nt]),f(z,{"need-photo":!0,selected:t.serviceForm.images,onSelect:t.selectPhotos},null,8,["selected","onSelect"])])):r("",!0),e("div",it,[e("div",at,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[6]||(s[6]=i=>t.serviceForm.need_prepayment=i),type:"checkbox",id:"need_prepayment"},null,512),[[k,t.serviceForm.need_prepayment]]),dt])])]),e("div",rt,[e("div",ct,[e("button",ut,[t.serviceForm.id===null?(l(),n("span",mt,"Создать услугу")):(l(),n("span",_t,"Обновить услугу"))])])])],32)}}}),bt={props:["param"],data(){return{expressions:[{expression:"{{userName}}",description:"Имя пользователя"},{expression:"{{level_1_percent}}",description:"Процент кэшбэка 1 уровня"},{expression:"{{level_2_percent}}",description:"Процент кэшбэка 2 уровня"},{expression:"{{level_3_percent}}",description:"Процент кэшбэка 3 уровня"},{expression:"{{cashback_fire_percent}}",description:"Процент сжигания кэшбэка"},{expression:"{{is_admin}}",description:"Статус администратора"},{expression:"{{is_work}}",description:"Статус работника"},{expression:"{{is_vip}}",description:"Статус VIP"},{expression:"{{is_manager}}",description:"Статус менеджера"},{expression:"{{is_deliveryman}}",description:"Статус доставщика"},{expression:"{{sex}}",description:"Пол клиента"},{expression:"{{cashback}}",description:"Сумма КэшБэк пользователя"},{expression:"{{telegramChatId}}",description:"Идентификатор чата"},{expression:"{{referralLink}}",description:"Реферальная ссылка"},{expression:"{{referralQr}}",description:"Реферальный QR-код"}]}},methods:{expressionsSelect(o){this.$emit("callback",{param:this.param,text:o.expression})}}},ft={class:"dropdown"},gt=e("button",{class:"btn btn-link dropdown-toggle",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-brands fa-hire-a-helper"})],-1),vt={class:"dropdown-menu item-with-text cursor-pointer text-muted p-2"},$t=["onClick"];function yt(o,t,s,a,i,d){return l(),n("div",ft,[gt,e("div",vt,[e("li",null,[(l(!0),n(v,null,y(i.expressions,_=>(l(),n("a",{class:"dropdown-item",onClick:p=>d.expressionsSelect(_)},u(_.description||"-"),9,$t))),256))])])])}const kt=U(bt,[["render",yt]]),Ft={key:0,class:"row"},wt={class:"col-12"},Ct={class:"form-floating mb-3"},St=e("label",{for:"floatingInput"},"Быстрый поиск команды",-1),jt={class:"col-12 mb-2"},Vt={class:"form-check"},qt={class:"form-check-label",for:"need_global"},zt={key:0},Pt={key:1},Ut={class:"form-check"},Ot=e("label",{class:"form-check-label",for:"need_show_deleted"}," Удаленные ",-1),At={key:0,class:"mb-3 col-12 col-sm-12"},It={class:"table"},Qt=e("thead",null,[e("tr",null,[e("th",{scope:"col"},"#"),e("th",{scope:"col"},"Команда"),e("th",{scope:"col"},"Пояснение")])],-1),Tt=["onClick"],Bt={key:2,class:"mb-3 col-md-12"},Rt=e("div",{class:"alert alert-danger",role:"alert"}," У Вас еще нет добавленных скриптов! ",-1),Mt=[Rt],Dt={props:["command","canSelect"],data(){return{bot:null,load:!1,need_global:!0,need_show_deleted:!0,slugs:[],ownSearch:null,paginate:[]}},watch:{ownSearch:function(o,t){this.loadSlugs()},need_global:function(o,t){this.loadSlugs()},need_show_deleted:function(o,t){this.loadSlugs()}},computed:{...C(["getCurrentBot","getSlugs","getSlugsPaginateObject"])},mounted(){this.loadCurrentBot().then(()=>{this.loadSlugs()})},methods:{nextSlugs(o){this.loadSlugs(o)},loadSlugs(o=0){return this.$store.dispatch("loadSlugs",{dataObject:{botId:this.bot.id,needGlobal:this.need_global,needDeleted:this.need_show_deleted,search:this.ownSearch},page:o}).then(t=>{this.slugs=this.getSlugs,this.paginate=this.getSlugsPaginateObject})},loadCurrentBot(o=null){return this.$store.dispatch("updateCurrentBot",{bot:o}).then(()=>{this.bot=this.getCurrentBot})},callbackSlugs(){this.loadSlugs()},selectSlug(o){this.$emit("select",o)}}},Et=Object.assign(Dt,{__name:"BotSlugSimpleTableList",setup(o){return(t,s)=>t.bot?(l(),n("div",Ft,[e("div",wt,[e("div",Ct,[c(e("input",{type:"search","onUpdate:modelValue":s[0]||(s[0]=a=>t.ownSearch=a),class:"form-control",id:"floatingInput",placeholder:"name@example.com"},null,512),[[h,t.ownSearch]]),St])]),e("div",jt,[e("div",Vt,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[1]||(s[1]=a=>t.need_global=a),type:"checkbox",id:"need_global"},null,512),[[k,t.need_global]]),e("label",qt,[t.need_global?(l(),n("span",zt,"Глобальные")):(l(),n("span",Pt,"Локальные"))])]),e("div",Ut,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[2]||(s[2]=a=>t.need_show_deleted=a),type:"checkbox",id:"need_show_deleted"},null,512),[[k,t.need_show_deleted]]),Ot])]),t.slugs?(l(),n("div",At,[e("table",It,[Qt,e("tbody",null,[(l(!0),n(v,null,y(t.slugs,(a,i)=>(l(),n("tr",{class:b({"border-info":a.deleted_at==null,"border-danger":a.deleted_at!=null})},[e("th",{scope:"row",class:b({"text-danger":a.deleted_at!=null})},u(a.id||"Нет идентификатора"),3),e("td",{onClick:d=>t.selectSlug(a),class:b({"text-danger":a.deleted_at!=null})},u(a.command||"Нет команды"),11,Tt),e("td",{class:b({"text-danger":a.deleted_at!=null})},u(a.comment||"Пояснение не указано"),3)],2))),256))])])])):r("",!0),t.paginate?(l(),$(j,{key:1,onPagination_page:t.nextSlugs,pagination:t.paginate},null,8,["onPagination_page","pagination"])):r("",!0),t.slugs.length===0?(l(),n("div",Bt,Mt)):r("",!0)])):r("",!0)}}),Lt={class:"form-floating mb-3"},Kt=e("label",{for:"floatingInput"},"Команда",-1),Nt={class:"form-floating mb-3"},Jt=e("label",{for:"floatingInput"},"Мнемоническое имя",-1),Ht={class:"form-floating mb-3"},Yt=e("label",{for:"floatingInput"},"Описание скрипта",-1),Gt=e("h6",null," Параметры скрипта ",-1),Wt=e("div",{class:"alert alert-info",role:"alert"}," Данные параметры используются для настройки скриптов на стороне сервера ",-1),Xt={class:"dropdown"},Zt=e("button",{class:"btn btn-outline-info w-100 dropdown-toggle mb-2",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"}," Добавить ",-1),xt={class:"dropdown-menu w-100"},es=["onClick"],ts={class:"row"},ss={class:"col-12"},os=["onClick"],ls=e("p",null,"Вы можете подгрузить отсутствующие параметры конфигурации",-1),ns=e("i",{class:"fa-solid fa-rotate mr-2"},null,-1),is={key:0,class:"row"},as={class:"col-12"},ds={class:"table"},rs=e("thead",null,[e("tr",null,[e("th",{scope:"col"},"Ключ"),e("th",{scope:"col"},"Значение")])],-1),cs={colspan:"2"},us={class:"w-100 d-flex align-items-center justify-content-between"},ms={class:"dropdown mr-2"},_s=e("button",{class:"btn btn-outline-primary",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-solid fa-bars"})],-1),hs={class:"dropdown-menu"},ps=["onClick"],bs=e("i",{class:"fa-solid fa-trash-can"},null,-1),fs=["onClick"],gs=e("i",{class:"fa-solid fa-caret-left"},null,-1),vs=["onClick"],$s=e("i",{class:"fa-solid fa-caret-right"},null,-1),ys=["innerHTML"],ks={key:1,class:"mb-0 font-bold"},Fs={class:"dropdown"},ws={class:"btn btn-outline-primary dropdown-toggle w-100 d-flex justify-content-between align-items-center",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},Cs={class:"dropdown-menu"},Ss=["onClick"],js={style:{width:"300px"}},Vs={class:"form-floating"},qs=["onUpdate:modelValue","id"],zs=["for"],Ps={key:0,class:"form-floating"},Us=["id","onUpdate:modelValue"],Os=["for"],As={key:1,class:"form-check"},Is=["onUpdate:modelValue","id"],Qs=["for"],Ts={key:2,class:"form-floating"},Bs=["onUpdate:modelValue","id"],Rs=["for"],Ms=["onClick"],Ds={key:0,class:"fa-solid fa-eye mr-2"},Es={key:1,class:"fa-solid fa-eye-slash mr-2"},Ls={key:2},Ks={key:3},Ns=["onClick"],Js={key:0,class:"fa-solid fa-eye mr-2"},Hs={key:1,class:"fa-solid fa-eye-slash mr-2"},Ys={key:2},Gs={key:3},Ws={key:5,class:"form-floating"},Xs=["onUpdate:modelValue","id"],Zs=["for"],xs=["onClick"],eo={key:0,class:"fa-solid fa-eye mr-2"},to={key:1,class:"fa-solid fa-eye-slash mr-2"},so={key:2},oo={key:3},lo={key:7,class:"form-check"},no=["onUpdate:modelValue","id"],io=["for"],ao={key:8,class:"form-floating"},ro=["id","onUpdate:modelValue"],co=["for"],uo=["onClick"],mo={key:0,class:"fa-solid fa-eye mr-2"},_o={key:1,class:"fa-solid fa-eye-slash mr-2"},ho={key:2},po={key:3},bo={colspan:"2"},fo={key:0,class:"form-floating mb-3"},go=["id","onUpdate:modelValue"],vo=["for"],$o={key:1,class:"form-floating"},yo=e("label",{class:"form-label",id:"bot-domain"},"JSON-код",-1),ko={key:2,class:"form-floating"},Fo=["onUpdate:modelValue","id"],wo=["for"],Co={key:3,class:"form-floating"},So=["onUpdate:modelValue","id"],jo=["for"],Vo={key:1,class:"row"},qo=e("div",{class:"col-12"},[e("p",null,"Параметры скрипта еще не добавлены")],-1),zo=[qo],Po={class:"btn btn-primary text-white w-100 mt-2 p-3"},Uo={key:0},Oo={key:1},Ao={props:["item"],components:{Vue3JsonEditor:le},data(){return{filters:[],simple:!0,configTypes:[{title:"Текстовый или числовой параметр",type:"text"},{title:"Большое текстовое поле",type:"large-text"},{title:"Канал обратной связи",type:"channel"},{title:"Логический оператор",type:"boolean"},{title:"Ссылка на изображение",type:"image"},{title:"Цвет",type:"color"},{title:"Geo",type:"geo"},{title:"Номер телефона",type:"phone"},{title:"ID скрипта",type:"script"},{title:"ID страницы",type:"page"},{title:"JSON",type:"json"}],bot:null,photos:[],slugForm:{bot_id:null,id:null,command:null,comment:null,slug:null,parent_id:null,config:[],is_global:!0}}},computed:{...C(["getCurrentBot"]),filteredConfigs(){return this.filters.length==0?this.slugForm.config:this.slugForm.config.filter(o=>this.filters.indexOf(o.type)>=0)}},mounted(){this.loadCurrentBot(),this.item&&(this.slugForm.id=this.item.id||null,this.slugForm.command=this.item.command,this.slugForm.comment=this.item.comment,this.slugForm.bot_id=this.item.bot_id,this.slugForm.slug=this.item.slug,this.slugForm.parent_id=this.item.parent_id||null,this.slugForm.config=this.item.config||[],this.slugForm.is_global=this.item.is_global||!1)},methods:{loadSlugParentParams(){this.$store.dispatch("loadSlugParams",{parentSlugId:this.slugForm.parent_id?this.slugForm.parent_id:this.slugForm.id}).then(o=>{let t=o.config,s=0;t.forEach(a=>{this.slugForm.config.findIndex(d=>d.key===a.key)===-1&&(s++,this.slugForm.config.unshift(a))}),this.$notify({title:"Конструктор команд",text:`Параметры успешно подгружены: Обновлено ${s} параметров`,type:"success"})})},toggleFilter(o){let t=this.filters.indexOf(o);t>=0?this.filters.splice(t,1):this.filters.push(o)},addTextTo(o,t={text:null}){this.slugForm.config[o].value=t.text},loadCurrentBot(o=null){return this.$store.dispatch("updateCurrentBot",{bot:o}).then(()=>{this.bot=this.getCurrentBot})},submit(){let o=new FormData;Object.keys(this.slugForm).forEach(t=>{const s=this.slugForm[t]||"";typeof s=="object"?o.append(t,JSON.stringify(s)):o.append(t,s)}),this.$store.dispatch(this.slugForm.id===null?"createSlug":"updateSlug",{slugForm:o}).then(t=>{this.$notify({title:"Конструктор команд",text:"Команда успешно обновлена",type:"success"}),this.slugForm.id===null&&(this.slugForm.id=null,this.slugForm.command=null,this.slugForm.comment=null,this.slugForm.bot_id=null,this.slugForm.slug=null,this.slugForm.config=[],this.slugForm.is_global=!0),this.$emit("callback")}).catch(t=>{})},onJsonChange(o,t){this.filteredConfigs[t].value=o},addConfig(o){this.slugForm.config.splice(0,0,{key:null,value:null,type:o||"text"})},move(o,t=0){let s=this.slugForm.config[o],a=this.slugForm.config.length||0,i=t===0?o-1>=0?o-1:a-1:o<a-1?o+1:0;this.slugForm.config[o]=this.slugForm.config[i],this.slugForm.config[i]=s},removeConfigItem(o){try{this.slugForm.config.splice(o,1)}catch{this.slugForm.config=[]}},selectSlug(o,t){this.filteredConfigs[t].value=o.id},selectPhoto(o,t){this.filteredConfigs[t].value=o.file_id}}},de=Object.assign(Ao,{__name:"SlugTableForm",setup(o){return(t,s)=>{const a=I("mask");return l(),n("form",{onSubmit:s[4]||(s[4]=S((...i)=>t.submit&&t.submit(...i),["prevent"]))},[e("div",Lt,[c(e("input",{type:"text","onUpdate:modelValue":s[0]||(s[0]=i=>t.slugForm.command=i),class:"form-control",id:"floatingInput",placeholder:"name@example.com",required:""},null,512),[[h,t.slugForm.command]]),Kt]),e("div",Nt,[c(e("input",{type:"text","onUpdate:modelValue":s[1]||(s[1]=i=>t.slugForm.slug=i),class:"form-control",id:"floatingInput",placeholder:"name@example.com",required:""},null,512),[[h,t.slugForm.slug]]),Jt]),e("div",Ht,[c(e("input",{type:"text","onUpdate:modelValue":s[2]||(s[2]=i=>t.slugForm.comment=i),class:"form-control",id:"floatingInput",placeholder:"name@example.com",required:""},null,512),[[h,t.slugForm.comment]]),Yt]),Gt,Wt,e("div",Xt,[Zt,e("ul",xt,[(l(!0),n(v,null,y(t.configTypes,(i,d)=>(l(),n("li",null,[e("a",{class:"dropdown-item",onClick:_=>t.addConfig(i.type)},u(i.title||"Не установлен"),9,es)]))),256))])]),e("div",ts,[e("div",ss,[e("p",null,[m("Фильтры: "),(l(!0),n(v,null,y(t.configTypes,(i,d)=>(l(),n("span",{class:b(["badge mb-1 bg-gray-100 cursor-pointer mr-1",{"bg-info":t.filters.indexOf(i.type)>=0}]),onClick:_=>t.toggleFilter(i.type)},u(i.type),11,os))),256))]),ls,e("button",{type:"button",onClick:s[3]||(s[3]=(...i)=>t.loadSlugParentParams&&t.loadSlugParentParams(...i)),class:"btn btn-outline-info"},[ns,m("Загрузить ")])])]),t.filteredConfigs.length>0?(l(),n("div",is,[e("div",as,[e("table",ds,[rs,e("tbody",null,[(l(!0),n(v,null,y(t.filteredConfigs,(i,d)=>(l(),n(v,null,[e("tr",{class:b({"table-light":d%2===0})},[e("td",cs,[e("div",us,[e("div",ms,[_s,e("ul",hs,[e("li",null,[e("a",{class:"dropdown-item",onClick:_=>t.removeConfigItem(d),href:"javascript:void(0)"},[bs,m(" Удалить")],8,ps)]),e("li",null,[e("a",{class:"dropdown-item",onClick:_=>t.move(d,0),href:"javascript:void(0)"},[gs,m(" Вверх")],8,fs)]),e("li",null,[e("a",{class:"dropdown-item",onClick:_=>t.move(d,1),href:"javascript:void(0)"},[$s,m(" Вниз")],8,vs)])])]),t.filteredConfigs[d].description?(l(),n("p",{key:0,class:"mb-0 font-italic font-bold",innerHTML:t.filteredConfigs[d].description},null,8,ys)):(l(),n("p",ks,"без описания")),e("div",Fs,[e("button",ws,u(t.filteredConfigs[d].type),1),e("ul",Cs,[(l(!0),n(v,null,y(t.configTypes,_=>(l(),n("li",null,[e("a",{class:"dropdown-item",onClick:p=>t.filteredConfigs[d].type=_.type},u(_.title||i.type),9,Ss)]))),256))])])])])],2),e("tr",{class:b({"table-light":d%2===0})},[e("td",js,[e("div",Vs,[c(e("input",{type:"text",class:"form-control","onUpdate:modelValue":_=>t.filteredConfigs[d].key=_,id:"field-input-key-"+d,placeholder:"name@example.com"},null,8,qs),[[h,t.filteredConfigs[d].key]]),e("label",{for:"field-input-key-"+d},"Ключ",8,zs)])]),e("td",null,[t.filteredConfigs[d].type==="text"||t.filteredConfigs[d].type==="channel"?(l(),n("div",Ps,[c(e("input",{type:"text",class:"form-control",id:"field-input-"+d,"onUpdate:modelValue":_=>t.filteredConfigs[d].value=_,placeholder:"name@example.com"},null,8,Us),[[h,t.filteredConfigs[d].value]]),e("label",{for:"field-input-"+d},"Значение",8,Os)])):r("",!0),t.filteredConfigs[d].type==="boolean"?(l(),n("div",As,[c(e("input",{class:"form-check-input","onUpdate:modelValue":_=>t.filteredConfigs[d].value=_,type:"checkbox",value:"false",id:"filtered-config-"+d+"-checkbox"},null,8,Is),[[k,t.filteredConfigs[d].value]]),e("label",{class:"form-check-label",for:"filtered-config-"+d+"-checkbox"},u(t.filteredConfigs[d].value?"Включено":"Выключено"),9,Qs)])):r("",!0),t.filteredConfigs[d].type==="geo"?(l(),n("div",Ts,[c(e("input",{class:"form-control",placeholder:"##.######,##.######","onUpdate:modelValue":_=>t.filteredConfigs[d].value=_,type:"text",id:"filtered-config-"+d+"-geo"},null,8,Bs),[[a,"##.######,##.######"],[h,t.filteredConfigs[d].value]]),e("label",{for:"filtered-config-"+d+"-geo"},"Значение",8,Rs)])):r("",!0),t.filteredConfigs[d].type==="script"?(l(),n("button",{key:3,type:"button",class:"btn btn-outline-light text-primary w-100 py-3",onClick:_=>i.content_show=!i.content_show},[i.content_show?(l(),n("i",Es)):(l(),n("i",Ds)),i.content_show?(l(),n("span",Ks,"Скрыть выбор скриптов")):(l(),n("span",Ls,"Показать выбор скриптов"))],8,Ms)):r("",!0),t.filteredConfigs[d].type==="page"?(l(),n("button",{key:4,type:"button",class:"btn btn-outline-light text-primary w-100 py-3",onClick:_=>i.content_show=!i.content_show},[i.content_show?(l(),n("i",Hs)):(l(),n("i",Js)),i.content_show?(l(),n("span",Gs,"Скрыть выбор страницы")):(l(),n("span",Ys,"Показать выбор страницы"))],8,Ns)):r("",!0),t.filteredConfigs[d].type==="phone"?(l(),n("div",Ws,[c(e("input",{class:"form-control",placeholder:"+7(###)###-##-##","onUpdate:modelValue":_=>t.filteredConfigs[d].value=_,type:"text",id:"filtered-config-"+d+"-phone"},null,8,Xs),[[a,"+7(###)###-##-##"],[h,t.filteredConfigs[d].value]]),e("label",{for:"filtered-config-"+d+"-phone"},"Значение",8,Zs)])):r("",!0),t.filteredConfigs[d].type==="json"?(l(),n("button",{key:6,type:"button",class:"btn btn-outline-light text-primary w-100 py-3",onClick:_=>i.content_show=!i.content_show},[i.content_show?(l(),n("i",to)):(l(),n("i",eo)),i.content_show?(l(),n("span",oo,"Скрыть редактор JSON")):(l(),n("span",so,"Показать редактор JSON"))],8,xs)):r("",!0),t.filteredConfigs[d].type==="color"?(l(),n("div",lo,[c(e("input",{class:"form-control","onUpdate:modelValue":_=>t.filteredConfigs[d].value=_,type:"color",id:"filtered-config-"+d+"-color"},null,8,no),[[h,t.filteredConfigs[d].value]]),e("label",{for:"filtered-config-"+d+"-color"},[e("p",{style:se({color:t.filteredConfigs[d].value})},"Цвет: "+u(t.filteredConfigs[d].value),5)],8,io)])):r("",!0),t.filteredConfigs[d].type==="large-text"?(l(),n("div",ao,[c(e("textarea",{class:"form-control",id:"field-input-"+d,"onUpdate:modelValue":_=>t.filteredConfigs[d].value=_,placeholder:"name@example.com"},`
                            `,8,ro),[[h,t.filteredConfigs[d].value]]),e("label",{for:"field-input-"+d},"Значение",8,co)])):r("",!0),t.filteredConfigs[d].type==="image"?(l(),n("button",{key:9,type:"button",class:"btn btn-outline-light text-primary w-100 py-3",onClick:_=>i.content_show=!i.content_show},[i.content_show?(l(),n("i",_o)):(l(),n("i",mo)),i.content_show?(l(),n("span",po,"Скрыть выбор изображений")):(l(),n("span",ho,"Показать выбор изображений"))],8,uo)):r("",!0)])],2),i.content_show?(l(),n("tr",{key:0,class:b({"table-light":d%2===0})},[e("td",bo,[t.filteredConfigs[d].type==="image"?(l(),n("div",fo,[c(e("input",{class:"form-control mb-2",id:"field-input-"+d,type:"text",disabled:"true","onUpdate:modelValue":_=>t.filteredConfigs[d].value=_,placeholder:"name@example.com"},null,8,go),[[h,t.filteredConfigs[d].value]]),e("label",{for:"field-input-"+d},"FileId ссылка на изображение",8,vo),f(z,{"need-video":!1,"need-photo":!0,selected:[t.filteredConfigs[d].value],onSelect:_=>t.selectPhoto(_,d)},null,8,["selected","onSelect"])])):r("",!0),t.filteredConfigs[d].type==="json"?(l(),n("div",$o,[yo,f(M(le),{mode:"form",modelValue:t.filteredConfigs[d].value,"onUpdate:modelValue":_=>t.filteredConfigs[d].value=_,"show-btns":!1,expandedOnStart:!0,onJsonChange:_=>t.onJsonChange(_,d)},null,8,["modelValue","onUpdate:modelValue","onJsonChange"])])):r("",!0),t.filteredConfigs[d].type==="page"?(l(),n("div",ko,[c(e("input",{class:"form-control mb-2","onUpdate:modelValue":_=>t.filteredConfigs[d].value=_,type:"text",id:"filtered-config-"+d+"-script"},null,8,Fo),[[h,t.filteredConfigs[d].value]]),e("label",{for:"filtered-config-"+d+"-script"},"Значение",8,wo),f(B,{selected:[t.filteredConfigs[d].value],onCallback:_=>t.selectSlug(_,d),editor:!1},null,8,["selected","onCallback"])])):r("",!0),t.filteredConfigs[d].type==="script"?(l(),n("div",Co,[c(e("input",{class:"form-control mb-2","onUpdate:modelValue":_=>t.filteredConfigs[d].value=_,type:"text",id:"filtered-config-"+d+"-script"},null,8,So),[[h,t.filteredConfigs[d].value]]),e("label",{for:"filtered-config-"+d+"-script"},"Значение",8,jo),f(Et,{onSelect:_=>t.selectSlug(_,d)},null,8,["onSelect"])])):r("",!0)])],2)):r("",!0)],64))),256))])])])])):(l(),n("div",Vo,zo)),e("button",Po,[t.slugForm.id==null?(l(),n("span",Uo," Сохранить команду ")):(l(),n("span",Oo," Обновить команду "))])],32)}}});const Io={class:"card-header d-flex justify-content-between align-items-center"},Qo={class:"d-flex"},To=e("i",{class:"fa-solid fa-arrow-left"},null,-1),Bo=[To],Ro={class:"dropdown"},Mo=e("i",{class:"fa-solid fa-ellipsis"},null,-1),Do=[Mo],Eo={class:"dropdown-menu"},Lo=["data-bs-target"],Ko=e("i",{class:"fa-regular fa-pen-to-square mr-1"},null,-1),No=e("i",{class:"fa-solid fa-clone mr-1"},null,-1),Jo=e("i",{class:"fa-regular fa-trash-can text-danger mr-1"},null,-1),Ho={key:0,class:"fa-solid fa-arrow-up-short-wide"},Yo={key:1,class:"fa-solid fa-arrow-down-short-wide"},Go={class:"card-body"},Wo={class:"row"},Xo={class:"col-12"},Zo={key:0},xo={key:1,class:"list-group list-group-numbered"},el={class:"list-group-item d-flex justify-content-between align-items-start"},tl={class:"ms-2 me-auto"},sl=e("div",{class:"fw-bold"},"Идентификатор",-1),ol={class:"list-group-item d-flex justify-content-between align-items-start"},ll={class:"ms-2 me-auto"},nl=e("div",{class:"fw-bold"},"Команда",-1),il={class:"list-group-item d-flex justify-content-between align-items-start"},al={class:"ms-2 me-auto"},dl=e("div",{class:"fw-bold"},"Мнемоническое имя",-1),rl={class:"list-group-item d-flex justify-content-between align-items-start"},cl={class:"ms-2 me-auto"},ul=e("div",{class:"fw-bold"},"Пояснение",-1),ml={key:0,class:"list-group-item d-flex justify-content-between align-items-start"},_l={class:"ms-2 me-auto"},hl=e("div",{class:"fw-bold"},"Набор параметров скрипта",-1),pl={key:1,class:"list-group-item d-flex justify-content-between align-items-start"},bl=e("div",{class:"ms-2 me-auto"},[e("div",{class:"fw-bold"},"Привязана страница")],-1),fl=[bl],gl={key:2,class:"list-group-item d-flex justify-content-between align-items-start"},vl=e("div",{class:"ms-2 me-auto"},[e("div",{class:"fw-bold"},"Глобальный скрипт")],-1),$l=[vl],yl={class:"list-group-item d-flex justify-content-between align-items-start"},kl={class:"ms-2 me-auto w-100"},Fl=e("div",{class:"fw-bold"},"Перенести данные из:",-1),wl=e("option",{value:null},"Не выбрано",-1),Cl=["value"],Sl=e("p",{class:"my-2"},[e("em",null,"Перенос данных затирает текущие данные в данном скрипте")],-1),jl=["disabled"],Vl=["id"],ql={class:"modal-dialog modal-fullscreen"},zl={class:"modal-content"},Pl={class:"modal-header"},Ul={class:"modal-title",id:"exampleModalLabel"},Ol=e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),Al={class:"modal-body"},Il=e("div",{class:"modal-footer"},[e("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Закрыть")],-1),Ql={props:["item","bot","selectMode","isActive"],data(){return{selected_slug_id:null,slugs:[],load:!1,simple:!0}},watch:{simple:function(){this.simple||this.loadAllSlugs()}},mounted(){},methods:{selectCard(){this.$emit("select",this.item)},slugFormCallback(){this.load=!0,this.$emit("callback"),this.$nextTick(()=>{this.load=!1})},editSlug(){this.load=!0,this.$nextTick(()=>{this.load=!1})},selectSlug(){this.load=!0,this.$emit("select",this.item),this.$nextTick(()=>{this.load=!1})},duplicateSlug(){this.load=!0,this.$store.dispatch("duplicateSlug",{dataObject:{slugId:this.item.id}}).then(o=>{this.$notify({title:"Конструктор команд",text:"Команда успешно продублирована",type:"success"}),this.$emit("callback"),this.$nextTick(()=>{this.load=!1})}).catch(o=>{this.$emit("callback"),this.$nextTick(()=>{this.load=!1})}),this.$emit("callback"),this.$nextTick(()=>{this.load=!1})},submitRelocateData(){this.$store.dispatch("relocateSlugActionData",{slug_sender_id:this.selected_slug_id,slug_recipient_id:this.item.id,bot_id:this.bot.id}).then(o=>{this.$notify({title:"Конструктор команд",text:"Данные команды успешно перенесены",type:"success"})}).catch(o=>{this.$notify({title:"Конструктор команд",text:"Ошибка переноса данных",type:"error"})})},loadAllSlugs(){this.$store.dispatch("loadAllSlugs",{botId:this.bot.id}).then(o=>{this.slugs=o.data})},removeSlug(){this.load=!0,this.$store.dispatch("removeSlug",{dataObject:{slugId:this.item.id}}).then(o=>{this.$notify({title:"Конструктор команд",text:"Команда успешно удалена",type:"success"}),this.$emit("callback"),this.$nextTick(()=>{this.load=!1})}).catch(o=>{this.$emit("callback"),this.$nextTick(()=>{this.load=!1})})}}},Tl=Object.assign(Ql,{__name:"Slug",setup(o){return(t,s)=>(l(),n(v,null,[e("div",{class:b(["card",{"deprecated-slug":o.item.deprecated_at!=null,"global-slug":o.item.is_global,"bg-success text-white":o.isActive}])},[e("div",Io,[e("div",Qo,[e("button",{onClick:s[0]||(s[0]=(...a)=>t.selectSlug&&t.selectSlug(...a)),type:"button",title:"Выбрать команду",class:b(["btn btn-outline-primary mr-2",{"text-white":o.isActive}])},Bo,2),e("div",Ro,[e("button",{class:b([{"text-white border-white":o.isActive},"btn btn-outline-secondary"]),type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},Do,2),e("ul",Eo,[e("li",null,[e("a",{class:"dropdown-item cursor-pointer",onClick:s[1]||(s[1]=(...a)=>t.editSlug&&t.editSlug(...a)),"data-bs-toggle":"modal","data-bs-target":"#edit-slug-"+o.item.id},[Ko,m(" Редактировать")],8,Lo)]),e("li",null,[e("a",{class:"dropdown-item cursor-pointer",onClick:s[2]||(s[2]=(...a)=>t.duplicateSlug&&t.duplicateSlug(...a))},[No,m(" Дублировать")])]),e("li",null,[e("a",{class:"dropdown-item cursor-pointer",onClick:s[3]||(s[3]=(...a)=>t.removeSlug&&t.removeSlug(...a))},[Jo,m(" Удалить")])])])])]),e("span",null,[e("small",null,[e("strong",null,"#"+u(o.item.id),1)])]),e("button",{type:"button",onClick:s[4]||(s[4]=a=>t.simple=!t.simple),class:b([{"text-white border-white":o.isActive},"btn btn-outline-primary ml-2"])},[t.simple?(l(),n("i",Ho)):(l(),n("i",Yo))],2)]),e("div",Go,[e("div",Wo,[e("div",Xo,[t.simple?(l(),n("p",Zo,u(o.item.command||"Нет команды"),1)):(l(),n("ol",xo,[e("li",el,[e("div",tl,[sl,m(" №"+u(o.item.id||"Нет идентификатора"),1)])]),e("li",ol,[e("div",ll,[nl,m(" "+u(o.item.command||"Нет команды"),1)])]),e("li",il,[e("div",al,[dl,m(" "+u(o.item.slug||"Slug"),1)])]),e("li",rl,[e("div",cl,[ul,m(" "+u(o.item.comment||"Пояснение не указано"),1)])]),o.item.config?(l(),n("li",ml,[e("div",_l,[hl,o.item.config?(l(!0),n(v,{key:0},y(o.item.config,a=>(l(),n("p",null,[e("strong",null,u(a.key||"Ключ не найден")+":",1),m(u(a.value||"Не указано"),1)]))),256)):r("",!0)])])):r("",!0),o.item.page?(l(),n("li",pl,fl)):r("",!0),o.item.is_global?(l(),n("li",gl,$l)):r("",!0),e("li",yl,[e("div",kl,[e("form",{onSubmit:s[6]||(s[6]=S((...a)=>t.submitRelocateData&&t.submitRelocateData(...a),["prevent"]))},[Fl,c(e("select",{class:"form-control w-100","onUpdate:modelValue":s[5]||(s[5]=a=>t.selected_slug_id=a),required:""},[wl,(l(!0),n(v,null,y(t.slugs,a=>(l(),n("option",{value:a.id},"#"+u(a.id)+" "+u(a.slug||"Не указан"),9,Cl))),256))],512),[[Q,t.selected_slug_id]]),Sl,e("button",{disabled:t.selected_slug_id==null,class:"btn btn-outline-warning w-100"}," Выполнить перенос ",8,jl)],32)])])]))])])])],2),e("div",{class:"modal fade",id:"edit-slug-"+o.item.id,tabindex:"-1"},[e("div",ql,[e("div",zl,[e("div",Pl,[e("h5",Ul,[m("Редактирование команды #"),e("span",null,u(o.item.id),1)]),Ol]),e("div",Al,[t.load?r("",!0):(l(),$(de,{key:0,item:o.item,onCallback:t.slugFormCallback},null,8,["item","onCallback"]))]),Il])])],8,Vl)],64))}}),Bl={key:0,class:"row"},Rl={class:"col-12 mb-2"},Ml={key:0},Dl=e("i",{class:"fa-solid fa-scroll"},null,-1),El={key:1},Ll=e("i",{class:"fa-regular fa-square-minus"},null,-1),Kl={key:0,class:"col-12"},Nl={class:"col-12"},Jl={class:"form-floating mb-3"},Hl=e("label",{for:"floatingInput"},"Быстрый поиск команды",-1),Yl={class:"col-12 mb-2"},Gl={class:"form-check"},Wl={class:"form-check-label",for:"need_global"},Xl={key:0},Zl={key:1},xl={class:"form-check"},en=e("label",{class:"form-check-label",for:"need_show_deleted"}," Удаленные ",-1),tn={key:1,class:"mb-3 col-12 col-sm-12"},sn={class:"table"},on=e("thead",null,[e("tr",null,[e("th",{scope:"col"},"#"),e("th",{scope:"col"},"Команда"),e("th",{scope:"col"},"Пояснение"),e("th",{scope:"col"},"Глобальный"),e("th",{scope:"col"},"Действия")])],-1),ln=["onClick"],nn={key:0},an=e("i",{class:"fa-solid fa-check text-success"},null,-1),dn=[an],rn={key:1},cn=e("i",{class:"fa-solid fa-xmark text-danger"},null,-1),un=[cn],mn={class:"dropdown"},_n=e("button",{class:"btn btn-outline-secondary",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-solid fa-ellipsis"})],-1),hn={class:"dropdown-menu"},pn={key:0},bn=["onClick"],fn=e("i",{class:"fa-solid fa-arrow-left mr-1"},null,-1),gn={key:1},vn=["onClick"],$n=e("a",{class:"dropdown-item cursor-pointer","data-bs-toggle":"modal","data-bs-target":"#edit-table-slug"},[e("i",{class:"fa-regular fa-pen-to-square mr-1"}),m(" Редактировать")],-1),yn=[$n],kn=["onClick"],Fn=e("i",{class:"fa-solid fa-clone mr-1"},null,-1),wn=["href"],Cn=e("i",{class:"fa-regular fa-file-excel mr-1"},null,-1),Sn={key:2},jn=["onClick"],Vn=e("i",{class:"fa-regular fa-trash-can text-danger mr-1"},null,-1),qn={key:3},zn=["onClick"],Pn=e("i",{class:"fa-regular fa-trash-can text-danger mr-1"},null,-1),Un={key:3,class:"mb-3 col-md-12"},On=e("div",{class:"alert alert-danger",role:"alert"}," У Вас еще нет добавленных скриптов! ",-1),An=[On],In={class:"modal fade",id:"edit-table-slug",tabindex:"-1"},Qn={class:"modal-dialog modal-fullscreen"},Tn={key:0,class:"modal-content"},Bn={class:"modal-header"},Rn={class:"modal-title",id:"exampleModalLabel"},Mn=e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),Dn={class:"modal-body"},En={class:"row"},Ln={class:"col-12"},Kn=e("div",{class:"modal-footer"},[e("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Закрыть")],-1),Nn={props:["selected","command","canSelect"],data(){return{bot:null,relocated_slug_id:null,need_global:!0,need_show_deleted:!0,show:!1,load:!1,slugs:[],paginate:[],selectedSlug:null,ownSearch:null,slugForm:{command:null,comment:null,slug:null}}},watch:{ownSearch:function(o,t){this.loadSlugs()},need_global:function(o,t){this.loadSlugs()},need_show_deleted:function(o,t){this.loadSlugs()}},computed:{...C(["getCurrentBot","getSlugs","getSlugsPaginateObject"])},mounted(){this.loadCurrentBot().then(()=>{this.loadSlugs(),this.command&&this.$nextTick(()=>{this.slugForm.command=this.command})})},methods:{nextSlugs(o){this.loadSlugs(o)},loadSlugs(o=0){return console.log("selected",this.selected),this.$store.dispatch("loadSlugs",{dataObject:{botId:this.bot.id,needGlobal:this.need_global,needDeleted:this.need_show_deleted,search:this.ownSearch||null},page:o}).then(t=>{this.slugs=this.getSlugs,this.paginate=this.getSlugsPaginateObject})},loadCurrentBot(o=null){return this.$store.dispatch("updateCurrentBot",{bot:o}).then(()=>{this.bot=this.getCurrentBot})},callbackSlugs(){this.loadSlugs()},selectSlug(o){this.load=!0,this.$nextTick(()=>{this.selectedSlug=o,this.load=!1}),this.$emit("select",o)},selectCard(){this.$emit("select",this.item)},slugFormCallback(){this.load=!0;const o=this.selectedSlug;this.loadSlugs().then(()=>{let t=this.slugs.find(s=>s.id===o.id);this.selectSlug(t||null)}),this.$emit("callback"),this.$nextTick(()=>{this.load=!1})},editSlug(){this.load=!0,this.$nextTick(()=>{this.load=!1})},duplicateSlug(o){this.load=!0,this.$store.dispatch("duplicateSlug",{dataObject:{slugId:o.id}}).then(t=>{this.$notify({title:"Конструктор команд",text:"Команда успешно продублирована",type:"success"}),this.$emit("callback"),this.$nextTick(()=>{this.load=!1})}).catch(t=>{this.$emit("callback"),this.$nextTick(()=>{this.load=!1})}),this.loadSlugs(),this.$emit("callback"),this.$nextTick(()=>{this.load=!1})},submitRelocateData(){this.$store.dispatch("relocateSlugActionData",{slug_sender_id:this.relocated_slug_id,slug_recipient_id:this.item.id,bot_id:this.bot.id}).then(o=>{this.$notify({title:"Конструктор команд",text:"Данные команды успешно перенесены",type:"success"})}).catch(o=>{this.$notify({title:"Конструктор команд",text:"Ошибка переноса данных",type:"error"})})},restoreSlug(o){this.load=!0,this.$store.dispatch("restoreSlug",{dataObject:{slugId:o.id}}).then(t=>{this.$notify({title:"Конструктор команд",text:"Команда успешно восстановлена",type:"success"}),this.loadSlugs(),this.$nextTick(()=>{this.load=!1})}).catch(t=>{this.$emit("callback"),this.$nextTick(()=>{this.load=!1})})},removeSlug(o){this.load=!0,this.$store.dispatch("removeSlug",{dataObject:{slugId:o.id}}).then(t=>{this.$notify({title:"Конструктор команд",text:"Команда успешно удалена",type:"success"}),this.loadSlugs()}).catch(t=>{this.$emit("callback"),this.$nextTick(()=>{this.load=!1})})}}},Jn=Object.assign(Nn,{__name:"BotSlugTableList",setup(o){return(t,s)=>(l(),n(v,null,[t.bot?(l(),n("div",Bl,[e("div",Rl,[e("button",{type:"button",onClick:s[0]||(s[0]=a=>t.show=!t.show),class:"btn btn-outline-success p-3 w-100"},[t.show?(l(),n("span",El,[Ll,m(" Свернуть форму добавления")])):(l(),n("span",Ml,[Dl,m(" Добавить глобальный скрипт")]))])]),t.show?(l(),n("div",Kl,[t.bot?(l(),$(H,{key:0,"can-add":!0,bot:t.bot,onCallback:t.loadSlugs},null,8,["bot","onCallback"])):r("",!0)])):r("",!0),e("div",Nl,[e("div",Jl,[c(e("input",{type:"search","onUpdate:modelValue":s[1]||(s[1]=a=>t.ownSearch=a),class:"form-control",id:"floatingInput",placeholder:"name@example.com"},null,512),[[h,t.ownSearch]]),Hl])]),e("div",Yl,[e("div",Gl,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[2]||(s[2]=a=>t.need_global=a),type:"checkbox",id:"need_global"},null,512),[[k,t.need_global]]),e("label",Wl,[t.need_global?(l(),n("span",Xl,"Глобальные")):(l(),n("span",Zl,"Локальные"))])]),e("div",xl,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[3]||(s[3]=a=>t.need_show_deleted=a),type:"checkbox",id:"need_show_deleted"},null,512),[[k,t.need_show_deleted]]),en])]),t.slugs&&t.bot?(l(),n("div",tn,[e("table",sn,[on,e("tbody",null,[(l(!0),n(v,null,y(t.slugs,(a,i)=>(l(),n("tr",{class:b({"border-info":a.deleted_at==null,"border-danger":a.deleted_at!=null})},[e("th",{scope:"row",class:b({"text-danger":a.deleted_at!=null})},u(a.id||"Нет идентификатора"),3),e("td",{onClick:d=>t.selectSlug(a),"data-bs-toggle":"modal","data-bs-target":"#edit-table-slug",class:b({"text-danger":a.deleted_at!=null})},u(a.command||"Нет команды"),11,ln),e("td",{class:b({"text-danger":a.deleted_at!=null})},u(a.comment||"Пояснение не указано"),3),e("td",null,[a.is_global?(l(),n("span",nn,dn)):(l(),n("span",rn,un))]),e("td",null,[e("div",mn,[_n,e("ul",hn,[o.canSelect?(l(),n("li",pn,[e("a",{onClick:d=>t.selectSlug(a),title:"Выбрать команду",class:"dropdown-item cursor-pointer"},[fn,m(" Выбрать команду ")],8,bn)])):r("",!0),o.canSelect?(l(),n("hr",gn)):r("",!0),e("li",{onClick:d=>t.selectSlug(a)},yn,8,vn),e("li",null,[e("a",{class:"dropdown-item cursor-pointer",onClick:d=>t.duplicateSlug(a)},[Fn,m(" Дублировать")],8,kn)]),e("li",null,[e("a",{class:"dropdown-item cursor-pointer",target:"_blank",href:"/admin/slugs/action-data-export/"+a.id},[Cn,m(" Скачать данные участников")],8,wn)]),a.deleted_at==null?(l(),n("li",Sn,[e("a",{class:"dropdown-item cursor-pointer",onClick:d=>t.removeSlug(a)},[Vn,m(" Удалить")],8,jn)])):r("",!0),a.deleted_at!=null?(l(),n("li",qn,[e("a",{class:"dropdown-item cursor-pointer",onClick:d=>t.restoreSlug(a)},[Pn,m(" Восстановить")],8,zn)])):r("",!0)])])])],2))),256))])])])):r("",!0),t.paginate?(l(),$(j,{key:2,onPagination_page:t.nextSlugs,pagination:t.paginate},null,8,["onPagination_page","pagination"])):r("",!0),t.slugs.length===0?(l(),n("div",Un,An)):r("",!0)])):r("",!0),e("div",In,[e("div",Qn,[t.selectedSlug&&!t.load?(l(),n("div",Tn,[e("div",Bn,[e("h5",Rn,[m("Редактирование команды #"),e("span",null,u(t.selectedSlug.id),1)]),Mn]),e("div",Dn,[e("div",En,[e("div",Ln,[f(de,{item:t.selectedSlug,onCallback:t.slugFormCallback},null,8,["item","onCallback"])])])]),Kn])):r("",!0)])])],64))}}),Hn={class:"row"},Yn={class:"col-12"},Gn=e("h6",null,"Добавление нового скрипта в бота",-1),Wn={key:0,class:"row"},Xn={class:"col-md-6 col-lg-4 col-sm-6 col-12 mb-2"},Zn={key:1,class:"row"},xn=e("div",{class:"col-12"},[e("div",{class:"alert alert-danger",role:"alert"},' У Вас еще нет добавленных скриптов! Воспользуйтесь разделом "Скрипты" для добавления. ')],-1),ei=[xn],ti={props:["bot","global","selected"],data(){return{load:!1,search:null,slugs:[],paginate:[]}},computed:{...C(["getSlugs","getSlugsPaginateObject"]),filteredSlugs(){return this.slugs?this.slugs.length===0?[]:this.search==null?this.slugs:this.slugs.filter(o=>{let t=o.slug||"",s=o.command||"",a=o.comment||"";return s.toLowerCase().indexOf(this.search.toLowerCase())!==-1||a.toLowerCase().indexOf(this.search.toLowerCase())!==-1||t.toLowerCase().indexOf(this.search.toLowerCase())!==-1}):[]}},mounted(){this.loadSlugs()},methods:{nextSlugs(o){this.loadSlugs(o)},selectSlug(o){this.$emit("callback",{id:o.id||null,slug:o.slug,comment:o.comment,command:o.command}),this.$notify("Вы выбрали скрипт из списка!")},loadSlugs(o=0){this.$store.dispatch("loadSlugs",{dataObject:{botId:this.bot.id,search:this.search||null,needGlobal:this.global},page:o}).then(t=>{this.slugs=this.getSlugs,this.paginate=this.getSlugsPaginateObject})},callbackSlugs(){}}},si=Object.assign(ti,{__name:"BotSlugListSimple",setup(o){return(t,s)=>(l(),n("div",Hn,[e("div",Yn,[Gn,e("div",null,[c(e("input",{type:"text",class:"form-control mt-1 mb-1","onUpdate:modelValue":s[0]||(s[0]=a=>t.search=a),onKeyup:s[1]||(s[1]=(...a)=>t.loadSlugs&&t.loadSlugs(...a)),placeholder:"Поиск нужного скрипта по описанию"},null,544),[[h,t.search]])]),t.slugs.length>0?(l(),n("div",Wn,[(l(!0),n(v,null,y(t.slugs,(a,i)=>(l(),n("div",Xn,[f(Tl,{"is-active":(o.selected||[]).indexOf(a.id)!=-1,item:a,bot:o.bot,onCallback:t.callbackSlugs,onSelect:t.selectSlug},null,8,["is-active","item","bot","onCallback","onSelect"])]))),256)),t.paginate?(l(),$(j,{key:0,onPagination_page:t.nextSlugs,pagination:t.paginate},null,8,["onPagination_page","pagination"])):r("",!0)])):(l(),n("div",Zn,ei))])]))}});const oi={props:["param"],data(){return{expressions:[{expression:null,description:"Нет проверки"},{expression:"/([a-z0-9]+)/i",description:"Проверка набора из латинских букв и цифр"},{expression:"/([а-яё0-9]+)/iu",description:"Проверка на кириллицу и цифры"},{expression:"/(?P<digit>\\d+)/",description:"Проверка на число"},{expression:"/^([a-z0-9_-]+.)*[a-z0-9_-]+@[a-z0-9_-]+(.[a-z0-9_-]+)*.[a-z]{2,6}$/",description:"Проверка Email"},{expression:"/^((8|+7)[- ]?)?((?d{3})?[- ]?)?[d- ]{7,10}$/",description:"Проверка номера телефона: +7(982)000-00-00"},{expression:"/^(0[1-9]|[12][0-9]|3[01])[.](0[1-9]|1[012])[.](19|20)dd$/",description:"Проверка даты по формату DD.MM.YYYY"},{expression:"/^[0-9]{4}-(0[1-9]|1[012])-(0[1-9]|1[0-9]|2[0-9]|3[01])$/",description:"Проверка даты по формату YYYY-MM-DD"},{expression:"/^(https?://)?([da-z.-]+).([a-z.]{2,6})([/w .-]*)*/?$/",description:"Проверка доменного имени"}]}},methods:{expressionsSelect(o){this.$emit("callback",{param:this.param,text:o.expression})}}},li={class:"dropdown"},ni=e("button",{class:"btn btn-link dropdown-toggle",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-regular fa-registered"})],-1),ii={class:"dropdown-menu item-with-text cursor-pointer text-muted p-2"},ai=["onClick"];function di(o,t,s,a,i,d){return l(),n("div",li,[ni,e("div",ii,[e("li",null,[(l(!0),n(v,null,y(i.expressions,_=>(l(),n("a",{class:"dropdown-item",onClick:p=>d.expressionsSelect(_)},u(_.description||"-"),9,ai))),256))])])])}const ri=U(oi,[["render",di]]),ci={class:"row mt-2"},ui={class:"col-12 d-flex justify-content-between align-items-center"},mi=["onClick"],_i={class:"row mb-2"},hi={class:"col-3"},pi={class:"form-floating"},bi=["onUpdate:modelValue"],fi=e("label",{for:"floatingInput"},"Значение параметра 1",-1),gi={class:"col-3"},vi={class:"form-floating"},$i=["onUpdate:modelValue"],yi=e("option",{value:null,selected:""},"без действия",-1),ki=["value"],Fi=e("label",{for:"floatingSelect"},"Доступные операции",-1),wi={class:"col-3"},Ci={class:"form-floating"},Si=["onUpdate:modelValue"],ji=e("label",{for:"floatingInput"},"Значение параметра 2",-1),Vi={class:"col-3"},qi={class:"form-floating"},zi=["disabled","onUpdate:modelValue"],Pi=e("label",{for:"floatingInput"},"Переменная результата",-1),Ui=e("div",{class:"row"},[e("div",{class:"col-6"},[e("h6",null,"Если условие выполнено")]),e("div",{class:"col-6"},[e("h6",null,[m("Если условие "),e("span",{class:"text-danger"},"не"),m(" выполнено")])])],-1),Oi={class:"row"},Ai={class:"col-6"},Ii={class:"form-floating mb-3"},Qi=["onUpdate:modelValue"],Ti=e("label",{for:"floatingInput"},"Текст для пользователя",-1),Bi={class:"col-6"},Ri={class:"form-floating mb-3"},Mi=["onUpdate:modelValue"],Di=e("label",{for:"floatingInput"},"Текст для пользователя",-1),Ei={class:"row"},Li={class:"col-6"},Ki={class:"form-check mb-2"},Ni=["onUpdate:modelValue","id"],Ji=["for"],Hi={class:"col-6"},Yi={class:"form-check mb-2"},Gi=["onUpdate:modelValue","id"],Wi=["for"],Xi={key:1,class:"alert alert-primary d-flex align-items-center mt-2",role:"alert"},Zi=e("i",{class:"fa-solid fa-triangle-exclamation mr-2"},null,-1),xi=e("div",null," Правила не добавлены ",-1),ea=[Zi,xi],ta={props:["modelValue"],data(){return{rules:[],operations:[{id:0,title:"Выдать результат без обработки"},{id:1,title:"Больше"},{id:2,title:"Меньше"},{id:3,title:"Равно"},{id:4,title:"Не равно"},{id:5,title:"Сложить"},{id:6,title:"Вычесть"},{id:7,title:"Логическое И"},{id:8,title:"Логическое ИЛИ"}]}},mounted(){this.modelValue&&(this.rules=this.modelValue)},methods:{addRule(){this.rules.push({param1:null,operation:null,param2:null,use_result_as:null,text_if_true:null,text_if_false:null,keyboard_if_true:null,keyboard_if_false:null,need_keyboard_if_true:!1,need_keyboard_if_false:!1}),this.$notify({title:"Конструктор ботов",text:"Успешная создано новое правило",type:"success"}),this.$emit("update:modelValue",this.rules)},testRule(o){let t=this.rules[o];return t.operation===5||t.operation===6},removeRule(o){this.rules.splice(o,1),this.$notify({title:"Конструктор ботов",text:"Успешная удалено выбранное правило",type:"success"})}}},sa=Object.assign(ta,{__name:"BotDialogResultRules",setup(o){return(t,s)=>(l(),n(v,null,[e("button",{type:"button",onClick:s[0]||(s[0]=(...a)=>t.addRule&&t.addRule(...a)),class:"btn btn-outline-info"},"Добавить правило "),t.rules.length>0?(l(!0),n(v,{key:0},y(t.rules,(a,i)=>(l(),n(v,null,[e("div",ci,[e("div",ui,[e("h6",null,"Шаг "+u(i+1),1),e("button",{onClick:d=>t.removeRule(i),type:"button",class:"btn btn-link"},"удалить правило ",8,mi)])]),e("div",_i,[e("div",hi,[e("div",pi,[c(e("input",{type:"text",class:"form-control","onUpdate:modelValue":d=>t.rules[i].param1=d,id:"floatingInput",placeholder:"name@example.com"},null,8,bi),[[h,t.rules[i].param1]]),fi])]),e("div",gi,[e("div",vi,[c(e("select",{class:"form-select","onUpdate:modelValue":d=>t.rules[i].operation=d,id:"floatingSelect","aria-label":"Floating label select example"},[yi,(l(!0),n(v,null,y(t.operations,d=>(l(),n("option",{value:d.id},u(d.title||"-"),9,ki))),256))],8,$i),[[Q,t.rules[i].operation]]),Fi])]),e("div",wi,[e("div",Ci,[c(e("input",{type:"text","onUpdate:modelValue":d=>t.rules[i].param2=d,class:"form-control",id:"floatingInput",placeholder:"name@example.com"},null,8,Si),[[h,t.rules[i].param2]]),ji])]),e("div",Vi,[e("div",qi,[c(e("input",{type:"text",disabled:!t.testRule(i),"onUpdate:modelValue":d=>t.rules[i].use_result_as=d,class:"form-control",id:"floatingInput",placeholder:"name@example.com"},null,8,zi),[[h,t.rules[i].use_result_as]]),Pi])])]),Ui,e("div",Oi,[e("div",Ai,[e("div",Ii,[c(e("input",{type:"text","onUpdate:modelValue":d=>t.rules[i].text_if_true=d,class:"form-control",id:"floatingInput",placeholder:"name@example.com"},null,8,Qi),[[h,t.rules[i].text_if_true]]),Ti])]),e("div",Bi,[e("div",Ri,[c(e("input",{type:"text","onUpdate:modelValue":d=>t.rules[i].text_if_false=d,class:"form-control",id:"floatingInput",placeholder:"name@example.com"},null,8,Mi),[[h,t.rules[i].text_if_false]]),Di])])]),e("div",Ei,[e("div",Li,[e("div",Ki,[c(e("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":d=>t.rules[i].need_keyboard_if_true=d,id:"need-keyboard-if-true-"+i},null,8,Ni),[[k,t.rules[i].need_keyboard_if_true]]),e("label",{class:"form-check-label",for:"need-keyboard-if-true-"+i}," Нужна клавиатура ",8,Ji)]),t.rules[i].need_keyboard_if_true?(l(),$(A,{key:0,type:"inline",modelValue:t.rules[i].keyboard_if_true,"onUpdate:modelValue":d=>t.rules[i].keyboard_if_true=d},null,8,["modelValue","onUpdate:modelValue"])):r("",!0)]),e("div",Hi,[e("div",Yi,[c(e("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":d=>t.rules[i].need_keyboard_if_false=d,id:"need-keyboard-if-false-"+i},null,8,Gi),[[k,t.rules[i].need_keyboard_if_false]]),e("label",{class:"form-check-label",for:"need-keyboard-if-false-"+i}," Нужна клавиатура ",8,Wi)]),t.rules[i].need_keyboard_if_false?(l(),$(A,{key:0,type:"inline",modelValue:t.rules[i].keyboard_if_false,"onUpdate:modelValue":d=>t.rules[i].keyboard_if_false=d},null,8,["modelValue","onUpdate:modelValue"])):r("",!0)])])],64))),256)):(l(),n("div",Xi,ea))],64))}});const oa={props:["modelValue","bot"],data(){return{text:null,search:null,variables:[]}},watch:{text:{handler:function(o){this.$emit("update:modelValue",this.text)},deep:!0}},computed:{filteredVariable(){return this.search?this.variables.filter(o=>o.text.indexOf(this.search)!==-1):this.variables}},mounted(){this.text=this.modelValue,this.loadVariables()},methods:{select(o){this.text||(this.text=""),this.text+=o},addAll(){this.filteredVariable.forEach(o=>{this.select(o)})},loadVariables(){this.$store.dispatch("loadDialogVariables",{bot_id:this.bot.id}).then(o=>{this.variables=o.data})}}},la={class:"dropdown"},na=e("button",{class:"btn btn-link dropdown-toggle",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-solid fa-spell-check"})],-1),ia={class:"dropdown-menu item-with-text cursor-pointer text-muted p-2"},aa=e("div",{class:"dropdown-divider"},null,-1),da=e("div",{class:"dropdown-divider"},null,-1),ra=["onClick"];function ca(o,t,s,a,i,d){return l(),n("div",la,[na,e("div",ia,[c(e("input",{type:"search",class:"form-control",id:"search-description-text","onUpdate:modelValue":t[0]||(t[0]=_=>i.search=_),placeholder:"Введите текст для поиска"},null,512),[[h,i.search]]),aa,e("button",{type:"button",onClick:t[1]||(t[1]=(..._)=>d.addAll&&d.addAll(..._)),class:"btn-outline-light btn w-100 text-primary"},"Добавить все "),da,(l(!0),n(v,null,y(d.filteredVariable,(_,p)=>(l(),n("p",{class:"p-1 text-left w-100 mb-1",onClick:F=>d.select(_)},u(_),9,ra))),256))])])}const W=U(oa,[["render",ca]]),ua={class:"mb-2 px-0"},ma={type:"submit",class:"btn btn-outline-success"},_a=e("i",{class:"fa-regular fa-floppy-disk mr-2"},null,-1),ha={key:0},pa={key:1},ba={class:"nav nav-tabs"},fa={class:"nav-item"},ga=e("i",{class:"fa-regular fa-comment-dots mr-2"},null,-1),va={class:"nav-item"},$a=e("i",{class:"fa-solid fa-link mr-2"},null,-1),ya={key:0,class:"nav-item"},ka=e("i",{class:"fa-brands fa-uncharted mr-2"},null,-1),Fa={key:1,class:"nav-item"},wa=e("i",{class:"fa-solid fa-hashtag mr-2"},null,-1),Ca={key:0,class:"py-2 px-0"},Sa={class:"form-check mb-2"},ja=["id"],Va=["for"],qa={key:0,class:"form-check mb-2"},za=["id"],Pa=["for"],Ua={key:1,class:"alert alert-info",role:"alert"},Oa={class:"form-floating mb-2"},Aa=["id"],Ia=["for"],Qa={key:2,class:"card"},Ta={class:"card-body"},Ba=e("div",{class:"alert alert-light"}," Данные блоки настраивают отображение данных администратором ",-1),Ra={class:"form-check"},Ma=["id"],Da=["for"],Ea={class:"alert alert-light"},La={class:"form-floating mb-2"},Ka=["id"],Na=["for"],Ja={class:"form-check"},Ha=["id"],Ya=["for"],Ga={class:"form-check"},Wa=["id"],Xa=["for"],Za={key:1,class:"form-floating mb-2"},xa=e("label",{for:"floatingInput"},"Почта для отправки результата",-1),ed={key:3,class:"mb-2"},td={class:"form-floating"},sd=e("label",{for:"floatingPassword"},"Сохранить ответ пользователя как внутреннюю переменную",-1),od={key:4,class:"form-check mb-2"},ld=e("label",{class:"form-check-label",for:"need-custom-stored-value"}," Нужно изменить данные в переменной ",-1),nd={key:5,class:"mb-2"},id={class:"form-floating"},ad=e("label",{for:"custom_stored_value"},"Поместить эти данные в результат",-1),dd={key:6,class:"form-floating mb-2"},rd=["disabled","id"],cd=["for"],ud={key:1,class:"py-2 px-0"},md={class:"mb-2"},_d={key:0,class:"row"},hd=e("div",{class:"col-12"},[e("h6",null,"Выбрать следующий диалог:")],-1),pd={key:0,class:"col-12 mb-2"},bd=e("i",{class:"fa-solid fa-arrows-rotate"},null,-1),fd={class:"col-md-12 mb-1"},gd={type:"button",class:"btn btn-outline-primary w-100 d-flex justify-content-between align-items-center",style:{"text-align":"left"}},vd=["onClick"],$d={key:1,class:"row"},yd=e("div",{class:"col-12"},[e("div",{class:"alert alert-danger",role:"alert"}," Диалогов для связывания нет ")],-1),kd=[yd],Fd={key:2,class:"py-2 px-0"},wd={class:"form-check mb-2"},Cd=e("label",{class:"form-check-label",for:"need-additional-functions"}," Нужен дополнительный функционал управления ",-1),Sd={key:0,class:"form-floating mb-2"},jd=["id"],Vd=["for"],qd={key:1,class:"mb-2"},zd={class:"d-flex justify-content-between align-items-center"},Pd=e("p",{class:"mb-2"},"Регулярное выражение для валидации данных ",-1),Ud={class:"form-floating"},Od=["id"],Ad=["for"],Id={key:2,class:"mb-2"},Qd={class:"d-flex justify-content-between align-items-center"},Td=e("p",{class:"mb-2"},"Канал для отправки данных ",-1),Bd={class:"form-floating"},Rd=["id"],Md=["for"],Dd={key:3,class:"mb-2"},Ed={class:"form-floating"},Ld=e("option",{selected:""},"Не выбрано",-1),Kd=["value"],Nd=e("label",{for:"store_variants"},"Сохранить в переменную",-1),Jd={class:"form-check mb-2"},Hd=e("label",{class:"form-check-label",for:"need-dialog-image"}," В диалоге нужно изображение ",-1),Yd={key:4,class:"card mb-2"},Gd={class:"card-body"},Wd=e("h6",null,"Фотографии к диалогу",-1),Xd={class:"photo-preview d-flex justify-content-start flex-wrap w-100"},Zd={for:"location-photos",style:{"margin-right":"10px"},class:"photo-loader ml-2"},xd=e("span",null,"+",-1),er={class:"mb-2 img-preview",style:{"margin-right":"10px"}},tr={class:"remove"},sr=["onClick"],or={class:"mb-2 img-preview",style:{"margin-right":"10px"}},lr={class:"remove"},nr=["onClick"],ir={class:"form-check mb-2"},ar=e("label",{class:"form-check-label",for:"need-dialog-menu-inline"}," В диалоге нужно меню тексту ",-1),dr={key:5,class:"card mb-2"},rr=e("div",{class:"card-header"},[e("h6",null,"Кнопки к тексту вопроса")],-1),cr={class:"card-body"},ur={class:"form-check mb-2"},mr=e("label",{class:"form-check-label",for:"need-dialog-menu-reply"}," В диалоге нужно нижнее меню ",-1),_r={key:6,class:"card mb-2"},hr=e("div",{class:"card-header"},[e("h6",null,"Кнопки в виде нижнего меню")],-1),pr={class:"card-body"},br={class:"form-check mb-2"},fr=e("label",{class:"form-check-label",for:"need-chains"}," Нужны многоуровневые диалоги ",-1),gr={key:7,class:"mb-2"},vr={key:0,class:"w-100 my-3",style:{"border-collapse":"separate","border-spacing":"5px 10px"}},$r=e("tr",{style:{"border-top":"1px #eaeaea solid"}},[e("td"),e("td"),e("td",null,[e("strong",null,"Ответ")]),e("td",null,[e("strong",null,"Следующий диалог")])],-1),yr={style:{width:"40px"}},kr=["onClick"],Fr=e("i",{class:"fa-solid fa-toggle-off cursor-pointer text-secondary"},null,-1),wr=[Fr],Cr=["onClick"],Sr=e("i",{class:"fa-solid fa-toggle-on cursor-pointer text-primary"},null,-1),jr=[Sr],Vr={scope:"row"},qr={class:"input-group"},zr={class:"input-group-text",id:"basic-addon1"},Pr=["onUpdate:modelValue"],Ur={class:"form-floating"},Or=["onUpdate:modelValue"],Ar=e("label",{for:"floatingInput"},"Точный текст ответа",-1),Ir={class:"input-group"},Qr={class:"form-floating"},Tr=["onUpdate:modelValue"],Br=e("label",{for:"floatingInput"},"Выберите\\введите диалог или введите его номер",-1),Rr={class:"dropdown d-flex"},Mr=e("button",{class:"btn btn-outline-secondary w-100",style:{"border-radius":"0px 5px 5px 0px"},"data-bs-auto-close":"outside",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-solid fa-up-right-and-down-left-from-center"})],-1),Dr={class:"dropdown-menu p-2",style:{width:"400px","max-height":"300px","overflow-y":"auto"}},Er={class:"list-group"},Lr=["onClick"],Kr=["onClick"],Nr={class:"px-3 pt-2"},Jr={class:"dropdown d-flex justify-content-center align-items-center"},Hr=e("button",{class:"btn btn-link",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-solid fa-bars"})],-1),Yr={class:"dropdown-menu"},Gr=["onClick"],Wr={key:0},Xr=e("td",null,null,-1),Zr=e("td",null,null,-1),xr={class:"input-group"},ec={class:"form-floating"},tc=["onUpdate:modelValue"],sc=e("label",{for:"floatingInput"},"Шаблон предполагаемого текста",-1),oc={class:"dropdown d-flex"},lc=e("button",{class:"btn btn-outline-secondary w-100",style:{"border-radius":"0px 5px 5px 0px"},type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-solid fa-up-right-and-down-left-from-center"})],-1),nc={class:"dropdown-menu"},ic=["onClick"],ac=["onClick"],dc={class:"form-floating"},rc=["onUpdate:modelValue","id"],cc=["for"],uc={key:1,class:"alert alert-primary mt-2",role:"alert"},mc={class:"form-check mb-2"},_c=e("label",{class:"form-check-label",for:"need-set-flags"}," Установить флаги в соответствующее значение ",-1),hc={key:8,class:"mb-2"},pc=e("p",null,"Выбрать флаги",-1),bc=["onClick"],fc={key:3,class:"py-2 px-0"},gc={props:["item","bot"],data(){return{tab:0,patterns:[{title:"Номер телефона РФ",value:"/^\\s?(\\+\\s?7|8)([- ()]*\\d){10}$/"},{title:"Дата в формате ДД/ММ/ГГГГ",value:"/(\\d{2})\\/(\\d{2})\\/(\\d{4})$/"},{title:"Время в формате ЧЧ:ММ[:СС]",value:"#^[01]?[0-9]|2[0-3]):[0-5][0-9](:[0-5][0-9])?$#"}],test:[],loading:!0,dialog_commands:[],dialog_commands_paginate_object:null,need_images:!1,need_inline_keyboard:!1,need_reply_keyboard:!1,need_custom_stored_value:!1,need_additional_functions:!1,need_chains:!1,need_set_flags:!1,flags_variants:[{title:"Является VIP",key:"is_vip",value:null},{title:"Является Админом",key:"is_admin",value:null},{title:"За работой",key:"is_work",value:null},{title:"Является менеджером",key:"is_manager",value:null}],store_variants:[{title:"Имя",key:"name"},{title:"Почта",key:"email"},{title:"Возраст",key:"age"},{title:"Город",key:"city"},{title:"Страна",key:"country"},{title:"Адрес",key:"address"},{title:"Телефон",key:"phone"},{title:"День рождение",key:"birthday"}],commandForm:{id:null,slug:null,pre_text:null,post_text:null,error_text:null,bot_id:null,input_pattern:null,inline_keyboard_id:null,reply_keyboard_id:null,images:null,next_bot_dialog_command_id:null,bot_dialog_group_id:null,is_empty:!1,is_inform:!1,custom_stored_value:null,send_params:{send_by_text:!0,format:null,send_by_file:!1,send_to_mail:!1,mail:null},result_flags:[],store_to:null,use_result_as:null,result_channel:null,inline_keyboard:null,reply_keyboard:null,answers:[],rules:[]},photos:[]}},watch:{"commandForm.is_inform":function(o,t){this.commandForm.is_inform&&(this.commandForm.is_empty=!1,this.commandForm.post_text=null,this.commandForm.answers=[])},need_custom_stored_value:function(o,t){this.need_custom_stored_value||(this.commandForm.custom_stored_value=null)},need_inline_keyboard:function(o,t){this.need_inline_keyboard||(this.commandForm.inline_keyboard_id=null,this.commandForm.inline_keyboard=null)},need_reply_keyboard:function(o,t){this.need_reply_keyboard||(this.commandForm.reply_keyboard_id=null,this.commandForm.reply_keyboard=null)},need_set_flags:function(o,t){this.need_set_flags||(this.commandForm.result_flags=[])},need_images:function(o,t){this.need_images||(this.commandForm.images=null)}},computed:{...C(["getDialogCommands","getDialogCommandsPaginateObject"]),filteredCommands(){return this.dialog_commands?this.dialog_commands.filter(o=>o.id!=this.commandForm.id):[]}},mounted(){this.item&&this.$nextTick(()=>{this.commandForm={id:this.item.id||null,slug:this.item.slug||null,pre_text:this.item.pre_text||null,post_text:this.item.post_text||null,error_text:this.item.error_text||null,custom_stored_value:this.item.custom_stored_value||null,is_empty:this.item.is_empty||!1,is_inform:this.item.is_inform||!1,input_pattern:this.item.input_pattern||null,inline_keyboard_id:this.item.inline_keyboard_id||null,reply_keyboard_id:this.item.reply_keyboard_id||null,images:this.item.images||[],next_bot_dialog_command_id:this.item.next_bot_dialog_command_id||null,bot_dialog_group_id:this.item.bot_dialog_group_id||null,result_channel:this.item.result_channel||null,inline_keyboard:this.item.inline_keyboard||null,reply_keyboard:this.item.reply_keyboard||null,result_flags:this.item.result_flags||[],store_to:this.item.store_to||null,answers:this.item.answers||[],use_result_as:this.item.use_result_as||null,rules:this.item.rules||[],send_params:{send_by_text:!0,format:null,send_by_file:!1,send_to_mail:!1,mail:null}},this.item.send_params&&(this.commandForm.send_params.format=this.item.send_params.format||null,this.commandForm.send_params.send_by_text=this.item.send_params.send_by_text||!0,this.commandForm.send_params.send_by_file=this.item.send_params.send_by_file||!1,this.commandForm.send_params.send_to_mail=this.item.send_params.send_to_mail||!1,this.commandForm.send_params.mail=this.item.send_params.mail||null),this.bot&&(this.commandForm.bot_id=this.bot.id||null),this.commandForm.inline_keyboard_id!=null&&(this.need_inline_keyboard=!0),this.commandForm.reply_keyboard_id!=null&&(this.need_reply_keyboard=!0),this.commandForm.images.length>0&&(this.need_images=!0),this.commandForm.result_flags.length>0&&(this.need_set_flags=!0),this.commandForm.answers.length>0&&(this.need_chains=!0),this.commandForm.custom_stored_value&&(this.need_custom_stored_value=!0)}),this.bot&&this.$nextTick(()=>{this.commandForm.bot_id=this.bot.id}),this.loadDialogs()},methods:{toggleRepeatSelfDialog(){this.commandForm.next_bot_dialog_command_id!=null&&this.commandForm.next_bot_dialog_command_id!==this.commandForm.id?this.commandForm.next_bot_dialog_command_id=this.commandForm.id:this.commandForm.next_bot_dialog_command_id=this.commandForm.next_bot_dialog_command_id===null?this.commandForm.id:null},addAnswer(){this.commandForm.answers.push({id:null,bot_dialog_command_id:null,answer:null,need_print:!0,pattern:null,custom_stored_value:null,next_bot_dialog_command_id:null})},nextDialogs(o){this.loadDialogs(o)},removeDialogAnswer(o,t){if(o.id==null){this.commandForm.answers.splice(t,1);return}this.commandForm.answers.splice(t,1),this.loading=!0,this.$store.dispatch("removeDialogAnswer",{dataObject:{dialogAnswerId:o.id}}).then(s=>{this.loading=!1,this.loadDialogs()}).catch(()=>{this.loading=!1})},loadDialogs(o=0){this.loading=!0,this.$store.dispatch("loadLinkedDialogCommands",{dataObject:{botId:this.bot.id||null,order:"id",direction:"asc"},page:o,size:100}).then(t=>{this.loading=!1;let s=t.data;this.dialog_commands=s.data||[],delete s.data,this.dialog_commands_paginate_object=s}).catch(()=>{this.loading=!1})},doCommandLink(o){this.loading=!0,this.commandForm.next_bot_dialog_command_id=o},submit(){this.loading=!0;let o=new FormData;if(Object.keys(this.commandForm).forEach(t=>{const s=this.commandForm[t]||"";typeof s=="object"?o.append(t,JSON.stringify(s)):o.append(t,s)}),this.photos){for(let t=0;t<this.photos.length;t++)o.append("files[]",this.photos[t]);o.delete("photos")}this.$store.dispatch(this.commandForm.id?"updateDialogCommand":"createDialogCommand",{dialogCommandForm:o}).then(t=>{this.loading=!1,this.$notify({title:"Конструктор ботов",text:"Успешная обработка диалоговой команды",type:"success"}),this.commandForm.id==null&&(this.commandForm={id:null,slug:null,pre_text:null,post_text:null,error_text:null,input_pattern:null,inline_keyboard_id:null,images:null,next_bot_dialog_command_id:null,bot_dialog_group_id:null,result_channel:null,inline_keyboard:null,is_inform:!1,is_empty:!1,result_flags:[],answers:[],store_to:null,custom_stored_value:null,use_result_as:null},this.photos=[]),this.$emit("callback")}).catch(t=>{this.loading=!1})},getPhoto(o){return{imageUrl:URL.createObjectURL(o)}},removePhoto(o,t){this[o].splice(t,1)},onChangePhotos(o){const t=o.target.files;for(let s=0;s<t.length;s++)this.photos.push(t[s])},addTextTo(o={param:null,text:null}){this.commandForm[o.param]=o.text},selectFlag(o){(!this.commandForm.result_flags||!Array.isArray(this.commandForm.result_flags))&&(this.commandForm.result_flags=[]);let t=this.commandForm.result_flags.indexOf(o.key);t===-1?this.commandForm.result_flags.push(o.key):this.commandForm.result_flags.splice(t,1)}}},X=Object.assign(gc,{__name:"BotDialogCommandForm",setup(o){return(t,s)=>{const a=I("lazy");return l(),n("form",{onSubmit:s[35]||(s[35]=S((...i)=>t.submit&&t.submit(...i),["prevent"]))},[e("div",ua,[e("button",ma,[_a,t.commandForm.id?(l(),n("span",ha,"Обновить диалог #"+u(t.commandForm.id),1)):(l(),n("span",pa,"Добавить диалог"))])]),e("ul",ba,[e("li",fa,[e("a",{class:b(["nav-link",{active:t.tab===0}]),onClick:s[0]||(s[0]=i=>t.tab=0),"aria-current":"page",href:"javascript:void(0)"},[ga,m(" Основное")],2)]),e("li",va,[e("a",{class:b(["nav-link",{active:t.tab===1}]),onClick:s[1]||(s[1]=i=>t.tab=1),href:"javascript:void(0)"},[$a,m(" Связывание диалогов")],2)]),t.commandForm.is_inform?r("",!0):(l(),n("li",ya,[e("a",{class:b(["nav-link",{active:t.tab===2}]),onClick:s[2]||(s[2]=i=>t.tab=2),href:"javascript:void(0)"},[ka,m(" Дополнительное")],2)])),t.commandForm.is_empty?(l(),n("li",Fa,[e("a",{class:b(["nav-link",{active:t.tab===3}]),onClick:s[3]||(s[3]=i=>t.tab=3),href:"javascript:void(0)","aria-disabled":"true"},[wa,m(" Вычисление результата")],2)])):r("",!0)]),t.tab===0?(l(),n("div",Ca,[e("div",Sa,[c(e("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":s[4]||(s[4]=i=>t.commandForm.is_inform=i),id:"need-inform-dialog"+(t.commandForm.id||"new"),checked:""},null,8,ja),[[k,t.commandForm.is_inform]]),e("label",{class:"form-check-label",for:"need-inform-dialog"+(t.commandForm.id||"new")}," Диалог только выводит данные ",8,Va)]),t.commandForm.is_inform?r("",!0):(l(),n("div",qa,[c(e("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":s[5]||(s[5]=i=>t.commandForm.is_empty=i),id:"need-empty-dialog"+(t.commandForm.id||"new"),checked:""},null,8,za),[[k,t.commandForm.is_empty]]),e("label",{class:"form-check-label",for:"need-empty-dialog"+(t.commandForm.id||"new")}," Диалог завершает цепочку (только вывод информации) ",8,Pa)])),t.commandForm.is_inform?(l(),n("div",Ua," Данный диалог позволит вам сразу вызвать связанный с ним другой диалог без ожидания ввод данных от пользователя! ")):r("",!0),f(W,{modelValue:t.commandForm.pre_text,"onUpdate:modelValue":s[6]||(s[6]=i=>t.commandForm.pre_text=i),bot:o.bot},null,8,["modelValue","bot"]),e("div",Oa,[c(e("textarea",{class:"form-control",id:"commandForm-pre-text-"+t.commandForm.id,placeholder:"Начни с малого...","onUpdate:modelValue":s[7]||(s[7]=i=>t.commandForm.pre_text=i),required:""},`
                `,8,Aa),[[h,t.commandForm.pre_text]]),e("label",{for:"commandForm-pre-text-"+t.commandForm.id},"Текст диалога",8,Ia)]),t.commandForm.is_empty?(l(),n("div",Qa,[e("div",Ta,[Ba,e("div",Ra,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[8]||(s[8]=i=>t.commandForm.send_params.send_by_text=i),type:"checkbox",role:"switch",id:"send-result-by-text"+(t.commandForm.id||"new")},null,8,Ma),[[k,t.commandForm.send_params.send_by_text]]),e("label",{class:"form-check-label",for:"send-result-by-text"+(t.commandForm.id||"new")},"Отправить текстом",8,Da)]),t.commandForm.send_params.send_by_text?(l(),n(v,{key:0},[e("div",Ea,[m(" Выберите шаблон из списка "),f(W,{class:"d-inline",modelValue:t.commandForm.send_params.format,"onUpdate:modelValue":s[9]||(s[9]=i=>t.commandForm.send_params.format=i),bot:o.bot},null,8,["modelValue","bot"]),m(" для форматирования результата или оставьте поле пустым, тогда будут выданы все полученные данные. Если каких-то полей не будет в результате - они будут проигнорированы. ")]),e("div",La,[c(e("textarea",{class:"form-control",id:"commandForm-send-params-format-"+(t.commandForm.id||"new"),placeholder:"Начни с малого...","onUpdate:modelValue":s[10]||(s[10]=i=>t.commandForm.send_params.format=i)},`
                                `,8,Ka),[[h,t.commandForm.send_params.format]]),e("label",{for:"commandForm-send-params-format-"+(t.commandForm.id||"new")},"Шаблон результата",8,Na)])],64)):r("",!0),e("div",Ja,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[11]||(s[11]=i=>t.commandForm.send_params.send_by_file=i),type:"checkbox",role:"switch",id:"send-result-by-file"+(t.commandForm.id||"new")},null,8,Ha),[[k,t.commandForm.send_params.send_by_file]]),e("label",{class:"form-check-label",for:"send-result-by-file"+(t.commandForm.id||"new")},"Отправить файлом",8,Ya)]),e("div",Ga,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[12]||(s[12]=i=>t.commandForm.send_params.send_to_mail=i),type:"checkbox",role:"switch",id:"send-result-to-mail"+(t.commandForm.id||"new")},null,8,Wa),[[k,t.commandForm.send_params.send_to_mail]]),e("label",{class:"form-check-label",for:"send-result-to-mail"+(t.commandForm.id||"new")},"Отправить на почту",8,Xa)]),t.commandForm.send_params.send_to_mail?(l(),n("div",Za,[c(e("input",{type:"email","onUpdate:modelValue":s[13]||(s[13]=i=>t.commandForm.send_params.mail=i),class:"form-control",id:"floatingInput",placeholder:"name@example.com",required:""},null,512),[[h,t.commandForm.send_params.mail]]),xa])):r("",!0)])])):r("",!0),t.commandForm.is_empty?r("",!0):(l(),n("div",ed,[e("div",td,[c(e("input",{type:"text",class:"form-control",id:"floatingPassword","onUpdate:modelValue":s[14]||(s[14]=i=>t.commandForm.use_result_as=i),placeholder:"Password"},null,512),[[h,t.commandForm.use_result_as]]),sd])])),t.commandForm.is_empty?r("",!0):(l(),n("div",od,[c(e("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":s[15]||(s[15]=i=>t.need_custom_stored_value=i),id:"need-custom-stored-value"},null,512),[[k,t.need_custom_stored_value]]),ld])),!t.commandForm.is_empty&&t.need_custom_stored_value?(l(),n("div",nd,[e("div",id,[c(e("input",{type:"text",class:"form-control",id:"custom_stored_value","onUpdate:modelValue":s[16]||(s[16]=i=>t.commandForm.custom_stored_value=i),placeholder:"Password"},null,512),[[h,t.commandForm.custom_stored_value]]),ad])])):r("",!0),!t.commandForm.is_empty&&!t.commandForm.is_inform?(l(),n("div",dd,[c(e("textarea",{class:"form-control",disabled:t.commandForm.is_inform,id:"commandForm-post-text-"+t.commandForm.id,placeholder:"Начни с малого...","onUpdate:modelValue":s[17]||(s[17]=i=>t.commandForm.post_text=i)},`
            `,8,rd),[[h,t.commandForm.post_text]]),e("label",{for:"commandForm-post-text-"+t.commandForm.id},"Текст после успешного завершения диалога",8,cd)])):r("",!0)])):r("",!0),t.tab===1?(l(),n("div",ud,[e("div",md,[t.filteredCommands.length>0?(l(),n("div",_d,[hd,t.commandForm.id?(l(),n("div",pd,[e("button",{type:"button",onClick:s[18]||(s[18]=(...i)=>t.toggleRepeatSelfDialog&&t.toggleRepeatSelfDialog(...i)),class:b([{"btn-outline-primary":t.commandForm.next_bot_dialog_command_id!==t.commandForm.id,"btn-primary":t.commandForm.next_bot_dialog_command_id===t.commandForm.id},"btn"])},[bd,m(" Зациклить диалог на себе в случае ошибки ")],2)])):r("",!0),(l(!0),n(v,null,y(t.filteredCommands,(i,d)=>(l(),n("div",fd,[e("button",gd,[e("span",null,[t.commandForm.next_bot_dialog_command_id==i.id?(l(),n("i",{key:0,class:"fa-solid fa-unlink text-danger mr-2",onClick:s[19]||(s[19]=_=>t.doCommandLink(null))})):(l(),n("i",{key:1,onClick:_=>t.doCommandLink(i.id),class:"fa-solid fa-link mr-2 text-success"},null,8,vd)),m(" [#"+u(i.id)+"] Текст диалога: "+u(i.pre_text||"Без текста"),1)])])]))),256)),t.dialog_commands_paginate_object?(l(),$(j,{key:1,onPagination_page:t.nextDialogs,pagination:t.dialog_commands_paginate_object},null,8,["onPagination_page","pagination"])):r("",!0)])):(l(),n("div",$d,kd))])])):r("",!0),t.tab===2?(l(),n("div",Fd,[e("div",wd,[c(e("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":s[20]||(s[20]=i=>t.need_additional_functions=i),id:"need-additional-functions"},null,512),[[k,t.need_additional_functions]]),Cd]),!t.commandForm.is_empty&&t.need_additional_functions?(l(),n("div",Sd,[c(e("textarea",{type:"text",class:"form-control",id:"commandForm-error-text-"+t.commandForm.id,placeholder:"Начни с малого...","onUpdate:modelValue":s[21]||(s[21]=i=>t.commandForm.error_text=i)},`
            `,8,jd),[[h,t.commandForm.error_text]]),e("label",{for:"commandForm-error-text-"+t.commandForm.id},"Текст на случай ошибки корректности данных",8,Vd)])):r("",!0),!t.commandForm.is_empty&&t.need_additional_functions?(l(),n("div",qd,[e("div",zd,[Pd,f(ri,{param:"input_pattern",onCallback:t.addTextTo},null,8,["onCallback"])]),e("div",Ud,[c(e("input",{type:"text","onUpdate:modelValue":s[22]||(s[22]=i=>t.commandForm.input_pattern=i),maxlength:"255",class:"form-control",id:"commandForm-input-pattern-"+t.commandForm.id,placeholder:"Регулярное выражение"},null,8,Od),[[h,t.commandForm.input_pattern]]),e("label",{for:"commandForm-result-channel-"+t.commandForm.id},"Регулярное выражение",8,Ad)])])):r("",!0),t.need_additional_functions?(l(),n("div",Id,[e("div",Qd,[Td,o.bot?(l(),$(ne,{key:0,token:o.bot.bot_token,param:"result_channel",onCallback:t.addTextTo},null,8,["token","onCallback"])):r("",!0)]),e("div",Bd,[c(e("input",{type:"number","onUpdate:modelValue":s[23]||(s[23]=i=>t.commandForm.result_channel=i),class:"form-control",id:"commandForm-result-channel-"+t.commandForm.id,placeholder:"id канала"},null,8,Rd),[[h,t.commandForm.result_channel]]),e("label",{for:"commandForm-result-channel-"+t.commandForm.id},"id канала",8,Md)])])):r("",!0),t.need_additional_functions?(l(),n("div",Dd,[e("div",Ed,[c(e("select",{class:"form-select","onUpdate:modelValue":s[24]||(s[24]=i=>t.commandForm.store_to=i),id:"store_variants","aria-label":"Floating label select example"},[Ld,(l(!0),n(v,null,y(t.store_variants,i=>(l(),n("option",{value:i.key},u(i.title||"Не указано"),9,Kd))),256))],512),[[Q,t.commandForm.store_to]]),Nd])])):r("",!0),e("div",Jd,[c(e("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":s[25]||(s[25]=i=>t.need_images=i),id:"need-dialog-image",checked:""},null,512),[[k,t.need_images]]),Hd]),t.need_images?(l(),n("div",Yd,[e("div",Gd,[Wd,e("div",Xd,[e("label",Zd,[xd,e("input",{type:"file",id:"location-photos",multiple:"",accept:"image/*",onChange:s[26]||(s[26]=(...i)=>t.onChangePhotos&&t.onChangePhotos(...i)),style:{display:"none"}},null,32)]),t.photos.length>0?(l(!0),n(v,{key:0},y(t.photos,(i,d)=>(l(),n("div",er,[c(e("img",null,null,512),[[a,t.getPhoto(i).imageUrl]]),e("div",tr,[e("a",{onClick:_=>t.removePhoto("photos",d)},"Удалить",8,sr)])]))),256)):r("",!0),t.commandForm.images&&o.bot?(l(!0),n(v,{key:1},y(t.commandForm.images,(i,d)=>(l(),n("div",or,[c(e("img",null,null,512),[[a,"/images-by-bot-id/"+o.bot.id+"/"+i]]),e("div",lr,[e("a",{onClick:_=>t.removePhoto("images",d)},"Удалить",8,nr)])]))),256)):r("",!0)])])])):r("",!0),e("div",ir,[c(e("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":s[27]||(s[27]=i=>t.need_inline_keyboard=i),id:"need-dialog-menu-inline",checked:""},null,512),[[k,t.need_inline_keyboard]]),ar]),t.need_inline_keyboard?(l(),n("div",dr,[rr,e("div",cr,[f(A,{type:"inline",modelValue:t.commandForm.inline_keyboard,"onUpdate:modelValue":s[28]||(s[28]=i=>t.commandForm.inline_keyboard=i)},null,8,["modelValue"])])])):r("",!0),e("div",ur,[c(e("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":s[29]||(s[29]=i=>t.need_reply_keyboard=i),id:"need-dialog-menu-reply",checked:""},null,512),[[k,t.need_reply_keyboard]]),mr]),t.need_reply_keyboard?(l(),n("div",_r,[hr,e("div",pr,[f(A,{type:"reply",modelValue:t.commandForm.reply_keyboard,"onUpdate:modelValue":s[30]||(s[30]=i=>t.commandForm.reply_keyboard=i)},null,8,["modelValue"])])])):r("",!0),e("div",br,[c(e("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":s[31]||(s[31]=i=>t.need_chains=i),id:"need-chains",checked:""},null,512),[[k,t.need_chains]]),fr]),t.need_chains?(l(),n("div",gr,[e("button",{type:"button",class:"btn btn-outline-primary",onClick:s[32]||(s[32]=(...i)=>t.addAnswer&&t.addAnswer(...i))},"Добавить вариант ответа "),t.commandForm.answers.length>0?(l(),n("table",vr,[e("tbody",null,[(l(!0),n(v,null,y(t.commandForm.answers,(i,d)=>(l(),n(v,null,[$r,e("tr",null,[e("td",yr,[t.commandForm.answers[d].in_edit_mode?(l(),n("span",{key:1,onClick:_=>t.commandForm.answers[d].in_edit_mode=!1},jr,8,Cr)):(l(),n("span",{key:0,onClick:_=>t.commandForm.answers[d].in_edit_mode=!0},wr,8,kr))]),e("th",Vr,u(d+1),1),e("td",null,[e("div",qr,[e("span",zr,[c(e("input",{class:"form-check-input","onUpdate:modelValue":_=>t.commandForm.answers[d].need_print=_,type:"checkbox",value:"",id:"flexCheckDefault"},null,8,Pr),[[k,t.commandForm.answers[d].need_print]])]),e("div",Ur,[c(e("input",{type:"text","onUpdate:modelValue":_=>t.commandForm.answers[d].answer=_,class:"form-control",id:"floatingInput",placeholder:"name@example.com"},null,8,Or),[[h,t.commandForm.answers[d].answer]]),Ar])])]),e("td",null,[e("div",Ir,[e("div",Qr,[c(e("input",{type:"text",class:"form-control","onUpdate:modelValue":_=>t.commandForm.answers[d].next_bot_dialog_command_id=_,id:"floatingInput",placeholder:"name@example.com",required:""},null,8,Tr),[[h,t.commandForm.answers[d].next_bot_dialog_command_id]]),Br]),e("div",Rr,[Mr,e("div",Dr,[e("ul",Er,[e("li",{class:"list-group-item cursor-pointer font-12",onClick:_=>t.commandForm.answers[d].next_bot_dialog_command_id=null}," Не выбран ",8,Lr),(l(!0),n(v,null,y(t.getDialogCommands,_=>(l(),n("li",{class:"list-group-item cursor-pointer font-12",style:{"line-height":"100%","text-align":"left"},onClick:p=>t.commandForm.answers[d].next_bot_dialog_command_id=_.id}," #"+u(_.id||"-")+" "+u(_.pre_text||"-"),9,Kr))),256))]),e("div",Nr,[t.dialog_commands_paginate_object?(l(),$(j,{key:0,onPagination_page:t.nextDialogs,pagination:t.dialog_commands_paginate_object},null,8,["onPagination_page","pagination"])):r("",!0)])])])])]),e("td",null,[e("div",Jr,[Hr,e("ul",Yr,[e("li",null,[e("a",{class:"dropdown-item",onClick:_=>t.removeDialogAnswer(i,d),href:"javascript:void(0)"},"Удалить",8,Gr)])])])])]),t.commandForm.answers[d].in_edit_mode?(l(),n("tr",Wr,[Xr,Zr,e("td",null,[e("div",xr,[e("div",ec,[c(e("input",{type:"text","onUpdate:modelValue":_=>t.commandForm.answers[d].pattern=_,class:"form-control",id:"floatingInput",placeholder:"name@example.com"},null,8,tc),[[h,t.commandForm.answers[d].pattern]]),sc]),e("div",oc,[lc,e("ul",nc,[e("li",null,[e("a",{class:"dropdown-item",onClick:_=>t.commandForm.answers[d].pattern=null,href:"javascript:void(0)"},"Не выбран",8,ic)]),e("li",null,[(l(!0),n(v,null,y(t.patterns,_=>(l(),n("a",{class:"dropdown-item",onClick:p=>t.commandForm.answers[d].pattern=_.value,href:"javascript:void(0)"},u(_.title||"-"),9,ac))),256))])])])])]),e("td",null,[e("div",dc,[c(e("input",{type:"text","onUpdate:modelValue":_=>t.commandForm.answers[d].custom_stored_value=_,class:"form-control",id:"custom_stored_value-"+d,placeholder:"name@example.com"},null,8,rc),[[h,t.commandForm.answers[d].custom_stored_value]]),e("label",{for:"custom_stored_value-"+d},"Поместить данный текст в переменную",8,cc)])])])):r("",!0)],64))),256))])])):(l(),n("div",uc," Добавьте один или несколько вариантов ответов "))])):r("",!0),e("div",mc,[c(e("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":s[33]||(s[33]=i=>t.need_set_flags=i),id:"need-set-flags",checked:""},null,512),[[k,t.need_set_flags]]),_c]),t.need_set_flags?(l(),n("div",hc,[pc,(l(!0),n(v,null,y(t.flags_variants,i=>(l(),n("span",{class:b(["badge text-info mr-2",{"bg-info text-white":t.commandForm.result_flags.indexOf(i.key)!=-1}]),onClick:d=>t.selectFlag(i)},u(i.title),11,bc))),256))])):r("",!0)])):r("",!0),t.tab===3?(l(),n("div",fc,[f(sa,{modelValue:t.commandForm.rules,"onUpdate:modelValue":s[34]||(s[34]=i=>t.commandForm.rules=i)},null,8,["modelValue"])])):r("",!0)],32)}}});const vc={class:"row"},$c={class:"col-md-2 col-12"},yc=e("i",{class:"fa-regular fa-comment-dots",style:{"margin-right":"10px"}},null,-1),kc={class:"col-md-10 col-12"},Fc={class:"input-group mb-3"},wc={style:{width:"200px !important"}},Cc=oe('<option value="25">25</option><option value="50">50</option><option value="100">100</option><option value="500">500</option><option value="1000">1000</option>',5),Sc=[Cc],jc={key:0,class:"row"},Vc={class:"col-md-12"},qc={class:"table"},zc=e("th",{class:"text-left",scope:"col",style:{width:"40px"}},null,-1),Pc=e("th",{class:"text-center",scope:"col",style:{width:"40px"}},"Команды",-1),Uc={style:{width:"40px"}},Oc=["onClick"],Ac=e("i",{class:"fa-solid fa-toggle-off cursor-pointer text-secondary"},null,-1),Ic=[Ac],Qc=["onClick"],Tc=e("i",{class:"fa-solid fa-toggle-on cursor-pointer text-primary"},null,-1),Bc=[Tc],Rc={scope:"row",class:"text-left",style:{width:"80px"}},Mc={class:"d-flex justify-content-start align-items-center"},Dc={key:0,class:"fa-solid fa-flag-checkered ml-2"},Ec={key:1,class:"fa-solid fa-sitemap ml-2"},Lc={key:2,class:"fa-solid fa-arrows-rotate ml-2"},Kc={class:"text-left",style:{"min-width":"400px"}},Nc={key:0,class:"dropdown"},Jc={style:{"line-height":"100%","font-size":"14px","text-align":"left"},class:"btn btn-link m-0 p-0 text-decoration-none",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},Hc={class:"dropdown-menu p-2"},Yc=["onSubmit"],Gc=e("p",{class:"mb-0"},"Значение",-1),Wc=["onUpdate:modelValue"],Xc=e("button",{class:"btn btn-outline-primary mt-2 w-100 text-center"}," Сохранить ",-1),Zc={class:"dropdown my-2"},xc={style:{"text-align":"left !important"},class:"text-decoration-none fst-italic color-black w-100 d-flex justify-content-between align-items-center",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},eu={class:"dropdown-menu p-4 text-body-secondary",style:{"max-width":"400px","min-width":"400px",height:"200px","overflow-y":"scroll"}},tu=e("h6",null,"Основные параметры диалога",-1),su={class:"table"},ou=e("td",null,"Есть ответы",-1),lu={key:0},nu={key:1},iu=e("i",{class:"fa-solid fa-xmark text-danger"},null,-1),au=[iu],du=e("td",null,"Цепочки",-1),ru={key:0,class:"badge bg-primary"},cu={key:1},uu=e("i",{class:"fa-solid fa-xmark text-danger"},null,-1),mu=[uu],_u=e("td",null,"Текст успеха",-1),hu={key:0},pu={key:1},bu=e("i",{class:"fa-solid fa-xmark text-danger"},null,-1),fu=[bu],gu=e("td",null,"Текст ошибки",-1),vu={key:0},$u={key:1},yu=e("i",{class:"fa-solid fa-xmark text-danger"},null,-1),ku=[yu],Fu=e("td",null,"Канал результата",-1),wu={key:0},Cu={key:1},Su=e("i",{class:"fa-solid fa-xmark text-danger"},null,-1),ju=[Su],Vu=e("td",null,"Флаги",-1),qu={key:0},zu={class:"badge bg-primary"},Pu={key:1},Uu=e("i",{class:"fa-solid fa-xmark text-danger"},null,-1),Ou=[Uu],Au=e("td",null,"Сохранить в",-1),Iu={key:0},Qu={key:1},Tu=e("i",{class:"fa-solid fa-xmark text-danger"},null,-1),Bu=[Tu],Ru=e("td",null,"Есть изображения",-1),Mu={key:0,class:"fa-solid fa-check text-success"},Du={key:1,class:"fa-solid fa-xmark text-danger"},Eu=e("td",null,"Есть паттерны",-1),Lu={key:0},Ku={key:1},Nu=e("i",{class:"fa-solid fa-xmark text-danger"},null,-1),Ju=[Nu],Hu=e("td",null,"Пустой",-1),Yu={key:0,class:"fa-solid fa-check text-success"},Gu={key:1,class:"fa-solid fa-xmark text-danger"},Wu=e("td",null,"Информационный",-1),Xu={key:0,class:"fa-solid fa-check text-success"},Zu={key:1,class:"fa-solid fa-xmark text-danger"},xu=e("td",null,"Есть кнопки",-1),em={key:0,class:"fa-solid fa-check text-success"},tm={key:1,class:"fa-solid fa-xmark text-danger"},sm=e("td",null,"Есть меню",-1),om={key:0,class:"fa-solid fa-check text-success"},lm={key:1,class:"fa-solid fa-xmark text-danger"},nm={key:1,class:"small font-bold m-0"},im=e("i",{class:"fa-solid fa-angles-right mx-2"},null,-1),am={style:{width:"150px"}},dm={class:"form-check"},rm=["onChange","onUpdate:modelValue","id"],cm=["for"],um=["onClick"],mm=e("i",{class:"fa-solid fa-angles-right mx-2"},null,-1),_m=e("small",null,[e("i",{class:"fa-solid fa-arrow-up-right-from-square text-primary"})],-1),hm=e("td",null,[e("i",{class:"fa-solid fa-arrow-right-long mx-2"})],-1),pm={style:{"max-width":"770px"}},bm={class:"dropdown"},fm={style:{"line-height":"100%","font-size":"10px","text-align":"left"},class:"btn btn-link m-0 p-0 text-decoration-none",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},gm={key:0},vm={key:1},$m={class:"dropdown-menu p-2"},ym=["onSubmit"],km=e("p",{class:"mb-0"},"Значение",-1),Fm=["onUpdate:modelValue"],wm=e("button",{class:"btn btn-outline-primary mt-2 w-100 text-center"}," Сохранить ",-1),Cm={key:0},Sm={key:0,class:"text-danger font-bold"},jm={key:1,class:"text-success font-bold"},Vm={key:2,class:"text-warning font-bold"},qm=["onClick"],zm=e("i",{class:"fa-solid fa-angles-right mx-2"},null,-1),Pm=e("small",null,[e("i",{class:"fa-solid fa-arrow-up-right-from-square text-primary"})],-1),Um={key:0},Om=e("i",{class:"fa-solid fa-arrow-right-long mx-2"},null,-1),Am=[Om],Im={key:1,style:{"max-width":"770px"}},Qm={class:"mb-0",style:{"line-height":"100%","font-size":"10px"}},Tm={class:"text-center",style:{width:"40px"}},Bm={class:"dropdown"},Rm=["disabled"],Mm=e("i",{class:"fa-solid fa-ellipsis"},null,-1),Dm=[Mm],Em={class:"dropdown-menu"},Lm=["onClick"],Km=e("i",{class:"fa-solid fa-arrow-left mr-1"},null,-1),Nm=e("hr",null,null,-1),Jm=["onClick"],Hm=e("i",{class:"fa-solid fa-clone mr-1"},null,-1),Ym=["onClick"],Gm=e("i",{class:"fa-solid fa-trash-can mr-1"},null,-1),Wm={key:0},Xm={colspan:"17"},Zm={key:1,class:"row"},xm=e("div",{class:"col-12"},[e("div",{class:"alert alert-danger",role:"alert"}," Не найдено ни одного диалога! ")],-1),e_=[xm],t_={class:"modal fade",id:"dialog-command-modal-editor",tabindex:"-1"},s_={class:"modal-dialog modal-fullscreen"},o_={class:"modal-content"},l_=e("div",{class:"modal-header"},[e("h1",{class:"modal-title fs-5",id:"staticBackdropLabel"}," Создание диалогового сообщения "),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),n_={class:"modal-body"},i_=e("div",{class:"modal-footer"},[e("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Закрыть")],-1),a_={data(){return{direction:"desc",order:"updated_at",size:500,variables:[],bot:null,selected:null,loading:!0,current_page:0,dialog_commands:[],search:null,dialog_commands_paginate_object:null}},computed:{...C(["getDialogCommands","getCurrentBot","getDialogCommandsPaginateObject"])},mounted(){this.loadCurrentBot().then(()=>{let o=localStorage.getItem("cashman_dialogs_current_page_"+this.bot.id)||0;this.loadDialogs(o)})},methods:{updateDialogCommand(o){let t=new FormData;Object.keys(o).forEach(s=>{const a=o[s]||"";typeof a=="object"?t.append(s,JSON.stringify(a)):t.append(s,a)}),this.$store.dispatch("updateDialogCommand",{dialogCommandForm:t}).then(s=>{this.loading=!1,this.$notify({title:"Конструктор ботов",text:"Успешная обработка диалоговой команды",type:"success"})}).catch(()=>{this.$notify({title:"Конструктор ботов",text:"Ошибка обработки диалоговой команды",type:"error"})})},updateAnswer(o){this.$store.dispatch("updatedDialogAnswer",{...o,bot_id:this.bot.id}).then(t=>{this.$notify({title:"Конструктор ботов",text:"Текст успешно обновлен",type:"success"})}).catch(t=>{})},loadAndOrder(o){this.order=o,this.direction=this.direction==="desc"?"asc":"desc",this.loadDialogs(0)},loadAndOpenEditor(o){this.loading=!0,this.$store.dispatch("loadLinkedDialogCommand",{command_id:o,bot_id:this.bot.id}).then(t=>{this.selected=t.data,console.log(t.data),this.loading=!1,new bootstrap.Modal(document.getElementById("dialog-command-modal-editor"),{}).show()}).catch(()=>{this.$notify({title:"Конструктор ботов",text:"Ошибка работы с командой",type:"error"})})},openEditor(o){this.loading=!0,o||this.dialog_commands.forEach(t=>{t.in_edit_mode=!1}),this.$nextTick(()=>{this.selected=o,this.loading=!1})},removeCommand(o){this.loading=!0,this.$store.dispatch("removeDialogCommand",{dataObject:{dialogCommandId:o}}).then(t=>{this.loading=!1,this.$notify({title:"Конструктор ботов",text:"Диалоговая команда успешно удалена!",type:"success"}),this.loadDialogs(),this.$emit("callback")}).catch(t=>{this.loading=!1})},duplicate(o){this.loading=!0,this.$store.dispatch("duplicateDialogCommand",{dataObject:{dialogCommandId:o}}).then(t=>{this.loading=!1,this.$notify({title:"Конструктор ботов",text:"Диалоговая команда успешно продублирована!",type:"success"}),this.loadDialogs(),this.$emit("callback")}).catch(t=>{this.loading=!1})},toggleEditMode(o){this.selected=o,o.in_edit_mode=!o.in_edit_mode},loadCurrentBot(o=null){return this.$store.dispatch("updateCurrentBot",{bot:o}).then(()=>{this.bot=this.getCurrentBot})},selectDialog(o){this.$emit("select-dialog",o),this.$notify("Вы выбрали диалог из списка!")},nextDialogs(o){this.loadDialogs(o)},selectElement(o){this.loading=!0,this.$nextTick(()=>{this.selected=this.dialog_commands.find(t=>t.id===o)||null,this.loading=!1})},loadDialogs(o=0){this.current_page=o,localStorage.setItem("cashman_dialogs_current_page_"+this.bot.id,this.current_page),this.$store.dispatch("loadDialogCommands",{dataObject:{botId:this.bot.id||null,search:this.search,order:this.order,direction:this.direction},page:o,size:this.size||25}).then(t=>{const s=this.selected;this.dialog_commands=this.getDialogCommands,this.dialog_commands_paginate_object=this.getDialogCommandsPaginateObject,this.loading=!0,this.$nextTick(()=>{s&&(this.selected=this.dialog_commands.find(a=>a.id===s.id)||null,this.selected.in_edit_mode=!1),this.loading=!1})}).catch(()=>{this.loading=!1})}}},re=Object.assign(a_,{__name:"BotDialogGroupList",setup(o){return(t,s)=>(l(),n(v,null,[e("div",vc,[e("div",$c,[e("button",{type:"button",onClick:s[0]||(s[0]=a=>t.openEditor(null)),"data-bs-toggle":"modal","data-bs-target":"#dialog-command-modal-editor",class:"btn btn-outline-success mb-2 w-100"},[yc,m("Новый диалог ")])]),e("div",kc,[e("div",Fc,[c(e("input",{type:"search",class:"form-control",placeholder:"Поиск диалога","aria-label":"Поиск диалога","onUpdate:modelValue":s[1]||(s[1]=a=>t.search=a),"aria-describedby":"button-addon2"},null,512),[[h,t.search]]),e("div",wc,[c(e("select",{onChange:s[2]||(s[2]=a=>t.loadDialogs(t.current_page)),"onUpdate:modelValue":s[3]||(s[3]=a=>t.size=a),class:"form-select rounded-0"},Sc,544),[[Q,t.size]])]),e("button",{class:"btn btn-outline-secondary",onClick:s[4]||(s[4]=a=>t.loadDialogs(0)),type:"button",id:"button-addon2"},"Найти ")])])]),t.dialog_commands.length>0?(l(),n("div",jc,[e("div",Vc,[e("table",qc,[e("thead",null,[e("tr",null,[zc,e("th",{class:"text-left cursor-pointer",scope:"col",onClick:s[5]||(s[5]=a=>t.loadAndOrder("id")),style:{width:"80px"}}," # "),e("th",{class:"text-left cursor-pointer",scope:"col",onClick:s[6]||(s[6]=a=>t.loadAndOrder("pre_text")),style:{"min-width":"400px"}},"Текст диалога "),Pc])]),e("tbody",null,[(l(!0),n(v,null,y(t.dialog_commands,(a,i)=>(l(),n(v,null,[e("tr",null,[e("td",Uc,[a.in_edit_mode?(l(),n("span",{key:1,onClick:d=>t.toggleEditMode(a)},Bc,8,Qc)):(l(),n("span",{key:0,onClick:d=>t.toggleEditMode(a)},Ic,8,Oc))]),e("th",Rc,[e("span",Mc,[m(u(a.id)+" ",1),a.is_empty?(l(),n("i",Dc)):r("",!0),a.is_inform?(l(),n("i",Ec)):r("",!0),a.next_bot_dialog_command_id===a.id?(l(),n("i",Lc)):r("",!0)])]),e("td",Kc,[a.is_empty?r("",!0):(l(),n("div",Nc,[e("button",Jc,[m(" Результат будет сохранен в "),e("strong",null,u(a.use_result_as||"не задана"),1)]),e("div",Hc,[e("form",{onSubmit:S(d=>t.updateDialogCommand(a),["prevent"]),class:"p-2"},[Gc,c(e("textarea",{class:"form-control","onUpdate:modelValue":d=>a.use_result_as=d,name:"",id:"",cols:"30",rows:"10"},null,8,Wc),[[h,a.use_result_as]]),Xc],40,Yc)])])),e("div",Zc,[e("button",xc,u(a.pre_text||"-"),1),e("div",eu,[tu,e("table",su,[e("tbody",null,[e("tr",null,[ou,e("td",null,[(a.answers||[]).length>0?(l(),n("p",lu,u(a.answers.length),1)):(l(),n("p",nu,au))])]),e("tr",null,[du,e("td",null,[a.next_bot_dialog_command_id?(l(),n("span",ru,"#"+u(a.next_bot_dialog_command_id||"-")+" ("+u(a.chain.length||0)+")",1)):(l(),n("span",cu,mu))])]),e("tr",null,[_u,e("td",null,[a.post_text?(l(),n("p",hu,u(a.post_text),1)):(l(),n("p",pu,fu))])]),e("tr",null,[gu,e("td",null,[a.error_text?(l(),n("p",vu,u(a.error_text),1)):(l(),n("p",$u,ku))])]),e("tr",null,[Fu,e("td",null,[a.result_channel?(l(),n("p",wu,u(a.result_channel),1)):(l(),n("p",Cu,ju))])]),e("tr",null,[Vu,e("td",null,[a.result_flags.length>0?(l(),n("p",qu,[(l(!0),n(v,null,y(a.result_flags,d=>(l(),n("span",zu,u(d||"-"),1))),256))])):(l(),n("p",Pu,Ou))])]),e("tr",null,[Au,e("td",null,[a.store_to?(l(),n("p",Iu,u(a.store_to),1)):(l(),n("p",Qu,Bu))])]),e("tr",null,[Ru,e("td",null,[(a.images||[]).length>0?(l(),n("i",Mu)):(l(),n("i",Du))])]),e("tr",null,[Eu,e("td",null,[a.input_pattern?(l(),n("p",Lu,u(a.input_pattern),1)):(l(),n("p",Ku,Ju))])]),e("tr",null,[Hu,e("td",null,[a.is_empty?(l(),n("i",Yu)):(l(),n("i",Gu))])]),e("tr",null,[Wu,e("td",null,[a.is_inform?(l(),n("i",Xu)):(l(),n("i",Zu))])]),e("tr",null,[xu,e("td",null,[a.inline_keyboard_id!=null?(l(),n("i",em)):(l(),n("i",tm))])]),e("tr",null,[sm,e("td",null,[a.reply_keyboard_id!=null?(l(),n("i",om)):(l(),n("i",lm))])])])])])]),(a.next_bot_dialog_command_id||(a.answers||[]).length>0)&&!a.is_inform?(l(),n("p",nm,[m("Ответ"),im,m("диалог")])):r("",!0),e("table",null,[(l(!0),n(v,null,y(a.answers,(d,_)=>(l(),n("tr",null,[e("td",am,[e("div",dm,[c(e("input",{class:"form-check-input",onChange:p=>t.updateAnswer(d),"onUpdate:modelValue":p=>a.answers[_].need_print=p,type:"checkbox",value:"",id:"answ-"+_+"-command-"+a.id},null,40,rm),[[k,a.answers[_].need_print]]),e("label",{class:"form-check-label",for:"answ-"+_+"-command-"+a.id},u(d.answer),9,cm)])]),e("td",{style:{width:"90px"},class:"cursor-pointer",onClick:p=>t.loadAndOpenEditor(d.next_bot_dialog_command_id)},[mm,m(u(d.next_bot_dialog_command_id)+" ",1),_m],8,um),hm,e("td",pm,[e("div",bm,[e("button",fm,[d.custom_stored_value?(l(),n("span",gm,u(d.custom_stored_value||"-"),1)):(l(),n("span",vm,"нажмите, чтобы добавить"))]),e("div",$m,[e("form",{onSubmit:S(p=>t.updateAnswer(d),["prevent"]),class:"p-2"},[km,c(e("textarea",{class:"form-control","onUpdate:modelValue":p=>d.custom_stored_value=p,name:"",id:"",cols:"30",rows:"10"},null,8,Fm),[[h,d.custom_stored_value]]),wm],40,ym)])])])]))),256)),a.next_bot_dialog_command_id?(l(),n("tr",Cm,[e("td",null,[(a.answers||[]).length>0&&!a.is_inform?(l(),n("span",Sm,"Другой ответ")):r("",!0),(a.answers||[]).length===0&&!a.is_inform?(l(),n("span",jm,"Любой ответ")):r("",!0),(a.answers||[]).length===0&&a.is_inform?(l(),n("span",Vm,"Переход к диалогу")):r("",!0)]),e("td",{class:"cursor-pointer",onClick:d=>t.loadAndOpenEditor(a.next_bot_dialog_command_id)},[zm,m(u(a.next_bot_dialog_command_id||"-")+" ",1),Pm],8,qm),a.custom_stored_value?(l(),n("td",Um,Am)):r("",!0),a.custom_stored_value?(l(),n("td",Im,[e("p",Qm,u(a.custom_stored_value||"-"),1)])):r("",!0)])):r("",!0)])]),e("td",Tm,[e("div",Bm,[e("button",{disabled:t.loading,class:"btn btn-outline-secondary",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},Dm,8,Rm),e("ul",Em,[e("li",null,[e("a",{onClick:d=>t.selectDialog(a),title:"Выбрать диалог",class:"dropdown-item cursor-pointer"},[Km,m(" Выбрать диалог ")],8,Lm)]),Nm,e("li",null,[e("a",{title:"Дублирование команды",onClick:d=>t.duplicate(a.id),class:"dropdown-item cursor-pointer"},[Hm,m(" Дублирование диалога ")],8,Jm)]),e("li",null,[e("a",{onClick:d=>t.removeCommand(a.id),title:"Удаление команды",class:"dropdown-item cursor-pointer"},[Gm,m(" Удаление диалога ")],8,Ym)])])])])]),a.in_edit_mode?(l(),n("tr",Wm,[e("td",Xm,[t.bot&&!t.loading?(l(),$(X,{key:0,item:t.selected,onCallback:t.loadDialogs,onSelectElement:t.selectElement,bot:t.bot},null,8,["item","onCallback","onSelectElement","bot"])):r("",!0)])])):r("",!0)],64))),256))])]),t.dialog_commands_paginate_object?(l(),$(j,{key:0,onPagination_page:t.nextDialogs,pagination:t.dialog_commands_paginate_object},null,8,["onPagination_page","pagination"])):r("",!0)])])):(l(),n("div",Zm,e_)),e("div",t_,[e("div",s_,[e("div",o_,[l_,e("div",n_,[t.bot&&!t.loading?(l(),$(X,{key:0,item:t.selected,onCallback:t.loadDialogs,onSelectElement:t.selectElement,bot:t.bot},null,8,["item","onCallback","onSelectElement","bot"])):r("",!0)]),i_])])])],64))}}),d_=e("div",{class:"alert alert-success",role:"alert"},' Проверка правил идет по методу "И" - все правила должны выполняться для перехода на данную страницу, иначе будет вызвана страница из блока "иначе". Действия для "иначе" добавлять не обязательно. ',-1),r_=e("h6",null,"Блок условий",-1),c_={key:0,class:"py-2"},u_={class:"form-label",id:"bot-domain"},m_=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),__=e("div",null,"Напишите текст, который будет отображен пользователю вместе с основным контентом в случае если условие будет выполнено ",-1),h_={class:"dropdown mb-2"},p_=e("button",{class:"btn btn-outline-info dropdown-toggle w-100",type:"button",id:"dropdownMenuButton1","data-bs-toggle":"dropdown","aria-expanded":"false"}," Добавить условие ",-1),b_={class:"dropdown-menu","aria-labelledby":"dropdownMenuButton1"},f_=["onClick"],g_={key:1},v_={key:2,class:"list-group"},$_={key:0,class:"list-group-item d-flex justify-content-between align-items-center"},y_={class:"form-check"},k_={class:"form-check-label",for:"bot-user-is-vip"},F_={key:0},w_={key:1},C_=e("i",{class:"fa-solid fa-trash-can"},null,-1),S_=[C_],j_={key:1,class:"list-group-item d-flex justify-content-between align-items-center"},V_={class:"form-check"},q_={class:"form-check-label",for:"bot-user-is-admin"},z_={key:0},P_={key:1},U_=e("i",{class:"fa-solid fa-trash-can"},null,-1),O_=[U_],A_={key:2,class:"list-group-item d-flex justify-content-between align-items-center"},I_={class:"form-check"},Q_={class:"form-check-label",for:"bot-user-is-deliveryman"},T_={key:0},B_={key:1},R_=e("i",{class:"fa-solid fa-trash-can"},null,-1),M_=[R_],D_={key:3,class:"list-group-item d-flex justify-content-between align-items-center"},E_={class:"form-check"},L_={class:"form-check-label",for:"bot-user-is-work"},K_={key:0},N_={key:1},J_=e("i",{class:"fa-solid fa-trash-can"},null,-1),H_=[J_],Y_={key:4,class:"list-group-item d-flex justify-content-between align-items-center"},G_={class:"form-check"},W_={class:"form-check-label",for:"bot-user-in-location"},X_={key:0},Z_={key:1},x_=e("i",{class:"fa-solid fa-trash-can"},null,-1),eh=[x_],th={key:5,class:"list-group-item d-flex justify-content-between align-items-center"},sh=e("label",{class:"form-label",id:"bot-domain"}," Возраст от ",-1),oh=e("i",{class:"fa-solid fa-trash-can"},null,-1),lh=[oh],nh={key:6,class:"list-group-item d-flex justify-content-between align-items-center"},ih=e("label",{class:"form-label",id:"bot-domain"}," Только для города ",-1),ah=e("i",{class:"fa-solid fa-trash-can"},null,-1),dh=[ah],rh={key:7,class:"list-group-item d-flex justify-content-between align-items-center"},ch={class:"form-check"},uh={class:"form-check-label",for:"bot-user-sex"},mh={key:0},_h={key:1},hh=e("i",{class:"fa-solid fa-trash-can"},null,-1),ph=[hh],bh={key:8,class:"list-group-item"},fh={class:"mb-3"},gh={class:"d-flex justify-content-between align-items-center"},vh={class:"form-label d-flex w-100 align-items-center",id:"bot-order-channel"},$h=["onClick"],yh=e("i",{class:"fa-solid fa-trash-can"},null,-1),kh=[yh],Fh=["onUpdate:modelValue"],wh={key:3,class:"mt-5"},Ch={key:4,class:"d-flex justify-content-between"},Sh={key:6,class:"py-2"},jh={class:"form-label",id:"bot-domain"},Vh=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),qh=e("div",null,'Напишите текст, который будет отображен пользователю вместе с основным контентом в случае если условие не будет выполнено и будет вызван блок "иначе" ',-1),zh={props:["bot","rulesForm"],data(){return{rules:[{id:1,title:"Является администратором",rules_block:"bot_user",rule:{is_admin:!0}},{id:2,title:"Является VIP-пользователем",rules_block:"bot_user",rule:{is_vip:!0}},{id:3,title:"Находится в заведении",rules_block:"bot_user",rule:{user_in_location:!0}},{id:4,title:"За работой",rules_block:"bot_user",rule:{is_work:!0}},{id:5,title:"Возраст от ...",rules_block:"bot_user",rule:{age:18}},{id:6,title:"Находится в городе ...",rules_block:"bot_user",rule:{city:"Краснодар"}},{id:7,title:"Пол",rules_block:"bot_user",rule:{sex:!0}},{id:8,title:"Состоит в канале",rules_block:"channels",rule:{channel:1}},{id:9,title:"Является Менеджером",rules_block:"bot_user",rule:{is_manager:!0}}]}},computed:{rulesForCustomFields(){let o=this.rules.filter(t=>t.key!=null);return console.log("filtered rules",o),o}},mounted(){},methods:{hasRuleKey(o){return this.rulesForm.rules_if==null?!1:(console.log("key=>",o||"-"),Object.keys(this.rulesForm.rules_if.bot_user).find(t=>t===o)!=null)},modifyChannel(o){this.rulesForm.rules_if.channels[o.param]=o.text},removeChannelFromRule(o){this.rulesForm.rules_if.channels.splice(o,1)},removeRule(o){delete this.rulesForm.rules_if.bot_user[o]},addRules(o){this.rulesForm.rules_if||(this.rulesForm.rules_if={bot_user:{},channels:[]}),o.rules_block==="bot_user"&&(this.rulesForm.rules_if.bot_user={...this.rulesForm.rules_if.bot_user,...o.rule}),o.rules_block==="channels"&&this.rulesForm.rules_if.channels.push(o.rule.channel)},loadCurrentBotFields(){return this.$store.dispatch("loadCurrentBotFields",{bot_id:this.bot.id}).then(o=>{(o.data||[]).forEach(s=>{s.is_active&&(this.rules.push({id:this.rules.length+1,title:s.label,key:s.key,type:s.type,rules_block:"bot_user",rule:{}}),s.type===0&&(this.rules[this.rules.length-1].rule[s.key]=""),s.type===1&&(this.rules[this.rules.length-1].rule[s.key]=0),s.type===2&&(this.rules[this.rules.length-1].rule[s.key]=!0))}),console.log("new rules=>",this.rules)})},attachPageToRule(o){o.id!=this.rulesForm.id?this.rulesForm.rules_else_page_id=o.id:this.$notify({title:"Конструктор страниц",text:"Вы не можете связать данную страницу с собой",type:"error"})}}},Ph=Object.assign(zh,{__name:"PageRules",setup(o){return(t,s)=>{const a=V("Popper");return l(),n(v,null,[d_,r_,o.rulesForm.rules_if?(l(),n("div",c_,[e("label",u_,[f(a,null,{content:g(()=>[__]),default:g(()=>[m_]),_:1}),m(" Сообщение при успешном прохождении условий (не обязательно) ")]),c(e("textarea",{type:"text",class:"form-control",placeholder:"Текст сообщения","aria-label":"Текст сообщения","onUpdate:modelValue":s[0]||(s[0]=i=>o.rulesForm.rules_if_message=i),maxlength:"255","aria-describedby":"rules-else-message"},`
            `,512),[[h,o.rulesForm.rules_if_message]])])):r("",!0),e("div",h_,[p_,e("ul",b_,[(l(!0),n(v,null,y(t.rules,i=>(l(),n("li",null,[e("a",{onClick:d=>t.addRules(i),class:"dropdown-item",href:"javascript:void(0)"},u(i.title||"Не указан"),9,f_)]))),256))])]),o.rulesForm.rules_if?(l(),n("h6",g_,"Выбранные условия")):r("",!0),o.rulesForm.rules_if?(l(),n("ul",v_,[t.hasRuleKey("is_vip")?(l(),n("li",$_,[e("div",y_,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[1]||(s[1]=i=>o.rulesForm.rules_if.bot_user.is_vip=i),type:"checkbox",id:"bot-user-is-vip"},null,512),[[k,o.rulesForm.rules_if.bot_user.is_vip]]),e("label",k_,[o.rulesForm.rules_if.bot_user.is_vip?(l(),n("span",F_,"Является VIP-пользователем")):(l(),n("span",w_,"Не является VIP-пользователем"))])]),e("button",{type:"button",class:"btn btn-outline-info",onClick:s[2]||(s[2]=i=>t.removeRule("is_vip"))},S_)])):r("",!0),t.hasRuleKey("is_admin")?(l(),n("li",j_,[e("div",V_,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[3]||(s[3]=i=>o.rulesForm.rules_if.bot_user.is_admin=i),type:"checkbox",id:"bot-user-is-admin"},null,512),[[k,o.rulesForm.rules_if.bot_user.is_admin]]),e("label",q_,[o.rulesForm.rules_if.bot_user.is_admin?(l(),n("span",z_,"Является администратором")):(l(),n("span",P_,"Не является администратором"))])]),e("button",{type:"button",class:"btn btn-outline-info",onClick:s[4]||(s[4]=i=>t.removeRule("is_admin"))},O_)])):r("",!0),t.hasRuleKey("is_deliveryman")?(l(),n("li",A_,[e("div",I_,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[5]||(s[5]=i=>o.rulesForm.rules_if.bot_user.is_deliveryman=i),type:"checkbox",id:"bot-user-is-deliveryman"},null,512),[[k,o.rulesForm.rules_if.bot_user.is_deliveryman]]),e("label",Q_,[o.rulesForm.rules_if.bot_user.is_deliveryman?(l(),n("span",T_,"Является доставщиком")):(l(),n("span",B_,"Не является доставщиком"))])]),e("button",{type:"button",class:"btn btn-outline-info",onClick:s[6]||(s[6]=i=>t.removeRule("is_deliveryman"))},M_)])):r("",!0),t.hasRuleKey("is_work")?(l(),n("li",D_,[e("div",E_,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[7]||(s[7]=i=>o.rulesForm.rules_if.bot_user.is_work=i),type:"checkbox",id:"bot-user-is-work"},null,512),[[k,o.rulesForm.rules_if.bot_user.is_work]]),e("label",L_,[o.rulesForm.rules_if.bot_user.is_work?(l(),n("span",K_,"За работой")):(l(),n("span",N_,"Не работает"))])]),e("button",{type:"button",class:"btn btn-outline-info",onClick:s[8]||(s[8]=i=>t.removeRule("is_work"))},H_)])):r("",!0),t.hasRuleKey("user_in_location")?(l(),n("li",Y_,[e("div",G_,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[9]||(s[9]=i=>o.rulesForm.rules_if.bot_user.user_in_location=i),type:"checkbox",id:"bot-user-in-location"},null,512),[[k,o.rulesForm.rules_if.bot_user.user_in_location]]),e("label",W_,[o.rulesForm.rules_if.bot_user.user_in_location?(l(),n("span",X_,"Находится в заведении")):(l(),n("span",Z_,"Не находится в заведении"))])]),e("button",{type:"button",class:"btn btn-outline-info",onClick:s[10]||(s[10]=i=>t.removeRule("user_in_location"))},eh)])):r("",!0),t.hasRuleKey("age")?(l(),n("li",th,[e("div",null,[sh,c(e("input",{type:"text",class:"form-control",placeholder:"Возраст от","aria-label":"Возраст от","onUpdate:modelValue":s[11]||(s[11]=i=>o.rulesForm.rules_if.bot_user.age=i),maxlength:"255","aria-describedby":"bot-user-age"},null,512),[[h,o.rulesForm.rules_if.bot_user.age]])]),e("button",{type:"button",class:"btn btn-outline-info",onClick:s[12]||(s[12]=i=>t.removeRule("age"))},lh)])):r("",!0),t.hasRuleKey("city")?(l(),n("li",nh,[e("div",null,[ih,c(e("input",{type:"text",class:"form-control",placeholder:"Город","aria-label":"Город","onUpdate:modelValue":s[13]||(s[13]=i=>o.rulesForm.rules_if.bot_user.city=i),maxlength:"255","aria-describedby":"bot-user-city"},null,512),[[h,o.rulesForm.rules_if.bot_user.city]])]),e("button",{type:"button",class:"btn btn-outline-info",onClick:s[14]||(s[14]=i=>t.removeRule("city"))},dh)])):r("",!0),t.hasRuleKey("sex")?(l(),n("li",rh,[e("div",ch,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[15]||(s[15]=i=>o.rulesForm.rules_if.bot_user.sex=i),type:"checkbox",id:"bot-user-sex"},null,512),[[k,o.rulesForm.rules_if.bot_user.sex]]),e("label",uh,[o.rulesForm.rules_if.bot_user.sex?(l(),n("span",mh,"Только для мужчин")):(l(),n("span",_h,"Только для женщин"))])]),e("button",{type:"button",class:"btn btn-outline-info",onClick:s[16]||(s[16]=i=>t.removeRule("sex"))},ph)])):r("",!0),o.rulesForm.rules_if.channels.length>0?(l(),n("li",bh,[m("Проверка нахождения в канале \\ группе: "),(l(!0),n(v,null,y(o.rulesForm.rules_if.channels,(i,d)=>(l(),n("div",fh,[e("div",gh,[e("label",vh,[f(ne,{token:o.bot.bot_token,param:`${d}`,onCallback:t.modifyChannel},null,8,["token","param","onCallback"]),m(" Канал для проверки ")]),e("button",{type:"button",class:"btn btn-link text-danger",onClick:_=>t.removeChannelFromRule(d)},kh,8,$h)]),c(e("input",{type:"text",class:"form-control",placeholder:"id канала","aria-label":"id канала","onUpdate:modelValue":_=>o.rulesForm.rules_if.channels[d]=_,maxlength:"255","aria-describedby":"bot-order-channel"},null,8,Fh),[[h,o.rulesForm.rules_if.channels[d]]])]))),256))])):r("",!0)])):r("",!0),o.rulesForm.rules_if?(l(),n("h6",wh,"Иначе")):r("",!0),o.rulesForm.rules_else_page_id?(l(),n("p",Ch,[m("Вы выбрали страницу #"+u(o.rulesForm.rules_else_page_id)+' в качестве условия "иначе" ',1),e("a",{href:"javascript:void(0)",onClick:s[17]||(s[17]=i=>o.rulesForm.rules_else_page_id=null)},"Очистить")])):r("",!0),o.rulesForm.rules_if?(l(),$(B,{key:5,current:o.rulesForm.id,onCallback:t.attachPageToRule,editor:!1},null,8,["current","onCallback"])):r("",!0),o.rulesForm.rules_if?(l(),n("div",Sh,[e("label",jh,[f(a,null,{content:g(()=>[qh]),default:g(()=>[Vh]),_:1}),m(" Сообщение в случае невыполнения условий (не обязательно) ")]),c(e("textarea",{type:"text",class:"form-control",placeholder:"Текст сообщения","aria-label":"Текст сообщения","onUpdate:modelValue":s[18]||(s[18]=i=>o.rulesForm.rules_else_message=i),maxlength:"255","aria-describedby":"rules-else-message"},`
            `,512),[[h,o.rulesForm.rules_else_message]])])):r("",!0)],64)}}}),Uh={class:"page-container"},Oh={class:"page-content"},Ah={class:"row"},Ih={class:"col"},Qh={class:"row"},Th={class:"col"},Bh={class:"row"},Rh={class:"col"},Mh={class:"row"},Dh={class:"col-12"},Eh=["innerHTML"],Lh={key:0,class:"row"},Kh={class:"col-12"},Nh={key:1,class:"row mt-2"},Jh=e("p",{class:"mb-0"},[e("strong",null,"Нижнее меню")],-1),Hh={class:"col-12"},Yh={props:["page"]},Gh=Object.assign(Yh,{__name:"PagePreview",setup(o){return(t,s)=>{const a=I("lazy");return l(),n("div",Uh,[e("div",Oh,[e("div",Ah,[o.page.images?(l(!0),n(v,{key:0},y(o.page.images,(i,d)=>(l(),n("div",Ih,[c(e("img",null,null,512),[[a,"/images-by-bot-id/"+o.page.bot_id+"/"+i]])]))),256)):r("",!0)]),e("div",Qh,[o.page.videos?(l(!0),n(v,{key:0},y(o.page.videos,(i,d)=>(l(),n("div",Th,[f(J,{content:i,type:"video"},null,8,["content"])]))),256)):r("",!0)]),e("div",Bh,[o.page.audios?(l(!0),n(v,{key:0},y(o.page.audios,(i,d)=>(l(),n("div",Rh,[f(J,{content:i,type:"audio"},null,8,["content"])]))),256)):r("",!0)]),e("div",Mh,[e("div",Dh,[e("p",{innerHTML:o.page.content},null,8,Eh)])])]),o.page.inlineKeyboard?(l(),n("div",Lh,[e("div",Kh,[o.page.inlineKeyboard.deleted_at?r("",!0):(l(),$(Y,{key:0,simple:!0,"select-mode":!0,keyboard:o.page.inlineKeyboard},null,8,["keyboard"]))])])):r("",!0),o.page.replyKeyboard?(l(),n("div",Nh,[Jh,e("div",Hh,[o.page.replyKeyboard.deleted_at?r("",!0):(l(),$(Y,{key:0,simple:!0,"select-mode":!0,keyboard:o.page.replyKeyboard},null,8,["keyboard"]))])])):r("",!0)])}}});const Wh={key:0,class:"row pt-3"},Xh={class:"col-12"},Zh={class:"alert alert-info",role:"alert"},xh=e("strong",null,"Внимание!",-1),ep={style:{"font-size":"16px"}},tp={key:0,class:"row"},sp={class:"col-12 mb-2"},op=e("h6",null,"На странице выбраны следующие разделы",-1),lp={class:"mini-pics justify-content-start d-inline-flex text-primary"},np=e("i",{class:"fa-regular fa-images"},null,-1),ip=[np],ap=e("i",{class:"fa-regular fa-note-sticky"},null,-1),dp=[ap],rp=e("i",{class:"fa-solid fa-photo-film"},null,-1),cp=[rp],up=e("i",{class:"fa-regular fa-file-audio"},null,-1),mp=[up],_p=e("i",{class:"fa-regular fa-file-word"},null,-1),hp=[_p],pp=e("i",{class:"fa-solid fa-link"},null,-1),bp=[pp],fp=e("i",{class:"fa-solid fa-scroll"},null,-1),gp=[fp],vp=e("i",{class:"fa-regular fa-comment-dots"},null,-1),$p=[vp],yp=e("i",{class:"fa-solid fa-scale-balanced"},null,-1),kp=[yp],Fp=e("i",{class:"fa-regular fa-keyboard"},null,-1),wp=[Fp],Cp=e("i",{class:"fa-solid fa-ellipsis"},null,-1),Sp=[Cp],jp={class:"row"},Vp={class:"col-md-8 col-12 mb-2"},qp={class:"form-label",id:"bot-domain"},zp=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),Pp=e("div",null,[m(" Команда должна начинаться с символа . и *"),e("br"),m(" Например: .*Меню"),e("br")],-1),Up=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),Op={class:"col-md-4 col-12 mb-2 d-flex justify-content-end align-items-end"},Ap={class:"btn-group",style:{background:"white"},role:"group","aria-label":"Basic example"},Ip={key:0,type:"submit",title:"Сохранить страницу",id:"save-page-btn",class:"btn btn-primary min-menu-btn"},Qp=e("i",{class:"fa-regular fa-floppy-disk"},null,-1),Tp=[Qp],Bp=e("i",{class:"fa-solid fa-xmark text-danger"},null,-1),Rp=[Bp],Mp=e("button",{type:"button",title:"Список страниц","data-bs-toggle":"offcanvas","data-bs-target":"#offcanvas",class:"btn btn-outline-primary text-primary min-menu-btn"},[e("i",{class:"fa-solid fa-list-ol"})],-1),Dp={class:"row"},Ep={class:"col-12 mb-2"},Lp={class:"form-label d-flex justify-content-between align-items-center mb-0",id:"bot-domain"},Kp=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),Np=e("div",null,[m(" Текстовый редактор. Данный текст будет в таком"),e("br"),m(" же виде отображен в посте в телеграм. ")],-1),Jp=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),Hp={class:"form-floating"},Yp={for:"floatingTextarea2"},Gp={key:0},Wp={class:"col-12 mb-2"},Xp={class:"nav nav-tabs justify-content-center"},Zp=e("i",{class:"fa-regular fa-keyboard"},null,-1),xp=e("span",null,"Нижнее меню",-1),eb=[Zp,xp],tb=e("i",{class:"fa-solid fa-ellipsis"},null,-1),sb=e("span",null,"Меню под текстом",-1),ob=[tb,sb],lb=e("i",{class:"fa-regular fa-images"},null,-1),nb=e("span",null,"Изображения",-1),ib=[lb,nb],ab=e("i",{class:"fa-solid fa-photo-film"},null,-1),db=e("span",null,"Видео",-1),rb=[ab,db],cb=e("i",{class:"fa-regular fa-note-sticky"},null,-1),ub=e("span",null,"Стикеры",-1),mb=[cb,ub],_b=e("i",{class:"fa-regular fa-file-audio"},null,-1),hb=e("span",null,"Аудио",-1),pb=[_b,hb],bb=e("i",{class:"fa-regular fa-file-word"},null,-1),fb=e("span",null,"Документы",-1),gb=[bb,fb],vb=e("i",{class:"fa-solid fa-link"},null,-1),$b=e("span",null,"Другая страница",-1),yb=[vb,$b],kb=e("i",{class:"fa-solid fa-scroll"},null,-1),Fb=e("span",null,"Скрипт",-1),wb=[kb,Fb],Cb=e("i",{class:"fa-regular fa-comment-dots"},null,-1),Sb=e("span",null,"Начало диалога",-1),jb=[Cb,Sb],Vb=e("i",{class:"fa-solid fa-scale-balanced"},null,-1),qb=e("span",null,"Правила",-1),zb=[Vb,qb],Pb={key:0,class:"col-12 mb-2"},Ub={class:"form-check"},Ob=e("label",{class:"form-check-label",for:"need-reply-menu"}," Нижнее меню страницы ",-1),Ab={key:1,class:"col-12 mb-2"},Ib={class:"card"},Qb={class:"card-header d-flex justify-between align-items-center"},Tb=e("h6",null,"Конструктор нижнего меню",-1),Bb={key:0},Rb={key:1},Mb={class:"card-body"},Db={class:"row"},Eb={class:"col-12 mb-2"},Lb={class:"form-label",id:"bot-domain"},Kb=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),Nb=e("div",null," Заголовок для нижнего меню ",-1),Jb={key:2,class:"col-12 mb-2"},Hb={class:"position-relative p-5 text-center text-muted bg-body border border-dashed rounded-2"},Yb={class:"d-flex justify-content-center mb-3"},Gb={alt:"",width:"100",height:"100"},Wb=e("h1",{class:"text-body-emphasis"},"Нижнее меню",-1),Xb=e("p",{class:"col-lg-8 mx-auto fs-5 text-muted"}," Создание и настройка нижнего меню страницы бота. Добавление и редактирование функций кнопок бота на странице. Данное меню отображается пользователю всегда. ",-1),Zb={class:"d-inline-flex gap-2 mb-5"},xb=["disabled"],ef=e("a",{href:"https://telegra.ph/Nizhnee-menyu-bota-01-03",target:"_blank",class:"d-inline-flex align-items-center btn btn-outline-secondary btn-lg px-4 rounded-pill"}," Подробнее ",-1),tf={key:0,class:"col-12 mb-2"},sf={class:"form-check"},of=e("label",{class:"form-check-label",for:"need-inline-menu"}," Меню под текстом страницы ",-1),lf={key:1,class:"col-12 mb-2"},nf={class:"card"},af={class:"card-header d-flex justify-between align-items-center"},df=e("h6",null,"Конструктор меню в сообщении",-1),rf={key:0},cf={key:1},uf={class:"card-body"},mf={key:2,class:"col-12 mb-2"},_f={class:"position-relative p-5 text-center text-muted bg-body border border-dashed rounded-2"},hf={class:"d-flex justify-content-center mb-3"},pf={alt:"",width:"100",height:"100"},bf=e("h1",{class:"text-body-emphasis"},"Меню под текстом",-1),ff=e("p",{class:"col-lg-8 mx-auto fs-5 text-muted"}," В отличии от нижнего меню, которое отображается всегда, меню под текстом показывается под контентом только в момент отображения этого контента. ",-1),gf={class:"d-inline-flex gap-2 mb-5"},vf=["disabled"],$f=e("a",{href:"https://telegra.ph/Menyu-k-tekstu-01-03",target:"_blank",class:"d-inline-flex align-items-center btn btn-outline-secondary btn-lg px-4 rounded-pill"}," Подробнее ",-1),yf={key:0,class:"col-12 mb-2"},kf={class:"form-check"},Ff=e("label",{class:"form-check-label",for:"need-page-images"}," Изображения на странице (максимум 10) ",-1),wf={key:1,class:"col-12 mb-2"},Cf={class:"card mb-3"},Sf=e("div",{class:"card-header"},[e("h6",null,"Загрузите изображения с файловой системы")],-1),jf={class:"card-body d-flex justify-content-start"},Vf={for:"photos",style:{"margin-right":"10px"},class:"photo-loader ml-2"},qf={class:"row"},zf={key:0,class:"col-12 d-flex flex-wrap"},Pf={class:"mb-2 img-preview",style:{"margin-right":"10px"}},Uf={class:"remove"},Of=["onClick"],Af={key:1},If={key:2,class:"col-12 d-flex flex-wrap"},Qf={class:"mb-2 img-preview",style:{"margin-right":"10px"}},Tf={class:"remove"},Bf=["onClick"],Rf={key:2,class:"col-12 mb-2"},Mf={class:"position-relative p-5 text-center text-muted bg-body border border-dashed rounded-2"},Df={class:"d-flex justify-content-center mb-3"},Ef={alt:"",width:"100",height:"100"},Lf=e("h1",{class:"text-body-emphasis"},"Изображения",-1),Kf=e("p",{class:"col-lg-8 mx-auto fs-5 text-muted"},[m(" Вы можете добавить к одной странице от "),e("b",null,"1"),m(" до "),e("b",null,"10"),m(" изображений. Изображения (от 2х) будут собраны в группу и показаны под текстовым содержимым страницы. Если изображение одно, то текст будет отображен под ним. ")],-1),Nf={class:"d-inline-flex gap-2 mb-5"},Jf=["disabled"],Hf=e("a",{href:"https://telegra.ph/Dobavlenie-izobrazhenij-01-03",target:"_blank",class:"d-inline-flex align-items-center btn btn-outline-secondary btn-lg px-4 rounded-pill"}," Подробнее ",-1),Yf={key:0,class:"col-12 mb-2"},Gf={class:"form-check"},Wf=e("label",{class:"form-check-label",for:"need-page-video"}," Видео к странице ",-1),Xf={key:1,class:"col-12 mb-2"},Zf={key:2,class:"col-12 mb-2"},xf={class:"position-relative p-5 text-center text-muted bg-body border border-dashed rounded-2"},e1={class:"d-flex justify-content-center mb-3"},t1={alt:"",width:"100",height:"100"},s1=e("h1",{class:"text-body-emphasis"},"Видео",-1),o1=e("p",{class:"col-lg-8 mx-auto fs-5 text-muted"},[m(" Вы можете добавить к одной странице от "),e("b",null,"1"),m(" до "),e("b",null,"10"),m(" видео. Ролики (от 2х) будут собраны в группу и показаны под текстовым содержимым страницы. ")],-1),l1={class:"d-inline-flex gap-2 mb-5"},n1=["disabled"],i1=e("a",{href:"https://telegra.ph/Dobavlenie-video-na-stranicu-01-03",target:"_blank",class:"d-inline-flex align-items-center btn btn-outline-secondary btn-lg px-4 rounded-pill"}," Подробнее ",-1),a1={key:0,class:"col-12 mb-2"},d1={class:"form-check"},r1=e("label",{class:"form-check-label",for:"need-page-sticker"}," Стикер к странице ",-1),c1={key:1,class:"col-12 mb-2"},u1={key:2,class:"col-12 mb-2"},m1={class:"position-relative p-5 text-center text-muted bg-body border border-dashed rounded-2"},_1={class:"d-flex justify-content-center mb-3"},h1={alt:"",width:"100",height:"100"},p1=e("h1",{class:"text-body-emphasis"},"Стикеры",-1),b1=e("p",{class:"col-lg-8 mx-auto fs-5 text-muted"}," Вы можете переслать любой стикер в бота (от лица администратора) и затем этот стикер использовать для взаимодействия с пользователем. ",-1),f1={class:"d-inline-flex gap-2 mb-5"},g1=["disabled"],v1=e("a",{href:"https://telegra.ph/Dobavlenie-stikera-na-stranicu-01-03",target:"_blank",class:"d-inline-flex align-items-center btn btn-outline-secondary btn-lg px-4 rounded-pill"}," Подробнее ",-1),$1={key:0,class:"col-12 mb-2"},y1={class:"form-check"},k1=e("label",{class:"form-check-label",for:"need-page-audio"}," Звук к странице ",-1),F1={key:1,class:"col-12 mb-2"},w1={key:2,class:"col-12 mb-2"},C1={class:"position-relative p-5 text-center text-muted bg-body border border-dashed rounded-2"},S1={class:"d-flex justify-content-center mb-3"},j1={alt:"",width:"100",height:"100"},V1=e("h1",{class:"text-body-emphasis"},"Аудио",-1),q1=e("p",{class:"col-lg-8 mx-auto fs-5 text-muted"},[m(" Вы можете добавить к одной странице от "),e("b",null,"1"),m(" до "),e("b",null,"10"),m(" аудио. Музыка (от 2х) будет собрана в группу и показана под текстовым содержимым страницы. Если вы хотите использовать "),e("b",{class:"text-danger"},"голосовое"),m(", то можно использовать максимум "),e("b",{class:"text-danger"},"одну запись"),m(". Или же, вы можете конвертировать её в mp3 и залить как музыкальный файл в бота. ")],-1),z1={class:"d-inline-flex gap-2 mb-5"},P1=["disabled"],U1=e("a",{href:"https://telegra.ph/Dobavlenie-audio-na-stranicu-01-03",target:"_blank",class:"d-inline-flex align-items-center btn btn-outline-secondary btn-lg px-4 rounded-pill"}," Подробнее ",-1),O1={key:0,class:"col-12 mb-2"},A1={class:"form-check"},I1=e("label",{class:"form-check-label",for:"need-page-document"}," Документ \\ презентацию к странице \\ картинку в оригинале ",-1),Q1={key:1,class:"col-12 mb-2"},T1={key:2,class:"col-12 mb-2"},B1={class:"position-relative p-5 text-center text-muted bg-body border border-dashed rounded-2"},R1={class:"d-flex justify-content-center mb-3"},M1={alt:"",width:"100",height:"100"},D1=e("h1",{class:"text-body-emphasis"},"Документы",-1),E1=e("p",{class:"col-lg-8 mx-auto fs-5 text-muted"},[m(" Вы можете добавить к одной странице от "),e("b",null,"1"),m(" до "),e("b",null,"10"),m(" документов. Документы (от 2х) будут собраны в группу и показана под текстовым содержимым страницы. В качестве файлов вы можете использовать текстовые документы, презентации, файлы-pdf, изображения в оригинальном размере. ")],-1),L1={class:"d-inline-flex gap-2 mb-5"},K1=["disabled"],N1=e("a",{href:"https://telegra.ph/Dobavlenie-dokumenta-01-03",target:"_blank",class:"d-inline-flex align-items-center btn btn-outline-secondary btn-lg px-4 rounded-pill"}," Подробнее ",-1),J1={class:"col-12 mb-2"},H1={class:"position-relative p-5 text-center text-muted bg-body border border-dashed rounded-2"},Y1={class:"d-flex justify-content-center mb-3"},G1={alt:"",width:"100",height:"100"},W1=e("h1",{class:"text-body-emphasis"},"Связь со страницей",-1),X1=e("p",{class:"col-lg-8 mx-auto fs-5 text-muted"}," Вы можете привязать вызов другой страницы непосредственно после вызова текущей. Это позволит выводить контент по цепочке для пользователя. ",-1),Z1={key:0,class:"my-3 text-success font-bold"},x1={class:"d-inline-flex gap-2 mb-5"},eg={key:1,"data-bs-toggle":"modal","data-bs-target":"#page-list-modal",class:"d-inline-flex align-items-center btn btn-lg px-4 rounded-pill btn-primary",type:"button"},tg=e("a",{href:"https://telegra.ph/Svyazyvanie-so-stranicej-01-03",target:"_blank",class:"d-inline-flex align-items-center btn btn-outline-secondary btn-lg px-4 rounded-pill"}," Подробнее ",-1),sg=e("h6",{class:"mb-3"},"Конструктор цепочек",-1),og={class:"d-flex justify-content-center align-items-center flex-wrap"},lg=e("span",{class:"px-2"},"Текущая страница",-1),ng=e("i",{class:"fa-solid fa-arrow-right"},null,-1),ig={class:"d-flex justify-content-center align-items-center px-3 py-2"},ag=["onClick"],dg={class:"position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger"},rg={key:0,class:"fa-solid fa-arrow-right ml-2"},cg={key:0,class:"fa-solid fa-arrow-right"},ug=e("button",{type:"button","data-bs-toggle":"modal","data-bs-target":"#page-list-modal",class:"btn btn-outline-secondary position-relative rounded-5 ml-5"},[e("i",{class:"fa-solid fa-plus"})],-1),mg={key:0,class:"col-12 mb-2"},_g=e("div",{class:"alert alert-info",role:"alert"}," Если в вашем боте нет каких-то предустановленных скриптов вы можете найти их в глобальном магазине скриптов ",-1),hg={class:"form-check"},pg=e("label",{class:"form-check-label",for:"need-show-global-slug-list"}," Добавить скрипты из глобального магазина? ",-1),bg={key:1,class:"col-12 mb-2"},fg={class:"form-check"},gg=e("label",{class:"form-check-label",for:"need-slug-attach"}," Привязать скрипт ",-1),vg={key:2,class:"col-12 mb-2"},$g={key:0,class:"alert alert-success d-flex justify-content-between align-items-center",role:"alert"},yg={key:3,class:"col-12 mb-2"},kg={class:"position-relative p-5 text-center text-muted bg-body border border-dashed rounded-2"},Fg={class:"d-flex justify-content-center mb-3"},wg={alt:"",width:"100",height:"100"},Cg=e("h1",{class:"text-body-emphasis"},"Скрипты",-1),Sg=e("p",{class:"col-lg-8 mx-auto fs-5 text-muted"}," Скрипты содержат основной функционал системы. Вы можете к каждой странице привязать один скрипт, который будет вызван после вывода основного содержимого страницы. ",-1),jg={class:"d-inline-flex gap-2 mb-5"},Vg=["disabled"],qg=e("a",{href:"https://telegra.ph/Svyazyvanie-so-skriptom-01-03",target:"_blank",class:"d-inline-flex align-items-center btn btn-outline-secondary btn-lg px-4 rounded-pill"}," Подробнее ",-1),zg={key:0,class:"col-12 mb-2"},Pg={class:"form-check"},Ug=e("label",{class:"form-check-label",for:"need-dialog-attach"}," Привязать начало диалога ",-1),Og={key:1,class:"col-12 mb-2"},Ag={key:0},Ig={key:2,class:"col-12 mb-2"},Qg={class:"position-relative p-5 text-center text-muted bg-body border border-dashed rounded-2"},Tg={class:"d-flex justify-content-center mb-3"},Bg={alt:"",width:"100",height:"100"},Rg=e("h1",{class:"text-body-emphasis"},"Диалоги",-1),Mg=e("p",{class:"col-lg-8 mx-auto fs-5 text-muted"}," Диалоги страницы - это инструмент запроса данных от пользователя. Вы можете привязать начало диалога к странице, а сам диалог будет вызван по цепочке. ",-1),Dg={class:"d-inline-flex gap-2 mb-5"},Eg=["disabled"],Lg=e("a",{href:"https://telegra.ph/Dobavlenie-dialoga-01-03",target:"_blank",class:"d-inline-flex align-items-center btn btn-outline-secondary btn-lg px-4 rounded-pill"}," Подробнее ",-1),Kg={key:0,class:"col-12 mb-2"},Ng={class:"form-check"},Jg=e("label",{class:"form-check-label",for:"need-rules"}," Нужны правила загрузки страницы ",-1),Hg={key:1,class:"col-12 mb-2"},Yg={key:2,class:"col-12 mb-2"},Gg={class:"position-relative p-5 text-center text-muted bg-body border border-dashed rounded-2"},Wg={class:"d-flex justify-content-center mb-3"},Xg={alt:"",width:"100",height:"100"},Zg=e("h1",{class:"text-body-emphasis"},"Правила отображения страницы",-1),xg=e("p",{class:"col-lg-8 mx-auto fs-5 text-muted"}," Вы можете создать правила, согласно которым будет отображена та или иная страница. Вы можете перенаправить пользователя с одной страницы на другую, в случае если ваше условие не выполнено. ",-1),ev={class:"d-inline-flex gap-2 mb-5"},tv=["disabled"],sv=e("a",{href:"https://telegra.ph/Pravila-na-stranice-01-03",target:"_blank",class:"d-inline-flex align-items-center btn btn-outline-secondary btn-lg px-4 rounded-pill"}," Подробнее ",-1),ov=e("div",{class:"row"},[e("div",{class:"col-12"},[e("div",{class:"alert alert-info",role:"alert"},[e("h6",null,"Страница поддерживает комбинации клавиш:"),e("ul",{class:"mb-0 mr-0 p-0"},[e("li",null,[e("strong",null,"Ctrl+S"),m(" - открыть\\закрыть окно сохранения")]),e("li",null,[e("strong",null,"Ctrl+D"),m(" - просмотр страницы (для сохраненных страниц)")]),e("li",null,[e("strong",null,"Ctrl+пробел"),m(" - открыть\\закрыть список страниц")]),e("li",null,[e("strong",null,"Ctrl+backspace"),m(" - очистить страницу\\новая страница")]),e("li",null,[e("strong",null,"Ctrl+стрелка вправо"),m(" - переключение между вкладка вперед")]),e("li",null,[e("strong",null,"Ctrl+стрелка влево"),m(" - переключение между вкладка назад")])])])])],-1),lv={class:"modal fade",id:"save-modal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},nv={class:"modal-dialog"},iv={class:"modal-content"},av=e("div",{class:"modal-header"},[e("h5",{class:"modal-title",id:"exampleModalLabel"},"Сохранение страницы"),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),dv={class:"modal-body"},rv={key:0,class:"row"},cv={class:"col-12 mb-2"},uv={class:"d-flex justify-between"},mv=["href"],_v={class:"col-12 mb-2"},hv=e("h6",null,"На странице выбраны следующие разделы",-1),pv={class:"mini-pics text-primary"},bv=e("i",{class:"fa-regular fa-images"},null,-1),fv=[bv],gv=e("i",{class:"fa-regular fa-note-sticky"},null,-1),vv=[gv],$v=e("i",{class:"fa-solid fa-photo-film"},null,-1),yv=[$v],kv=e("i",{class:"fa-regular fa-file-audio"},null,-1),Fv=[kv],wv=e("i",{class:"fa-regular fa-file-word"},null,-1),Cv=[wv],Sv=e("i",{class:"fa-solid fa-link"},null,-1),jv=[Sv],Vv=e("i",{class:"fa-solid fa-scroll"},null,-1),qv=[Vv],zv=e("i",{class:"fa-regular fa-comment-dots"},null,-1),Pv=[zv],Uv=e("i",{class:"fa-solid fa-scale-balanced"},null,-1),Ov=[Uv],Av=e("i",{class:"fa-regular fa-keyboard"},null,-1),Iv=[Av],Qv=e("i",{class:"fa-solid fa-ellipsis"},null,-1),Tv=[Qv],Bv={key:0,class:"col-12 mb-2"},Rv={class:"form-check"},Mv=e("label",{class:"form-check-label",for:"need-show-qr-and-link"}," Показать ссылку на страницу и QR-код ",-1),Dv={key:1,class:"col-12 mb-2"},Ev={class:"d-flex justify-content-center"},Lv={style:{width:"200px",height:"200px"}},Kv={class:"col-12 mb-2"},Nv={class:"form-label",id:"bot-domain"},Jv=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),Hv=e("div",null,"Напишите для себя пояснение для чего нужна данная страница. Это поможет другим менеджерам лучше понять Вас. ",-1),Yv=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),Gv={class:"col-12"},Wv={class:"form-check"},Xv=e("label",{class:"form-check-label",for:"is-external"}," Внешнее управление страницей ",-1),Zv={key:0,class:"alert alert-danger",role:"alert"},xv={key:0,class:"mb-0"},e$=e("strong",null,'"Информация о боте"',-1),t$=e("strong",null,"Другие настройки",-1),s$=e("strong",null,'"Ссылка на внешний сервис обработки данных"',-1),o$={class:"col-12"},l$={class:"form-check"},n$=e("label",{class:"form-check-label",for:"need_log_user_action"}," Логгировать действия пользователя в канал при переходе ",-1),i$={class:"col-12"},a$={class:"form-check"},d$=e("label",{class:"form-check-label",for:"need-stay-after-save"}," Остаться на текущей странице после сохранения ",-1),r$=e("div",{class:"col-12"},[e("button",{type:"submit",id:"submit-page",class:"btn btn-success w-100 p-3"},"Сохранить ")],-1),c$=e("div",{class:"modal-footer"},[e("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Не сохранять")],-1),u$={class:"modal fade",id:"page-list-modal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},m$={class:"modal-dialog"},_$={class:"modal-content"},h$={class:"modal-body"},p$={class:"modal fade",id:"page-preview-modal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},b$={class:"modal-dialog"},f$={class:"modal-content"},g$={class:"modal-body"},v$={key:1},$$={class:"offcanvas offcanvas-end w-25",tabindex:"-1",id:"offcanvas","data-bs-keyboard":"true","data-bs-scroll":"true","data-bs-backdrop":"true"},y$=e("div",{class:"offcanvas-header"},[e("h6",{class:"offcanvas-title d-none d-sm-block",id:"offcanvas"},"Ваши страницы (кнопки)"),e("button",{type:"button",class:"btn-close text-reset","data-bs-dismiss":"offcanvas","aria-label":"Close"})],-1),k$={class:"offcanvas-body"},F$={class:"row"},w$={class:"col-12"},C$={data(){return{tab:0,links:[],saveModal:null,pageModal:null,pagePreviewModal:null,page:null,need_clean:!1,load:!1,photos:[],showReplyTemplateSelector:!1,showInlineTemplateSelector:!1,loaded_page_list:!0,load_slug_simple_list:!0,showMenu:!1,need_show_qr_and_link:!1,need_stay_after_save:!0,need_show_global_slug_list:!1,need_page_sticker:!1,need_page_audios:!1,need_page_documents:!1,need_page_video:!1,need_page_images:!1,need_inline_menu:!1,need_reply_menu:!1,need_attach_page:!1,need_attach_dialog:!1,need_attach_slug:!1,need_rules:!1,bot:null,pageForm:{id:null,content:"",command:null,slug:null,comment:null,videos:[],images:[],audios:[],documents:[],sticker:null,reply_keyboard_title:null,reply_keyboard:null,reply_keyboard_settings:null,inline_keyboard:null,is_external:!1,need_log_user_action:!1,next_page_id:null,next_bot_dialog_command_id:null,next_bot_menu_slug_id:null,rules_if:null,rules_else_page_id:null,rules_if_message:null,rules_else_message:null}}},watch:{need_page_images:function(o,t){this.need_page_images||(this.photos=[],this.pageForm.images=[])},need_page_audios:function(o,t){this.need_page_audios||(this.pageForm.audios=[])},need_page_documents:function(o,t){this.need_page_documents||(this.pageForm.documents=[])},need_page_sticker:function(o,t){this.need_page_sticker||(this.pageForm.sticker=null)},need_page_video:function(o,t){this.need_page_video||(this.pageForm.videos=[])},need_inline_menu:function(o,t){this.need_inline_menu||(this.pageForm.inline_keyboard=null,this.pageForm.inline_keyboard_id=null)},need_rules:function(o,t){this.need_rules||(this.pageForm.rules_if=null,this.pageForm.rules_else_page_id=null,this.pageForm.rules_if_message=null,this.pageForm.rules_else_message=null)},need_reply_menu:function(o,t){this.need_reply_menu||(this.pageForm.reply_keyboard=null,this.pageForm.reply_keyboard_id=null)},need_attach_page:function(o,t){this.need_attach_page||(this.pageForm.next_page_id=null)},need_attach_dialog:function(o,t){this.need_attach_dialog||(this.pageForm.next_bot_dialog_command_id=null)},need_attach_slug:function(o,t){this.need_attach_slug||(this.pageForm.next_bot_menu_slug_id=null)},pageForm:{handler:function(o){this.pageForm.reply_keyboard!=null&&(this.need_reply_menu=!0),this.pageForm.inline_keyboard!=null&&(this.need_inline_menu=!0),this.pageForm.images.length>0&&(this.need_page_images=!0),this.pageForm.next_bot_dialog_command_id!=null&&(this.need_attach_dialog=!0),this.pageForm.next_bot_menu_slug_id!=null&&(this.need_attach_slug=!0),this.pageForm.next_page_id!=null&&(this.need_attach_page=!0),this.pageForm.rules_if!=null&&(this.need_rules=!0),this.pageForm.videos.length>0&&(this.need_page_video=!0),this.pageForm.audios.length>0&&(this.need_page_audios=!0),this.pageForm.documents.length>0&&(this.need_page_documents=!0),this.pageForm.sticker&&(this.need_page_sticker=!0),this.need_clean=!0},deep:!0}},computed:{...C(["getCurrentBot"]),qr(){return"https://api.qrserver.com/v1/create-qr-code/?size=450x450&qzone=2&data="+this.link},selectedLinkIds(){let o=this.links.map(t=>t.id);return this.page==null?o:this.page.id!=null?[this.page.id,...o]:o},hasParts(){return this.need_page_sticker||this.need_page_audios||this.need_page_documents||this.need_page_video||this.need_page_images||this.need_inline_menu||this.need_reply_menu||this.need_attach_page||this.need_attach_dialog||this.need_attach_slug||this.need_rules},pageLink(){if(!this.pageForm.id)return"Ссылка недоступна";let o="";for(let t=0;t<10-(""+this.pageForm.id).length;t++)o+="0";return o+=this.pageForm.id,"https://t.me/"+this.getCurrentBot.bot_domain+"?start="+btoa("004"+o)}},mounted(){this.page?this.preparePageForm(this.page):this.clearForm(),this.loadCurrentBot().then(()=>{this.saveModal=new bootstrap.Modal(document.getElementById("save-modal"),{})}),this.pageModal=new bootstrap.Offcanvas(document.getElementById("offcanvas"),{scroll:!0}),this.pagePreviewModal=new bootstrap.Modal(document.getElementById("page-preview-modal"),{}),window.addEventListener("keydown",o=>{if(o.ctrlKey&&o.keyCode==8&&(o.preventDefault(),this.clearForm()),o.ctrlKey&&o.code=="KeyD"&&(o.preventDefault(),this.pagePreviewModal.toggle()),o.ctrlKey&&o.keyCode==32&&(o.preventDefault(),this.pageModal.toggle()),o.ctrlKey&&o.code=="KeyS"){o.preventDefault();const t=document.querySelector("#save-page-btn");t?t.click():this.$notify({title:"Конструктор страниц",text:"Вы еще не начали создавать страницу!",type:"warning"})}o.ctrlKey&&o.keyCode==39&&(o.preventDefault(),this.tab===10?this.tab=0:this.tab++),o.ctrlKey&&o.keyCode==37&&(o.preventDefault(),this.tab===0?this.tab=10:this.tab--)})},methods:{chainCollapseTest(o){return this.page==null?this.links.filter(t=>t.id==o.id).length>1:[this.page,...this.links].filter(t=>t.id==o.id).length>1},loadPageChains(){return this.$store.dispatch("loadPageChains",{dataObject:{start_page_id:this.page.id}}).then(o=>{this.links=o.data})},removeLink(o){this.links.splice(o,1)},loadSlugs(){this.load_slug_simple_list=!1,this.need_show_global_slug_list=!1,this.$nextTick(()=>{this.load_slug_simple_list=!0})},preparePageForm(o){this.need_show_qr_and_link=!1,this.need_show_global_slug_list=!1,this.need_page_sticker=!1,this.need_page_audios=!1,this.need_page_documents=!1,this.need_page_video=!1,this.need_page_images=!1,this.need_inline_menu=!1,this.need_reply_menu=!1,this.need_attach_page=!1,this.need_attach_dialog=!1,this.need_attach_slug=!1,this.need_rules=!1,this.links=[],this.page=o,this.photos=[],this.$nextTick(()=>{this.pageForm.id=o.id,this.pageForm.slug_id=o.slug?o.slug.id:null,this.pageForm.content=o.content,this.pageForm.command=o.slug?o.slug.command:null,this.pageForm.slug=o.slug?o.slug.slug:null,this.pageForm.comment=o.slug?o.slug.comment:null,this.pageForm.images=o.images||[],this.pageForm.sticker=o.sticker||null,this.pageForm.reply_keyboard_title=o.reply_keyboard_title||null,this.pageForm.reply_keyboard_id=o.reply_keyboard_id||null,this.pageForm.inline_keyboard_id=o.inline_keyboard_id||null,this.pageForm.reply_keyboard=o.replyKeyboard||null,this.pageForm.inline_keyboard=o.inlineKeyboard||null,this.pageForm.next_page_id=o.next_page_id||null,this.pageForm.next_bot_dialog_command_id=o.next_bot_dialog_command_id||null,this.pageForm.next_bot_menu_slug_id=o.next_bot_menu_slug_id||null,this.pageForm.is_external=o.is_external||!1,this.pageForm.need_log_user_action=o.need_log_user_action||!1,this.pageForm.rules_if=o.rules_if||null,this.pageForm.rules_else_page_id=o.rules_else_page_id||null,this.pageForm.audios=o.audios||[],this.pageForm.documents=o.documents||[],this.pageForm.videos=o.videos||[],this.pageForm.rules_if_message=o.rules_if_message||null,this.pageForm.rules_else_message=o.rules_else_message||null,this.pageForm.id!=null&&this.pageForm.next_page_id!=null&&this.loadPageChains()})},copyToClipBoard(o){navigator.clipboard.writeText(o).then(()=>{this.$notify({title:"Копирование",text:"Ссылка скопирована в буфер"})}).catch(t=>{this.$notify({title:"Копирование",text:"Ошибка копирования",type:"error"})})},associateDialog(o){this.pageForm.next_bot_dialog_command_id=o.id},associateSlug(o){this.pageForm.next_bot_menu_slug_id=o.id},loadCurrentBot(o=null){return this.$store.dispatch("updateCurrentBot",{bot:o}).then(()=>{this.bot=this.getCurrentBot})},clearLinks(){this.links=[],this.pageForm.next_page_id=null},attachPage(o){this.links.length==0&&(o.id!=this.pageForm.id?(this.$notify({title:"Конструктор страниц",text:"Вы успешно связали страницы!",type:"success"}),this.pageForm.next_page_id=o.id):this.$notify({title:"Конструктор страниц",text:"Вы не можете связать данную страницу с собой",type:"error"})),(this.page==null?this.links.findIndex(s=>s.id===o.id)!=-1:this.links.findIndex(s=>s.id===o.id)!=-1||o.id===this.page.id)||this.links.push(o)},injectContent(o){this.pageForm.content?this.pageForm.content+=o.text:this.pageForm.content=o.text},clearForm(){this.photos=[],this.pageForm={id:null,content:null,command:null,slug:null,comment:null,sticker:null,images:[],reply_keyboard:null,inline_keyboard:null,is_external:!1,need_log_user_action:!1,videos:[],audios:[],documents:[],reply_keyboard_title:null,reply_keyboard_id:null,inline_keyboard_id:null,next_page_id:null,next_menu_slug:null,next_bot_dialog_command_id:null,next_bot_menu_slug_id:null,rules_if_message:null,rules_else_message:null},this.photos=[],this.showReplyTemplateSelector=!1,this.showInlineTemplateSelector=!1,this.need_page_images=!1,this.need_page_video=!1,this.need_inline_menu=!1,this.need_reply_menu=!1,this.need_attach_page=!1,this.need_attach_dialog=!1,this.need_attach_slug=!1,this.need_rules=!1,this.need_page_audios=!1,this.need_page_documents=!1,this.need_page_sticker=!1,this.links=[],this.$nextTick(()=>{this.need_clean=!1})},openSaveModal(){(this.pageForm.comment||"").length===0&&(this.pageForm.comment=this.pageForm.command),this.saveModal.show()},submitPage(){let o=new FormData;if(Object.keys(this.pageForm).forEach(t=>{const s=this.pageForm[t]||"";typeof s=="object"?o.append(t,JSON.stringify(s)):o.append(t,s)}),this.bot&&o.append("bot_id",this.bot.id),this.photos.length>0)for(let t=0;t<this.photos.length;t++)o.append("photos[]",this.photos[t]);this.$store.dispatch(this.pageForm.id==null?"createPage":"updatePage",{pageForm:o}).then(t=>{this.pageForm.id==null&&this.preparePageForm(t.data),this.links.length>0&&this.$store.dispatch("storePageChains",{dataObject:{start_page_id:t.data.id,links:this.links.map(s=>s.id)}}),this.need_stay_after_save||(this.load=!0,this.$nextTick(()=>{this.load=!1,this.clearForm()})),this.loaded_page_list=!1,this.$nextTick(()=>{this.loaded_page_list=!0}),this.saveModal.hide(),this.$emit("callback",t.data),this.$notify({title:"Конструктор ботов",text:this.pageForm.id==null?"Страница успешно создана!":"Страница успешно обновлена!",type:"success"}),this.$store.dispatch("loadPages",{dataObject:{botId:this.bot.id,needNewFirst:!0},page:localStorage.getItem(`cashman_pagelist_${this.bot.id}_page_index`)||0})}).catch(t=>{})},saveInlineKeyboard(o){this.pageForm.inline_keyboard=o},selectReplyKeyboard(o){this.pageForm.reply_keyboard=o,this.showReplyTemplateSelector=!1},selectInlineKeyboard(o){this.pageForm.inline_keyboard=o,this.showInlineTemplateSelector=!1},getPhoto(o){return{imageUrl:URL.createObjectURL(o)}},removePhoto(o){this.photos.splice(o,1)},removeImage(o){this.pageForm.images.splice(o,1)},onChangePhotos(o){const t=o.target.files;for(let s=0;s<t.length;s++)this.photos.push(t[s])},onChange(o){this.pageForm.content=o},selectPhoto(o){this.pageForm.images||(this.pageForm.images=[]);let t=this.pageForm.images.indexOf(o.file_id);t!==-1?this.pageForm.images.splice(t,1):this.pageForm.images.push(o.file_id)},selectSticker(o){this.pageForm.sticker=o.file_id},selectVideo(o){this.pageForm.videos||(this.pageForm.videos=[]);let t=this.pageForm.videos.indexOf(o.file_id);t!==-1?this.pageForm.videos.splice(t,1):this.pageForm.videos.push(o.file_id)},selectAudio(o){this.pageForm.audios||(this.pageForm.audios=[]);let t=this.pageForm.audios.indexOf(o.file_id);if(o.type==="voice"){if(t!==-1){this.pageForm.audios.splice(t,1);return}this.pageForm.audios=[o.file_id];return}t!==-1?this.pageForm.audios.splice(t,1):this.pageForm.audios.push(o.file_id)},selectDocument(o){this.pageForm.documents||(this.pageForm.documents=[]);let t=this.pageForm.documents.indexOf(o.file_id);t!==-1?this.pageForm.documents.splice(t,1):this.pageForm.documents.push(o.file_id)},pageListCallback(o){this.$notify("Вы выбрали страницу из списка! Все остальные действия будут производится для этой страницы"),this.load=!0,this.preparePageForm(o),this.$nextTick(()=>{this.load=!1})}}},S$=Object.assign(C$,{__name:"Page",setup(o){return(t,s)=>{const a=V("Popper"),i=I("lazy");return l(),n(v,null,[t.pageForm.id?(l(),n("div",Wh,[e("div",Xh,[e("div",Zh,[xh,m(" Вы в режиме редактирования страницы (кнопки) "),e("strong",ep,u(t.page.slug?t.page.slug.command:"Без названия"),1),m(", если хотите создать новую нажмите "),e("a",{href:"javascript:void(0)",class:"btn btn-primary ml-2",onClick:s[0]||(s[0]=(...d)=>t.clearForm&&t.clearForm(...d))},"Создать новую страницу")])])])):r("",!0),t.bot?(l(),n("form",{key:1,id:"page-construct",class:"py-3",onSubmit:s[45]||(s[45]=S((...d)=>t.openSaveModal&&t.openSaveModal(...d),["prevent"]))},[t.hasParts?(l(),n("div",tp,[e("div",sp,[op,e("ul",lp,[e("li",{class:b(["mr-1",{active:t.need_page_images}]),title:"Изображения"},ip,2),e("li",{class:b(["mr-1",{active:t.need_page_sticker}]),title:"Стикеры"},dp,2),e("li",{class:b(["mr-1",{active:t.need_page_video}]),title:"Видео"},cp,2),e("li",{class:b(["mr-1",{active:t.need_page_audios}]),title:"Аудио"},mp,2),e("li",{class:b(["mr-1",{active:t.need_page_documents}]),title:"Документы"},hp,2),e("li",{class:b(["mr-1",{active:t.need_attach_page}]),title:"Страницы"},bp,2),e("li",{class:b(["mr-1",{active:t.need_attach_slug}]),title:"Скрипты"},gp,2),e("li",{class:b(["mr-1",{active:t.need_attach_dialog}]),title:"Диалоги"},$p,2),e("li",{class:b(["mr-1",{active:t.need_rules}]),title:"Правила"},kp,2),e("li",{class:b(["mr-1",{active:t.need_reply_menu}]),title:"Нижнее меню"},wp,2),e("li",{title:"Текстовое меню",class:b({active:t.need_inline_menu})},Sp,2)])])])):r("",!0),e("div",jp,[e("div",Vp,[e("label",qp,[f(a,null,{content:g(()=>[Pp]),default:g(()=>[zp]),_:1}),m(" Команда "),Up]),c(e("input",{type:"text",class:"form-control",placeholder:"Команда","aria-label":"Команда","onUpdate:modelValue":s[1]||(s[1]=d=>t.pageForm.command=d),maxlength:"255","aria-describedby":"bot-domain",required:""},null,512),[[h,t.pageForm.command]])]),e("div",Op,[e("div",Ap,[t.pageForm.id||t.need_clean?(l(),n("button",Ip,Tp)):r("",!0),t.pageForm.id||t.need_clean?(l(),n("button",{key:1,type:"button",onClick:s[2]||(s[2]=(...d)=>t.clearForm&&t.clearForm(...d)),title:"Очистить \\ Новая страница",class:"btn btn-outline-primary min-menu-btn"},Rp)):r("",!0),Mp])])]),c(e("div",Dp,[e("div",Ep,[e("label",Lp,[e("div",null,[f(a,null,{content:g(()=>[Np]),default:g(()=>[Kp]),_:1}),m(" Текстовое содержимое страницы "),Jp]),f(kt,{param:"content",onCallback:t.injectContent},null,8,["onCallback"])]),e("div",Hp,[c(e("textarea",{class:"form-control","onUpdate:modelValue":s[3]||(s[3]=d=>t.pageForm.content=d),maxlength:"4096",placeholder:"Введите текст",id:"floatingTextarea2",style:{"min-height":"150px"}},null,512),[[h,t.pageForm.content]]),e("label",Yp,[m("Содержимое страницы "),t.pageForm.content?(l(),n("span",Gp,u(t.pageForm.content.length)+"/4096 ",1)):r("",!0)])])]),e("div",Wp,[e("ul",Xp,[e("li",{class:"nav-item",onClick:s[4]||(s[4]=d=>t.tab=0)},[e("a",{class:b([{active:t.tab===0,"primary-mark":t.need_reply_menu},"nav-link d-flex flex-column justify-content-center align-items-center font-12"]),href:"javascript:void(0)"},eb,2)]),e("li",{class:"nav-item",onClick:s[5]||(s[5]=d=>t.tab=1)},[e("a",{class:b([{active:t.tab===1,"primary-mark":t.need_inline_menu},"nav-link d-flex flex-column justify-content-center align-items-center font-12"]),href:"javascript:void(0)"},ob,2)]),e("li",{class:"nav-item",onClick:s[6]||(s[6]=d=>t.tab=2)},[e("a",{class:b([{active:t.tab===2,"primary-mark":t.need_page_images},"nav-link d-flex flex-column justify-content-center align-items-center font-12"]),href:"javascript:void(0)"},ib,2)]),e("li",{class:"nav-item",onClick:s[7]||(s[7]=d=>t.tab=3)},[e("a",{class:b([{active:t.tab===3,"primary-mark":t.need_page_video},"nav-link d-flex flex-column justify-content-center align-items-center font-12"]),href:"javascript:void(0)"},rb,2)]),e("li",{class:"nav-item",onClick:s[8]||(s[8]=d=>t.tab=4)},[e("a",{class:b([{active:t.tab===4,"primary-mark":t.need_page_sticker},"nav-link d-flex flex-column justify-content-center align-items-center font-12"]),href:"javascript:void(0)"},mb,2)]),e("li",{class:"nav-item",onClick:s[9]||(s[9]=d=>t.tab=5)},[e("a",{class:b([{active:t.tab===5,"primary-mark":t.need_page_audios},"nav-link d-flex flex-column justify-content-center align-items-center font-12"]),href:"javascript:void(0)"},pb,2)]),e("li",{class:"nav-item",onClick:s[10]||(s[10]=d=>t.tab=6)},[e("a",{class:b([{active:t.tab===6,"primary-mark":t.need_page_documents},"nav-link d-flex flex-column justify-content-center align-items-center font-12"]),href:"javascript:void(0)"},gb,2)]),e("li",{class:"nav-item",onClick:s[11]||(s[11]=d=>t.tab=7)},[e("a",{class:b([{active:t.tab===7,"primary-mark":t.need_attach_page},"nav-link d-flex flex-column justify-content-center align-items-center font-12"]),href:"javascript:void(0)"},yb,2)]),e("li",{class:"nav-item",onClick:s[12]||(s[12]=d=>t.tab=8)},[e("a",{class:b([{active:t.tab===8,"primary-mark":t.need_attach_slug},"nav-link d-flex flex-column justify-content-center align-items-center font-12"]),href:"javascript:void(0)"},wb,2)]),e("li",{class:"nav-item",onClick:s[13]||(s[13]=d=>t.tab=9)},[e("a",{class:b([{active:t.tab===9,"primary-mark":t.need_attach_dialog},"nav-link d-flex flex-column justify-content-center align-items-center font-12"]),href:"javascript:void(0)"},jb,2)]),e("li",{class:"nav-item",onClick:s[14]||(s[14]=d=>t.tab=10)},[e("a",{class:b([{active:t.tab===10,"primary-mark":t.need_rules},"nav-link d-flex flex-column justify-content-center align-items-center font-12"]),href:"javascript:void(0)"},zb,2)])])]),c(e("div",null,[t.need_reply_menu?(l(),n("div",Pb,[e("div",Ub,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[15]||(s[15]=d=>t.need_reply_menu=d),type:"checkbox",id:"need-reply-menu"},null,512),[[k,t.need_reply_menu]]),Ob])])):r("",!0),t.need_reply_menu?(l(),n("div",Ab,[e("div",Ib,[e("div",Qb,[Tb,e("button",{class:b(["btn",{"btn-outline-primary":!t.showReplyTemplateSelector,"btn-primary":t.showReplyTemplateSelector}]),type:"button",onClick:s[16]||(s[16]=d=>t.showReplyTemplateSelector=!t.showReplyTemplateSelector)},[t.showReplyTemplateSelector?(l(),n("span",Rb," Скрыть шаблоны меню")):(l(),n("span",Bb," Открыть шаблоны меню"))],2)]),e("div",Mb,[e("div",Db,[e("div",Eb,[e("label",Lb,[f(a,null,{content:g(()=>[Nb]),default:g(()=>[Kb]),_:1}),m(" Заголовок ")]),c(e("input",{type:"text",class:"form-control",placeholder:"Заголовок меню","aria-label":"Заголовок меню","onUpdate:modelValue":s[17]||(s[17]=d=>t.pageForm.reply_keyboard_title=d),maxlength:"255","aria-describedby":"bot-domain"},null,512),[[h,t.pageForm.reply_keyboard_title]])])]),t.showReplyTemplateSelector?(l(),$(T,{key:0,class:"mb-2",type:"reply",onSelect:t.selectReplyKeyboard,"select-mode":!0},null,8,["onSelect"])):(l(),$(A,{key:1,type:"reply",modelValue:t.pageForm.reply_keyboard,"onUpdate:modelValue":s[18]||(s[18]=d=>t.pageForm.reply_keyboard=d)},null,8,["modelValue"]))])])])):(l(),n("div",Jb,[e("div",Hb,[e("div",Yb,[c(e("img",Gb,null,512),[[i,"../images/icon.png"]])]),Wb,Xb,e("div",Zb,[e("button",{disabled:t.need_reply_menu,onClick:s[19]||(s[19]=d=>t.need_reply_menu=!0),class:b([{"btn-primary":!t.need_reply_menu,"btn-outline-secondary":t.need_reply_menu},"d-inline-flex align-items-center btn btn-lg px-4 rounded-pill"]),type:"button"}," Добавить ",10,xb),ef])])]))],512),[[q,t.tab===0]]),c(e("div",null,[t.need_inline_menu?(l(),n("div",tf,[e("div",sf,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[20]||(s[20]=d=>t.need_inline_menu=d),type:"checkbox",id:"need-inline-menu"},null,512),[[k,t.need_inline_menu]]),of])])):r("",!0),t.need_inline_menu?(l(),n("div",lf,[e("div",nf,[e("div",af,[df,e("button",{class:b(["btn",{"btn-outline-primary":!t.showInlineTemplateSelector,"btn-primary":t.showInlineTemplateSelector}]),type:"button",onClick:s[21]||(s[21]=d=>t.showInlineTemplateSelector=!t.showInlineTemplateSelector)},[t.showInlineTemplateSelector?(l(),n("span",cf," Скрыть шаблоны меню")):(l(),n("span",rf," Открыть шаблоны меню"))],2)]),e("div",uf,[t.showInlineTemplateSelector?(l(),$(T,{key:0,class:"mb-2",type:"inline",onSelect:t.selectInlineKeyboard,"select-mode":!0},null,8,["onSelect"])):(l(),$(A,{key:1,type:"inline",modelValue:t.pageForm.inline_keyboard,"onUpdate:modelValue":s[22]||(s[22]=d=>t.pageForm.inline_keyboard=d)},null,8,["modelValue"]))])])])):(l(),n("div",mf,[e("div",_f,[e("div",hf,[c(e("img",pf,null,512),[[i,"../images/icon.png"]])]),bf,ff,e("div",gf,[e("button",{disabled:t.need_inline_menu,onClick:s[23]||(s[23]=d=>t.need_inline_menu=!0),class:b([{"btn-primary":!t.need_inline_menu,"btn-outline-secondary":t.need_inline_menu},"d-inline-flex align-items-center btn btn-lg px-4 rounded-pill"]),type:"button"}," Добавить ",10,vf),$f])])]))],512),[[q,t.tab===1]]),c(e("div",null,[t.need_page_images?(l(),n("div",yf,[e("div",kf,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[24]||(s[24]=d=>t.need_page_images=d),type:"checkbox",id:"need-page-images"},null,512),[[k,t.need_page_images]]),Ff])])):r("",!0),t.need_page_images?(l(),n("div",wf,[e("div",Cf,[Sf,e("div",jf,[e("label",Vf,[m(" + "),e("input",{type:"file",id:"photos",multiple:"",accept:"image/*",onChange:s[25]||(s[25]=(...d)=>t.onChangePhotos&&t.onChangePhotos(...d)),style:{display:"none"}},null,32)]),e("div",qf,[t.photos.length>0?(l(),n("div",zf,[(l(!0),n(v,null,y(t.photos,(d,_)=>(l(),n("div",Pf,[c(e("img",null,null,512),[[i,t.getPhoto(d).imageUrl]]),e("div",Uf,[e("a",{onClick:p=>t.removePhoto(_)},"Удалить",8,Of)])]))),256))])):r("",!0),t.pageForm.images.length>0?(l(),n("h6",Af,"Ранее загруженные фотографии")):r("",!0),t.pageForm.images.length>0?(l(),n("div",If,[(l(!0),n(v,null,y(t.pageForm.images,(d,_)=>(l(),n("div",Qf,[c(e("img",null,null,512),[[i,"/images-by-bot-id/"+t.bot.id+"/"+d]]),e("div",Tf,[e("a",{onClick:p=>t.removeImage(_)},"Удалить",8,Bf)])]))),256))])):r("",!0)])])])])):(l(),n("div",Rf,[e("div",Mf,[e("div",Df,[c(e("img",Ef,null,512),[[i,"../images/icon.png"]])]),Lf,Kf,e("div",Nf,[e("button",{disabled:t.need_page_images,onClick:s[26]||(s[26]=d=>t.need_page_images=!0),class:b([{"btn-primary":!t.need_page_images,"btn-outline-secondary":t.need_page_images},"d-inline-flex align-items-center btn btn-lg px-4 rounded-pill"]),type:"button"}," Добавить ",10,Jf),Hf])])]))],512),[[q,t.tab===2]]),c(e("div",null,[t.need_page_video?(l(),n("div",Yf,[e("div",Gf,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[27]||(s[27]=d=>t.need_page_video=d),type:"checkbox",id:"need-page-video"},null,512),[[k,t.need_page_video]]),Wf])])):r("",!0),t.need_page_video?(l(),n("div",Xf,[f(z,{"need-video":!0,"need-video-note":!0,selected:t.pageForm.videos,onSelect:t.selectVideo},null,8,["selected","onSelect"])])):(l(),n("div",Zf,[e("div",xf,[e("div",e1,[c(e("img",t1,null,512),[[i,"../images/icon.png"]])]),s1,o1,e("div",l1,[e("button",{disabled:t.need_page_video,onClick:s[28]||(s[28]=d=>t.need_page_video=!0),class:b([{"btn-primary":!t.need_page_video,"btn-outline-secondary":t.need_page_video},"d-inline-flex align-items-center btn btn-lg px-4 rounded-pill"]),type:"button"}," Добавить ",10,n1),i1])])]))],512),[[q,t.tab===3]]),c(e("div",null,[t.need_page_sticker?(l(),n("div",a1,[e("div",d1,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[29]||(s[29]=d=>t.need_page_sticker=d),type:"checkbox",id:"need-page-sticker"},null,512),[[k,t.need_page_sticker]]),r1])])):r("",!0),t.need_page_sticker?(l(),n("div",c1,[f(z,{"need-sticker":!0,selected:[t.pageForm.sticker],onSelect:t.selectSticker},null,8,["selected","onSelect"])])):(l(),n("div",u1,[e("div",m1,[e("div",_1,[c(e("img",h1,null,512),[[i,"../images/icon.png"]])]),p1,b1,e("div",f1,[e("button",{disabled:t.need_page_sticker,onClick:s[30]||(s[30]=d=>t.need_page_sticker=!0),class:b([{"btn-primary":!t.need_page_sticker,"btn-outline-secondary":t.need_page_sticker},"d-inline-flex align-items-center btn btn-lg px-4 rounded-pill"]),type:"button"}," Добавить ",10,g1),v1])])]))],512),[[q,t.tab===4]]),c(e("div",null,[t.need_page_audios?(l(),n("div",$1,[e("div",y1,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[31]||(s[31]=d=>t.need_page_audios=d),type:"checkbox",id:"need-page-audio"},null,512),[[k,t.need_page_audios]]),k1])])):r("",!0),t.need_page_audios?(l(),n("div",F1,[f(z,{"need-audio":!0,selected:t.pageForm.audios,onSelect:t.selectAudio},null,8,["selected","onSelect"])])):(l(),n("div",w1,[e("div",C1,[e("div",S1,[c(e("img",j1,null,512),[[i,"../images/icon.png"]])]),V1,q1,e("div",z1,[e("button",{disabled:t.need_page_audios,onClick:s[32]||(s[32]=d=>t.need_page_audios=!0),class:b([{"btn-primary":!t.need_page_audios,"btn-outline-secondary":t.need_page_audios},"d-inline-flex align-items-center btn btn-lg px-4 rounded-pill"]),type:"button"}," Добавить ",10,P1),U1])])]))],512),[[q,t.tab===5]]),c(e("div",null,[t.need_page_documents?(l(),n("div",O1,[e("div",A1,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[33]||(s[33]=d=>t.need_page_documents=d),type:"checkbox",id:"need-page-document"},null,512),[[k,t.need_page_documents]]),I1])])):r("",!0),t.need_page_documents?(l(),n("div",Q1,[f(z,{"need-document":!0,selected:t.pageForm.documents,onSelect:t.selectDocument},null,8,["selected","onSelect"])])):(l(),n("div",T1,[e("div",B1,[e("div",R1,[c(e("img",M1,null,512),[[i,"../images/icon.png"]])]),D1,E1,e("div",L1,[e("button",{disabled:t.need_page_documents,onClick:s[34]||(s[34]=d=>t.need_page_documents=!0),class:b([{"btn-primary":!t.need_page_documents,"btn-outline-secondary":t.need_page_documents},"d-inline-flex align-items-center btn btn-lg px-4 rounded-pill"]),type:"button"}," Добавить ",10,K1),N1])])]))],512),[[q,t.tab===6]]),c(e("div",null,[e("div",J1,[e("div",H1,[e("div",Y1,[c(e("img",G1,null,512),[[i,"../images/icon.png"]])]),W1,X1,t.pageForm.next_page_id?(l(),n("p",Z1,"Связано со страницей #"+u(t.pageForm.next_page_id),1)):r("",!0),e("div",x1,[t.pageForm.next_page_id?(l(),n("button",{key:0,class:"d-inline-flex align-items-center btn btn-lg px-4 rounded-pill btn-danger",type:"button",onClick:s[35]||(s[35]=(...d)=>t.clearLinks&&t.clearLinks(...d))},"Очистить ")):(l(),n("button",eg," Связать ")),tg]),sg,e("div",og,[lg,ng,(l(!0),n(v,null,y(t.links,(d,_)=>(l(),n("div",ig,[e("button",{type:"button",onClick:p=>t.removeLink(_),class:b([{"btn-danger":t.chainCollapseTest(d)},"btn btn-primary position-relative rounded-5"])},[m(u(d.slug.command||"-")+" ",1),e("span",dg," #"+u(d.id),1)],10,ag),_<t.links.length-1?(l(),n("i",rg)):r("",!0)]))),256)),t.links.length>0?(l(),n("i",cg)):r("",!0),ug])])])],512),[[q,t.tab===7]]),c(e("div",null,[t.need_attach_slug?(l(),n("div",mg,[_g,e("div",hg,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[36]||(s[36]=d=>t.need_show_global_slug_list=d),type:"checkbox",id:"need-show-global-slug-list"},null,512),[[k,t.need_show_global_slug_list]]),pg]),t.bot&&t.need_show_global_slug_list?(l(),$(H,{key:0,"can-add":!0,bot:t.bot,onCallback:t.loadSlugs},null,8,["bot","onCallback"])):r("",!0)])):r("",!0),t.need_attach_slug?(l(),n("div",bg,[e("div",fg,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[37]||(s[37]=d=>t.need_attach_slug=d),type:"checkbox",id:"need-slug-attach"},null,512),[[k,t.need_attach_slug]]),gg])])):r("",!0),t.need_attach_slug?(l(),n("div",vg,[t.pageForm.next_bot_menu_slug_id?(l(),n("div",$g,[m(" Связано со скриптом #"+u(t.pageForm.next_bot_menu_slug_id)+" ",1),e("a",{class:"btn btn-link text-danger",onClick:s[38]||(s[38]=d=>t.pageForm.next_bot_menu_slug_id=null)},"Очистить")])):r("",!0),t.bot&&t.load_slug_simple_list?(l(),$(si,{key:1,global:!0,"can-select":!0,selected:[t.pageForm.next_bot_menu_slug_id],onCallback:t.associateSlug,bot:t.bot},null,8,["selected","onCallback","bot"])):r("",!0)])):(l(),n("div",yg,[e("div",kg,[e("div",Fg,[c(e("img",wg,null,512),[[i,"../images/icon.png"]])]),Cg,Sg,e("div",jg,[e("button",{disabled:t.need_attach_slug,onClick:s[39]||(s[39]=d=>t.need_attach_slug=!0),class:b([{"btn-primary":!t.need_attach_slug,"btn-outline-secondary":t.need_attach_slug},"d-inline-flex align-items-center btn btn-lg px-4 rounded-pill"]),type:"button"}," Добавить ",10,Vg),qg])])]))],512),[[q,t.tab===8]]),c(e("div",null,[t.need_attach_dialog?(l(),n("div",zg,[e("div",Pg,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[40]||(s[40]=d=>t.need_attach_dialog=d),type:"checkbox",id:"need-dialog-attach"},null,512),[[k,t.need_attach_dialog]]),Ug])])):r("",!0),t.need_attach_dialog?(l(),n("div",Og,[t.pageForm.next_bot_dialog_command_id?(l(),n("p",Ag,[m("Связано с диалогом #"+u(t.pageForm.next_bot_dialog_command_id)+" ",1),e("a",{class:"btn btn-link",onClick:s[41]||(s[41]=d=>t.pageForm.next_bot_dialog_command_id=null)},"Очистить")])):r("",!0),t.bot?(l(),$(re,{key:1,onSelectDialog:t.associateDialog,bot:t.bot},null,8,["onSelectDialog","bot"])):r("",!0)])):(l(),n("div",Ig,[e("div",Qg,[e("div",Tg,[c(e("img",Bg,null,512),[[i,"../images/icon.png"]])]),Rg,Mg,e("div",Dg,[e("button",{disabled:t.need_attach_dialog,onClick:s[42]||(s[42]=d=>t.need_attach_dialog=!0),class:b([{"btn-primary":!t.need_attach_dialog,"btn-outline-secondary":t.need_attach_dialog},"d-inline-flex align-items-center btn btn-lg px-4 rounded-pill"]),type:"button"}," Добавить ",10,Eg),Lg])])]))],512),[[q,t.tab===9]]),c(e("div",null,[t.need_rules?(l(),n("div",Kg,[e("div",Ng,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[43]||(s[43]=d=>t.need_rules=d),type:"checkbox",id:"need-rules"},null,512),[[k,t.need_rules]]),Jg])])):r("",!0),t.need_rules?(l(),n("div",Hg,[f(Ph,{bot:t.bot,"rules-form":t.pageForm},null,8,["bot","rules-form"])])):(l(),n("div",Yg,[e("div",Gg,[e("div",Wg,[c(e("img",Xg,null,512),[[i,"../images/icon.png"]])]),Zg,xg,e("div",ev,[e("button",{disabled:t.need_rules,onClick:s[44]||(s[44]=d=>t.need_rules=!0),class:b([{"btn-primary":!t.need_rules,"btn-outline-secondary":t.need_rules},"d-inline-flex align-items-center btn btn-lg px-4 rounded-pill"]),type:"button"}," Добавить ",10,tv),sv])])]))],512),[[q,t.tab===10]])],512),[[q,!t.pageForm.is_external]])],32)):r("",!0),ov,e("div",lv,[e("div",nv,[e("div",iv,[av,e("div",dv,[t.bot?(l(),n("div",rv,[e("div",cv,[e("h6",uv,[e("span",null,[m("Вы создаете страницу для "),e("a",{href:"https://t.me/"+t.bot.bot_domain,target:"_blank"},u(t.bot.bot_domain),9,mv)])])])])):r("",!0),e("form",{onSubmit:s[52]||(s[52]=S((...d)=>t.submitPage&&t.submitPage(...d),["prevent"])),class:"row"},[e("div",_v,[hv,e("ul",pv,[e("li",{class:b({active:t.need_page_images})},fv,2),e("li",{class:b({active:t.need_page_sticker})},vv,2),e("li",{class:b({active:t.need_page_video})},yv,2),e("li",{class:b({active:t.need_page_audios})},Fv,2),e("li",{class:b({active:t.need_page_documents})},Cv,2),e("li",{class:b({active:t.need_attach_page})},jv,2),e("li",{class:b({active:t.need_attach_slug})},qv,2),e("li",{class:b({active:t.need_attach_dialog})},Pv,2),e("li",{class:b({active:t.need_rules})},Ov,2),e("li",{class:b({active:t.need_reply_menu})},Iv,2),e("li",{class:b({active:t.need_inline_menu})},Tv,2)])]),t.pageForm.id?(l(),n("div",Bv,[e("div",Rv,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[46]||(s[46]=d=>t.need_show_qr_and_link=d),type:"checkbox",id:"need-show-qr-and-link"},null,512),[[k,t.need_show_qr_and_link]]),Mv])])):r("",!0),t.pageForm.id&&t.need_show_qr_and_link?(l(),n("div",Dv,[e("p",null,[m("Ссылка на текущую страницу: "),e("span",{class:"bg-secondary font-bold cursor-pointer",onClick:s[47]||(s[47]=d=>t.copyToClipBoard(t.pageLink))},u(t.pageLink),1)]),e("div",Ev,[c(e("img",Lv,null,512),[[i,t.qr]])])])):r("",!0),e("div",Kv,[e("label",Nv,[f(a,null,{content:g(()=>[Hv]),default:g(()=>[Jv]),_:1}),m(" Описание страницы "),Yv]),c(e("textarea",{type:"text",class:"form-control",placeholder:"Описание страницы","aria-label":"Описание страницы","onUpdate:modelValue":s[48]||(s[48]=d=>t.pageForm.comment=d),maxlength:"255","aria-describedby":"bot-domain",required:""},`
            `,512),[[h,t.pageForm.comment]])]),e("div",Gv,[e("div",Wv,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[49]||(s[49]=d=>t.pageForm.is_external=d),type:"checkbox",id:"is-external"},null,512),[[k,t.pageForm.is_external]]),Xv]),t.pageForm.is_external?(l(),n("div",Zv,[m(" Обработка ссылок передана на внешний адрес, указанный в настройках бота! Все запросы по данной кнопке будут отправлены на указанный URL-адрес: "),e("strong",null,u(t.bot.callback_link||"не указано")+".",1),t.bot.callback_link?r("",!0):(l(),n("p",xv,[m("Внешня ссылка не установлена! Перейдите в раздел "),e$,m(", затем "),t$,m(" и установите ссылку для внешнего управления в поле "),s$,m("!")]))])):r("",!0)]),e("div",o$,[e("div",l$,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[50]||(s[50]=d=>t.pageForm.need_log_user_action=d),type:"checkbox",id:"need_log_user_action"},null,512),[[k,t.pageForm.need_log_user_action]]),n$])]),e("div",i$,[e("div",a$,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[51]||(s[51]=d=>t.need_stay_after_save=d),type:"checkbox",id:"need-stay-after-save"},null,512),[[k,t.need_stay_after_save]]),d$])]),r$],32)]),c$])])]),e("div",u$,[e("div",m$,[e("div",_$,[e("div",h$,[f(B,{current:t.pageForm.id,selected:t.selectedLinkIds,onCallback:t.attachPage,editor:!1},null,8,["current","selected","onCallback"])])])])]),e("div",p$,[e("div",b$,[e("div",f$,[e("div",g$,[t.page?(l(),$(Gh,{key:0,page:t.page},null,8,["page"])):(l(),n("p",v$,"Сперва сохраните страницу"))])])])]),m(" - "),e("div",$$,[y$,e("div",k$,[e("div",F$,[e("div",w$,[t.loaded_page_list?(l(),$(B,{key:0,editor:!0,current:t.page,onCallback:t.pageListCallback},null,8,["current","onCallback"])):r("",!0)])])])])],64)}}}),j$={props:["bot","item"],data(){return{sectionForm:{section:null},categoryForm:{label:null},tab:0,types:[{title:"Готовый продукт",value:1},{title:"Товар на вес",value:2},{title:"Конструктор товара",value:3}],productCategories:[],sections:["Общие характеристики","Дополнительная информация"],photos:[],categories:[],removed_options:[],productForm:{article:null,vk_product_id:null,frontpad_article:null,iiko_article:null,title:null,description:null,images:[],type:1,old_price:null,current_price:null,variants:[],in_stop_list_at:null,bot_id:null,options:[],reviews:[],categories:[]}}},computed:{...C(["getProductCategories"]),filteredCategories(){return this.productCategories.length===0?this.categories:this.categories.filter(o=>this.productCategories.indexOf(o.value)===-1)}},mounted(){this.loadProductCategories(),this.item&&this.$nextTick(()=>{this.productForm={id:this.item.id||null,article:this.item.article||null,vk_product_id:this.item.vk_product_id||null,frontpad_article:this.item.frontpad_article||null,iiko_article:this.item.iiko_article||null,title:this.item.title||null,description:this.item.description||null,images:this.item.images||null,type:this.item.type||1,old_price:this.item.old_price||null,current_price:this.item.current_price||null,variants:this.item.variants||null,in_stop_list_at:this.item.in_stop_list_at||null,bot_id:this.item.bot_id||null,options:this.item.options||null,reviews:this.item.reviews||null},this.options=[],this.item.categories.forEach(o=>{this.productCategories.push(o.id)})})},methods:{prepareCategoryName(o){let t=this.categories.find(s=>s.value===o);return console.log(t),t?t.label:o},addCategory(){const o=this.categoryForm.label;this.productCategories.push(o),this.categoryForm.label=null},selectCategory(o){this.productCategories.push(o.value)},submit(){let o=new FormData;if(Object.keys(this.productForm).forEach(t=>{const s=this.productForm[t]||"";typeof s=="object"?o.append(t,JSON.stringify(s)):o.append(t,s)}),this.bot&&o.append("bot_id",this.bot.id),this.photos.length>0)for(let t=0;t<this.photos.length;t++)o.append("photos[]",this.photos[t]);this.removed_options.length>0&&o.append("removed_options",JSON.stringify(this.removed_options)),this.productCategories.length>0&&o.append("categories",JSON.stringify(this.productCategories)),this.$store.dispatch("saveProduct",{productForm:o}).then(t=>{this.load=!0,this.$notify({title:"Конструктор ботов",text:"Продукт успешно сохранен!",type:"success"}),this.clearForm(),this.$emit("refresh")}).catch(t=>{})},onChangePhotos(o){const t=o.target.files;for(let s=0;s<t.length;s++)this.photos.push(t[s])},loadProductCategories(){this.$store.dispatch("loadProductCategories",{dataObject:{bot_id:this.bot.id}}).then(()=>{this.getProductCategories.forEach(t=>{this.categories.push({value:t.id,label:t.title})})})},getPhoto(o){return{imageUrl:URL.createObjectURL(o)}},removeSection(o){this.sections.splice(o,1)},addSection(){this.sections.push(this.sectionForm.section),this.sectionForm.section=null},addOption(){this.productForm.options||(this.productForm.options=[]),this.productForm.options.push({id:null,key:null,value:null,title:null,section:null})},addVariant(){this.productForm.variants||(this.productForm.variants=[]),this.productForm.variants.push({key:null,value:null})},removeProductCategory(o){this.productCategories.splice(o,1)},removeVariant(o){this.productForm.variants.splice(o,1)},removeOption(o){this.productForm.options[o].id&&this.removed_options.push(this.productForm.options[o].id),this.productForm.options.splice(o,1)},removeImage(o){this.productForm.images.splice(o,1)},removePhoto(o){this.photos.splice(o,1)},clearForm(){const o={article:null,vk_product_id:null,title:null,description:null,images:[],type:1,old_price:null,current_price:null,variants:[],in_stop_list_at:null,bot_id:null,options:[],reviews:[],categories:[]};this.photos=[],this.removed_options=[],this.productCategories=[],this.productForm=o}}},V$={class:"nav nav-tabs"},q$={class:"nav-item"},z$={class:"nav-item"},P$={class:"nav-item"},U$={key:0},O$=e("div",{class:"col-12"},[e("button",{type:"submit",class:"btn btn-outline-primary"},[e("i",{class:"fa-regular fa-floppy-disk mr-2"}),m(" Сохранить товар ")])],-1),A$={class:"col-md-8 d-flex align-items-center"},I$={class:"form-check"},Q$=e("label",{class:"form-check-label",for:"in-stop-list"}," Товар находится в стоп-листе ",-1),T$={class:"col-md-4 d-flex justify-content-end"},B$={class:"col-md-12 mb-3"},R$=["onClick"],M$={class:"dropdown"},D$=e("button",{type:"button",class:"btn btn-outline-info w-100","data-bs-toggle":"dropdown","data-bs-display":"static","aria-expanded":"false"},[e("p",{class:"mb-0"},"Выберите категорию")],-1),E$={class:"dropdown-menu w-100",style:{"overflow-y":"scroll",height:"300px"}},L$={class:"p-3"},K$=e("label",{for:"exampleDropdownFormEmail1",class:"form-label"},"Новая категория",-1),N$={class:"p-3"},J$=e("li",null,[e("hr",{class:"dropdown-divider"})],-1),H$=["onClick"],Y$={class:"col-md-6"},G$={class:"form-floating mb-3"},W$=e("label",{for:"article"},"Артикул товара",-1),X$={class:"col-md-6"},Z$={class:"form-floating mb-3"},x$=e("label",{for:"article"},"Артикул товара FrontPad",-1),ey={class:"col-md-6"},ty={class:"form-floating mb-3"},sy=e("label",{for:"article"},"Артикул товара в IIKO",-1),oy={class:"col-md-6"},ly={class:"form-floating mb-3"},ny=e("label",{for:"vk-product-id"},"Идентификатор товара VK",-1),iy={class:"col-md-6"},ay={class:"form-floating mb-3"},dy=e("label",{for:"title"},"Названи товара",-1),ry={class:"col-md-6"},cy={class:"form-floating mb-3"},uy=["value"],my=e("label",{for:"type"},"Тип товара",-1),_y={class:"col-md-12"},hy={class:"form-floating mb-3"},py=e("label",{for:"description"},"Описание товара",-1),by={class:"col-md-6"},fy={class:"form-floating mb-3"},gy=e("label",{for:"current-price"},"Актуальная цена",-1),vy={class:"col-md-6"},$y={class:"form-floating mb-3"},yy=e("label",{for:"old-price"},"Старая цена",-1),ky={class:"col-md-12 mb-3"},Fy={class:"card"},wy={class:"card-header"},Cy={key:0},Sy={class:"card-body"},jy={class:"row"},Vy={class:"col-12 mb-3"},qy={class:"col-md-6 mb-3"},zy={class:"card w-100"},Py={class:"card-body"},Uy={class:"form-floating mb-3"},Oy=["onUpdate:modelValue","id"],Ay=["for"],Iy={class:"form-floating mb-3"},Qy=["onUpdate:modelValue","id"],Ty=["for"],By={class:"card-footer"},Ry=["onClick"],My=e("i",{class:"fa-solid fa-trash-can"},null,-1),Dy=[My],Ey={class:"col-md-12 mb-3"},Ly={class:"card"},Ky=e("div",{class:"card-header"},[e("h6",null,"Характеристики товара")],-1),Ny={class:"card-body"},Jy={class:"row mb-3"},Hy={class:"col-12"},Yy=e("button",{class:"btn btn-outline-info",type:"submit",id:"button-addon2"},"Добавить секцию ",-1),Gy={class:"badge bg-info mr-1"},Wy=["onClick"],Xy=e("i",{class:"fa-solid fa-xmark"},null,-1),Zy=[Xy],xy={class:"row"},e2={class:"col-md-4 mb-3"},t2={class:"card w-100"},s2={class:"card-body"},o2={class:"form-floating mb-3"},l2=["onUpdate:modelValue","id"],n2=["for"],i2={class:"form-floating mb-3"},a2=["onUpdate:modelValue","id"],d2=["for"],r2={class:"form-floating mb-3"},c2=["onUpdate:modelValue","id"],u2=e("option",{value:null},"Без секции",-1),m2=["value"],_2=["for"],h2={class:"card-footer"},p2=["onClick"],b2=e("i",{class:"fa-solid fa-trash-can"},null,-1),f2=[b2],g2={class:"row"},v2={class:"col-12"},$2={class:"col-md-12 mb-3"},y2=e("h6",null,"Фотографии товара",-1),k2={class:"photo-preview d-flex justify-content-start flex-wrap w-100"},F2={for:"location-photos",style:{"margin-right":"10px"},class:"photo-loader ml-2"},w2=e("span",null,"+",-1),C2={class:"mb-2 img-preview",style:{"margin-right":"10px"}},S2={class:"remove"},j2=["onClick"],V2={class:"mb-2 img-preview",style:{"margin-right":"10px"}},q2={class:"remove"},z2=["onClick"],P2={key:1};function U2(o,t,s,a,i,d){const _=I("lazy");return l(),n(v,null,[e("ul",V$,[e("li",q$,[e("a",{class:b(["nav-link",{active:i.tab===0}]),onClick:t[0]||(t[0]=p=>i.tab=0),"aria-current":"page",href:"#product-form-info"},"Информация о товаре",2)]),e("li",z$,[e("a",{class:b(["nav-link",{active:i.tab===1}]),onClick:t[1]||(t[1]=p=>i.tab=1),href:"#product-reviews"},"Комментарии",2)]),e("li",P$,[e("a",{class:b(["nav-link",{active:i.tab===2}]),onClick:t[2]||(t[2]=p=>i.tab=2),href:"#product-reviews"},"Заказы",2)])]),i.tab===0?(l(),n("div",U$,[e("form",{onSubmit:t[21]||(t[21]=S((...p)=>d.submit&&d.submit(...p),["prevent"])),class:"row py-2"},[O$,e("div",A$,[e("div",I$,[c(e("input",{class:"form-check-input","onUpdate:modelValue":t[3]||(t[3]=p=>i.productForm.in_stop_list_at=p),type:"checkbox",value:"false",id:"in-stop-list"},null,512),[[k,i.productForm.in_stop_list_at]]),Q$])]),e("div",T$,[e("a",{href:"#",class:"btn btn-link",onClick:t[4]||(t[4]=(...p)=>d.clearForm&&d.clearForm(...p))},"Новый товар")]),e("div",B$,[(l(!0),n(v,null,y(i.productCategories,(p,F)=>(l(),n("span",{class:"badge bg-info mr-1 mb-1 cursor-pointer",onClick:w=>d.removeProductCategory(F)},u(d.prepareCategoryName(p)),9,R$))),256)),e("div",M$,[D$,e("ul",E$,[e("div",L$,[K$,c(e("input",{type:"text",class:"form-control","onUpdate:modelValue":t[5]||(t[5]=p=>i.categoryForm.label=p),id:"exampleDropdownFormEmail1",placeholder:"Название категории"},null,512),[[h,i.categoryForm.label]])]),e("div",N$,[e("button",{class:"btn btn-primary w-100",type:"button",onClick:t[6]||(t[6]=(...p)=>d.addCategory&&d.addCategory(...p))},"Добавить категорию ")]),J$,(l(!0),n(v,null,y(d.filteredCategories,p=>(l(),n("li",null,[e("button",{class:"dropdown-item",type:"button",onClick:F=>d.selectCategory(p)},u(p.label),9,H$)]))),256))])])]),e("div",Y$,[e("div",G$,[c(e("input",{type:"text","onUpdate:modelValue":t[7]||(t[7]=p=>i.productForm.article=p),class:"form-control",id:"article",placeholder:"name@example.com"},null,512),[[h,i.productForm.article]]),W$])]),e("div",X$,[e("div",Z$,[c(e("input",{type:"text","onUpdate:modelValue":t[8]||(t[8]=p=>i.productForm.frontpad_article=p),class:"form-control",id:"article",placeholder:"name@example.com"},null,512),[[h,i.productForm.frontpad_article]]),x$])]),e("div",ey,[e("div",ty,[c(e("input",{type:"text","onUpdate:modelValue":t[9]||(t[9]=p=>i.productForm.iiko_article=p),class:"form-control",id:"article",placeholder:"name@example.com"},null,512),[[h,i.productForm.iiko_article]]),sy])]),e("div",oy,[e("div",ly,[c(e("input",{type:"text","onUpdate:modelValue":t[10]||(t[10]=p=>i.productForm.vk_product_id=p),disabled:!0,class:"form-control",id:"vk-product-id",placeholder:"name@example.com"},null,512),[[h,i.productForm.vk_product_id]]),ny])]),e("div",iy,[e("div",ay,[c(e("input",{type:"text","onUpdate:modelValue":t[11]||(t[11]=p=>i.productForm.title=p),class:"form-control",id:"title",placeholder:"name@example.com"},null,512),[[h,i.productForm.title]]),dy])]),e("div",ry,[e("div",cy,[c(e("select",{class:"form-select","onUpdate:modelValue":t[12]||(t[12]=p=>i.productForm.type=p),id:"type","aria-label":"Floating label select example"},[(l(!0),n(v,null,y(i.types,(p,F)=>(l(),n("option",{value:p.value},u(p.title),9,uy))),256))],512),[[Q,i.productForm.type]]),my])]),e("div",_y,[e("div",hy,[c(e("textarea",{class:"form-control","onUpdate:modelValue":t[13]||(t[13]=p=>i.productForm.description=p),placeholder:"Leave a comment here",id:"description"},null,512),[[h,i.productForm.description]]),py])]),e("div",by,[e("div",fy,[c(e("input",{type:"number","onUpdate:modelValue":t[14]||(t[14]=p=>i.productForm.current_price=p),class:"form-control",id:"current-price",placeholder:"name@example.com"},null,512),[[h,i.productForm.current_price]]),gy])]),e("div",vy,[e("div",$y,[c(e("input",{type:"number","onUpdate:modelValue":t[15]||(t[15]=p=>i.productForm.old_price=p),class:"form-control",id:"old-price",placeholder:"name@example.com"},null,512),[[h,i.productForm.old_price]]),yy])]),e("div",ky,[e("div",Fy,[e("div",wy,[e("h6",null,[m("Варианты товара "),i.productForm.variants?(l(),n("span",Cy,"("+u(i.productForm.variants.length)+")",1)):r("",!0)])]),e("div",Sy,[e("div",jy,[e("div",Vy,[e("button",{type:"button",class:"btn btn-outline-info w-100",onClick:t[16]||(t[16]=(...p)=>d.addVariant&&d.addVariant(...p))},"Добавить вариант ")]),(l(!0),n(v,null,y(i.productForm.variants,(p,F)=>(l(),n("div",qy,[e("div",zy,[e("div",Py,[e("div",Uy,[c(e("input",{type:"text","onUpdate:modelValue":w=>i.productForm.variants[F].key=w,class:"form-control",id:"variant-key-"+F,placeholder:"name@example.com",required:""},null,8,Oy),[[h,i.productForm.variants[F].key]]),e("label",{for:"variant-key-"+F},"Ключ",8,Ay)]),e("div",Iy,[c(e("input",{type:"text","onUpdate:modelValue":w=>i.productForm.variants[F].value=w,class:"form-control",id:"variant-value-"+F,placeholder:"name@example.com",required:""},null,8,Qy),[[h,i.productForm.variants[F].value]]),e("label",{for:"variant-value-"+F},"Значение",8,Ty)])]),e("div",By,[e("button",{type:"button",class:"btn btn-outline-danger",onClick:w=>d.removeVariant(F)},Dy,8,Ry)])])]))),256))])])])]),e("div",Ey,[e("div",Ly,[Ky,e("div",Ny,[e("div",Jy,[e("div",Hy,[e("form",{onSubmit:t[18]||(t[18]=S((...p)=>d.addSection&&d.addSection(...p),["prevent"])),class:"input-group mb-3"},[c(e("input",{type:"text","onUpdate:modelValue":t[17]||(t[17]=p=>i.sectionForm.section=p),class:"form-control border-info",placeholder:"Название секции","aria-label":"Recipient's username","aria-describedby":"button-addon2",required:""},null,512),[[h,i.sectionForm.section]]),Yy],32),(l(!0),n(v,null,y(i.sections,(p,F)=>(l(),n("span",Gy,[m(u(p)+" ",1),e("strong",{onClick:w=>d.removeSection(F)},Zy,8,Wy)]))),256))])]),e("div",xy,[(l(!0),n(v,null,y(i.productForm.options,(p,F)=>(l(),n("div",e2,[e("div",t2,[e("div",s2,[e("div",o2,[c(e("input",{type:"text","onUpdate:modelValue":w=>i.productForm.options[F].title=w,class:"form-control",id:"option-title-"+F,placeholder:"name@example.com"},null,8,l2),[[h,i.productForm.options[F].title]]),e("label",{for:"option-title-"+F},"Название характеристики",8,n2)]),e("div",i2,[c(e("input",{type:"text","onUpdate:modelValue":w=>i.productForm.options[F].value=w,class:"form-control",id:"option-value-"+F,placeholder:"name@example.com"},null,8,a2),[[h,i.productForm.options[F].value]]),e("label",{for:"option-value-"+F},"Значение характеристики",8,d2)]),e("div",r2,[c(e("select",{class:"form-select","onUpdate:modelValue":w=>i.productForm.options[F].section=w,id:"option-section-"+F,"aria-label":"Floating label select example"},[u2,(l(!0),n(v,null,y(i.sections,w=>(l(),n("option",{value:w},u(w),9,m2))),256))],8,c2),[[Q,i.productForm.options[F].section]]),e("label",{for:"option-section-"+F},"Секция товара",8,_2)])]),e("div",h2,[e("button",{type:"button",class:"btn btn-outline-danger",onClick:w=>d.removeOption(F)},f2,8,p2)])])]))),256))]),e("div",g2,[e("div",v2,[e("button",{type:"button",class:"btn btn-outline-info w-100",onClick:t[19]||(t[19]=(...p)=>d.addOption&&d.addOption(...p))},"Добавить характеристику ")])])])])]),e("div",$2,[y2,e("div",k2,[e("label",F2,[w2,e("input",{type:"file",id:"location-photos",multiple:"",accept:"image/*",onChange:t[20]||(t[20]=(...p)=>d.onChangePhotos&&d.onChangePhotos(...p)),style:{display:"none"}},null,32)]),i.productForm.images?(l(!0),n(v,{key:0},y(i.productForm.images,(p,F)=>(l(),n("div",C2,[c(e("img",null,null,512),[[_,p]]),e("div",S2,[e("a",{onClick:w=>d.removeImage(F)},"Удалить",8,j2)])]))),256)):r("",!0),i.photos.length>0?(l(!0),n(v,{key:1},y(i.photos,(p,F)=>(l(),n("div",V2,[c(e("img",null,null,512),[[_,d.getPhoto(p).imageUrl]]),e("div",q2,[e("a",{onClick:w=>d.removePhoto(F)},"Удалить",8,z2)])]))),256)):r("",!0)])])],32)])):r("",!0),i.tab===1?(l(),n("div",P2," Отзывы ")):r("",!0)],64)}const ce=U(j$,[["render",U2]]);({...C(["getCurrentBot"])});const O2=e("button",{class:"btn btn-outline-info",type:"submit",id:"button-addon2"}," Найти ",-1),A2={key:0},I2={class:"row"},Q2={class:"col-12"},T2={class:"table"},B2=e("thead",null,[e("tr",null,[e("th",{scope:"col"}),e("th",{scope:"col"},"#"),e("th",{scope:"col"},"Название"),e("th",{scope:"col"},"Картинка"),e("th",{scope:"col"},"Действия")])],-1),R2=["onClick"],M2=e("i",{class:"fa-solid fa-toggle-off cursor-pointer text-secondary"},null,-1),D2=[M2],E2=["onClick"],L2=e("i",{class:"fa-solid fa-toggle-on cursor-pointer text-primary"},null,-1),K2=[L2],N2={scope:"row"},J2=["onClick"],H2=["src"],Y2={key:1},G2={class:"d-flex"},W2=e("i",{class:"fa-regular fa-copy"},null,-1),X2=[W2],Z2=e("i",{class:"fa-solid fa-trash-can"},null,-1),x2=[Z2],ek={key:0},tk={colspan:"5"},sk={props:["bot"],data(){return{search:null,products:[],paginate:null}},computed:{...C(["getProducts","getProductsPaginateObject"]),filteredProducts(){return this.search?this.products.filter(o=>o.title.toLowerCase().trim().indexOf(this.search.toLowerCase().trim())>=0):this.products}},mounted(){this.loadProducts()},methods:{refresh(){this.products.forEach(o=>{o.in_edit_mode=!1})},toggleEditProduct(o){console.log("product0",o),o.in_edit_mode=!o.in_edit_mode},selectProduct(o){this.$emit("select",o)},nextProducts(o){this.loadProducts(o)},preparedImgUrl(o){return o.toLocaleLowerCase().startsWith("https://")||o.toLocaleLowerCase().startsWith("http://")?o:"/images-by-bot-id/"+this.bot.id+"/"+o},removeProduct(o){this.$store.dispatch("removeProduct",o.id).then(t=>{this.$notify({title:"Конструктор ботов",text:"Продукт успешно удален!",type:"success"})}).catch(t=>{})},duplicateProduct(o){this.$store.dispatch("duplicateProduct",o.id).then(t=>{this.$notify({title:"Конструктор ботов",text:"Продукт успешно продублирован!",type:"success"})}).catch(t=>{})},loadProducts(o=0){return this.$store.dispatch("loadProducts",{dataObject:{bot_id:this.bot.id,search:this.search},page:o}).then(()=>{this.products=this.getProducts,this.paginate=this.getProductsPaginateObject})}}},ok=Object.assign(sk,{__name:"ProductTableList",setup(o){return(t,s)=>(l(),n(v,null,[e("form",{class:"input-group mb-3",onSubmit:s[1]||(s[1]=S(a=>t.loadProducts(0),["prevent"]))},[c(e("input",{type:"text",class:"form-control border-info",placeholder:"Поиск товара","aria-label":"Поиск товара","onUpdate:modelValue":s[0]||(s[0]=a=>t.search=a),"aria-describedby":"button-addon2",required:""},null,512),[[h,t.search]]),O2],32),e("p",null,[m("Всего товаров: "),t.paginate?(l(),n("span",A2,u(t.paginate.meta.total||0),1)):r("",!0)]),e("div",I2,[e("div",Q2,[e("table",T2,[B2,e("tbody",null,[(l(!0),n(v,null,y(t.filteredProducts,(a,i)=>(l(),n(v,null,[e("tr",null,[e("td",null,[a.in_edit_mode?(l(),n("span",{key:1,onClick:d=>t.toggleEditProduct(a)},K2,8,E2)):(l(),n("span",{key:0,onClick:d=>t.toggleEditProduct(a)},D2,8,R2))]),e("th",N2,u(a.id),1),e("td",null,[e("a",{href:"javascript:void(0)",onClick:d=>t.selectProduct(a)},u(a.title),9,J2)]),e("td",null,[(a.images||[]).length>0?(l(),n("img",{key:0,src:t.preparedImgUrl(a.images[0]),style:{width:"100px",height:"100px","object-fit":"cover"},class:"d-block",alt:"..."},null,8,H2)):(l(),n("p",Y2,"Не добавлено"))]),e("td",null,[e("div",G2,[e("button",{title:"Дублировать товар",onClick:s[2]||(s[2]=(...d)=>t.duplicateProduct&&t.duplicateProduct(...d)),class:"btn btn-outline-info mr-1"},X2),e("button",{title:"Удалить товар",onClick:s[3]||(s[3]=(...d)=>t.removeProduct&&t.removeProduct(...d)),class:"btn btn-outline-danger"},x2)])])]),a.in_edit_mode?(l(),n("tr",ek,[e("td",tk,[f(ce,{bot:o.bot,item:a,onRefresh:t.refresh},null,8,["bot","item","onRefresh"])])])):r("",!0)],64))),256))])])])]),t.paginate?(l(),$(j,{key:0,onPagination_page:t.nextProducts,pagination:t.paginate},null,8,["onPagination_page","pagination"])):r("",!0)],64))}}),lk=e("button",{class:"btn btn-outline-info",type:"submit",id:"button-addon2"}," Найти ",-1),nk={key:0},ik={class:"row"},ak={class:"col-12"},dk={class:"table"},rk=e("thead",null,[e("tr",null,[e("th",{scope:"col"},"#"),e("th",{scope:"col"},"Название"),e("th",{scope:"col"},"Состояние"),e("th",{scope:"col"},"Позиция в выдаче"),e("th",{scope:"col"},"Действия")])],-1),ck={scope:"row"},uk=["onClick"],mk=["onClick"],_k={key:0},hk={key:1},pk=["onChange","onUpdate:modelValue"],bk=["onClick"],fk=e("i",{class:"fa-solid fa-trash-can"},null,-1),gk=[fk],vk={props:["bot"],data(){return{search:null,categories:[],paginate:null}},computed:{...C(["getProductCategories","getProductCategoriesPaginateObject"]),filteredProductCategories(){return this.search?this.categories.filter(o=>o.title.toLowerCase().trim().indexOf(this.search.toLowerCase().trim())>=0):this.categories}},mounted(){this.loadProductCategories()},methods:{updateCategory(o){console.log("update",o),this.$store.dispatch("storeProductCategory",{category:o,bot_id:this.bot.id}).then(t=>{this.$notify({title:"Конструктор ботов",text:"Данные сохранены!",type:"success"})}).catch(t=>{this.$notify({title:"Конструктор ботов",text:"Ошибка сохранения данных!",type:"error"})})},changeCategoryStatus(o){let t=this.categories.findIndex(s=>o.id===s.id);t!==-1&&(this.categories[t].is_active=!this.categories[t].is_active,this.$store.dispatch("changeProductCategoryStatus",o.id).then(s=>{this.$notify({title:"Конструктор ботов",text:"Статус категории успешно изменен!",type:"success"})}).catch(s=>{}))},selectProductCategory(o){this.$emit("select",o)},nextProductCategories(o){this.loadProductCategories(o)},removeProductCategory(o){this.$store.dispatch("removeProductCategory",o.id).then(t=>{this.$notify({title:"Конструктор ботов",text:"Продукт успешно удален!",type:"success"})}).catch(t=>{})},loadProductCategories(o=0){return this.$store.dispatch("loadProductCategories",{dataObject:{bot_id:this.bot.id,search:this.search},page:o}).then(()=>{this.categories=this.getProductCategories,this.paginate=this.getProductCategoriesPaginateObject})}}},$k=Object.assign(vk,{__name:"ProductCategoryTableList",setup(o){return(t,s)=>(l(),n(v,null,[e("form",{class:"input-group mb-3",onSubmit:s[1]||(s[1]=S(a=>t.loadProductCategories(0),["prevent"]))},[c(e("input",{type:"text",class:"form-control border-info",placeholder:"Поиск категории товара","aria-label":"Поиск категории товара","onUpdate:modelValue":s[0]||(s[0]=a=>t.search=a),"aria-describedby":"button-addon2",required:""},null,512),[[h,t.search]]),lk],32),e("p",null,[m("Всего категорий: "),t.paginate?(l(),n("span",nk,u(t.paginate.meta.total||0),1)):r("",!0)]),e("div",ik,[e("div",ak,[e("table",dk,[rk,e("tbody",null,[(l(!0),n(v,null,y(t.filteredProductCategories,(a,i)=>(l(),n("tr",null,[e("th",ck,u(a.id),1),e("td",null,[e("a",{href:"javascript:void(0)",onClick:d=>t.selectProductCategory(a),"data-bs-toggle":"modal","data-bs-target":"#product-form-edit"},null,8,uk),m(u(a.title),1)]),e("td",null,[e("button",{type:"button",onClick:d=>t.changeCategoryStatus(a),class:"btn btn-outline-success"},[a.is_active?(l(),n("span",_k,"Активная")):(l(),n("span",hk,"Не активная"))],8,mk)]),e("td",null,[c(e("input",{type:"number",onChange:d=>t.updateCategory(a),"onUpdate:modelValue":d=>a.order_position=d,class:"form-control"},null,40,pk),[[h,a.order_position]])]),e("td",null,[e("button",{title:"Удалить товар",onClick:d=>t.removeProductCategory(a),class:"btn btn-outline-danger"},gk,8,bk)])]))),256))])])])]),t.paginate?(l(),$(j,{key:0,onPagination_page:t.nextProductCategories,pagination:t.paginate},null,8,["onPagination_page","pagination"])):r("",!0)],64))}}),yk={class:"nav nav-tabs my-3"},kk={class:"nav-item"},Fk={class:"nav-item"},wk={class:"nav-item"},Ck={class:"nav-item"},Sk={key:0},jk={class:"card mb-2"},Vk=e("div",{class:"card-header"},[e("h6",null,"Управление магазином")],-1),qk={class:"card-body"},zk={class:"row"},Pk={class:"col-12"},Uk={class:"form-label d-flex justify-content-between mt-2",id:"bot-level-3"},Ok=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),Ak=e("div",null,"Ссылка на страницу ВК с товарами для вашего магазина в боте ",-1),Ik=e("a",{href:"https://vk.com/groups?w=groups_create",target:"_blank"},"Создать",-1),Qk=["disabled"],Tk=e("i",{class:"fa-regular fa-floppy-disk mr-2"},null,-1),Bk={class:"row mb-3"},Rk={class:"col-md-3"},Mk=["href"],Dk=oe('<div class="col-md-3"><button class="btn btn-outline-info w-100">Экспорт в XLS</button></div><div class="col-md-3"><button class="btn btn-outline-info w-100">Импорт из XLS</button></div><div class="col-md-3"><button class="btn btn-outline-danger w-100">Удалить товары</button></div>',3),Ek=e("div",{class:"row"},[e("div",{class:"col-md-3"},[e("button",{class:"btn btn-outline-info w-100"},"Экспортировать заказы")])],-1),Lk={key:1},Kk={class:"modal fade",id:"product-form-edit",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},Nk={class:"modal-dialog"},Jk={class:"modal-content"},Hk=e("div",{class:"modal-header"},[e("h1",{class:"modal-title fs-5",id:"exampleModalLabel"},"Modal title"),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),Yk={class:"modal-body"},Gk=e("div",{class:"modal-footer"},[e("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Close"),e("button",{type:"button",class:"btn btn-primary"},"Save changes")],-1),Wk={key:2},Xk={key:3},Zk={data(){return{load:!1,tab:0,url:null,link:null,bot:null,selectedProduct:null,selectedCategory:null,botForm:{vk_shop_link:null}}},computed:{...C(["getCurrentBot"])},mounted(){this.bot=this.getCurrentBot,this.botForm.vk_shop_link=this.bot.vk_shop_link||null,this.updateProducts()},methods:{updateShopLink(){this.load=!0,this.botForm.bot_id=this.bot.id,this.$store.dispatch("updateShopLink",{botForm:this.botForm}).then(o=>{this.load=!1,this.updateProducts(),this.$notify({title:"Менеджер магазина",text:"Ссылка на источник в ВК обновлена"})}).catch(()=>{this.load=!1})},refresh(){this.load=!0,this.selectedProduct=null,this.$nextTick(()=>{this.load=!1})},selectProduct(o){this.load=!0,this.$nextTick(()=>{this.selectedProduct=o,this.load=!1})},selectProductCategory(o){this.load=!0,this.$nextTick(()=>{this.selectedCategory=o,this.load=!1})},updateProducts(){this.load=!0,this.$store.dispatch("updateProductsFromVk",{dataObject:{bot_domain:this.getCurrentBot.bot_domain}}).then(o=>{this.link=o.data.url,this.load=!1,this.url=null}).catch(()=>{this.load=!1})}}},xk=Object.assign(Zk,{__name:"Shop",setup(o){return(t,s)=>{const a=V("Popper");return l(),n(v,null,[e("ul",yk,[e("li",kk,[e("a",{class:b(["nav-link",{active:t.tab===0}]),onClick:s[0]||(s[0]=i=>t.tab=0),"aria-current":"page",href:"#"},"Товары",2)]),e("li",Fk,[e("a",{class:b(["nav-link",{active:t.tab===3}]),onClick:s[1]||(s[1]=i=>t.tab=3),href:"#"},"Категории товаров",2)]),e("li",wk,[e("a",{class:b(["nav-link",{active:t.tab===1}]),onClick:s[2]||(s[2]=i=>t.tab=1),href:"#"},"Настройка&Обновление",2)]),e("li",Ck,[e("a",{class:b(["nav-link",{active:t.tab===2}]),onClick:s[3]||(s[3]=i=>t.tab=2),href:"#"},"Заказы",2)])]),t.tab===1?(l(),n("div",Sk,[e("div",jk,[Vk,e("div",qk,[e("div",zk,[e("div",Pk,[e("form",{onSubmit:s[5]||(s[5]=S((...i)=>t.updateShopLink&&t.updateShopLink(...i),["prevent"])),class:"mb-2"},[e("label",Uk,[e("div",null,[f(a,null,{content:g(()=>[Ak]),default:g(()=>[Ok]),_:1}),m(" ВК-группа ")]),Ik]),c(e("input",{type:"url",class:"form-control",placeholder:"Ссылка на группу ВК","aria-label":"ссылка на группу ВК","onUpdate:modelValue":s[4]||(s[4]=i=>t.botForm.vk_shop_link=i),"aria-describedby":"vk_shop_link"},null,512),[[h,t.botForm.vk_shop_link]]),e("button",{disabled:t.load,class:"btn btn-outline-primary mt-2 mb-2 w-100"},[Tk,m(" Сохранить ")],8,Qk)],32)])]),e("div",Bk,[e("div",Rk,[e("a",{target:"_blank",href:t.link,class:"btn btn-primary w-100"}," Обновить товар ",8,Mk)]),Dk]),Ek])])])):r("",!0),t.tab===0?(l(),n("div",Lk,[t.bot&&!t.load?(l(),$(ok,{key:0,bot:t.bot,onSelect:t.selectProduct},null,8,["bot","onSelect"])):r("",!0),e("div",Kk,[e("div",Nk,[e("div",Jk,[Hk,e("div",Yk,[t.bot&&!t.load?(l(),$(ce,{key:0,bot:t.bot,item:t.selectedProduct,onRefresh:t.refresh},null,8,["bot","item","onRefresh"])):r("",!0)]),Gk])])])])):r("",!0),t.tab===2?(l(),n("div",Wk)):r("",!0),t.tab===3?(l(),n("div",Xk,[t.bot&&!t.load?(l(),$($k,{key:0,bot:t.bot,onSelect:t.selectProductCategory},null,8,["bot","onSelect"])):r("",!0)])):r("",!0)],64)}}}),e0={props:["data"],data(){return{hasConnect:!1,bot:null,amoForm:{client_id:null,client_secret:null,auth_code:null,redirect_uri:null,subdomain:null,bot_id:null}}},computed:{...C(["getCurrentBot"])},mounted(){this.bot=this.getCurrentBot,this.data?this.$nextTick(()=>{this.amoForm.client_id=this.data.client_id||null,this.amoForm.client_secret=this.data.client_secret||null,this.amoForm.auth_code=this.data.auth_code||null,this.amoForm.redirect_uri=this.data.redirect_uri||null,this.amoForm.subdomain=this.data.subdomain||null,this.amoForm.bot_id=this.data.bot_id||this.bot.id||null}):this.amoForm.bot_id=this.bot.id||null},methods:{submitAmo(){let o=new FormData;Object.keys(this.amoForm).forEach(t=>{const s=this.amoForm[t]||"";typeof s=="object"?o.append(t,JSON.stringify(s)):o.append(t,s)}),this.$store.dispatch("saveAmoCRM",{amoForm:o}).then(t=>{this.$notify("Данные CRM успешно сохранены")}).catch(t=>{})}}},t0=e("div",{class:"col-12"},[e("p",null,[e("a",{target:"_blank",href:"https://www.amocrm.ru/developers/content/oauth/step-by-step"},"Документация для разработчика "),m(" по шагам")])],-1),s0={class:"col-md-6 col-12 mb-2"},o0={class:"form-label",id:"client_id"},l0=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),n0=e("div",null,"ID интеграции",-1),i0=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),a0={class:"col-md-6 col-12 mb-2"},d0={class:"form-label",id:"client_secret"},r0=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),c0=e("div",null,"Секрет интеграции",-1),u0=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),m0={class:"col-md-6 mb-2"},_0={class:"form-label",id:"auth_code"},h0=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),p0=e("div",null,"Полученный код авторизации",-1),b0=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),f0={class:"col-md-6 col-12 mb-2"},g0={class:"form-label",id:"subdomain2"},v0=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),$0=e("div",null,"Ваш поддомен в системе AMO CRM",-1),y0=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),k0=e("div",{class:"col-md-12 col-12"},[e("button",{type:"submit",class:"btn btn-outline-primary p-3 w-100"},[e("i",{class:"fa-solid fa-cloud-arrow-down mr-1"}),m(" Сохранить настройку AMO ")])],-1);function F0(o,t,s,a,i,d){const _=V("Popper");return l(),n("form",{onSubmit:t[4]||(t[4]=S((...p)=>d.submitAmo&&d.submitAmo(...p),["prevent"])),class:"row"},[t0,e("div",s0,[e("label",o0,[f(_,null,{content:g(()=>[n0]),default:g(()=>[l0]),_:1}),m(" client_id "),i0]),c(e("input",{type:"text",class:"form-control",placeholder:"client_id","aria-label":"client_id","onUpdate:modelValue":t[0]||(t[0]=p=>i.amoForm.client_id=p),"aria-describedby":"client_id"},null,512),[[h,i.amoForm.client_id]])]),e("div",a0,[e("label",d0,[f(_,null,{content:g(()=>[c0]),default:g(()=>[r0]),_:1}),m(" client_secret "),u0]),c(e("input",{type:"text",class:"form-control",placeholder:"client_secret","aria-label":"client_secret","onUpdate:modelValue":t[1]||(t[1]=p=>i.amoForm.client_secret=p),"aria-describedby":"client_secret"},null,512),[[h,i.amoForm.client_secret]])]),e("div",m0,[e("label",_0,[f(_,null,{content:g(()=>[p0]),default:g(()=>[h0]),_:1}),m(" auth_code "),b0]),c(e("textarea",{class:"form-control",placeholder:"auth_code","aria-label":"auth_code","onUpdate:modelValue":t[2]||(t[2]=p=>i.amoForm.auth_code=p),"aria-describedby":"auth_code"},`
                                    `,512),[[h,i.amoForm.auth_code]])]),e("div",f0,[e("label",g0,[f(_,null,{content:g(()=>[$0]),default:g(()=>[v0]),_:1}),m(" subdomain "),y0]),c(e("input",{type:"text",class:"form-control",placeholder:"subdomain","aria-label":"subdomain","onUpdate:modelValue":t[3]||(t[3]=p=>i.amoForm.subdomain=p),"aria-describedby":"subdomain"},null,512),[[h,i.amoForm.subdomain]])]),k0],32)}const w0=U(e0,[["render",F0]]),C0={props:["data"],data(){return{load:!1,bot:null,yClientsForm:{login:null,password:null,partner_token:null,company:null}}},computed:{...C(["getCurrentBot"])},mounted(){this.bot=this.getCurrentBot,this.data&&this.$nextTick(()=>{this.yClientsForm.login=this.data.login||null,this.yClientsForm.password=this.data.password||null,this.yClientsForm.partner_token=this.data.partner_token||null,this.yClientsForm.company=this.data.company||null})},methods:{submitYClients(){let o=new FormData;Object.keys(this.yClientsForm).forEach(t=>{const s=this.yClientsForm[t]||"";typeof s=="object"?o.append(t,JSON.stringify(s)):o.append(t,s)}),o.append("bot_id",this.bot.id),this.$store.dispatch("saveYClients",{yClientsForm:o}).then(t=>{this.$notify({title:"Работа с YClients",text:"Данные YClients успешно сохранены",type:"success"})}).catch(t=>{this.$notify({title:"Работа с YClients",text:"Ошибка сохранения данных",type:"error"})})}}},S0=e("h6",null,"Настройка YClients",-1),j0={class:"row"},V0={class:"col-md-12"},q0={class:"mb-2"},z0=e("label",{class:"form-label d-flex justify-content-between mt-2",for:"login"},[m(" Логин "),e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно")],-1),P0={class:"mb-2"},U0=e("label",{class:"form-label d-flex justify-content-between mt-2",for:"password"},[m(" Пароль "),e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно")],-1),O0={class:"mb-2"},A0=e("label",{class:"form-label d-flex justify-content-between mt-2",for:"partner_token"},[m(" Партнерский тоукен "),e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно")],-1),I0={class:"mb-2"},Q0=e("label",{class:"form-label d-flex justify-content-between mt-2",for:"partner_token"},[m(" ID компании, в которую записывать клиентов "),e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно")],-1),T0=e("button",{class:"btn btn-success w-100 r mb-3 text-uppercase font-900"}," Сохранить ",-1);function B0(o,t,s,a,i,d){return l(),n(v,null,[S0,e("form",{onSubmit:t[4]||(t[4]=S((..._)=>d.submitYClients&&d.submitYClients(..._),["prevent"]))},[e("div",j0,[e("div",V0,[e("div",q0,[z0,c(e("input",{type:"text",id:"login",class:"form-control",placeholder:"Ваш логин","aria-label":"Ваш логин","onUpdate:modelValue":t[0]||(t[0]=_=>i.yClientsForm.login=_),"aria-describedby":"Ваш логин",required:""},null,512),[[h,i.yClientsForm.login]])]),e("div",P0,[U0,c(e("input",{type:"text",id:"password",class:"form-control",placeholder:"Ваш пароль","aria-label":"Ваш пароль","onUpdate:modelValue":t[1]||(t[1]=_=>i.yClientsForm.password=_),"aria-describedby":"Ваш пароль",required:""},null,512),[[h,i.yClientsForm.password]])]),e("div",O0,[A0,c(e("input",{type:"text",id:"partner_token",class:"form-control",placeholder:"Ваш партнерский тоукен","aria-label":"Ваш партнерский тоукен","onUpdate:modelValue":t[2]||(t[2]=_=>i.yClientsForm.partner_token=_),"aria-describedby":"Ваш партнерский тоукен",required:""},null,512),[[h,i.yClientsForm.partner_token]])]),e("div",I0,[Q0,c(e("input",{type:"number",id:"throttle",class:"form-control",placeholder:"ID компании","aria-label":"ID компании","onUpdate:modelValue":t[3]||(t[3]=_=>i.yClientsForm.company=_),"aria-describedby":"ID компании",required:""},null,512),[[h,i.yClientsForm.company]])])])]),T0],32)],64)}const R0=U(C0,[["render",B0]]),M0={class:"py-2"},D0={class:"nav nav-tabs"},E0={class:"nav-item"},L0={class:"nav-item"},K0={key:0,class:"row"},N0={class:"col-12 py-2"},J0={key:1,class:"row"},H0={class:"col-12 py-2"},Y0={class:"col-12"},G0={props:["bot"],data(){return{tab:1,load:!1,loadMailingTable:!1}},mounted(){},methods:{callbackPersonalMail(){this.loadMailingTable=!0,this.$nextTick(()=>{this.loadMailingTable=!1})}}},W0=Object.assign(G0,{__name:"Mail",setup(o){return(t,s)=>(l(),n("div",M0,[e("ul",D0,[e("li",E0,[e("a",{class:b(["nav-link",{active:t.tab===0}]),onClick:s[0]||(s[0]=a=>t.tab=0),"aria-current":"page",href:"#"},"Рассылка в канал",2)]),e("li",L0,[e("a",{class:b(["nav-link",{active:t.tab===1}]),onClick:s[1]||(s[1]=a=>t.tab=1),href:"#"},"Рассылка в бота",2)])]),t.tab===0?(l(),n("div",K0,[e("div",N0,[f(pe)])])):r("",!0),t.tab===1?(l(),n("div",J0,[e("div",H0,[f(be,{onCallback:t.callbackPersonalMail},null,8,["onCallback"])]),e("div",Y0,[t.loadMailingTable?r("",!0):(l(),$(fe,{key:0,bot:o.bot},null,8,["bot"]))])])):r("",!0)]))}}),X0={data(){return{load:!1,bot:null,fieldTypes:[{title:"Текст",value:0},{title:"Число",value:1},{title:"Логический",value:2},{title:"Дата и время",value:3}],fieldForm:{fields:[]}}},computed:{...C(["getCurrentBot"])},mounted(){this.loadCurrentBot().then(()=>{this.bot=this.getCurrentBot,this.$nextTick(()=>{this.fieldForm.fields=this.bot.field_settings||[]}),this.loadCurrentBotFields()})},methods:{loadCurrentBotFields(){return this.$store.dispatch("loadCurrentBotFields",{bot_id:this.bot.id}).then(o=>{this.fieldForm.fields=o.data||[]})},loadCurrentBot(o=null){return this.$store.dispatch("updateCurrentBot",{bot:o}).then(()=>{this.bot=this.getCurrentBot})},removeField(o){this.fieldForm.fields.splice(o,1)},submit(){let o=new FormData;Object.keys(this.fieldForm).forEach(t=>{const s=this.fieldForm[t]||"";typeof s=="object"?o.append(t,JSON.stringify(s)):o.append(t,s)}),o.append("bot_id",this.bot.id),this.$store.dispatch("storeBotFields",{dataObject:o}).then(t=>{this.$notify({title:"Конструктор ботов",text:"Поля успешно обновлены",type:"success"}),this.fieldForm.fields=[],this.fieldForm.fields=t.data}).catch(t=>{this.$notify({title:"Конструктор ботов",text:"Ошибка обновления полей",type:"error"})})},addField(){if(this.fieldForm.fields||(this.fieldForm.fields=[]),this.fieldForm.fields.length>0&&this.fieldForm.fields.findIndex(t=>t.key==null)!==-1){this.$notify({title:"Настраиваемые поля",text:"У вас есть пустые ключевые поля!",type:"error"});return}this.fieldForm.fields.push({key:null,type:0,label:null,description:null,required:!1,validate_pattern:null})}}},Z0={class:"mb-2"},x0={class:"d-flex justify-content-between"},e3=e("h6",null,"Настройка полей пользователя бота",-1),t3=e("i",{class:"fa-solid fa-plus mr-2"},null,-1),s3=e("p",null,[e("em",null,"Данные поля будут добавлены пользователю бота и будут автоматически учитываться в условиях страниц, скриптах (в формах заполнения данных), диалогах. Ключи должны быть уникальные для каждого бота. Если ключ дублируется, то будет использовано более позднее его значение. Если поле добавлено и сохранено, то удалить его уже нельзя, только скрыть. "),m(". "),e("br"),e("span",{class:"text-danger"},"*"),m(" - обязательное поле ")],-1),o3={class:"table"},l3=e("thead",null,[e("tr",null,[e("th",{scope:"col"},"#"),e("th",{scope:"col"},[m("Ключ"),e("span",{class:"text-danger"},"*")]),e("th",{scope:"col"},[m("Подпись поля"),e("span",{class:"text-danger"},"*")]),e("th",{scope:"col"},[m("Тип поля"),e("span",{class:"text-danger"},"*")]),e("th",{scope:"col"},"Паттерн"),e("th",{scope:"col"},"Обязательный"),e("th",{scope:"col"},[m("Вопрос для анкеты"),e("span",{class:"text-danger"},"*")]),e("th",{scope:"col"})])],-1),n3={scope:"row"},i3={scope:"col"},a3=["onUpdate:modelValue"],d3={scope:"col"},r3=["onUpdate:modelValue"],c3={scope:"col"},u3=["onUpdate:modelValue"],m3=["value"],_3={scope:"col"},h3=["disabled","onUpdate:modelValue"],p3={scope:"col"},b3={class:"form-check"},f3=["onUpdate:modelValue","id"],g3=["for"],v3={key:0},$3={key:1},y3={scope:"col"},k3=["onUpdate:modelValue"],F3={scope:"col"},w3=["onClick"],C3=e("i",{class:"fa-regular fa-trash-can"},null,-1),S3=[C3],j3={key:1,class:"form-check mt-2"},V3=["onUpdate:modelValue","id"],q3=["for"],z3={key:0},P3=e("i",{class:"fa-solid fa-eye text-success"},null,-1),U3=[P3],O3={key:1},A3=e("i",{class:"fa-solid fa-eye-slash text-danger"},null,-1),I3=[A3],Q3=e("button",{type:"submit",class:"btn btn-success w-100 p-3"}," Сохранить поля ",-1);function T3(o,t,s,a,i,d){return l(),n("div",Z0,[e("div",x0,[e3,e("button",{type:"button",onClick:t[0]||(t[0]=_=>d.addField()),class:"btn mb-2 rounded-sm btn-outline-info"},[t3,m(" Добавить параметр ")])]),s3,e("form",{onSubmit:t[1]||(t[1]=S((..._)=>d.submit&&d.submit(..._),["prevent"]))},[e("table",o3,[l3,e("tbody",null,[(l(!0),n(v,null,y(i.fieldForm.fields,(_,p)=>(l(),n("tr",null,[e("th",n3,u(p+1),1),e("th",i3,[c(e("input",{type:"text",class:"form-control mb-2 w-100",placeholder:"Ключ","aria-label":"Ключ",maxlength:"255","onUpdate:modelValue":F=>i.fieldForm.fields[p].key=F,required:""},null,8,a3),[[h,i.fieldForm.fields[p].key]])]),e("th",d3,[c(e("input",{type:"text",class:"form-control mb-2 w-100",placeholder:"Подпись поля","aria-label":"Название поля",maxlength:"255","onUpdate:modelValue":F=>i.fieldForm.fields[p].label=F,required:""},null,8,r3),[[h,i.fieldForm.fields[p].label]])]),e("th",c3,[c(e("select",{class:"form-select","onUpdate:modelValue":F=>i.fieldForm.fields[p].type=F},[(l(!0),n(v,null,y(i.fieldTypes,F=>(l(),n("option",{value:F.value},u(F.title||"Не указан"),9,m3))),256))],8,u3),[[Q,i.fieldForm.fields[p].type]])]),e("th",_3,[c(e("input",{type:"text",class:"form-control mb-2 w-100",placeholder:"Паттерн","aria-label":"Паттерн",maxlength:"255",disabled:i.fieldForm.fields[p].type===2,"onUpdate:modelValue":F=>i.fieldForm.fields[p].validate_pattern=F},null,8,h3),[[h,i.fieldForm.fields[p].validate_pattern]])]),e("th",p3,[e("div",b3,[c(e("input",{class:"form-check-input","onUpdate:modelValue":F=>i.fieldForm.fields[p].required=F,type:"checkbox",value:"",id:"field-required"+p},null,8,f3),[[k,i.fieldForm.fields[p].required]]),e("label",{class:"form-check-label",for:"field-required"+p},[i.fieldForm.fields[p].required?(l(),n("span",v3,"Да")):r("",!0),i.fieldForm.fields[p].required?r("",!0):(l(),n("span",$3,"Нет"))],8,g3)])]),e("th",y3,[c(e("input",{type:"text",class:"form-control mb-2 w-100",placeholder:"Описание вопроса","aria-label":"Описание вопроса",maxlength:"255","onUpdate:modelValue":F=>i.fieldForm.fields[p].description=F,required:""},null,8,k3),[[h,i.fieldForm.fields[p].description]])]),e("th",F3,[i.fieldForm.fields[p].id?(l(),n("div",j3,[c(e("input",{class:"form-check-input d-none","onUpdate:modelValue":F=>i.fieldForm.fields[p].is_active=F,type:"checkbox",value:"",id:"field-is_active-"+p},null,8,V3),[[k,i.fieldForm.fields[p].is_active]]),e("label",{class:"form-check-label",for:"field-is_active-"+p},[i.fieldForm.fields[p].is_active?(l(),n("span",z3,U3)):r("",!0),i.fieldForm.fields[p].is_active?r("",!0):(l(),n("span",O3,I3))],8,q3)])):(l(),n("button",{key:0,type:"button",onClick:F=>d.removeField(p),class:"btn btn-link text-danger"},S3,8,w3))])]))),256))])]),Q3],32)])}const B3=U(X0,[["render",T3]]),R3={class:"row"},M3={class:"input-group mb-3"},D3={key:0,class:"row"},E3={class:"col-12 col-md-12 mb-3"},L3={class:"table"},K3=e("thead",null,[e("tr",null,[e("th",{scope:"col"},"#"),e("th",{scope:"col"},"Тип"),e("th",{scope:"col"},"Подпись"),e("th",{scope:"col"},"File Id"),e("th",{scope:"col"},"Действия")])],-1),N3={scope:"row"},J3={class:"badge bg-info rounded-pill"},H3={style:{"word-break":"break-all"}},Y3={style:{"word-break":"break-all"}},G3={style:{"min-width":"200px"}},W3=["onClick"],X3=e("i",{class:"fa-solid fa-eye"},null,-1),Z3=[X3],x3=["onClick"],eF=e("i",{class:"fa-brands fa-telegram"},null,-1),tF=[eF],sF=["onClick"],oF=e("i",{class:"fa-solid fa-trash"},null,-1),lF=[oF],nF={class:"col-12"},iF={key:1,class:"row"},aF=e("div",{class:"col-12"},[e("div",{class:"alert alert-warning",role:"alert"}," У выбранного бота нет медиа-файлов ")],-1),dF=[aF],rF={class:"modal fade",id:"preview-modal",tabindex:"-1","aria-labelledby":"preview-modal-label","aria-hidden":"true"},cF={class:"modal-dialog"},uF={class:"modal-content"},mF={class:"modal-body"},_F={key:0,class:"d-flex justify-content-center align-items-center"},hF=e("div",{class:"modal-footer"},[e("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Закрыть")],-1),pF={data(){return{bot:null,previewContent:null,loading:!0,media:[],search:null,media_paginate_object:null}},computed:{...C(["getMedia","getMediaPaginateObject","getCurrentBot"])},mounted(){this.loadCurrentBot().then(()=>{this.loadMedia()})},methods:{selectMedia(o){this.$emit("select",o)},loadCurrentBot(o=null){return this.$store.dispatch("updateCurrentBot",{bot:o}).then(()=>{this.bot=this.getCurrentBot})},nextMedia(o){this.loadMedia(o)},remove(o){this.$store.dispatch("removeMedia",{dataObject:{mediaId:o}}).then(t=>{this.loadMedia(),this.$notify({title:"Удаление медиа-контента",text:"Медиа контент удален"})}).catch(()=>{})},showPreview(o){this.previewContent=null,this.$nextTick(()=>{this.previewContent=o,new bootstrap.Modal("#preview-modal",{}).show()})},showPreviewInTg(o){this.$store.dispatch("showMediaPreview",{dataObject:{mediaId:o}}).then(t=>{this.$notify({title:"Превью медиа-контента",text:"Отправлено в бота"})}).catch(()=>{})},loadMedia(o=0){this.loading=!0,this.$store.dispatch("loadMedia",{dataObject:{bot_id:this.bot.id||null,search:this.search,needVideo:!0,needVideoNote:!0,needPhoto:!0,needAudio:!0,needDocument:!0,needSticker:!0},page:o}).then(t=>{this.loading=!1,this.media=this.getMedia,this.media_paginate_object=this.getMediaPaginateObject}).catch(()=>{this.loading=!1})}}},bF=Object.assign(pF,{__name:"BotMediaTable",setup(o){return(t,s)=>(l(),n(v,null,[e("div",R3,[e("div",M3,[c(e("input",{type:"search",class:"form-control",placeholder:"Поиск файла","aria-label":"Поиск файла","onUpdate:modelValue":s[0]||(s[0]=a=>t.search=a)},null,512),[[h,t.search]]),e("button",{class:"btn btn-outline-secondary",onClick:s[1]||(s[1]=a=>t.loadMedia(0)),type:"button",id:"button-addon2"},"Найти ")])]),t.media.length>0?(l(),n("div",D3,[e("div",E3,[e("table",L3,[K3,e("tbody",null,[(l(!0),n(v,null,y(t.media,(a,i)=>(l(),n("tr",null,[e("th",N3,u(a.id),1),e("td",null,[e("span",J3,u(a.type),1)]),e("td",null,[e("p",H3,u(a.caption??"Без подписи"),1)]),e("td",null,[e("p",Y3,u(a.file_id),1)]),e("td",null,[e("div",G3,[e("a",{href:"javascript:void(0)",class:"btn btn-info mr-2",onClick:d=>t.showPreview(a)},Z3,8,W3),e("a",{href:"javascript:void(0)",class:"btn btn-info mr-2",onClick:d=>t.showPreviewInTg(a.id)},tF,8,x3),e("a",{href:"javascript:void(0)",class:"btn btn-outline-danger text-danger",onClick:d=>t.remove(a.id)},lF,8,sF)])])]))),256))])])]),e("div",nF,[t.media_paginate_object?(l(),$(j,{key:0,onPagination_page:t.nextMedia,pagination:t.media_paginate_object},null,8,["onPagination_page","pagination"])):r("",!0)])])):(l(),n("div",iF,dF)),e("div",rF,[e("div",cF,[e("div",uF,[e("div",mF,[t.previewContent!=null?(l(),n("div",_F,[f(J,{type:t.previewContent.type,content:t.previewContent.file_id},null,8,["type","content"])])):r("",!0)]),hF])])])],64))}}),fF={class:"row py-3"},gF={class:"col-12"},vF={class:"row"},$F={class:"col-12"},yF={key:0},kF={key:1},FF={key:0,class:"col-12 mb-3"},wF={class:"col-12 mb-3"},CF={key:0},SF={key:1},jF={key:1,class:"col-12 mb-3"},VF={class:"row py-3"},qF=e("div",{class:"col-12"},[e("p",{class:"mb-0"},"Выбор статуса")],-1),zF={class:"col-md-3"},PF=["onClick"],UF={class:"row"},OF={class:"col-12 mb-3"},AF={class:"form-label",id:"service-title"},IF=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),QF=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),TF={class:"col-12 mb-3"},BF={class:"form-label",id:"service-title"},RF=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),MF=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),DF={class:"col-12 mb-3"},EF={class:"form-label",id:"appointment-info"},LF=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),KF=e("div",null," Краткая информация от клиента ",-1),NF=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),JF={key:0,class:"text-gray-400 ml-3",style:{"font-size":"10px"}},HF={class:"row"},YF={class:"col-12"},GF={type:"submit",class:"btn btn-outline-success w-100 p-3"},WF={key:0},XF={key:1},ZF={props:["eventId","bot","appointment"],data(){return{step:0,load:!1,selected_schedule_time:null,selected_bot_user:null,need_load_users:!1,need_schedule_time:!1,statuses:[{value:0,title:"Новая запись"},{value:1,title:"Подтверждение записи"},{value:2,title:"Прохождение по записи"},{value:3,title:"Отмена записи"}],days:["понедельник","вторник","среду","четверг","пятницу","субботу","воскресенье"],appointmentForm:{id:null,appointment_event_id:null,appointment_schedule_id:null,bot_user_id:null,status:0,name:null,phone:null,info:null}}},mounted(){this.appointment&&this.$nextTick(()=>{this.appointmentForm={id:this.appointment.id||null,appointment_event_id:this.appointment.appointment_event_id||null,appointment_schedule_id:this.appointment.appointment_schedule_id||null,bot_user_id:this.appointment.bot_user_id||null,status:this.appointment.status||0,name:this.appointment.name||null,phone:this.appointment.phone||null,info:this.appointment.info||null},this.selected_schedule_time=this.appointment.schedule||null,this.selected_bot_user=this.appointment.botUser||null})},methods:{selectScheduleTime(o){if(o.appointment){this.$notify("Данное время уже занято!");return}this.selected_schedule_time=o,this.need_schedule_time=!1},selectBotUser(o){this.selected_bot_user=o,this.need_load_users=!1},clearAppointmentForm(){this.appointmentForm={id:null,appointment_event_id:null,appointment_schedule_id:null,bot_user_id:null,status:0},this.selected_schedule_time=null,this.selected_bot_user=null},submitForm(){this.appointmentForm.bot_user_id=this.selected_bot_user.id,this.appointmentForm.appointment_schedule_id=this.selected_schedule_time.id,this.appointmentForm.appointment_event_id=this.eventId;let o=new FormData;Object.keys(this.appointmentForm).forEach(t=>{const s=this.appointmentForm[t]||"";typeof s=="object"?o.append(t,JSON.stringify(s)):o.append(t,s)}),o.append("bot_id",this.bot.id),this.$store.dispatch("storeAppointment",{dataObject:{appointmentForm:o}}).then(t=>{this.clearAppointmentForm(),this.$emit("callback"),this.$notify("Запись успешно создана")}).catch(t=>{this.$notify("Ошибка создания записи")})}}},xF=Object.assign(ZF,{__name:"AppointmentForm",setup(o){return(t,s)=>{const a=V("Popper"),i=I("mask");return l(),n(v,null,[e("div",fF,[e("div",gF,[e("button",{onClick:s[0]||(s[0]=(...d)=>t.clearAppointmentForm&&t.clearAppointmentForm(...d)),class:"btn btn-primary"},"Новая заявка ")])]),e("form",{onSubmit:s[6]||(s[6]=S((...d)=>t.submitForm&&t.submitForm(...d),["prevent"]))},[e("div",vF,[e("div",$F,[e("a",{href:"javascript:void(0)",class:"btn btn-link",onClick:s[1]||(s[1]=d=>t.need_load_users=!t.need_load_users)},[t.selected_bot_user==null?(l(),n("span",yF,"Выберите пользователя")):r("",!0),t.selected_bot_user?(l(),n("span",kF," Пользователь "+u(t.selected_bot_user.name||t.selected_bot_user.fio_from_telegram||t.selected_bot_user.telegram_chat_id||"-"),1)):r("",!0)])]),t.need_load_users?(l(),n("div",FF,[f(D,{simple:!0,onSelect:t.selectBotUser},null,8,["onSelect"])])):r("",!0),e("div",wF,[e("a",{href:"javascript:void(0)",class:"btn btn-link",onClick:s[2]||(s[2]=d=>t.need_schedule_time=!t.need_schedule_time)},[t.selected_schedule_time==null?(l(),n("span",CF,"Выберите время в расписании")):r("",!0),t.selected_schedule_time?(l(),n("span",SF," Запись на "+u(t.days[t.selected_schedule_time.day-1]||"-")+" с "+u(t.selected_schedule_time.start_time||"-")+" до "+u(t.selected_schedule_time.end_time||"-"),1)):r("",!0)])]),t.need_schedule_time?(l(),n("div",jF,[f(ie,{"event-id":o.eventId,bot:o.bot,onSelect:t.selectScheduleTime},null,8,["event-id","bot","onSelect"])])):r("",!0)]),e("div",VF,[qF,(l(!0),n(v,null,y(t.statuses,d=>(l(),n("div",zF,[e("button",{type:"button",class:b([{"btn-success text-white":t.appointmentForm.status==d.value},"btn btn-outline-success w-100"]),onClick:_=>t.appointmentForm.status=d.value},u(d.title||"не указано"),11,PF)]))),256))]),e("div",UF,[e("div",OF,[e("label",AF,[f(a,{content:"ФИО человека, который посетит запись"},{default:g(()=>[IF]),_:1}),m(" Ф.И.О. посетителя "),QF]),c(e("input",{type:"text",class:"form-control",placeholder:"Иванов Иван Иванович","aria-label":"ФИО","onUpdate:modelValue":s[3]||(s[3]=d=>t.appointmentForm.name=d),maxlength:"255","aria-describedby":"appointment-name",required:""},null,512),[[h,t.appointmentForm.name]])]),e("div",TF,[e("label",BF,[f(a,{content:"Номер телефона человека, который посетит запись"},{default:g(()=>[RF]),_:1}),m(" Телефонный номер "),MF]),c(e("input",{type:"text",class:"form-control",placeholder:"+7(000)000-00-00","aria-label":"номер телефона","onUpdate:modelValue":s[4]||(s[4]=d=>t.appointmentForm.phone=d),maxlength:"255","aria-describedby":"appointment-phone",required:""},null,512),[[i,"+7(###)###-##-##"],[h,t.appointmentForm.phone]])]),e("div",DF,[e("label",EF,[f(a,null,{content:g(()=>[KF]),default:g(()=>[LF]),_:1}),m(" Описание услуги "),NF,t.appointmentForm.info?(l(),n("small",JF," Длина текста "+u(t.appointmentForm.info.length)+" / 255",1)):r("",!0)]),c(e("textarea",{type:"text",class:"form-control",placeholder:"Информация от клиента","aria-label":"Информация от клиента",maxlength:"255","onUpdate:modelValue":s[5]||(s[5]=d=>t.appointmentForm.info=d),"aria-describedby":"appointment-info",required:""},`
                    `,512),[[h,t.appointmentForm.info]])])]),e("div",HF,[e("div",YF,[e("button",GF,[t.appointmentForm.id==null?(l(),n("span",WF,"Записаться")):(l(),n("span",XF,"Обновить запись"))])])])],32)],64)}}}),e5={class:"row"},t5={class:"col-12"},s5={key:0,class:"table"},o5=e("th",{scope:"col"},"Действие",-1),l5=["onClick"],n5={scope:"row"},i5={key:0},a5={key:0,class:"dropdown"},d5=e("button",{class:"btn btn-outline-secondary",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-solid fa-ellipsis"})],-1),r5={class:"dropdown-menu"},c5={key:0},u5=["onClick"],m5={key:1},_5={class:"col-12"},h5={props:["bot","eventId"],data(){return{direction:"desc",order:"updated_at",show:!0,is_group:!1,loading:!0,services:[],search:null,statuses:["Новая запись","Подтверждение записи","Прохождение по записи","Отмена записи"],days:["понедельник","вторник","среду","четверг","пятницу","субботу","воскресенье"],paginate_object:null}},computed:{...C(["getAppointments","getAppointmentsPaginateObject"])},mounted(){this.loadAppointments()},methods:{nextAppointments(o){this.loadAppointments(o)},selectAppointment(o){this.$emit("select",o)},loadAndOrder(o){this.order=o,this.direction=this.direction==="desc"?"asc":"desc",this.loadAppointments(0)},removeAppointment(o){this.loading=!0,this.$store.dispatch("removeAppointment",{dataObject:{appointmentId:o}}).then(t=>{this.loading=!1,this.loadAppointments(0),this.$notify("Запись успешно удалена")}).catch(()=>{this.loading=!1,this.$notify("Ошибка удаления записи")})},loadAppointments(o=0){this.loading=!0,this.$store.dispatch("loadAppointments",{dataObject:{event_id:this.eventId,bot_id:this.bot.id||null,search:this.search,order:this.order,direction:this.direction},page:o,size:100}).then(t=>{this.loading=!1,this.services=this.getAppointments,this.paginate_object=this.getAppointmentsPaginateObject}).catch(()=>{this.loading=!1})}}},p5=Object.assign(h5,{__name:"AppointmentsTable",setup(o){return(t,s)=>(l(),n("div",e5,[e("div",t5,[t.services.length>0?(l(),n("table",s5,[e("thead",null,[e("tr",null,[e("th",{scope:"col",class:"cursor-pointer",onClick:s[0]||(s[0]=a=>t.loadAndOrder("id"))},"#"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[1]||(s[1]=a=>t.loadAndOrder("bot_user_id"))},"Пользователь"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[2]||(s[2]=a=>t.loadAndOrder("appointment_schedule_id"))},"Дата записи "),e("th",{scope:"col",class:"cursor-pointer",onClick:s[3]||(s[3]=a=>t.loadAndOrder("status"))},"Статус"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[4]||(s[4]=a=>t.loadAndOrder("name"))},"Посетитель"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[5]||(s[5]=a=>t.loadAndOrder("phone"))},"Телефон посетителя"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[6]||(s[6]=a=>t.loadAndOrder("info"))},"Доп.инф"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[7]||(s[7]=a=>t.loadAndOrder("updated_at"))},"Дата изменения"),o5])]),e("tbody",null,[(l(!0),n(v,null,y(t.services,(a,i)=>(l(),n("tr",{onClick:d=>t.selectAppointment(a),class:b({"border-info":a.deleted_at==null,"border-danger":a.deleted_at!=null})},[e("th",n5,u(a.id),1),e("td",null,u(a.botUser.fio_from_telegram||a.botUser.telegram_chat_id||"Не указано"),1),e("td",null,[a.schedule?(l(),n("p",i5," Запись на "+u(t.days[a.schedule.day-1]||"Не указано")+" с "+u(a.schedule.start_time||"Не указано")+" до "+u(a.schedule.end_time||"Не указано"),1)):r("",!0)]),e("td",null,u(t.statuses[a.status]),1),e("td",null,u(t.$filters.current(a.updated_at)),1),e("td",null,u(a.name||"не указано"),1),e("td",null,u(a.phone||"не указано"),1),e("td",null,u(a.info||"не указано"),1),e("td",null,[a.id?(l(),n("div",a5,[d5,e("ul",r5,[a.deleted_at==null?(l(),n("li",c5,[e("a",{class:"dropdown-item",onClick:d=>t.removeAppointment(a.id),href:"javascript:void(0)"},"Удалить",8,u5)])):r("",!0)])])):r("",!0)])],10,l5))),256))])])):(l(),n("p",m5,"На текущий момент нет ни одного созданного сервиса"))]),e("div",_5,[t.paginate_object?(l(),$(j,{key:0,onPagination_page:t.nextAppointments,pagination:t.paginate_object},null,8,["onPagination_page","pagination"])):r("",!0)])]))}}),b5={class:"row py-2"},f5={class:"col-12"},g5={class:"input-group mb-3"},v5={class:"col-12"},$5={key:0,class:"table"},y5=e("th",{scope:"col"},"Действие",-1),k5={scope:"row"},F5=["onClick"],w5={key:0,class:"fa-solid fa-chevron-down text-success"},C5={key:1,class:"fa-solid fa-xmark text-danger"},S5={key:0,class:"dropdown"},j5=e("button",{class:"btn btn-outline-secondary",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-solid fa-ellipsis"})],-1),V5={class:"dropdown-menu"},q5={key:0},z5=["onClick"],P5={key:1},U5=["onClick"],O5={key:1},A5={class:"col-12"},I5={props:["bot"],data(){return{direction:"desc",order:"updated_at",show:!0,is_group:!1,loading:!0,events:[],search:null,paginate_object:null}},computed:{...C(["getAppointmentEvents","getAppointmentEventsPaginateObject"])},mounted(){this.loadAppointmentEvents()},methods:{duplicateAppointmentEvent(o){this.loading=!0,this.$store.dispatch("duplicateAppointmentEvent",{dataObject:{appointmentEventId:o,bot_id:this.bot.id}}).then(t=>{this.loading=!1,this.loadAppointmentEvents(0),this.$notify("Событие успешно продублировано")}).catch(()=>{this.loading=!1,this.$notify("Ошибка дублирования события")})},removeAppointmentEvent(o){this.loading=!0,this.$store.dispatch("removeAppointmentEvent",{dataObject:{appointmentEventId:o}}).then(t=>{this.loading=!1,this.loadAppointmentEvents(0),this.$notify("Событие успешно удалено")}).catch(()=>{this.loading=!1,this.$notify("Ошибка удаления события")})},nextAppointmentEvents(o){this.loadAppointmentEvents(o)},selectEvent(o){this.$emit("select",o)},loadAndOrder(o){this.order=o,this.direction=this.direction==="desc"?"asc":"desc",this.loadAppointmentEvents(0)},loadAppointmentEvents(o=0){this.loading=!0,this.$store.dispatch("loadAppointmentEvents",{dataObject:{bot_id:this.bot.id||null,search:this.search,is_group:this.is_group,order:this.order,direction:this.direction},page:o,size:20}).then(t=>{this.loading=!1,this.events=this.getAppointmentEvents,this.paginate_object=this.getAppointmentEventsPaginateObject}).catch(()=>{this.loading=!1})}}},Q5=Object.assign(I5,{__name:"AppointmentEventTable",setup(o){return(t,s)=>(l(),n("div",b5,[e("div",f5,[e("div",g5,[c(e("input",{type:"search",class:"form-control",placeholder:"Поиск события","aria-label":"Поиск события","onUpdate:modelValue":s[0]||(s[0]=a=>t.search=a),"aria-describedby":"appointment-search-event"},null,512),[[h,t.search]]),e("button",{class:"btn btn-outline-secondary",onClick:s[1]||(s[1]=a=>t.loadAppointmentEvents(0)),type:"button",id:"appointment-search-event"},"Найти ")])]),e("div",v5,[t.events.length>0?(l(),n("table",$5,[e("thead",null,[e("tr",null,[e("th",{scope:"col",class:"cursor-pointer",onClick:s[2]||(s[2]=a=>t.loadAndOrder("id"))},"#"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[3]||(s[3]=a=>t.loadAndOrder("title"))},"Название"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[4]||(s[4]=a=>t.loadAndOrder("subtitle"))},"Подзаголовок"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[5]||(s[5]=a=>t.loadAndOrder("address"))},"Адрес"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[6]||(s[6]=a=>t.loadAndOrder("description"))},"Описание"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[7]||(s[7]=a=>t.loadAndOrder("is_group"))},"Групповое"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[8]||(s[8]=a=>t.loadAndOrder("updated_at"))},"Дата изменения"),y5])]),e("tbody",null,[(l(!0),n(v,null,y(t.events,(a,i)=>(l(),n("tr",{class:b({"border-info":a.deleted_at==null,"border-danger":a.deleted_at!=null})},[e("th",k5,u(a.id),1),e("td",{onClick:d=>t.selectEvent(a)},u(a.title||"Не указано"),9,F5),e("td",null,u(a.subtitle||"Не указано"),1),e("td",null,u(a.address||"Не указано"),1),e("td",null,u(a.description||"Не указано"),1),e("td",null,[a.is_group?(l(),n("i",w5)):(l(),n("i",C5))]),e("td",null,u(t.$filters.current(a.updated_at)),1),e("td",null,[a.id?(l(),n("div",S5,[j5,e("ul",V5,[a.deleted_at==null?(l(),n("li",q5,[e("a",{class:"dropdown-item",onClick:d=>t.removeAppointmentEvent(a.id),href:"javascript:void(0)"},"Удалить",8,z5)])):r("",!0),a.deleted_at==null?(l(),n("li",P5,[e("a",{class:"dropdown-item",onClick:d=>t.duplicateAppointmentEvent(a.id),href:"javascript:void(0)"},"Дублировать",8,U5)])):r("",!0)])])):r("",!0)])],2))),256))])])):(l(),n("p",O5,"На текущий момент нет событий в вашем списке"))]),e("div",A5,[t.paginate_object?(l(),$(j,{key:0,onPagination_page:t.nextAppointmentEvents,pagination:t.paginate_object},null,8,["onPagination_page","pagination"])):r("",!0)])]))}}),T5={class:"row"},B5={class:"col-12"},R5={key:0,class:"table"},M5=e("th",{scope:"col"},"Действие",-1),D5={scope:"row"},E5=["onClick"],L5={key:0,class:"fa-solid fa-chevron-down text-success"},K5={key:1,class:"fa-solid fa-xmark text-danger"},N5={key:0,class:"dropdown"},J5=e("button",{class:"btn btn-outline-secondary",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-solid fa-ellipsis"})],-1),H5={class:"dropdown-menu"},Y5={key:0},G5=["onClick"],W5={key:1},X5={class:"col-12"},Z5={props:["bot","eventId"],data(){return{direction:"desc",order:"updated_at",show:!0,is_group:!1,loading:!0,services:[],search:null,paginate_object:null}},computed:{...C(["getAppointmentServices","getAppointmentServicesPaginateObject"])},mounted(){this.loadAppointmentServices()},methods:{nextAppointmentService(o){this.loadAppointmentServices(o)},selectService(o){this.$emit("select",o)},removeAppointmentService(o){this.loading=!0,this.$store.dispatch("removeAppointmentService",{dataObject:{appointmentServiceId:o}}).then(t=>{this.loading=!1,this.loadAppointmentServices(0),this.$notify("Сервис успешно удален")}).catch(()=>{this.loading=!1,this.$notify("Ошибка удаления сервиса")})},loadAndOrder(o){this.order=o,this.direction=this.direction==="desc"?"asc":"desc",this.loadAppointmentServices(0)},loadAppointmentServices(o=0){this.loading=!0,this.$store.dispatch("loadAppointmentServices",{dataObject:{event_id:this.eventId,bot_id:this.bot.id||null,search:this.search,order:this.order,direction:this.direction},page:o,size:100}).then(t=>{this.loading=!1,this.services=this.getAppointmentServices,this.paginate_object=this.getAppointmentServicesPaginateObject}).catch(()=>{this.loading=!1})}}},x5=Object.assign(Z5,{__name:"AppointmentServicesTable",setup(o){return(t,s)=>(l(),n("div",T5,[e("div",B5,[t.services.length>0?(l(),n("table",R5,[e("thead",null,[e("tr",null,[e("th",{scope:"col",class:"cursor-pointer",onClick:s[0]||(s[0]=a=>t.loadAndOrder("id"))},"#"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[1]||(s[1]=a=>t.loadAndOrder("title"))},"Название"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[2]||(s[2]=a=>t.loadAndOrder("subtitle"))},"Подзаголовок"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[3]||(s[3]=a=>t.loadAndOrder("description"))},"Описание"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[4]||(s[4]=a=>t.loadAndOrder("is_group"))},"Групповое"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[5]||(s[5]=a=>t.loadAndOrder("updated_at"))},"Дата изменения"),M5])]),e("tbody",null,[(l(!0),n(v,null,y(t.services,(a,i)=>(l(),n("tr",{class:b({"border-info":a.deleted_at==null,"border-danger":a.deleted_at!=null})},[e("th",D5,u(a.id),1),e("td",{onClick:d=>t.selectService(a)},u(a.title||"Не указано"),9,E5),e("td",null,u(a.subtitle||"Не указано"),1),e("td",null,u(a.description||"Не указано"),1),e("td",null,[a.is_group?(l(),n("i",L5)):(l(),n("i",K5))]),e("td",null,u(t.$filters.current(a.updated_at)),1),e("td",null,[a.id?(l(),n("div",N5,[J5,e("ul",H5,[a.deleted_at==null?(l(),n("li",Y5,[e("a",{class:"dropdown-item",onClick:d=>t.removeAppointmentService(a.id),href:"javascript:void(0)"},"Удалить",8,G5)])):r("",!0)])])):r("",!0)])],2))),256))])])):(l(),n("p",W5,"На текущий момент нет ни одного созданого сервиса"))]),e("div",X5,[t.paginate_object?(l(),$(j,{key:0,onPagination_page:t.nextAppointmentService,pagination:t.paginate_object},null,8,["onPagination_page","pagination"])):r("",!0)])]))}}),ew={class:"row"},tw={class:"col-12 mb-3"},sw={class:"form-label",id:"event-title"},ow=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),lw=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),nw={class:"col-12 mb-3"},iw={class:"form-label",id:"event-subtitle"},aw=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),dw=e("div",null,"Подзаголовок события или доп. инфа под названием события ",-1),rw=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),cw={class:"col-12 mb-3"},uw={class:"form-check"},mw=e("label",{class:"form-check-label",for:"need_add_address"}," Нужно указать адрес и координат мероприятия ",-1),_w={key:0,class:"col-12 mb-3"},hw={class:"form-label",id:"event-address"},pw=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),bw=e("div",null,"Адрес, указывающий точное место проведения события \\ мероприятия ",-1),fw={key:1,class:"col-12 mb-3"},gw={class:"form-label",id:"event-coords"},vw=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),$w=e("div",null,"Координаты мероприятия ",-1),yw={class:"col-12 mb-3"},kw={class:"form-label",id:"event-description"},Fw=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),ww=e("div",null," Краткая информация о происходящем мероприятии ",-1),Cw=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),Sw={key:0,class:"text-gray-400 ml-3",style:{"font-size":"10px"}},jw={class:"col-12 mb-3"},Vw={class:"form-label",id:"event-on_start_appointment"},qw=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),zw=e("div",null," Текст, который будет отображен клиенту, когда тот записался ",-1),Pw=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),Uw={key:0,class:"text-gray-400 ml-3",style:{"font-size":"10px"}},Ow={class:"col-12 mb-3"},Aw={class:"form-label",id:"event-on_cancel_appointment"},Iw=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),Qw=e("div",null," Текст, который будет отображен клиенту, когда тот отменил запись ",-1),Tw=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),Bw={key:0,class:"text-gray-400 ml-3",style:{"font-size":"10px"}},Rw={class:"col-12 mb-3"},Mw={class:"form-label",id:"event-on_after_appointment"},Dw=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),Ew=e("div",null," Текст, который будет отображен клиенту, когда тот прошел событие успешно ",-1),Lw=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),Kw={key:0,class:"text-gray-400 ml-3",style:{"font-size":"10px"}},Nw={class:"col-12 mb-3"},Jw={class:"form-label",id:"event-on_repeat_appointment"},Hw=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),Yw=e("div",null," Текст, который будет отображен клиенту, когда тот записывается 2й и более раз ",-1),Gw=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),Ww={key:0,class:"text-gray-400 ml-3",style:{"font-size":"10px"}},Xw={class:"col-12 mb-3"},Zw={class:"form-check"},xw=e("label",{class:"form-check-label",for:"need_media"}," Нужно изображение к событию ",-1),eC={key:2,class:"col-12 mb-3"},tC={class:"form-label",id:"event-images"},sC=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),oC=e("div",null," Изображение, которое видит пользователь при выборе события ",-1),lC=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),nC={class:"col-12 mb-3"},iC={class:"form-check"},aC=e("label",{class:"form-check-label",for:"is-group"}," Является групповым мероприятием ",-1),dC={key:3,class:"col-md-6 col-12 mb-3"},rC={class:"form-label",id:"event-min_people"},cC=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),uC=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),mC={key:4,class:"col-md-6 col-12 mb-3"},_C={class:"form-label",id:"event-max_people"},hC=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),pC=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),bC={class:"row"},fC={class:"col-12"},gC={type:"submit",class:"btn btn-outline-success w-100 p-3"},vC={key:0},$C={key:1},yC={props:["event","bot"],data(){return{step:0,load:!1,need_reset:!1,need_services:!1,need_add_address:!1,need_media:!1,eventForm:{id:null,title:null,subtitle:null,description:null,address:null,coords:null,images:[],services:[],times:[],is_group:!1,max_people:0,min_people:0,on_start_appointment:null,on_cancel_appointment:null,on_after_appointment:null,on_repeat_appointment:null}}},watch:{eventForm:{handler(o){this.need_reset=!0},deep:!0}},mounted(){this.event&&this.$nextTick(()=>{this.eventForm={id:this.event.id||null,title:this.event.title||null,subtitle:this.event.subtitle||null,description:this.event.description||null,images:this.event.images||[],is_group:this.event.is_group||!1,address:this.event.address||null,coords:this.event.coords||null,max_people:this.event.max_people||0,min_people:this.event.min_people||0,on_start_appointment:this.event.on_start_appointment||null,on_cancel_appointment:this.event.on_cancel_appointment||null,on_after_appointment:this.event.on_after_appointment||null,on_repeat_appointment:this.event.on_repeat_appointment||null}})},methods:{selectPhotos(o){this.eventForm.images||(this.eventForm.images=[]);let t=this.eventForm.images.indexOf(o.file_id);t!==-1?this.eventForm.images.splice(t,1):this.eventForm.images.push(o.file_id)},resetForm(){},submitForm(){let o=new FormData;Object.keys(this.eventForm).forEach(t=>{const s=this.eventForm[t]||"";typeof s=="object"?o.append(t,JSON.stringify(s)):o.append(t,s)}),o.append("bot_id",this.bot.id),this.$store.dispatch(this.eventForm.id===null?"addAppointmentEvent":"updateAppointmentEvent",{appointmentEventForm:o}).then(t=>{this.$emit("callback",t.data),this.$nextTick(()=>{this.eventForm={id:null,title:null,subtitle:null,description:null,address:null,coords:null,images:[],services:[],times:[],is_group:!1,max_people:0,min_people:0,on_start_appointment:null,on_cancel_appointment:null,on_after_appointment:null,on_repeat_appointment:null}}),this.$notify("Событие успешно создано")}).catch(t=>{this.$notify("Ошибка создания события")})}}},Z=Object.assign(yC,{__name:"AppointmentEventForm",setup(o){return(t,s)=>{const a=V("Popper"),i=I("mask");return l(),n("form",{onSubmit:s[14]||(s[14]=S((...d)=>t.submitForm&&t.submitForm(...d),["prevent"]))},[e("div",ew,[e("div",tw,[e("label",sw,[f(a,{content:"Название вашего события (или специалиста), на которое планируется осуществить запись"},{default:g(()=>[ow]),_:1}),m(" Название события "),lw]),c(e("input",{type:"text",class:"form-control",placeholder:"Название","aria-label":"Название","onUpdate:modelValue":s[0]||(s[0]=d=>t.eventForm.title=d),maxlength:"255","aria-describedby":"event-title",required:""},null,512),[[h,t.eventForm.title]])]),e("div",nw,[e("label",iw,[f(a,null,{content:g(()=>[dw]),default:g(()=>[aw]),_:1}),m(" Подзаголовок события "),rw]),c(e("input",{type:"text",class:"form-control",placeholder:"Подзаголовок","aria-label":"Подзаголовок","onUpdate:modelValue":s[1]||(s[1]=d=>t.eventForm.subtitle=d),maxlength:"255","aria-describedby":"event-subtitle",required:""},null,512),[[h,t.eventForm.subtitle]])]),e("div",cw,[e("div",uw,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[2]||(s[2]=d=>t.need_add_address=d),type:"checkbox",id:"need_add_address"},null,512),[[k,t.need_add_address]]),mw])]),t.need_add_address?(l(),n("div",_w,[e("label",hw,[f(a,null,{content:g(()=>[bw]),default:g(()=>[pw]),_:1}),m(" Адрес события \\ мероприятия ")]),c(e("input",{type:"text",class:"form-control",placeholder:"Адрес события","aria-label":"Адрес события","onUpdate:modelValue":s[3]||(s[3]=d=>t.eventForm.address=d),maxlength:"255","aria-describedby":"event-address",required:""},null,512),[[h,t.eventForm.address]])])):r("",!0),t.need_add_address?(l(),n("div",fw,[e("label",gw,[f(a,null,{content:g(()=>[$w]),default:g(()=>[vw]),_:1}),m(" Координаты мероприятия: широта, долгота ")]),c(e("input",{type:"text",class:"form-control",placeholder:"00.0000,00.0000","aria-label":"Координаты события","onUpdate:modelValue":s[4]||(s[4]=d=>t.eventForm.coords=d),maxlength:"255","aria-describedby":"event-coords",required:""},null,512),[[h,t.eventForm.coords],[i,"##.####,##.####"]])])):r("",!0),e("div",yw,[e("label",kw,[f(a,null,{content:g(()=>[ww]),default:g(()=>[Fw]),_:1}),m(" Описание события "),Cw,t.eventForm.description?(l(),n("small",Sw," Длина текста "+u(t.eventForm.description.length)+"/255",1)):r("",!0)]),c(e("textarea",{type:"text",class:"form-control",placeholder:"Описание мероприятия","aria-label":"Описание мероприятия",maxlength:"255","onUpdate:modelValue":s[5]||(s[5]=d=>t.eventForm.description=d),"aria-describedby":"event-description",required:""},`
                    `,512),[[h,t.eventForm.description]])]),e("div",jw,[e("label",Vw,[f(a,null,{content:g(()=>[zw]),default:g(()=>[qw]),_:1}),m(" Текст при записи на событие "),Pw,t.eventForm.on_start_appointment?(l(),n("small",Uw," Длина текста "+u(t.eventForm.on_start_appointment.length)+"/255",1)):r("",!0)]),c(e("textarea",{type:"text",class:"form-control",placeholder:"Текст при записи на событие","aria-label":"Текст при записи на событие","onUpdate:modelValue":s[6]||(s[6]=d=>t.eventForm.on_start_appointment=d),maxlength:"255","aria-describedby":"event-on_start_appointment",required:""},`
                    `,512),[[h,t.eventForm.on_start_appointment]])]),e("div",Ow,[e("label",Aw,[f(a,null,{content:g(()=>[Qw]),default:g(()=>[Iw]),_:1}),m(" Текст при отмене записи на событие "),Tw,t.eventForm.on_cancel_appointment?(l(),n("small",Bw," Длина текста "+u(t.eventForm.on_cancel_appointment.length)+"/255",1)):r("",!0)]),c(e("textarea",{type:"text",class:"form-control",placeholder:"Текст при отмене записи на событие","aria-label":"Текст при отмене записи на событие","onUpdate:modelValue":s[7]||(s[7]=d=>t.eventForm.on_cancel_appointment=d),maxlength:"255","aria-describedby":"event-on_cancel_appointment",required:""},`
                    `,512),[[h,t.eventForm.on_cancel_appointment]])]),e("div",Rw,[e("label",Mw,[f(a,null,{content:g(()=>[Ew]),default:g(()=>[Dw]),_:1}),m(" Текст после прохождения события "),Lw,t.eventForm.on_after_appointment?(l(),n("small",Kw," Длина текста "+u(t.eventForm.on_after_appointment.length)+"/255",1)):r("",!0)]),c(e("textarea",{type:"text",class:"form-control",placeholder:"Текст после прохождения события","aria-label":"Текст после прохождения события","onUpdate:modelValue":s[8]||(s[8]=d=>t.eventForm.on_after_appointment=d),maxlength:"255","aria-describedby":"event-on_after_appointment",required:""},`
                    `,512),[[h,t.eventForm.on_after_appointment]])]),e("div",Nw,[e("label",Jw,[f(a,null,{content:g(()=>[Yw]),default:g(()=>[Hw]),_:1}),m(" Текст при повторной записи на событие "),Gw,t.eventForm.on_repeat_appointment?(l(),n("small",Ww," Длина текста "+u(t.eventForm.on_repeat_appointment.length)+"/255",1)):r("",!0)]),c(e("textarea",{type:"text",class:"form-control",placeholder:" Текст при повторной записи на событие","aria-label":" Текст при повторной записи на событие","onUpdate:modelValue":s[9]||(s[9]=d=>t.eventForm.on_repeat_appointment=d),maxlength:"255","aria-describedby":"event-on_repeat_appointment",required:""},`
                    `,512),[[h,t.eventForm.on_repeat_appointment]])]),e("div",Xw,[e("div",Zw,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[10]||(s[10]=d=>t.need_media=d),type:"checkbox",id:"need_media"},null,512),[[k,t.need_media]]),xw])]),t.need_media?(l(),n("div",eC,[e("label",tC,[f(a,null,{content:g(()=>[oC]),default:g(()=>[sC]),_:1}),m(" Изображение к событию "),lC]),f(z,{"need-photo":!0,selected:t.eventForm.images,onSelect:t.selectPhotos},null,8,["selected","onSelect"])])):r("",!0),e("div",nC,[e("div",iC,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[11]||(s[11]=d=>t.eventForm.is_group=d),type:"checkbox",id:"is-group"},null,512),[[k,t.eventForm.is_group]]),aC])]),t.eventForm.is_group?(l(),n("div",dC,[e("label",rC,[f(a,{content:"Минимально необходимое число людей, для начала 1 мероприятия"},{default:g(()=>[cC]),_:1}),m(" Минимальное число посетителей в группе "),uC]),c(e("input",{type:"number",class:"form-control",placeholder:"Минимальное число посетителей","aria-label":"Название","onUpdate:modelValue":s[12]||(s[12]=d=>t.eventForm.min_people=d),"aria-describedby":"event-min_people",required:""},null,512),[[h,t.eventForm.min_people]])])):r("",!0),t.eventForm.is_group?(l(),n("div",mC,[e("label",_C,[f(a,{content:"Количество людей, которые могут посетить мероприятие за 1 сеанс"},{default:g(()=>[hC]),_:1}),m(" Максимальное число посетителей в группе "),pC]),c(e("input",{type:"number",class:"form-control",placeholder:"Максимальное число посетителей","aria-label":"Название","onUpdate:modelValue":s[13]||(s[13]=d=>t.eventForm.max_people=d),"aria-describedby":"event-max_people",required:""},null,512),[[h,t.eventForm.max_people]])])):r("",!0)]),e("div",bC,[e("div",fC,[e("button",gC,[t.eventForm.id==null?(l(),n("span",vC,"Создать событие")):(l(),n("span",$C,"Обновить событие"))])])])],32)}}}),kC={class:"row pt-3"},FC={class:"col-md-4"},wC={class:"form-floating mb-3"},CC=e("label",{for:"config-step"},"Шаг, минуты",-1),SC={class:"col-md-4"},jC={class:"form-floating mb-3"},VC=e("label",{for:"config-start-time"},"Начало, часы",-1),qC={class:"col-md-4"},zC={class:"form-floating mb-3"},PC=["min"],UC=e("label",{for:"config-end-time"},"Конец, часы",-1),OC=e("hr",null,null,-1),AC={key:0,class:"row"},IC={class:"col-12 d-flex justify-content-end pb-3"},QC={class:"row"},TC={class:"col-md-4 text-center"},BC={key:0,class:"fa-solid fa-arrow-down-short-wide"},RC={key:1,class:"fa-solid fa-arrow-up-wide-short"},MC={class:"col-md-4 text-center"},DC={key:0,class:"fa-solid fa-arrow-down-short-wide"},EC={key:1,class:"fa-solid fa-arrow-up-wide-short"},LC={class:"col-md-4 text-center"},KC={key:0,class:"fa-solid fa-arrow-down-short-wide"},NC={key:1,class:"fa-solid fa-arrow-up-wide-short"},JC={class:"col-md-4"},HC={class:"form-floating"},YC=["onUpdate:modelValue","id"],GC=["for"],WC={class:"col-md-4"},XC={class:"form-floating"},ZC=["onUpdate:modelValue","id"],xC=["for"],e4={class:"col-md-4"},t4={class:"form-floating"},s4=["onUpdate:modelValue","id"],o4=["for"],l4={class:"row mt-3"},n4={class:"col-12"},i4={class:"row"},a4={class:"col-12"},d4={class:"col-12"},r4={class:"text-center"},c4={class:"row d-flex justify-content-center"},u4={class:"col-md-4"},m4={class:"table"},_4=e("th",{scope:"col"},"#",-1),h4={scope:"col"},p4={scope:"row"},b4=["onClick"],f4={key:0,class:"fa-solid fa-check"},g4={key:1,class:"fa-solid fa-xmark"},v4={components:{VueDatePicker:ae},props:["eventId","bot"],data(){return{date:null,load:!1,step:30,start:8,end:18,order:null,direction:null,paginate_object:null,years:[2024,2025],months:["Январь","Февраль","Март","Апрель","Май","Июнь","Июль","Август","Сентябрь","октябрь","Ноябрь","Декабрь"],days:["Понедельник","Вторник","Среда","Четверг","Пятница","Суббота","Воскресенье"],schedule:[],added_schedule:[]}},watch:{date:{handler:function(o){this.loadAppointmentSchedules()},deep:!0}},computed:{...C(["getAppointmentSchedules","getAppointmentSchedulesPaginateObject"]),currentWeek(){return new Date().getWeek()},currentMonthWeek(){return new Date().getMonthWeek()},currentMonth(){return new Date().getMonth()},currentYear(){return new Date().getFullYear()},times(){let o=this.step,t=[],s=0,a=0;for(let i=0;s<24*60;i++){let d=Math.floor(s/60);if(d>=this.start&&d<=this.end){let _=s%60;t[a]=("0"+d).slice(-2)+":"+("0"+_).slice(-2),a++}s=s+o}return t}},mounted(){this.date=new Date,this.loadAppointmentSchedules()},methods:{removeAppointmentSchedule(o){this.loading=!0,this.$store.dispatch("removeAppointmentSchedule",{dataObject:{appointmentScheduleId:o}}).then(t=>{this.loading=!1,this.loadAppointmentSchedules(0),this.$notify("Время успешно удалено")}).catch(()=>{this.loading=!1,this.$notify("Ошибка удаления времени")})},loadAndOrder(o){this.order=o,this.direction=this.direction==="desc"?"asc":"desc",this.loadAppointmentSchedules(0)},nextAppointmentSchedule(o){this.loadAppointmentSchedules(o)},loadAppointmentSchedules(o=0){this.loading=!0,this.$store.dispatch("loadAppointmentSchedules",{dataObject:{date:this.date||null,event_id:this.eventId,bot_id:this.bot.id||null,order:this.order,direction:this.direction},page:o,size:20}).then(t=>{this.loading=!1,this.schedule=this.getAppointmentSchedules,this.paginate_object=this.getAppointmentSchedulesPaginateObject}).catch(()=>{this.loading=!1})},storeSchedule(){this.$store.dispatch("storeAppointmentSchedule",{dataObject:{schedule:[...this.schedule,...this.added_schedule],bot_id:this.bot.id,appointment_event_id:this.eventId}}).then(()=>{this.$notify("Расписание успешно сохранено"),this.loadAppointmentSchedules(),this.added_schedule=[]}).catch(()=>{this.$notify("Ошибка сохраения расписания")})},inScheduleRow(o){return this.schedule.findIndex(t=>t.start_time==this.times[o])!=-1||this.added_schedule.findIndex(t=>t.start_time==this.times[o])!=-1},inSchedule(o,t){return this.schedule.findIndex(s=>s.day==t&&s.start_time==this.times[o])!=-1||this.added_schedule.findIndex(s=>s.day==t&&s.start_time==this.times[o])!=-1},setScheduleItem(o,t){let s=this.schedule.findIndex(a=>a.day==t&&a.start_time==this.times[o]);if(s!==-1){this.schedule.splice(s,1);return}if(s=this.added_schedule.findIndex(a=>a.day==t&&a.start_time==this.times[o]),s!==-1){this.added_schedule.splice(s,1);return}this.added_schedule.push({day:t,start_time:this.times[o]||null,end_time:this.times[o+1]||null,week:this.date==null?this.currentWeek:new Date(this.date).getWeek(),month:this.date==null?this.currentMonth:new Date(this.date).getMonth(),year:this.date==null?this.currentYear:new Date(this.date).getFullYear()})}}},$4=Object.assign(v4,{__name:"AppointmentScheduleForm",setup(o){return(t,s)=>(l(),n(v,null,[e("div",kC,[e("div",FC,[e("div",wC,[c(e("input",{type:"number",class:"form-control","onUpdate:modelValue":s[0]||(s[0]=a=>t.step=a),min:"0",id:"config-step",placeholder:"30 минут"},null,512),[[h,t.step]]),CC])]),e("div",SC,[e("div",jC,[c(e("input",{type:"number","onUpdate:modelValue":s[1]||(s[1]=a=>t.start=a),min:"0",max:"23",class:"form-control",id:"config-start-time",placeholder:"Часы"},null,512),[[h,t.start]]),VC])]),e("div",qC,[e("div",zC,[c(e("input",{type:"number","onUpdate:modelValue":s[2]||(s[2]=a=>t.end=a),min:t.start,max:"23",class:"form-control",id:"config-end-time",placeholder:"Часы"},null,8,PC),[[h,t.end]]),UC])])]),OC,t.schedule.length>0||t.added_schedule.length>0?(l(),n("div",AC,[e("div",IC,[e("button",{onClick:s[3]||(s[3]=(...a)=>t.storeSchedule&&t.storeSchedule(...a)),class:"btn btn-primary"},"Сохранить текущий график ")]),e("div",QC,[e("div",TC,[e("a",{onClick:s[4]||(s[4]=a=>t.loadAndOrder("day")),href:"javascript:void(0)"},[m("День "),t.order==="day"&&t.direction==="asc"?(l(),n("i",BC)):r("",!0),t.order==="day"&&t.direction==="desc"?(l(),n("i",RC)):r("",!0)])]),e("div",MC,[e("a",{onClick:s[5]||(s[5]=a=>t.loadAndOrder("start_time")),href:"javascript:void(0)"},[m("Начало "),t.order==="start_time"&&t.direction==="asc"?(l(),n("i",DC)):r("",!0),t.order==="start_time"&&t.direction==="desc"?(l(),n("i",EC)):r("",!0)])]),e("div",LC,[e("a",{onClick:s[6]||(s[6]=a=>t.loadAndOrder("end_time")),href:"javascript:void(0)"},[m("Конец "),t.order==="end_time"&&t.direction==="asc"?(l(),n("i",KC)):r("",!0),t.order==="end_time"&&t.direction==="desc"?(l(),n("i",NC)):r("",!0)])])])])):r("",!0),(l(!0),n(v,null,y([...t.schedule,...t.added_schedule],(a,i)=>(l(),n("div",{class:b(["row py-2",{"bg-warning":a.id==null}])},[e("div",JC,[e("div",HC,[c(e("input",{type:"text","onUpdate:modelValue":d=>t.days[a.day-1]=d,class:"form-control",id:"day-of-week-"+i,placeholder:"День недели"},null,8,YC),[[h,t.days[a.day-1]]]),e("label",{for:"day-of-week-"+i},"День недели",8,GC)])]),e("div",WC,[e("div",XC,[c(e("input",{type:"text","onUpdate:modelValue":d=>a.start_time=d,class:"form-control",id:"day-of-start-at-"+i,placeholder:"Время начало"},null,8,ZC),[[h,a.start_time]]),e("label",{for:"day-of-start-at-"+i},"Начало",8,xC)])]),e("div",e4,[e("div",t4,[c(e("input",{type:"text","onUpdate:modelValue":d=>a.end_time=d,class:"form-control",id:"day-of-end-at-"+i,placeholder:"Время окончания"},null,8,s4),[[h,a.end_time]]),e("label",{for:"day-of-end-at-"+i},"Окончание",8,o4)])])],2))),256)),e("div",l4,[e("div",n4,[t.paginate_object?(l(),$(j,{key:0,onPagination_page:t.nextAppointmentSchedule,pagination:t.paginate_object},null,8,["onPagination_page","pagination"])):r("",!0)])]),e("div",i4,[e("div",a4,[e("button",{class:"btn btn-primary",onClick:s[7]||(s[7]=a=>t.schedule=[])},"Очистить таблицу")]),e("div",d4,[e("p",r4,[m(" Год: "),e("strong",null,u(t.currentYear),1),m(" Месяц: "),e("strong",null,u(t.months[t.currentMonth]),1),m(" Неделя: "),e("strong",null,u(t.currentWeek),1)])])]),e("div",c4,[e("div",u4,[f(M(ae),{modelValue:t.date,"onUpdate:modelValue":s[8]||(s[8]=a=>t.date=a)},null,8,["modelValue"])])]),e("table",m4,[e("thead",null,[e("tr",null,[_4,(l(!0),n(v,null,y(t.days,a=>(l(),n("th",h4,u(a),1))),256))])]),e("tbody",null,[(l(!0),n(v,null,y(t.times,(a,i)=>(l(),n("tr",{class:b({"table-light":t.inScheduleRow(i)})},[e("th",p4,u(a),1),(l(),n(v,null,y(7,d=>e("td",null,[e("button",{class:b([{"btn-primary text-white":t.inSchedule(i,d)},"btn btn-outline-primary"]),onClick:_=>t.setScheduleItem(i,d)},[t.inSchedule(i,d)?(l(),n("i",f4)):(l(),n("i",g4))],10,b4)])),64))],2))),256))])])],64))}});(function(){try{if(typeof document<"u"){var o=document.createElement("style");o.appendChild(document.createTextNode(".vue3-star-ratings[data-v-7fab3f62]{width:fit-content;overflow:hidden;position:relative;white-space:nowrap}.vue3-star-ratings *[data-v-7fab3f62]{box-sizing:border-box;margin:0;padding:0;line-height:1}.vue3-star-ratings__inner[data-v-7fab3f62],.vue3-star-ratings__outer[data-v-7fab3f62]{height:inherit}.vue3-star-ratings__outer[data-v-7fab3f62]{position:absolute;top:0;left:0;width:var(--vue3StarRatingOuterWidth);max-width:100%;overflow:hidden;color:var(--vue3StarRatingsOuterColor);transition:width .32s cubic-bezier(.075,.82,.165,1)}.vue3-star-ratings__inner[data-v-7fab3f62]{color:var(--vue3StarRatingsInnerColor)}.vue3-star-ratings__icon[data-v-7fab3f62]{fill:currentColor;width:var(--vue3StarRatingIconSize);aspect-ratio:1;cursor:pointer;display:inline-block}")),document.head.appendChild(o)}}catch(t){console.error("vite-plugin-css-injected-by-js",t)}})();const ue=(o,t)=>{const s=o.__vccOpts||o;for(const[a,i]of t)s[a]=i;return s},y4={},k4={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512.002 512.002"},F4=e("path",{d:"M511.267 197.258a14.995 14.995 0 00-12.107-10.209l-158.723-23.065-70.985-143.827a14.998 14.998 0 00-26.901 0l-70.988 143.827-158.72 23.065a14.998 14.998 0 00-8.312 25.585l114.848 111.954-27.108 158.083a14.999 14.999 0 0021.763 15.812l141.967-74.638 141.961 74.637a15 15 0 0021.766-15.813l-27.117-158.081 114.861-111.955a14.994 14.994 0 003.795-15.375z"},null,-1),w4=[F4];function C4(o,t){return l(),n("svg",k4,w4)}const x=ue(y4,[["render",C4]]),S4={class:"vue3-star-ratings__outer"},j4={class:"vue3-star-ratings__inner"},V4=ge({__name:"Vue3StarRatings",props:{modelValue:{default:0},numberOfStars:{default:5},starColor:{default:"#ff9800"},inactiveColor:{default:"#333333"},starSize:{default:24},disableClick:{type:Boolean},customSvg:{default:x}},emits:["update:modelValue"],setup(o,{emit:t}){const s=o,a=K(()=>s.customSvg||x),i={rounded(w,O){const P=Math.pow(10,O);return Math.round(w*P)/P}},d=ve(),_=K({get(){return s.modelValue},set(w){const O=i.rounded(w,1);t("update:modelValue",O)}});function p(w){if(s.disableClick)return;const O=this.getBoundingClientRect(),{pageX:P}=w,L=P-O.left,me=O.width,_e=s.numberOfStars,he=L/me*_e;_.value=he}const F=K(()=>(_.value<0?0:_.value>s.numberOfStars?s.numberOfStars:_.value)/s.numberOfStars*100);return $e(()=>{var w;const O={"--vue3StarRatingsInnerColor":s.inactiveColor,"--vue3StarRatingsOuterColor":s.starColor,"--vue3StarRatingOuterWidth":`${F.value}%`,"--vue3StarRatingIconSize":`${s.starSize}px`};for(const[P,L]of Object.entries(O))(w=d.value)==null||w.style.setProperty(P,L)}),ye(()=>{var w;(w=d.value)==null||w.addEventListener("click",p)}),ke(()=>{var w;(w=d.value)==null||w.removeEventListener("click",p)}),(w,O)=>(l(),n("div",{class:"vue3-star-ratings",ref_key:"starsContainer",ref:d,style:se({pointerEvents:w.disableClick?"none":"auto"})},[e("div",S4,[(l(!0),n(v,null,y(w.numberOfStars,P=>(l(),$(G(a.value),{key:P,class:"vue3-star-ratings__icon"}))),128))]),e("div",j4,[(l(!0),n(v,null,y(w.numberOfStars,P=>(l(),$(G(a.value),{key:P,class:"vue3-star-ratings__icon"}))),128))])],4))}}),E=ue(V4,[["__scopeId","data-v-7fab3f62"]]),q4={class:"row py-3"},z4={class:"col-12"},P4={class:"row"},U4={class:"col-12"},O4={key:0},A4={key:1},I4={key:0,class:"col-12 mb-3"},Q4={class:"col-12 mb-3"},T4={key:0},B4={key:1},R4={key:1,class:"col-12 mb-3"},M4={class:"col-12 mb-3"},D4={class:"col-12 mb-3"},E4={class:"form-label",id:"event-on_after_appointment"},L4=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),K4=e("div",null," Текст, который пользователь оставляет после прохождения услуги ",-1),N4=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),J4={key:0,class:"text-gray-400 ml-3",style:{"font-size":"10px"}},H4={class:"row"},Y4={class:"col-12"},G4={type:"submit",class:"btn btn-outline-success w-100 p-3"},W4={key:0},X4={key:1},Z4={props:["eventId","bot","review"],components:{vue3starRatings:E},data(){return{step:0,load:!1,selected_schedule_time:null,selected_bot_user:null,need_load_users:!1,need_schedule_time:!1,days:["понедельник","вторник","среду","четверг","пятницу","субботу","воскресенье"],reviewForm:{id:null,appointment_event_id:null,appointment_schedule_id:null,bot_user_id:null,rating:null,text:null}}},watch:{reviewForm:{handler(o){this.need_reset=!0},deep:!0}},mounted(){this.review&&this.$nextTick(()=>{this.reviewForm={id:this.review.id||null,appointment_event_id:this.review.appointment_event_id||null,appointment_schedule_id:this.review.appointment_schedule_id||null,bot_user_id:this.review.bot_user_id||null,rating:this.review.rating||null,text:this.review.text||null},this.selected_schedule_time=this.review.schedule||null,this.selected_bot_user=this.review.botUser||null})},methods:{selectScheduleTime(o){this.selected_schedule_time=o,this.need_schedule_time=!1},selectBotUser(o){this.selected_bot_user=o,this.need_load_users=!1},clearReviewForm(){this.reviewForm={id:null,appointment_event_id:null,appointment_schedule_id:null,bot_user_id:null,rating:null,text:null},this.selected_schedule_time=null,this.selected_bot_user=null},submitForm(){this.reviewForm.bot_user_id=this.selected_bot_user.id,this.reviewForm.appointment_schedule_id=this.selected_schedule_time.id,this.reviewForm.appointment_event_id=this.eventId;let o=new FormData;Object.keys(this.reviewForm).forEach(t=>{const s=this.reviewForm[t]||"";typeof s=="object"?o.append(t,JSON.stringify(s)):o.append(t,s)}),o.append("bot_id",this.bot.id),this.$store.dispatch("storeAppointmentReview",{dataObject:{appointmentReviewForm:o}}).then(t=>{this.$emit("callback",t.data),this.$notify("Отзыв успешно создан"),this.clearReviewForm()}).catch(t=>{this.$notify("Ошибка создания отзыва")})}}},x4=Object.assign(Z4,{__name:"AppointmentReviewForm",setup(o){return(t,s)=>{const a=V("Popper");return l(),n(v,null,[e("div",q4,[e("div",z4,[e("button",{onClick:s[0]||(s[0]=(...i)=>t.clearReviewForm&&t.clearReviewForm(...i)),class:"btn btn-primary"},"Новый отзыв")])]),e("form",{onSubmit:s[5]||(s[5]=S((...i)=>t.submitForm&&t.submitForm(...i),["prevent"]))},[e("div",P4,[e("div",U4,[e("a",{href:"javascript:void(0)",class:"btn btn-link",onClick:s[1]||(s[1]=i=>t.need_load_users=!t.need_load_users)},[t.selected_bot_user==null?(l(),n("span",O4,"Выберите пользователя")):r("",!0),t.selected_bot_user?(l(),n("span",A4," Пользователь "+u(t.selected_bot_user.name||t.selected_bot_user.fio_from_telegram||t.selected_bot_user.telegram_chat_id||"-"),1)):r("",!0)])]),t.need_load_users?(l(),n("div",I4,[f(D,{simple:!0,onSelect:t.selectBotUser},null,8,["onSelect"])])):r("",!0),e("div",Q4,[e("a",{href:"javascript:void(0)",class:"btn btn-link",onClick:s[2]||(s[2]=i=>t.need_schedule_time=!t.need_schedule_time)},[t.selected_schedule_time==null?(l(),n("span",T4,"Выберите время в расписании")):r("",!0),t.selected_schedule_time?(l(),n("span",B4," Запись на "+u(t.days[t.selected_schedule_time.day-1]||"-")+" с "+u(t.selected_schedule_time.start_time||"-")+" до "+u(t.selected_schedule_time.end_time||"-"),1)):r("",!0)])]),t.need_schedule_time?(l(),n("div",R4,[f(ie,{"event-id":o.eventId,bot:o.bot,onSelect:t.selectScheduleTime},null,8,["event-id","bot","onSelect"])])):r("",!0),e("div",M4,[e("p",null," Рейтинг: "+u(t.reviewForm.rating||0),1),f(M(E),{modelValue:t.reviewForm.rating,"onUpdate:modelValue":s[3]||(s[3]=i=>t.reviewForm.rating=i)},null,8,["modelValue"])]),e("div",D4,[e("label",E4,[f(a,null,{content:g(()=>[K4]),default:g(()=>[L4]),_:1}),m(" Текст отзыва "),N4,t.reviewForm.text?(l(),n("small",J4," Длина текста "+u(t.reviewForm.text.length)+"/255",1)):r("",!0)]),c(e("textarea",{type:"text",class:"form-control",placeholder:"Текст отзыва","aria-label":"Текст отзыва","onUpdate:modelValue":s[4]||(s[4]=i=>t.reviewForm.text=i),maxlength:"255","aria-describedby":"review-text",required:""},`
                    `,512),[[h,t.reviewForm.text]])])]),e("div",H4,[e("div",Y4,[e("button",G4,[t.reviewForm.id==null?(l(),n("span",W4,"Оставить отзыв")):(l(),n("span",X4,"Обновить отзыв"))])])])],32)],64)}}}),e8={class:"row"},t8={class:"col-12"},s8={key:0,class:"table"},o8=e("th",{scope:"col"},"Действие",-1),l8=["onClick"],n8={scope:"row"},i8={class:"d-flex align-items-center"},a8={class:"ml-2"},d8={key:0,class:"dropdown"},r8=e("button",{class:"btn btn-outline-secondary",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-solid fa-ellipsis"})],-1),c8={class:"dropdown-menu"},u8={key:0},m8=["onClick"],_8={key:1},h8={class:"col-12"},p8={props:["bot","eventId"],components:{vue3starRatings:E},data(){return{direction:"desc",order:"updated_at",show:!0,is_group:!1,loading:!0,reviews:[],search:null,paginate_object:null}},computed:{...C(["getAppointmentReviews","getAppointmentReviewsPaginateObject"])},mounted(){this.loadAppointmentReviews()},methods:{nextAppointmentReviews(o){this.loadAppointmentReviews(o)},selectReview(o){this.$emit("select",o)},loadAndOrder(o){this.order=o,this.direction=this.direction==="desc"?"asc":"desc",this.loadAppointmentReviews(0)},removeAppointmentReview(o){this.loading=!0,this.$store.dispatch("removeAppointmentReview",{dataObject:{appointmentReviewId:o}}).then(t=>{this.loadAppointmentReviews(0),this.$notify("Сервис успешно удален"),this.loading=!1}).catch(()=>{this.loading=!1,this.$notify("Ошибка удаления сервиса")})},loadAppointmentReviews(o=0){this.loading=!0,this.$store.dispatch("loadAppointmentReviews",{dataObject:{event_id:this.eventId,bot_id:this.bot.id||null,search:this.search,order:this.order,direction:this.direction},page:o,size:100}).then(t=>{this.loading=!1,this.reviews=this.getAppointmentReviews,this.paginate_object=this.getAppointmentReviewsPaginateObject}).catch(()=>{this.loading=!1})}}},b8=Object.assign(p8,{__name:"AppointmentReviewsTable",setup(o){return(t,s)=>(l(),n("div",e8,[e("div",t8,[t.reviews.length>0?(l(),n("table",s8,[e("thead",null,[e("tr",null,[e("th",{scope:"col",class:"cursor-pointer",onClick:s[0]||(s[0]=a=>t.loadAndOrder("id"))},"#"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[1]||(s[1]=a=>t.loadAndOrder("bot_user_id"))},"Пользователь"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[2]||(s[2]=a=>t.loadAndOrder("rating"))},"Рейтинг"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[3]||(s[3]=a=>t.loadAndOrder("text"))},"Текст"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[4]||(s[4]=a=>t.loadAndOrder("updated_at"))},"Дата изменения"),o8])]),e("tbody",null,[(l(!0),n(v,null,y(t.reviews,(a,i)=>(l(),n("tr",{onClick:d=>t.selectReview(a),class:b({"border-info":a.deleted_at==null,"border-danger":a.deleted_at!=null})},[e("th",n8,u(a.id),1),e("td",null,u(a.botUser.fio_from_telegram||a.botUser.telegram_chat_id||"Не указано"),1),e("td",null,[e("p",i8,[f(M(E),{disableClick:!0,modelValue:a.rating,"onUpdate:modelValue":d=>a.rating=d},null,8,["modelValue","onUpdate:modelValue"]),e("span",a8,u(a.rating||0),1)])]),e("td",null,u(a.text||"Не указано"),1),e("td",null,u(t.$filters.current(a.updated_at)),1),e("td",null,[a.id?(l(),n("div",d8,[r8,e("ul",c8,[a.deleted_at==null?(l(),n("li",u8,[e("a",{class:"dropdown-item",onClick:d=>t.removeAppointmentReview(a.id),href:"javascript:void(0)"},"Удалить",8,m8)])):r("",!0)])])):r("",!0)])],10,l8))),256))])])):(l(),n("p",_8,"На текущий момент нет ни одного созданного отзыва"))]),e("div",h8,[t.paginate_object?(l(),$(j,{key:0,onPagination_page:t.nextAppointmentReviews,pagination:t.paginate_object},null,8,["onPagination_page","pagination"])):r("",!0)])]))}}),f8={key:0,class:"py-2"},g8={class:"row"},v8={class:"col-12"},$8={key:1,class:"py-2"},y8={class:"row"},k8={class:"col-12"},F8={key:2,class:"py-2"},w8={class:"row"},C8={class:"col-12"},S8={class:"nav nav-tabs justify-content-center"},j8={key:0,class:"row py-3"},V8={class:"col-12"},q8={key:1,class:"row py-3"},z8={class:"col-12"},P8={class:"col-12 py-3"},U8=e("h4",null,"Доступные сервисы в событии",-1),O8={key:2,class:"row"},A8={class:"col-12"},I8={key:3,class:"row"},Q8={class:"col-12"},T8={class:"col-12 py-3"},B8=e("h4",null,"Актуальные записи на событие",-1),R8={key:4,class:"row"},M8={class:"col-12"},D8={class:"col-12 py-3"},E8=e("h4",null,"Отзывы к событию",-1),L8={props:["bot"],data(){return{part:0,tab:0,loadTable:!1,loadService:!1,loadReviewForm:!1,loadAppointments:!1,loadReviews:!1,loadAppointmentForm:!1,loadForm:!1,selectedEvent:null,selectedService:null,selectedAppointment:null,selectedReview:null}},computed:{...C(["getAppointmentEvents","getAppointmentEventsPaginateObject"])},mounted(){},methods:{callbackForm(){this.loadTable=!0,this.$nextTick(()=>{this.loadTable=!1})},callbackAppointment(){this.loadAppointments=!0,this.$nextTick(()=>{this.loadAppointments=!1})},callbackReview(){this.loadReviews=!0,this.$nextTick(()=>{this.loadReviews=!1})},createEvent(){this.part=2},selectAppointment(o){this.loadAppointmentForm=!0,this.selectedAppointment=o,this.$nextTick(()=>{this.loadAppointmentForm=!1})},selectService(o){this.loadService=!0,this.selectedService=o,this.$nextTick(()=>{this.loadService=!1})},selectReview(o){this.loadReviewForm=!0,this.selectedReview=o,this.$nextTick(()=>{this.loadReviewForm=!1})},selectEvent(o){this.loadForm=!0,this.$nextTick(()=>{this.loadForm=!1,this.selectedEvent=o,this.part=1,this.tab=0})}}},K8=Object.assign(L8,{__name:"Appointment",setup(o){return(t,s)=>(l(),n(v,null,[t.part===0?(l(),n("div",f8,[e("div",g8,[e("div",v8,[e("button",{type:"button",onClick:s[0]||(s[0]=(...a)=>t.createEvent&&t.createEvent(...a)),class:"btn btn-primary"}," Создать новое событие ")])]),t.loadTable?r("",!0):(l(),$(Q5,{key:0,onSelect:t.selectEvent,bot:o.bot},null,8,["onSelect","bot"]))])):r("",!0),t.part===2?(l(),n("div",$8,[e("div",y8,[e("div",k8,[e("button",{type:"button",onClick:s[1]||(s[1]=a=>t.part=0),class:"btn btn-outline-primary"}," Назад ")])]),t.loadForm?r("",!0):(l(),$(Z,{key:0,onCallback:t.callbackForm,bot:o.bot},null,8,["onCallback","bot"]))])):r("",!0),t.part===1?(l(),n("div",F8,[e("div",w8,[e("div",C8,[e("button",{type:"button",onClick:s[2]||(s[2]=a=>t.part=0),class:"btn btn-outline-primary"}," Назад ")])]),e("ul",S8,[e("li",{class:"nav-item",onClick:s[3]||(s[3]=a=>t.tab=0)},[e("a",{class:b(["nav-link",{active:t.tab===0}]),"aria-current":"page",href:"javascript:void(0)"},"Информация о событии",2)]),e("li",{class:"nav-item",onClick:s[4]||(s[4]=a=>t.tab=1)},[e("a",{class:b(["nav-link",{active:t.tab===1}]),href:"javascript:void(0)"},"Сервисы в событии",2)]),e("li",{class:"nav-item",onClick:s[5]||(s[5]=a=>t.tab=2)},[e("a",{class:b(["nav-link",{active:t.tab===2}]),href:"javascript:void(0)"},"График",2)]),e("li",{class:"nav-item",onClick:s[6]||(s[6]=a=>t.tab=3)},[e("a",{class:b(["nav-link",{active:t.tab===3}]),href:"javascript:void(0)"},"Записи на событие",2)]),e("li",{class:"nav-item",onClick:s[7]||(s[7]=a=>t.tab=4)},[e("a",{class:b(["nav-link",{active:t.tab===4}]),href:"javascript:void(0)"},"Отзывы о событии",2)])]),t.tab===0?(l(),n("div",j8,[e("div",V8,[t.loadForm?r("",!0):(l(),$(Z,{key:0,onCallback:t.callbackForm,event:t.selectedEvent,bot:o.bot},null,8,["onCallback","event","bot"]))])])):r("",!0),t.tab===1?(l(),n("div",q8,[e("div",z8,[t.loadService?r("",!0):(l(),$(pt,{key:0,service:t.selectedService,"event-id":t.selectedEvent.id,bot:o.bot},null,8,["service","event-id","bot"]))]),e("div",P8,[U8,f(x5,{"event-id":t.selectedEvent.id,onSelect:t.selectService,bot:o.bot},null,8,["event-id","onSelect","bot"])])])):r("",!0),t.tab===2?(l(),n("div",O8,[e("div",A8,[f($4,{"event-id":t.selectedEvent.id,bot:o.bot},null,8,["event-id","bot"])])])):r("",!0),t.tab===3?(l(),n("div",I8,[e("div",Q8,[t.loadAppointmentForm?r("",!0):(l(),$(xF,{key:0,bot:o.bot,onCallback:t.callbackAppointment,"event-id":t.selectedEvent.id,appointment:t.selectedAppointment},null,8,["bot","onCallback","event-id","appointment"]))]),e("div",T8,[B8,t.loadAppointments?r("",!0):(l(),$(p5,{key:0,"event-id":t.selectedEvent.id,onSelect:t.selectAppointment,bot:o.bot},null,8,["event-id","onSelect","bot"]))])])):r("",!0),t.tab===4?(l(),n("div",R8,[e("div",M8,[t.loadReviewForm?r("",!0):(l(),$(x4,{key:0,review:t.selectedReview,bot:o.bot,onCallback:s[8]||(s[8]=a=>t.callbackReview()),"event-id":t.selectedEvent.id},null,8,["review","bot","event-id"]))]),e("div",D8,[E8,t.loadReviews?r("",!0):(l(),$(b8,{key:0,bot:o.bot,onSelect:t.selectReview,"event-id":t.selectedEvent.id},null,8,["bot","onSelect","event-id"]))])])):r("",!0)])):r("",!0)],64))}}),N8={props:["param"],data(){return{htmlInjections:[{title:"Кнопка синяя",value:"<a href='http://test.com/test' class='w-100 btn btn-primary'>Текст кнопки</a>"},{title:"Кнопка без цвета",value:"<a href='http://test.com/test' class='w-100 btn btn-link'>Текст кнопки</a>"},{title:"Кнопка с синей обводкой",value:"<a href='http://test.com/test' class='w-100 btn btn-outline-primary'>Текст кнопки</a>"}]}},mounted(){},methods:{attachTo(o){this.$emit("callback",{param:this.param||null,value:o})}}},J8={class:"dropdown"},H8=e("button",{class:"btn btn-link dropdown-toggle",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"}," Кнопки ",-1),Y8={class:"dropdown-menu"},G8=["onClick"],W8={class:"dropdown-item",href:"javascript:void(0)"};function X8(o,t,s,a,i,d){return l(),n("div",J8,[H8,e("ul",Y8,[(l(!0),n(v,null,y(i.htmlInjections,_=>(l(),n("li",{onClick:p=>d.attachTo(_.value)},[e("a",W8,u(_.title||"Не указано"),1)],8,G8))),256))])])}const R=U(N8,[["render",X8]]),Z8={class:"row"},x8={class:"col-12 mb-3"},e6={class:"form-label",id:"quiz-title"},t6=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),s6=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),o6={class:"col-12 mb-3"},l6={class:"form-check"},n6=e("label",{class:"form-check-label",for:"need_media"}," Нужен медиа-контент ",-1),i6={key:0,class:"col-12 mb-3"},a6={class:"form-label",id:"quiz-images"},d6=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),r6=e("div",null," Изображение, которое видит пользователь при выборе квиза ",-1),c6=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),u6={class:"col-12 mb-3"},m6={class:"form-label",id:"quiz-description"},_6=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),h6=e("div",null," Краткая информация о квизе ",-1),p6=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),b6={key:0,class:"text-gray-400 ml-3",style:{"font-size":"10px"}},f6={class:"col-12 mb-3"},g6={class:"form-check"},v6=e("label",{class:"form-check-label",for:"polling_mode"}," Квиз в режиме опроса (без команд и таймеров) ",-1),$6={key:1,class:"col-12 mb-3"},y6={class:"form-label",id:"quiz-time_limit"},k6=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),F6=e("div",null," Время на ответ ",-1),w6=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),C6={class:"col-12 mb-3"},S6={class:"form-check"},j6=e("label",{class:"form-check-label",for:"is-group"}," Показывать ответы по окончанию раунда ",-1),V6={class:"col-12 mb-3"},q6={class:"form-check"},z6=e("label",{class:"form-check-label",for:"is_active"}," Квиз виден пользователям ",-1),P6={key:2,class:"col-12 mb-3"},U6={class:"form-check"},O6=e("label",{class:"form-check-label",for:"round_mode"}," Использовать систему раундов ",-1),A6={class:"col-12 mb-3"},I6={class:"form-label",id:"quiz-time_limit"},Q6=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),T6=e("div",null," Число попыток прохождения квиза ",-1),B6=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),R6={class:"col-12 mb-3"},M6={class:"form-label",id:"quiz-time_limit"},D6=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),E6=e("div",null," Сколько % нужно ответить чтоб пройти ",-1),L6=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),K6={class:"row"},N6={class:"col-12 py-2"},J6={class:"col-12 mb-3"},H6={class:"row"},Y6={class:"col-10"},G6={class:"d-flex justify-content-between"},W6={class:"form-label",id:"quiz-success_message"},X6=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),Z6=e("div",null," Текст в случае успешного прохождения квиза ",-1),x6=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),e7={key:0,class:"text-gray-400 ml-3",style:{"font-size":"10px"}},t7=["onUpdate:modelValue"],s7={class:"col-2 d-flex align-items-center justify-content-center"},o7=["disabled","onClick"],l7={class:"row"},n7={class:"col-12 mb-2"},i7={class:"form-check"},a7=e("label",{class:"form-check-label",for:"need_inline_menu_on_success"}," Меню под текстом страницы при выигрыше ",-1),d7={key:0,class:"col-12 mb-2"},r7={class:"card"},c7={class:"card-header d-flex justify-between align-items-center"},u7=e("h6",null,"Конструктор меню в сообщении",-1),m7={key:0},_7={key:1},h7={class:"card-body"},p7={class:"row"},b7={class:"col-12 py-2"},f7={class:"col-12 mb-3"},g7={class:"row"},v7={class:"col-10"},$7={class:"d-flex justify-content-between"},y7=["id"],k7=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),F7=e("div",null," Текст в случае неудачного прохождения квиза ",-1),w7=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),C7={key:0,class:"text-gray-400 ml-3",style:{"font-size":"10px"}},S7=["onUpdate:modelValue"],j7={class:"col-2 d-flex align-items-center justify-content-center"},V7=["disabled","onClick"],q7={class:"row"},z7={class:"col-12 mb-2"},P7={class:"form-check"},U7=e("label",{class:"form-check-label",for:"need_template_selector_on_failure"}," Меню под текстом страницы при проигрыше ",-1),O7={key:0,class:"col-12 mb-2"},A7={class:"card"},I7={class:"card-header d-flex justify-between align-items-center"},Q7=e("h6",null,"Конструктор меню в сообщении",-1),T7={key:0},B7={key:1},R7={class:"card-body"},M7={class:"row"},D7={class:"col-12 mb-3"},E7={class:"form-floating"},L7=["value","selected"],K7=e("label",{for:"quiz-display-type"},"Тип вывода вопросов",-1),N7={class:"row"},J7={class:"col-12"},H7={type:"submit",class:"btn btn-outline-success w-100 p-3"},Y7={key:0},G7={key:1},W7={props:["quiz","bot"],data(){return{step:0,load:!1,need_reset:!1,need_services:!1,need_media:!1,need_inline_menu_on_success:!1,need_template_selector_on_success:!1,need_template_selector_on_failure:!1,need_inline_menu_on_failure:!1,types:["По порядку","Перемешать всё","Перемешать ответы","Перемешать вопросы"],quizForm:{id:null,title:null,image:null,description:null,completed_at:null,start_at:null,end_at:null,display_type:0,time_limit:30,show_answers:!1,polling_mode:!1,round_mode:!0,is_active:!1,try_count:1,success_percent:50,success_message:["Задание успешно пройдено!"],failure_message:["К сожалению вы не прошли задание!"],success_inline_keyboard_id:null,success_inline_keyboard:null,failure_inline_keyboard_id:null,failure_inline_keyboard:null}}},watch:{quizForm:{handler(o){this.need_reset=!0},deep:!0},"quizForm.polling_mode":{handler(o){this.quizForm.round_mode=!1},deep:!0}},mounted(){this.quiz&&this.$nextTick(()=>{this.quizForm={id:this.quiz.id||null,title:this.quiz.title||null,image:this.quiz.image||null,description:this.quiz.description||null,completed_at:this.quiz.completed_at?this.$filters.currentFull(this.quiz.completed_at):null,start_at:this.quiz.start_at?this.$filters.currentFull(this.quiz.start_at):null,end_at:this.quiz.end_at?this.$filters.currentFull(this.quiz.end_at):null,display_type:this.quiz.display_type||0,time_limit:this.quiz.time_limit||30,show_answers:this.quiz.show_answers||!1,polling_mode:this.quiz.polling_mode||!1,round_mode:this.quiz.round_mode||!1,is_active:this.quiz.is_active||!1,try_count:this.quiz.try_count||1,success_inline_keyboard_id:this.quiz.success_inline_keyboard_id||null,success_inline_keyboard:this.quiz.success_inline_keyboard||null,failure_inline_keyboard_id:this.quiz.failure_inline_keyboard_id||null,failure_inline_keyboard:this.quiz.failure_inline_keyboard||null,success_percent:this.quiz.success_percent||50,success_message:this.quiz.success_message||["Задание успешно пройдено!"],failure_message:this.quiz.failure_message||["К сожалению вы не прошли задание!"]},this.quizForm.success_inline_keyboard&&(this.need_inline_menu_on_success=!0),this.quizForm.failure_inline_keyboard&&(this.need_inline_menu_on_failure=!0)})},methods:{selectInlineKeyboardOnSuccess(o){this.quizForm.success_inline_keyboard=o,this.need_template_selector_on_success=!1},selectInlineKeyboardOnFailure(o){this.quizForm.failure_inline_keyboard=o,this.need_template_selector_on_failure=!1},attachTo(o,t){this.quizForm[o.param][t]==null?this.quizForm[o.param][t]=o.value:this.quizForm[o.param][t]+=o.value},selectPhoto(o){this.quizForm.image=o.file_id},removeMessage(o,t){this.quizForm[o||"success_message"].splice(t,1)},addMessage(o,t){this.quizForm[o||"success_message"].push(t)},submitForm(){let o=new FormData;Object.keys(this.quizForm).forEach(t=>{const s=this.quizForm[t]||"";typeof s=="object"?o.append(t,JSON.stringify(s)):o.append(t,s)}),o.append("bot_id",this.bot.id),this.$store.dispatch("storeQuiz",{quizForm:o}).then(t=>{this.quizForm={id:null,title:null,image:null,description:null,completed_at:null,start_at:null,end_at:null,display_type:0,time_limit:30,show_answers:!1,polling_mode:!1,round_mode:!1,is_active:!1,try_count:1,success_percent:50,success_inline_keyboard_id:null,success_inline_keyboard:null,failure_inline_keyboard_id:null,failure_inline_keyboard:null,success_message:["Задание успешно пройдено!"],failure_message:["К сожалению вы не прошли задание!"]},this.$emit("callback",t.data),this.$notify("Событие успешно создано")}).catch(t=>{this.$notify("Ошибка создания события")})}}},ee=Object.assign(W7,{__name:"QuizForm",setup(o){return(t,s)=>{const a=V("Popper");return l(),n("form",{onSubmit:s[19]||(s[19]=S((...i)=>t.submitForm&&t.submitForm(...i),["prevent"])),class:"py-3"},[e("div",Z8,[e("div",x8,[e("label",e6,[f(a,{content:"Название вашего квиза"},{default:g(()=>[t6]),_:1}),m(" Название квиза "),s6]),c(e("input",{type:"text",class:"form-control",placeholder:"Название","aria-label":"Название","onUpdate:modelValue":s[0]||(s[0]=i=>t.quizForm.title=i),maxlength:"255","aria-describedby":"quiz-title",required:""},null,512),[[h,t.quizForm.title]])]),e("div",o6,[e("div",l6,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[1]||(s[1]=i=>t.need_media=i),type:"checkbox",id:"need_media"},null,512),[[k,t.need_media]]),n6])]),t.need_media?(l(),n("div",i6,[e("label",a6,[f(a,null,{content:g(()=>[r6]),default:g(()=>[d6]),_:1}),m(" Изображение к квизу "),c6]),f(z,{"need-photo":!0,selected:t.quizForm.image,onSelect:t.selectPhoto},null,8,["selected","onSelect"])])):r("",!0),e("div",u6,[e("label",m6,[f(a,null,{content:g(()=>[h6]),default:g(()=>[_6]),_:1}),m(" Описание события "),p6,t.quizForm.description?(l(),n("small",b6," Длина текста "+u(t.quizForm.description.length)+"/255",1)):r("",!0)]),c(e("textarea",{class:"form-control",placeholder:"Описание мероприятия","aria-label":"Описание мероприятия",maxlength:"255","onUpdate:modelValue":s[2]||(s[2]=i=>t.quizForm.description=i),"aria-describedby":"quiz-description",required:""},`
                    `,512),[[h,t.quizForm.description]])]),e("div",f6,[e("div",g6,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[3]||(s[3]=i=>t.quizForm.polling_mode=i),type:"checkbox",id:"polling_mode"},null,512),[[k,t.quizForm.polling_mode]]),v6])]),t.quizForm.polling_mode?r("",!0):(l(),n("div",$6,[e("label",y6,[f(a,null,{content:g(()=>[F6]),default:g(()=>[k6]),_:1}),m(" Лимит времени на ответ в секундах "),w6]),c(e("input",{type:"number",class:"form-control",placeholder:"Лимит времени на ответ","aria-label":"Лимит времени на ответ",step:"0.1",min:"0","onUpdate:modelValue":s[4]||(s[4]=i=>t.quizForm.time_limit=i),"aria-describedby":"quiz-time_limit",required:""},null,512),[[h,t.quizForm.time_limit]])])),e("div",C6,[e("div",S6,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[5]||(s[5]=i=>t.quizForm.show_answers=i),type:"checkbox",id:"is-group"},null,512),[[k,t.quizForm.show_answers]]),j6])]),e("div",V6,[e("div",q6,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[6]||(s[6]=i=>t.quizForm.is_active=i),type:"checkbox",id:"is_active"},null,512),[[k,t.quizForm.is_active]]),z6])]),t.quizForm.polling_mode?r("",!0):(l(),n("div",P6,[e("div",U6,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[7]||(s[7]=i=>t.quizForm.round_mode=i),type:"checkbox",id:"round_mode"},null,512),[[k,t.quizForm.round_mode]]),O6])])),e("div",A6,[e("label",I6,[f(a,null,{content:g(()=>[T6]),default:g(()=>[Q6]),_:1}),m(" Количество попыток "),B6]),c(e("input",{type:"number",class:"form-control",placeholder:"Число попыток","aria-label":"Число попыток",step:"1",min:"1","onUpdate:modelValue":s[8]||(s[8]=i=>t.quizForm.try_count=i),"aria-describedby":"quiz-try_count",required:""},null,512),[[h,t.quizForm.try_count]])]),e("div",R6,[e("label",M6,[f(a,null,{content:g(()=>[E6]),default:g(()=>[D6]),_:1}),m(" % для прохождения "),L6]),c(e("input",{type:"number",class:"form-control",placeholder:"Процент для победы","aria-label":"Процент для победы",step:"1",min:"0","onUpdate:modelValue":s[9]||(s[9]=i=>t.quizForm.success_percent=i),"aria-describedby":"quiz-success_percent",required:""},null,512),[[h,t.quizForm.success_percent]])])]),e("div",K6,[e("div",N6,[e("button",{class:"btn btn-outline-info rounded-5",type:"button",onClick:s[10]||(s[10]=i=>t.addMessage("success_message",null))},"Добавить еще вариант текста ")]),(l(!0),n(v,null,y(t.quizForm.success_message,(i,d)=>(l(),n("div",J6,[e("div",H6,[e("div",Y6,[e("div",G6,[e("label",W6,[f(a,null,{content:g(()=>[Z6]),default:g(()=>[X6]),_:1}),m(" Текст при победе "),x6,t.quizForm.success_message[d]?(l(),n("small",e7," Длина текста "+u(t.quizForm.success_message[d].length)+"/255",1)):r("",!0)]),f(R,{param:"success_message",onCallback:_=>t.attachTo(_,d)},null,8,["onCallback"])]),c(e("textarea",{class:"form-control",placeholder:"Текст при победе","aria-label":"Текст при победе",maxlength:"255","onUpdate:modelValue":_=>t.quizForm.success_message[d]=_,"aria-describedby":"quiz-success_message",required:""},`
                    `,8,t7),[[h,t.quizForm.success_message[d]]])]),e("div",s7,[e("button",{class:"btn btn-outline-danger",disabled:t.quizForm.success_message.length<=1,onClick:_=>t.removeMessage("success_message",d)},"Удалить ",8,o7)])])]))),256))]),e("div",l7,[e("div",n7,[e("div",i7,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[11]||(s[11]=i=>t.need_inline_menu_on_success=i),type:"checkbox",id:"need_inline_menu_on_success"},null,512),[[k,t.need_inline_menu_on_success]]),a7])]),t.need_inline_menu_on_success?(l(),n("div",d7,[e("div",r7,[e("div",c7,[u7,e("button",{class:b(["btn",{"btn-outline-primary":!t.need_template_selector_on_success,"btn-primary":t.need_template_selector_on_success}]),type:"button",onClick:s[12]||(s[12]=i=>t.need_template_selector_on_success=!t.need_template_selector_on_success)},[t.need_template_selector_on_success?(l(),n("span",_7," Скрыть шаблоны меню")):(l(),n("span",m7," Открыть шаблоны меню"))],2)]),e("div",h7,[t.need_template_selector_on_success?(l(),$(T,{key:0,class:"mb-2",type:"inline",onSelect:t.selectInlineKeyboardOnSuccess,"select-mode":!0},null,8,["onSelect"])):(l(),$(A,{key:1,type:"inline",modelValue:t.quizForm.success_inline_keyboard,"onUpdate:modelValue":s[13]||(s[13]=i=>t.quizForm.success_inline_keyboard=i)},null,8,["modelValue"]))])])])):r("",!0)]),e("div",p7,[e("div",b7,[e("button",{class:"btn btn-outline-info rounded-5",type:"button",onClick:s[14]||(s[14]=i=>t.addMessage("failure_message",null))},"Добавить еще вариант текста ")]),(l(!0),n(v,null,y(t.quizForm.failure_message,(i,d)=>(l(),n("div",f7,[e("div",g7,[e("div",v7,[e("div",$7,[e("label",{class:"form-label",id:"quiz-failure_message"+d},[f(a,null,{content:g(()=>[F7]),default:g(()=>[k7]),_:1}),m(" Текст при проигрыше "),w7,t.quizForm.failure_message[d]?(l(),n("small",C7," Длина текста "+u(t.quizForm.failure_message[d].length)+"/255",1)):r("",!0)],8,y7),f(R,{param:"failure_message",onCallback:_=>t.attachTo(_,d)},null,8,["onCallback"])]),c(e("textarea",{class:"form-control",placeholder:"Текст при проигрыше","aria-label":"Текст при проигрыше",maxlength:"255","onUpdate:modelValue":_=>t.quizForm.failure_message[d]=_,"aria-describedby":"quiz-success_message",required:""},`
                    `,8,S7),[[h,t.quizForm.failure_message[d]]])]),e("div",j7,[e("button",{class:"btn btn-outline-danger",disabled:t.quizForm.failure_message.length<=1,onClick:_=>t.removeMessage("failure_message",d)},"Удалить ",8,V7)])])]))),256))]),e("div",q7,[e("div",z7,[e("div",P7,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[15]||(s[15]=i=>t.need_inline_menu_on_failure=i),type:"checkbox",id:"need_template_selector_on_failure"},null,512),[[k,t.need_inline_menu_on_failure]]),U7])]),t.need_inline_menu_on_failure?(l(),n("div",O7,[e("div",A7,[e("div",I7,[Q7,e("button",{class:b(["btn",{"btn-outline-primary":!t.need_template_selector_on_failure,"btn-primary":t.need_template_selector_on_failure}]),type:"button",onClick:s[16]||(s[16]=i=>t.need_template_selector_on_failure=!t.need_template_selector_on_failure)},[t.need_template_selector_on_failure?(l(),n("span",B7," Скрыть шаблоны меню")):(l(),n("span",T7," Открыть шаблоны меню"))],2)]),e("div",R7,[t.need_template_selector_on_failure?(l(),$(T,{key:0,class:"mb-2",type:"inline",onSelect:t.selectInlineKeyboardOnFailure,"select-mode":!0},null,8,["onSelect"])):(l(),$(A,{key:1,type:"inline",modelValue:t.quizForm.failure_inline_keyboard,"onUpdate:modelValue":s[17]||(s[17]=i=>t.quizForm.failure_inline_keyboard=i)},null,8,["modelValue"]))])])])):r("",!0)]),e("div",M7,[e("div",D7,[e("div",E7,[c(e("select",{class:"form-select","onUpdate:modelValue":s[18]||(s[18]=i=>t.quizForm.display_type=i),id:"quiz-display-type","aria-label":"quiz-display-type"},[(l(!0),n(v,null,y(t.types,(i,d)=>(l(),n("option",{value:d,selected:d==t.quizForm.display_type},u(i),9,L7))),256))],512),[[Q,t.quizForm.display_type]]),K7])])]),e("div",N7,[e("div",J7,[e("button",H7,[t.quizForm.id==null?(l(),n("span",Y7,"Создать квиз")):(l(),n("span",G7,"Обновить квиз"))])])])],32)}}}),X7={class:"row py-2"},Z7={class:"col-12"},x7={class:"input-group mb-3"},e9={class:"col-12"},t9={key:0,class:"table"},s9=e("th",{scope:"col"},"Число вопросов",-1),o9=e("th",{scope:"col"},"Число команд",-1),l9=e("th",{scope:"col"},"Действие",-1),n9={scope:"row"},i9=["onClick"],a9={key:0,style:{width:"50px",height:"50px"},alt:""},d9={key:1},r9={key:0,class:"mb-0"},c9={key:1},u9={key:0,class:"mb-0"},m9={key:1},_9={key:0,class:"mb-0"},h9={key:1},p9={key:0,class:"fa-solid fa-chevron-down text-success"},b9={key:1,class:"fa-solid fa-xmark text-danger"},f9={key:0,class:"fa-solid fa-chevron-down text-success"},g9={key:1,class:"fa-solid fa-xmark text-danger"},v9={key:0,class:"dropdown"},$9=e("button",{class:"btn btn-outline-secondary",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-solid fa-ellipsis"})],-1),y9={class:"dropdown-menu"},k9={key:0},F9=["onClick"],w9={key:1},C9=e("div",{class:"alert alert-warning alert-dismissible fade show",role:"alert"},[e("strong",null,"Внимание!"),m(" Вы еще не добавили ни одного квиза! "),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"alert","aria-label":"Close"})],-1),S9={class:"position-relative p-5 text-center text-muted bg-body border border-dashed rounded-2"},j9={class:"d-flex justify-content-center mb-3"},V9={alt:"",width:"100",height:"100"},q9=e("h1",{class:"text-body-emphasis"},"Создание Квиза",-1),z9=e("p",{class:"col-lg-8 mx-auto fs-5 text-muted"}," Квиз - это игра. Создавайте игры и делитесь с клиентами ссылкой на игру. Формируйте команды, начисляйте баллы, меняйте баллы на вкусные призы. Всё в ваших руках. ",-1),P9={class:"d-inline-flex gap-2 mb-5"},U9=e("a",{href:"https://telegra.ph/Sozdanie-Kviza-01-13",target:"_blank",class:"d-inline-flex align-items-center btn btn-outline-secondary btn-lg px-4 rounded-pill"}," Подробнее ",-1),O9={key:0,class:"col-12"},A9={props:["bot"],data(){return{direction:"desc",order:"updated_at",show:!0,loading:!0,quizzes:[],search:null,paginate_object:null}},computed:{...C(["getQuizzes","getQuizzesPaginateObject"])},mounted(){this.loadQuizzes()},methods:{removeQuiz(o){this.loading=!0,this.$store.dispatch("removeQuiz",{quizId:o}).then(t=>{this.loading=!1,this.loadQuizzes(0),this.$notify("Событие успешно удалено")}).catch(()=>{this.loading=!1,this.$notify("Ошибка удаления события")})},createQuiz(){this.$emit("create")},nextQuizzes(o){this.loadQuizzes(o)},selectEvent(o){this.$emit("select",o)},loadAndOrder(o){this.order=o,this.direction=this.direction==="desc"?"asc":"desc",this.loadQuizzes(0)},loadQuizzes(o=0){this.loading=!0,this.$store.dispatch("loadQuizzes",{dataObject:{bot_id:this.bot.id||null,search:this.search,order:this.order,direction:this.direction},page:o,size:20}).then(t=>{this.loading=!1,this.quizzes=this.getQuizzes,this.paginate_object=this.getQuizzesPaginateObject}).catch(()=>{this.loading=!1})}}},I9=Object.assign(A9,{__name:"QuizTable",setup(o){return(t,s)=>{const a=I("lazy");return l(),n("div",X7,[e("div",Z7,[e("div",x7,[c(e("input",{type:"search",class:"form-control",placeholder:"Поиск квиза","aria-label":"Поиск квиза","onUpdate:modelValue":s[0]||(s[0]=i=>t.search=i),"aria-describedby":"quiz-search-quiz"},null,512),[[h,t.search]]),e("button",{class:"btn btn-outline-secondary",onClick:s[1]||(s[1]=i=>t.loadQuizzes(0)),type:"button",id:"quiz-search-quiz"},"Найти ")])]),e("div",e9,[t.quizzes.length>0?(l(),n("table",t9,[e("thead",null,[e("tr",null,[e("th",{scope:"col",class:"cursor-pointer",onClick:s[2]||(s[2]=i=>t.loadAndOrder("id"))},"#"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[3]||(s[3]=i=>t.loadAndOrder("title"))},"Название"),s9,o9,e("th",{scope:"col",class:"cursor-pointer",onClick:s[4]||(s[4]=i=>t.loadAndOrder("image"))},"Изображение к квизу"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[5]||(s[5]=i=>t.loadAndOrder("description"))},"Описание"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[6]||(s[6]=i=>t.loadAndOrder("completed_at"))},"Квиз пройден"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[7]||(s[7]=i=>t.loadAndOrder("start_at"))},"Дата и время начала"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[8]||(s[8]=i=>t.loadAndOrder("end_at"))},"Дата и время завершения"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[9]||(s[9]=i=>t.loadAndOrder("display_type"))},"Тип отображения"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[10]||(s[10]=i=>t.loadAndOrder("show_answers"))},"Показывать ответы по окончанию раунда "),e("th",{scope:"col",class:"cursor-pointer",onClick:s[11]||(s[11]=i=>t.loadAndOrder("is_active"))},"Активный "),e("th",{scope:"col",class:"cursor-pointer",onClick:s[12]||(s[12]=i=>t.loadAndOrder("updated_at"))},"Дата изменения"),l9])]),e("tbody",null,[(l(!0),n(v,null,y(t.quizzes,(i,d)=>(l(),n("tr",{class:b({"border-info":i.deleted_at==null,"border-danger":i.deleted_at!=null})},[e("th",n9,u(i.id),1),e("td",{onClick:_=>t.selectEvent(i)},u(i.title||"Не указано"),9,i9),e("td",null,u((i.questions||[]).length),1),e("td",null,u((i.commands||[]).length),1),e("td",null,[i.image!=null?c((l(),n("img",a9,null,512)),[[a,"/file-by-file-id/"+i.image]]):(l(),n("p",d9,"не указано"))]),e("td",null,u(i.description||"Не указано"),1),e("td",null,[i.completed_at?(l(),n("p",r9,u(t.$filters.currentFull(i.completed_at)),1)):(l(),n("p",c9,"Не задано"))]),e("td",null,[i.start_at?(l(),n("p",u9,u(t.$filters.currentFull(i.start_at)),1)):(l(),n("p",m9,"Не задано"))]),e("td",null,[i.end_at?(l(),n("p",_9,u(t.$filters.currentFull(i.end_at)),1)):(l(),n("p",h9,"Не задано"))]),e("td",null,u(i.display_type),1),e("td",null,u(i.time_limit),1),e("td",null,[i.show_answers?(l(),n("i",p9)):(l(),n("i",b9))]),e("td",null,[i.is_active?(l(),n("i",f9)):(l(),n("i",g9))]),e("td",null,u(t.$filters.current(i.updated_at)),1),e("td",null,[i.id?(l(),n("div",v9,[$9,e("ul",y9,[i.deleted_at==null?(l(),n("li",k9,[e("a",{class:"dropdown-item",onClick:_=>t.removeQuiz(i.id),href:"javascript:void(0)"},"Удалить",8,F9)])):r("",!0)])])):r("",!0)])],2))),256))])])):(l(),n("div",w9,[C9,e("div",S9,[e("div",j9,[c(e("img",V9,null,512),[[a,"../images/icon.png"]])]),q9,z9,e("div",P9,[e("button",{onClick:s[13]||(s[13]=(...i)=>t.createQuiz&&t.createQuiz(...i)),class:"d-inline-flex align-items-center btn btn-lg px-4 rounded-pill btn-primary",type:"button"}," Добавить "),U9])])]))]),t.quizzes.length>0?(l(),n("div",O9,[t.paginate_object?(l(),$(j,{key:0,onPagination_page:t.nextQuizzes,pagination:t.paginate_object},null,8,["onPagination_page","pagination"])):r("",!0)])):r("",!0)])}}}),Q9={props:{type:String,value:String}},T9={class:"d-flex mb-2"},B9={class:"form-floating mb-3"},R9=["value"],M9=e("label",{for:"custom-url-link-for-success"},"Ссылка на файл",-1);function D9(o,t,s,a,i,d){return l(),n(v,null,[e("div",T9,[e("span",{class:b(["badge bg-secondary cursor-pointer mr-1",{"bg-success":s.type=="video"}]),onClick:t[0]||(t[0]=_=>o.$emit("update:type","video"))},"Видео",2),e("span",{class:b(["badge bg-secondary cursor-pointer mr-1",{"bg-success":s.type=="video_note"}]),onClick:t[1]||(t[1]=_=>o.$emit("update:type","video_note"))},"Кружок",2),e("span",{class:b(["badge bg-secondary cursor-pointer mr-1",{"bg-success":s.type=="photo"}]),onClick:t[2]||(t[2]=_=>o.$emit("update:type","photo"))},"Изображение",2),e("span",{class:b(["badge bg-secondary cursor-pointer mr-1",{"bg-success":s.type=="audio"}]),onClick:t[3]||(t[3]=_=>o.$emit("update:type","audio"))},"Звук",2)]),e("div",B9,[e("input",{type:"text",class:"form-control",value:s.value,onInput:t[4]||(t[4]=_=>o.$emit("update:value",_.target.value)),id:"custom-url-link-for-success",placeholder:"https://...."},null,40,R9),M9])],64)}const N=U(Q9,[["render",D9]]),E9={class:"row py-3"},L9={class:"col-12"},K9={class:"row"},N9={class:"col-12 mb-3"},J9={key:0},H9=["onClick"],Y9={class:"form-label",id:"quiz-round"},G9=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),W9=e("div",null," Раунд, в котором будет отображен вопрос ",-1),X9=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),Z9={class:"col-12 mb-3"},x9={class:"form-label",id:"event-on_after_appointment"},eS=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),tS=e("div",null," Текст вопроса ",-1),sS=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),oS={key:0,class:"text-gray-400 ml-3",style:{"font-size":"10px"}},lS={class:"col-12 mb-3"},nS={class:"form-check"},iS=e("label",{class:"form-check-label",for:"need_media"}," Нужен медиа-контент ",-1),aS={key:0,class:"col-12 mb-3"},dS={class:"form-label",id:"quiz-images"},rS=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),cS=e("div",null," Изображение, видео, аудио сопровождение вопроса ",-1),uS={key:0,class:"badge rounded-pill text-bg-info m-0"},mS=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),_S=e("h6",null,"Вставьте ссылку на контент...",-1),hS=e("h6",null,"...или выберите из доступных",-1),pS={class:"col-12 mb-3"},bS={class:"form-check"},fS=e("label",{class:"form-check-label",for:"is_multiply"}," Множественные ответы ",-1),gS={class:"col-12 mb-3"},vS={class:"form-check"},$S=e("label",{class:"form-check-label",for:"is_open"}," Открытый вопрос ",-1),yS={class:"col-12 mb-3"},kS={class:"d-flex justify-content-between"},FS={class:"form-label",id:"quiz-description"},wS=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),CS=e("div",null," Текст при выборе правильного ответа ",-1),SS=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),jS={key:0,class:"text-gray-400 ml-3",style:{"font-size":"10px"}},VS={class:"col-12 mb-3"},qS={class:"form-check"},zS=e("label",{class:"form-check-label",for:"need_media_for_success"}," Нужен медиа-контент при правильном ответе ",-1),PS={key:1,class:"col-12 mb-3"},US=e("h6",null,"Вставьте ссылку на контент...",-1),OS=e("h6",null,"...или выберите из доступных",-1),AS={class:"col-12 mb-3"},IS={class:"d-flex justify-content-between"},QS={class:"form-label",id:"quiz-description"},TS=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),BS=e("div",null," Текст в выбора неправильного ответа ",-1),RS=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),MS={key:0,class:"text-gray-400 ml-3",style:{"font-size":"10px"}},DS={class:"col-12 mb-3"},ES={class:"form-check"},LS=e("label",{class:"form-check-label",for:"need_media_for_failed"}," Нужен медиа-контент при неправильном ответе ",-1),KS={key:2,class:"col-12 mb-3"},NS=e("h6",null,"Вставьте ссылку на контент...",-1),JS=e("h6",null,"...или выберите из доступных",-1),HS={class:"row"},YS={class:"col-12"},GS={class:"col-12"},WS={key:0,class:"table"},XS=e("thead",null,[e("tr",null,[e("th",{scope:"col"},"#"),e("th",{scope:"col"},"Текст вопроса"),e("th",{scope:"col"},"Баллы"),e("th",{scope:"col"},"Контент"),e("th",{scope:"col"},"Тип контента"),e("th",{scope:"col"},"Является верным"),e("th",{scope:"col"},"Действие")])],-1),ZS={scope:"row"},xS={class:"form-floating mb-3"},ej=["onUpdate:modelValue","id"],tj=["for"],sj={class:"form-floating mb-3"},oj=["onUpdate:modelValue","id"],lj=["for"],nj=["onClick"],ij={class:"form-check"},aj=["onUpdate:modelValue","id"],dj=["for"],rj={class:"dropdown"},cj=e("button",{class:"btn btn-outline-secondary",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-solid fa-ellipsis"})],-1),uj={class:"dropdown-menu"},mj={key:0},_j=["onClick"],hj={key:1},pj=["onClick"],bj={key:1},fj={class:"row"},gj={class:"col-12"},vj={type:"submit",class:"btn btn-outline-success w-100 p-3"},$j={key:0},yj={key:1},kj={class:"modal fade",id:"chooseMediaContent",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},Fj={class:"modal-dialog"},wj={class:"modal-content"},Cj={key:0,class:"modal-body"},Sj=e("div",{class:"modal-footer"},[e("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Закрыть")],-1),jj={class:"modal fade",id:"chooseSuccessMediaContent",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},Vj={class:"modal-dialog"},qj={class:"modal-content"},zj={class:"modal-body"},Pj=e("div",{class:"modal-footer"},[e("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Закрыть")],-1),Uj={class:"modal fade",id:"chooseFailureMediaContent",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},Oj={class:"modal-dialog"},Aj={class:"modal-content"},Ij={class:"modal-body"},Qj=e("div",{class:"modal-footer"},[e("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Закрыть")],-1),Tj={class:"modal fade",id:"chooseBaseMediaContent",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},Bj={class:"modal-dialog"},Rj={class:"modal-content"},Mj={class:"modal-body"},Dj=e("div",{class:"modal-footer"},[e("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Закрыть")],-1),Ej={props:["quizId","bot","question"],data(){return{step:0,load:!1,selectedQuestionIndex:null,need_media:!1,need_media_for_success:!1,need_media_for_failed:!1,rounds:[],questionForm:{id:null,text:null,round:null,media_content:null,content_type:null,is_multiply:!1,is_open:!1,answers:[],success_message:null,failure_message:null,success_media_content:null,failure_media_content:null,success_media_content_type:null,failure_media_content_type:null}}},watch:{questionForm:{handler(o){this.need_reset=!0},deep:!0},need_media:function(o,t){this.need_page_images||(this.questionForm.media_content=null,this.questionForm.content_type=null)},need_media_for_success:function(o,t){this.need_page_images||(this.questionForm.success_media_content=null,this.questionForm.success_media_content_type=null)},need_media_for_failed:function(o,t){this.need_page_images||(this.questionForm.failure_media_content=null,this.questionForm.failure_media_content_type=null)}},mounted(){this.loadQuizRounds(),this.question&&(this.question.media_content!=null&&(this.need_media=!0),this.question.success_media_content!=null&&(this.need_media_for_success=!0),this.question.failure_media_content!=null&&(this.need_media_for_failed=!0),this.$nextTick(()=>{this.questionForm={id:this.question.id||null,text:this.question.text||null,round:this.question.round||null,media_content:this.question.media_content||null,content_type:this.question.content_type||null,is_multiply:this.question.is_multiply||!1,is_open:this.question.is_open||!1,answers:this.question.answers||[],success_message:this.question.success_message||null,failure_message:this.question.failure_message||null,success_media_content:this.question.success_media_content||null,failure_media_content:this.question.failure_media_content||null,success_media_content_type:this.question.success_media_content_type||null,failure_media_content_type:this.question.failure_media_content_type||null}}))},methods:{attachTo(o){this.questionForm[o.param]==null?this.questionForm[o.param]=o.value:this.questionForm[o.param]+=o.value},loadQuizRounds(){this.$store.dispatch("loadQuizRounds",{dataObject:{bot_id:this.bot.id||null,quiz_id:this.quizId||null}}).then(o=>{this.rounds=o})},chooseBaseMediaContent(o){new bootstrap.Modal(document.getElementById("chooseBaseMediaContent"),{}).show()},chooseSuccessMediaContent(o){new bootstrap.Modal(document.getElementById("chooseSuccessMediaContent"),{}).show()},chooseFailureMediaContent(o){new bootstrap.Modal(document.getElementById("chooseFailureMediaContent"),{}).show()},chooseMediaContent(o){this.selectedQuestionIndex=null,this.$nextTick(()=>{this.selectedQuestionIndex=o}),new bootstrap.Modal(document.getElementById("chooseMediaContent"),{}).show()},selectMediaForFailure(o){this.questionForm.failure_media_content=o.file_id,this.questionForm.failure_media_content_type=o.type},selectMediaForSuccess(o){this.questionForm.success_media_content=o.file_id,this.questionForm.success_media_content_type=o.type},selectMediaForAnswer(o){this.questionForm.answers[this.selectedQuestionIndex].media_content=o.file_id,this.questionForm.answers[this.selectedQuestionIndex].content_type=o.type},selectMedia(o){this.questionForm.media_content=o.file_id,this.questionForm.content_type=o.type},clearQuestionForm(){this.questionForm={id:null,text:null,round:null,media_content:null,content_type:null,is_multiply:!1,is_open:!1,answers:[],success_message:null,failure_message:null,success_media_content:null,failure_media_content:null,success_media_content_type:null,failure_media_content_type:null}},addNewAnswer(){this.questionForm.answers.push({text:null,media_content:null,content_type:null,is_right_answer:!1,points:0})},removeAnswerFromArray(o){this.questionForm.answers.splice(o,1)},removeAnswer(o){this.$store.dispatch("removeQuizAnswer",{quizAnswerId:o}).then(t=>{this.$notify("Вопрос успешно удален");let s=this.questionForm.answers.findIndex(a=>a.id==o);this.questionForm.answers.splice(s,1)}).catch(t=>{this.$notify("Ошибка удаления вопроса")})},submitForm(){let o=new FormData;Object.keys(this.questionForm).forEach(t=>{const s=this.questionForm[t]||"";typeof s=="object"?o.append(t,JSON.stringify(s)):o.append(t,s)}),o.append("bot_id",this.bot.id),o.append("quiz_id",this.quizId),this.$store.dispatch("storeQuizQuestion",{quizQuestionForm:o}).then(t=>{this.$emit("callback",t.data),this.$notify("Вопрос успешно создан"),this.clearQuestionForm(),this.loadQuizRounds()}).catch(t=>{this.$notify("Ошибка создания вопроса")})}}},Lj=Object.assign(Ej,{__name:"QuizQuestionForm",setup(o){return(t,s)=>{const a=V("Popper");return l(),n(v,null,[e("div",E9,[e("div",L9,[e("button",{onClick:s[0]||(s[0]=(...i)=>t.clearQuestionForm&&t.clearQuestionForm(...i)),class:"btn btn-primary"},"Новый вопрос ")])]),e("form",{onSubmit:s[20]||(s[20]=S((...i)=>t.submitForm&&t.submitForm(...i),["prevent"]))},[e("div",K9,[e("div",N9,[t.rounds.length>0?(l(),n("p",J9,[m(" Ранее созданные раунды: "),(l(!0),n(v,null,y(t.rounds,i=>(l(),n("span",{onClick:d=>t.questionForm.round=i,class:"badge bg-primary mr-1 cursor-pointer"},u(i),9,H9))),256))])):r("",!0),e("label",Y9,[f(a,null,{content:g(()=>[W9]),default:g(()=>[G9]),_:1}),m(" Раунд "),X9]),c(e("input",{type:"number",class:"form-control",placeholder:"Раунд","aria-label":"Раундт",step:"1",min:"1","onUpdate:modelValue":s[1]||(s[1]=i=>t.questionForm.round=i),"aria-describedby":"quiz-round",required:""},null,512),[[h,t.questionForm.round]])]),e("div",Z9,[e("label",x9,[f(a,null,{content:g(()=>[tS]),default:g(()=>[eS]),_:1}),m(" Текст вопроса "),sS,t.questionForm.text?(l(),n("small",oS," Длина текста "+u(t.questionForm.text.length)+"/255",1)):r("",!0)]),c(e("textarea",{type:"text",class:"form-control",placeholder:"Текст вопроса","aria-label":"Текст вопроса","onUpdate:modelValue":s[2]||(s[2]=i=>t.questionForm.text=i),maxlength:"255","aria-describedby":"review-text",required:""},`
                    `,512),[[h,t.questionForm.text]])]),e("div",lS,[e("div",nS,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[3]||(s[3]=i=>t.need_media=i),type:"checkbox",id:"need_media"},null,512),[[k,t.need_media]]),iS])]),t.need_media?(l(),n("div",aS,[e("label",dS,[f(a,null,{content:g(()=>[cS]),default:g(()=>[rS]),_:1}),m(" Медиа контент к вопросу "),t.questionForm.content_type?(l(),n("span",uS,u(t.questionForm.content_type),1)):r("",!0),mS]),_S,f(N,{value:t.questionForm.media_content,type:t.questionForm.content_type,"onUpdate:type":s[4]||(s[4]=i=>t.questionForm.content_type=i),"onUpdate:value":s[5]||(s[5]=i=>t.questionForm.media_content=i)},null,8,["value","type"]),hS,e("button",{type:"button",onClick:s[6]||(s[6]=(...i)=>t.chooseBaseMediaContent&&t.chooseBaseMediaContent(...i)),class:"btn btn-outline-info rounded-lg"},"Выбрать медиа-файл ")])):r("",!0),e("div",pS,[e("div",bS,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[7]||(s[7]=i=>t.questionForm.is_multiply=i),type:"checkbox",id:"is_multiply"},null,512),[[k,t.questionForm.is_multiply]]),fS])]),e("div",gS,[e("div",vS,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[8]||(s[8]=i=>t.questionForm.is_open=i),type:"checkbox",id:"is_open"},null,512),[[k,t.questionForm.is_open]]),$S])]),e("div",yS,[e("div",kS,[e("label",FS,[f(a,null,{content:g(()=>[CS]),default:g(()=>[wS]),_:1}),m(" Текст при выборе правильного ответа "),SS,t.questionForm.success_message?(l(),n("small",jS," Длина текста "+u(t.questionForm.success_message.length)+"/255",1)):r("",!0)]),f(R,{param:"success_message",onCallback:t.attachTo},null,8,["onCallback"])]),c(e("textarea",{class:"form-control",placeholder:"Текст при правильном ответе","aria-label":"Текст при правильном ответе",maxlength:"255","onUpdate:modelValue":s[9]||(s[9]=i=>t.questionForm.success_message=i),"aria-describedby":"quiz-question-success_message"},`
                    `,512),[[h,t.questionForm.success_message]])]),e("div",VS,[e("div",qS,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[10]||(s[10]=i=>t.need_media_for_success=i),type:"checkbox",id:"need_media_for_success"},null,512),[[k,t.need_media_for_success]]),zS])]),t.need_media_for_success?(l(),n("div",PS,[US,f(N,{type:t.questionForm.success_media_content_type,"onUpdate:type":s[11]||(s[11]=i=>t.questionForm.success_media_content_type=i),value:t.questionForm.success_media_content,"onUpdate:value":s[12]||(s[12]=i=>t.questionForm.success_media_content=i)},null,8,["type","value"]),OS,e("button",{type:"button",onClick:s[13]||(s[13]=(...i)=>t.chooseSuccessMediaContent&&t.chooseSuccessMediaContent(...i)),class:"btn btn-outline-info rounded-lg"},"Выбрать медиа-файл ")])):r("",!0),e("div",AS,[e("div",IS,[e("label",QS,[f(a,null,{content:g(()=>[BS]),default:g(()=>[TS]),_:1}),m(" Текст при выборе неправильного ответа "),RS,t.questionForm.failure_message?(l(),n("small",MS," Длина текста "+u(t.questionForm.failure_message.length)+"/255",1)):r("",!0)]),f(R,{param:"failure_message",onCallback:t.attachTo},null,8,["onCallback"])]),c(e("textarea",{class:"form-control",placeholder:"Текст при неправильном ответе","aria-label":"Текст при неправильном ответе",maxlength:"255","onUpdate:modelValue":s[14]||(s[14]=i=>t.questionForm.failure_message=i),"aria-describedby":"quiz-question-failure-message"},`
                    `,512),[[h,t.questionForm.failure_message]])]),e("div",DS,[e("div",ES,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[15]||(s[15]=i=>t.need_media_for_failed=i),type:"checkbox",id:"need_media_for_failed"},null,512),[[k,t.need_media_for_failed]]),LS])]),t.need_media_for_failed?(l(),n("div",KS,[NS,f(N,{type:t.questionForm.failure_media_content_type,"onUpdate:type":s[16]||(s[16]=i=>t.questionForm.failure_media_content_type=i),value:t.questionForm.failure_media_content,"onUpdate:value":s[17]||(s[17]=i=>t.questionForm.failure_media_content=i)},null,8,["type","value"]),JS,e("button",{type:"button",onClick:s[18]||(s[18]=(...i)=>t.chooseFailureMediaContent&&t.chooseFailureMediaContent(...i)),class:"btn btn-outline-info rounded-lg"},"Выбрать медиа-файл ")])):r("",!0)]),e("div",HS,[e("div",YS,[e("button",{onClick:s[19]||(s[19]=(...i)=>t.addNewAnswer&&t.addNewAnswer(...i)),type:"button",class:"btn btn-outline-success rounded-5"}," Добавить ответы ")]),e("div",GS,[t.questionForm.answers.length>0?(l(),n("table",WS,[XS,e("tbody",null,[(l(!0),n(v,null,y(t.questionForm.answers,(i,d)=>(l(),n("tr",{class:b({"border-info":i.deleted_at==null,"border-danger":i.deleted_at!=null})},[e("th",ZS,u(i.id||"Новый"),1),e("td",null,[e("div",xS,[c(e("input",{type:"text","onUpdate:modelValue":_=>t.questionForm.answers[d].text=_,class:"form-control",id:"answer-text-"+d,placeholder:"Текст ответа"},null,8,ej),[[h,t.questionForm.answers[d].text]]),e("label",{for:"answer-text-"+d},"Текст ответа",8,tj)])]),e("td",null,[e("div",sj,[c(e("input",{type:"text","onUpdate:modelValue":_=>t.questionForm.answers[d].points=_,class:"form-control",id:"answer-points-"+d,placeholder:"Текст ответа"},null,8,oj),[[h,t.questionForm.answers[d].points]]),e("label",{for:"answer-points-"+d},"Баллы",8,lj)])]),e("td",null,[e("p",{class:"cursor-pointer",onClick:_=>t.chooseMediaContent(d)},u(i.media_content||"Не указано"),9,nj)]),e("td",null,u(i.content_type||"Не указано"),1),e("td",null,[e("div",ij,[c(e("input",{class:"form-check-input","onUpdate:modelValue":_=>t.questionForm.answers[d].is_right_answer=_,type:"checkbox",id:"answer-is_right_answer-"+d},null,8,aj),[[k,t.questionForm.answers[d].is_right_answer]]),e("label",{class:"form-check-label",for:"answer-is_right_answer-"+d}," Правильный ответ ",8,dj)])]),e("td",null,[e("div",rj,[cj,e("ul",uj,[i.id==null?(l(),n("li",mj,[e("a",{class:"dropdown-item",onClick:_=>t.removeAnswerFromArray(d),href:"javascript:void(0)"},"Удалить",8,_j)])):r("",!0),i.deleted_at==null&&i.id!=null?(l(),n("li",hj,[e("a",{class:"dropdown-item",onClick:_=>t.removeAnswer(i.id),href:"javascript:void(0)"},"Удалить",8,pj)])):r("",!0)])])])],2))),256))])])):(l(),n("p",bj,"На текущий момент нет ни одного созданного ответа"))])]),e("div",fj,[e("div",gj,[e("button",vj,[t.questionForm.id==null?(l(),n("span",$j,"Сохранить вопрос")):(l(),n("span",yj,"Обновить вопрос"))])])])],32),e("div",kj,[e("div",Fj,[e("div",wj,[t.selectedQuestionIndex!=null?(l(),n("div",Cj,[f(z,{"need-video":!0,"need-video-note":!0,"need-audio":!0,"need-photo":!0,selected:[t.questionForm.answers[t.selectedQuestionIndex||0].media_content||""],onSelect:t.selectMediaForAnswer},null,8,["selected","onSelect"])])):r("",!0),Sj])])]),e("div",jj,[e("div",Vj,[e("div",qj,[e("div",zj,[f(z,{"need-video":!0,"need-video-note":!0,"need-audio":!0,"need-photo":!0,selected:[t.questionForm.success_media_content],onSelect:t.selectMediaForSuccess},null,8,["selected","onSelect"])]),Pj])])]),e("div",Uj,[e("div",Oj,[e("div",Aj,[e("div",Ij,[f(z,{"need-video":!0,"need-video-note":!0,"need-audio":!0,"need-photo":!0,selected:[t.questionForm.failure_media_content],onSelect:t.selectMediaForFailure},null,8,["selected","onSelect"])]),Qj])])]),e("div",Tj,[e("div",Bj,[e("div",Rj,[e("div",Mj,[f(z,{"need-video":!0,"need-video-note":!0,"need-audio":!0,"need-photo":!0,selected:[t.questionForm.media_content],onSelect:t.selectMedia},null,8,["selected","onSelect"])]),Dj])])])],64)}}}),Kj={class:"row"},Nj={class:"col-12"},Jj={key:0,class:"table"},Hj=e("th",{scope:"col"},"Число ответов",-1),Yj=e("th",{scope:"col"},"Действие",-1),Gj={scope:"row"},Wj=["onClick"],Xj={key:0,class:"fa-solid fa-chevron-down text-success"},Zj={key:1,class:"fa-solid fa-xmark text-danger"},xj={key:0,class:"fa-solid fa-chevron-down text-success"},eV={key:1,class:"fa-solid fa-xmark text-danger"},tV={key:0,class:"dropdown"},sV=e("button",{class:"btn btn-outline-secondary",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-solid fa-ellipsis"})],-1),oV={class:"dropdown-menu"},lV={key:0},nV=["onClick"],iV={key:1},aV={class:"col-12"},dV={props:["bot","quizId"],data(){return{direction:"desc",order:"updated_at",show:!0,is_group:!1,loading:!0,questions:[],search:null,paginate_object:null}},computed:{...C(["getQuizQuestions","getQuizQuestionsPaginateObject"])},mounted(){this.loadQuizQuestions()},methods:{nextQuizQuestion(o){this.loadQuizQuestions(o)},selectQuizQuestion(o){this.$emit("select",o),this.$notify("Вопрос успешно выбран")},removeQuizQuestion(o){this.loading=!0,this.$store.dispatch("removeQuizQuestion",{quizQuestionId:o}).then(t=>{this.loading=!1,this.loadQuizQuestions(0),this.$notify("Вопрос успешно удален")}).catch(()=>{this.loading=!1,this.$notify("Вопрос удаления сервиса")})},loadAndOrder(o){this.order=o,this.direction=this.direction==="desc"?"asc":"desc",this.loadQuizQuestions(0)},loadQuizQuestions(o=0){this.loading=!0,this.$store.dispatch("loadQuizQuestions",{dataObject:{quiz_id:this.quizId,bot_id:this.bot.id||null,search:this.search,order:this.order,direction:this.direction},page:o,size:100}).then(t=>{this.loading=!1,this.questions=this.getQuizQuestions,this.paginate_object=this.getQuizQuestionsPaginateObject}).catch(()=>{this.loading=!1})}}},rV=Object.assign(dV,{__name:"QuizQuestionTable",setup(o){return(t,s)=>(l(),n("div",Kj,[e("div",Nj,[t.questions.length>0?(l(),n("table",Jj,[e("thead",null,[e("tr",null,[e("th",{scope:"col",class:"cursor-pointer",onClick:s[0]||(s[0]=a=>t.loadAndOrder("id"))},"#"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[1]||(s[1]=a=>t.loadAndOrder("text"))},"Текст вопроса"),Hj,e("th",{scope:"col",class:"cursor-pointer",onClick:s[2]||(s[2]=a=>t.loadAndOrder("round"))},"Раунд"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[3]||(s[3]=a=>t.loadAndOrder("media_content"))},"Контент"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[4]||(s[4]=a=>t.loadAndOrder("content_type"))},"Тип контента"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[5]||(s[5]=a=>t.loadAndOrder("is_multiply"))},"Множественный"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[6]||(s[6]=a=>t.loadAndOrder("is_open"))},"Открытый"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[7]||(s[7]=a=>t.loadAndOrder("updated_at"))},"Дата изменения"),Yj])]),e("tbody",null,[(l(!0),n(v,null,y(t.questions,(a,i)=>(l(),n("tr",{class:b({"border-info":a.deleted_at==null,"border-danger":a.deleted_at!=null})},[e("th",Gj,u(a.id),1),e("td",{onClick:d=>t.selectQuizQuestion(a)},u(a.text||"Не указано"),9,Wj),e("td",null,u((a.answers||[]).length),1),e("td",null,u(a.round||"Не указано"),1),e("td",null,u(a.media_content||"Не указано"),1),e("td",null,u(a.content_type||"Не указано"),1),e("td",null,[a.is_multiply?(l(),n("i",Xj)):(l(),n("i",Zj))]),e("td",null,[a.is_open?(l(),n("i",xj)):(l(),n("i",eV))]),e("td",null,u(t.$filters.current(a.updated_at)),1),e("td",null,[a.id?(l(),n("div",tV,[sV,e("ul",oV,[a.deleted_at==null?(l(),n("li",lV,[e("a",{class:"dropdown-item",onClick:d=>t.removeQuizQuestion(a.id),href:"javascript:void(0)"},"Удалить",8,nV)])):r("",!0)])])):r("",!0)])],2))),256))])])):(l(),n("p",iV,"На текущий момент нет ни одного созданного вопроса"))]),e("div",aV,[t.paginate_object?(l(),$(j,{key:0,onPagination_page:t.nextQuizQuestion,pagination:t.paginate_object},null,8,["onPagination_page","pagination"])):r("",!0)])]))}}),cV={class:"row py-3"},uV={class:"col-12"},mV={class:"row"},_V={class:"col-12 mb-3"},hV={class:"form-label",id:"command-title"},pV=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),bV=e("div",null," Название команды ",-1),fV=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),gV={class:"col-12 mb-3"},vV={class:"form-label",id:"event-on_after_appointment"},$V=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),yV=e("div",null," Текст описания команды ",-1),kV=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),FV={key:0,class:"text-gray-400 ml-3",style:{"font-size":"10px"}},wV=e("div",{class:"col-12 mb-3"},[e("button",{type:"button",class:"btn btn-outline-info rounded-5","data-bs-toggle":"modal","data-bs-target":"#select-players"}," Подобрать участников команды ")],-1),CV={key:0,class:"col-12 mb-3"},SV=e("h4",null,"Пользователи в команде",-1),jV={class:"list-group list-group-numbered"},VV={class:"list-group-item d-flex justify-content-between align-items-start"},qV={class:"ms-2 me-auto"},zV={class:"fw-bold"},PV={class:"dropdown"},UV=e("button",{class:"btn btn-outline-secondary",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-solid fa-ellipsis"})],-1),OV={class:"dropdown-menu"},AV=["onClick"],IV={class:"row"},QV={class:"col-12"},TV={type:"submit",class:"btn btn-outline-success w-100 p-3"},BV={key:0},RV={key:1},MV={class:"modal fade",id:"select-players",tabindex:"-1","aria-labelledby":"select-players-label","aria-hidden":"true"},DV={class:"modal-dialog modal-fullscreen"},EV={class:"modal-content"},LV=e("div",{class:"modal-header"},[e("h1",{class:"modal-title fs-5",id:"select-players-label"},"Подбор участников команды"),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),KV={class:"modal-body"},NV=e("div",{class:"modal-footer"},[e("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Закрыть")],-1),JV={props:["quizId","bot","command"],data(){return{step:0,load:!1,commandForm:{id:null,title:null,description:null,players:[]}}},watch:{commandForm:{handler(o){this.need_reset=!0},deep:!0}},mounted(){this.command&&this.$nextTick(()=>{this.commandForm={id:this.command.id||null,title:this.command.title||null,description:this.command.description||null,players:this.command.players||[]}})},methods:{removePlayerFromCommand(o){},selectBotUser(o){if(this.commandForm.players.findIndex(s=>s.id==o.id)>=0){this.$notify("Такой пользователь уже есть в списке");return}this.$notify("Пользователь успешно добавлен"),this.commandForm.players.push(o)},clearCommandForm(){this.commandForm={id:null,title:null,description:null,players:[]}},submitForm(){let o=new FormData;Object.keys(this.commandForm).forEach(t=>{const s=this.commandForm[t]||"";typeof s=="object"?o.append(t,JSON.stringify(s)):o.append(t,s)}),o.append("bot_id",this.bot.id),o.append("quiz_id",this.quizId),this.$store.dispatch("storeQuizCommand",{quizCommandForm:o}).then(t=>{this.$emit("callback",t.data),this.$notify("Команда успешно создана"),this.clearCommandForm()}).catch(t=>{this.$notify("Ошибка создания команды")})}}},HV=Object.assign(JV,{__name:"QuizCommandForm",setup(o){return(t,s)=>{const a=V("Popper");return l(),n(v,null,[e("div",cV,[e("div",uV,[e("button",{onClick:s[0]||(s[0]=(...i)=>t.clearCommandForm&&t.clearCommandForm(...i)),class:"btn btn-primary"},"Новая команда")])]),e("form",{onSubmit:s[3]||(s[3]=S((...i)=>t.submitForm&&t.submitForm(...i),["prevent"]))},[e("div",mV,[e("div",_V,[e("label",hV,[f(a,null,{content:g(()=>[bV]),default:g(()=>[pV]),_:1}),m(" Название команды "),fV]),c(e("input",{type:"text",class:"form-control",placeholder:"Название команды","aria-label":"Название команды",maxlength:"255","onUpdate:modelValue":s[1]||(s[1]=i=>t.commandForm.title=i),"aria-describedby":"command-title",required:""},null,512),[[h,t.commandForm.title]])]),e("div",gV,[e("label",vV,[f(a,null,{content:g(()=>[yV]),default:g(()=>[$V]),_:1}),m(" Описание команды "),kV,t.commandForm.description?(l(),n("small",FV," Длина текста "+u(t.commandForm.description.length)+"/255",1)):r("",!0)]),c(e("textarea",{type:"text",class:"form-control",placeholder:"Текст описания","aria-label":"Текст описания","onUpdate:modelValue":s[2]||(s[2]=i=>t.commandForm.description=i),maxlength:"255","aria-describedby":"command-text",required:""},`
                    `,512),[[h,t.commandForm.description]])]),wV,t.commandForm.players.length>0?(l(),n("div",CV,[SV,e("ol",jV,[(l(!0),n(v,null,y(t.commandForm.players,i=>(l(),n("li",VV,[e("div",qV,[e("div",zV,"#"+u(i.id),1),m(" "+u(i.fio_from_telegram||i.telegram_chat_id),1)]),e("div",PV,[UV,e("ul",OV,[e("li",null,[e("a",{class:"dropdown-item",onClick:d=>t.removePlayerFromCommand(i.id),href:"javascript:void(0)"},"Удалить",8,AV)])])])]))),256))])])):r("",!0)]),e("div",IV,[e("div",QV,[e("button",TV,[t.commandForm.id==null?(l(),n("span",BV,"Сохранить команду")):(l(),n("span",RV,"Обновить команду"))])])])],32),e("div",MV,[e("div",DV,[e("div",EV,[LV,e("div",KV,[f(D,{simple:!0,onSelect:t.selectBotUser},null,8,["onSelect"])]),NV])])])],64)}}}),YV={class:"row"},GV={class:"col-12"},WV={key:0,class:"table"},XV=e("th",{scope:"col"},"Число участников",-1),ZV=e("th",{scope:"col"},"Действие",-1),xV={scope:"row"},eq=["onClick"],tq={key:0,class:"dropdown"},sq=e("button",{class:"btn btn-outline-secondary",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-solid fa-ellipsis"})],-1),oq={class:"dropdown-menu"},lq={key:0},nq=["onClick"],iq={key:1},aq={class:"col-12"},dq={props:["bot","quizId"],data(){return{direction:"desc",order:"updated_at",show:!0,is_group:!1,loading:!0,commands:[],search:null,paginate_object:null}},computed:{...C(["getQuizCommands","getQuizCommandsPaginateObject"])},mounted(){this.loadQuizCommands()},methods:{nextQuizCommand(o){this.loadQuizCommands(o)},selectQuizCommand(o){this.$emit("select",o),this.$notify("Вопрос успешно выбран")},removeQuizCommand(o){this.loading=!0,this.$store.dispatch("removeQuizCommand",{quizCommandId:o}).then(t=>{this.loading=!1,this.loadQuizCommands(0),this.$notify("Вопрос успешно удален")}).catch(()=>{this.loading=!1,this.$notify("Вопрос удаления сервиса")})},loadAndOrder(o){this.order=o,this.direction=this.direction==="desc"?"asc":"desc",this.loadQuizCommands(0)},loadQuizCommands(o=0){this.loading=!0,this.$store.dispatch("loadQuizCommands",{dataObject:{quiz_id:this.quizId,bot_id:this.bot.id||null,search:this.search,order:this.order,direction:this.direction},page:o,size:100}).then(t=>{this.loading=!1,this.commands=this.getQuizCommands,this.paginate_object=this.getQuizCommandsPaginateObject}).catch(()=>{this.loading=!1})}}},rq=Object.assign(dq,{__name:"QuizCommandTable",setup(o){return(t,s)=>(l(),n("div",YV,[e("div",GV,[t.commands.length>0?(l(),n("table",WV,[e("thead",null,[e("tr",null,[e("th",{scope:"col",class:"cursor-pointer",onClick:s[0]||(s[0]=a=>t.loadAndOrder("id"))},"#"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[1]||(s[1]=a=>t.loadAndOrder("title"))},"Название"),XV,e("th",{scope:"col",class:"cursor-pointer",onClick:s[2]||(s[2]=a=>t.loadAndOrder("description"))},"Описание"),ZV])]),e("tbody",null,[(l(!0),n(v,null,y(t.commands,(a,i)=>(l(),n("tr",{class:b({"border-info":a.deleted_at==null,"border-danger":a.deleted_at!=null})},[e("th",xV,u(a.id),1),e("td",{onClick:d=>t.selectQuizCommand(a)},u(a.title||"Не указано"),9,eq),e("td",null,u((a.players||[]).length),1),e("td",null,u(a.description||"Не указано"),1),e("td",null,[a.id?(l(),n("div",tq,[sq,e("ul",oq,[a.deleted_at==null?(l(),n("li",lq,[e("a",{class:"dropdown-item",onClick:d=>t.removeQuizCommand(a.id),href:"javascript:void(0)"},"Удалить",8,nq)])):r("",!0)])])):r("",!0)])],2))),256))])])):(l(),n("p",iq,"На текущий момент нет ни одной созданной команды"))]),e("div",aq,[t.paginate_object?(l(),$(j,{key:0,onPagination_page:t.nextQuizCommand,pagination:t.paginate_object},null,8,["onPagination_page","pagination"])):r("",!0)])]))}}),cq={class:"row"},uq={class:"col-12"},mq={key:0,class:"table"},_q=e("th",{scope:"col"},"Название квиза",-1),hq=e("th",{scope:"col"},"Название команды",-1),pq=e("th",{scope:"col"},"Число участников",-1),bq=e("th",{scope:"col"},"Результат",-1),fq=e("th",{scope:"col"},"Действие",-1),gq={scope:"row"},vq=["onClick"],$q={key:0},yq=e("td",null,"-",-1),kq={key:0,class:"dropdown"},Fq=e("button",{class:"btn btn-outline-secondary",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-solid fa-ellipsis"})],-1),wq={class:"dropdown-menu"},Cq={key:0},Sq=["onClick"],jq={key:1},Vq={class:"col-12"},qq={props:["bot","quizId"],data(){return{direction:"desc",order:"updated_at",show:!0,is_group:!1,loading:!0,results:[],search:null,paginate_object:null}},computed:{...C(["getQuizResults","getQuizResultsPaginateObject"])},mounted(){this.loadQuizResults()},methods:{nextQuizResult(o){this.loadQuizResults(o)},selectQuizResult(o){this.$emit("select",o),this.$notify("Вопрос успешно выбран")},removeQuizResult(o){this.loading=!0,this.$store.dispatch("removeQuizResult",{quizResultId:o}).then(t=>{this.loading=!1,this.loadQuizResults(0),this.$notify("Вопрос успешно удален")}).catch(()=>{this.loading=!1,this.$notify("Вопрос удаления сервиса")})},loadAndOrder(o){this.order=o,this.direction=this.direction==="desc"?"asc":"desc",this.loadQuizResults(0)},loadQuizResults(o=0){this.loading=!0,this.$store.dispatch("loadQuizResults",{dataObject:{quiz_id:this.quizId,bot_id:this.bot.id||null,search:this.search,order:this.order,direction:this.direction},page:o,size:100}).then(t=>{this.loading=!1,this.results=this.getQuizResults,this.paginate_object=this.getQuizResultsPaginateObject}).catch(()=>{this.loading=!1})}}},zq=Object.assign(qq,{__name:"QuizResultTable",setup(o){return(t,s)=>(l(),n("div",cq,[e("div",uq,[t.results.length>0?(l(),n("table",mq,[e("thead",null,[e("tr",null,[e("th",{scope:"col",class:"cursor-pointer",onClick:s[0]||(s[0]=a=>t.loadAndOrder("id"))},"#"),_q,hq,pq,e("th",{scope:"col",class:"cursor-pointer",onClick:s[1]||(s[1]=a=>t.loadAndOrder("points"))},"Баллы"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[2]||(s[2]=a=>t.loadAndOrder("times"))},"Время"),bq,fq])]),e("tbody",null,[(l(!0),n(v,null,y(t.results,(a,i)=>(l(),n("tr",{class:b({"border-info":a.deleted_at==null,"border-danger":a.deleted_at!=null})},[e("th",gq,u(a.id),1),e("td",{onClick:d=>t.selectQuizResult(a)},u(a.quiz.title||"Не указано"),9,vq),e("td",null,[a.command?(l(),n("span",$q,u(a.command.title||"Не указано"),1)):r("",!0)]),e("td",null,u((a.command.players||[]).length),1),e("td",null,u(a.points||"Не указано"),1),e("td",null,u(a.times||"Не указано"),1),yq,e("td",null,[a.id?(l(),n("div",kq,[Fq,e("ul",wq,[a.deleted_at==null?(l(),n("li",Cq,[e("a",{class:"dropdown-item",onClick:d=>t.removeQuizResult(a.id),href:"javascript:void(0)"},"Удалить",8,Sq)])):r("",!0)])])):r("",!0)])],2))),256))])])):(l(),n("p",jq,"На текущий момент нет ни одного созданного вопроса"))]),e("div",Vq,[t.paginate_object?(l(),$(j,{key:0,onPagination_page:t.nextQuizResult,pagination:t.paginate_object},null,8,["onPagination_page","pagination"])):r("",!0)])]))}}),Pq={key:0,class:"py-2"},Uq={class:"row"},Oq={class:"col-12"},Aq={key:1,class:"py-2"},Iq={class:"row"},Qq={class:"col-12"},Tq={key:2,class:"py-2"},Bq={class:"row"},Rq={class:"col-12"},Mq={class:"nav nav-tabs justify-content-center"},Dq={key:0,class:"row py-3"},Eq={class:"col-12"},Lq={key:1,class:"row py-3"},Kq={class:"col-12"},Nq={class:"col-12 py-3"},Jq=e("h4",null,"Доступные вопросы",-1),Hq={key:2,class:"row"},Yq={class:"col-12"},Gq={class:"col-12 py-3"},Wq=e("h4",null,"Команды участники квиза",-1),Xq={key:3,class:"row"},Zq={class:"col-12 py-3"},xq=e("h4",null,"Статистика",-1),ez={key:4,class:"row"},tz=e("div",{class:"col-12"},null,-1),sz=e("div",{class:"col-12 py-3"},[e("h4",null,"Отзывы к событию")],-1),oz=[tz,sz],lz={props:["bot"],data(){return{part:0,tab:0,loadTable:!1,loadQuizCommand:!1,loadQuizQuestion:!1,loadQuizQuestionTable:!1,loadQuizCommandTable:!1,loadQuizResult:!1,loadForm:!1,selectedQuiz:null,selectedQuizQuestion:null,selectedQuizCommand:null,selectedQuizResult:null}},mounted(){},methods:{callbackCommandForm(){this.loadQuizCommandTable=!0,this.$nextTick(()=>{this.loadQuizCommandTable=!1})},callbackQuestionForm(){this.loadQuizQuestionTable=!0,this.$nextTick(()=>{this.loadQuizQuestionTable=!1})},callbackForm(){this.loadTable=!0,this.part=0,this.$nextTick(()=>{this.loadTable=!1})},createQuiz(){this.part=2},selectQuizResult(o){this.loadQuizResult=!0,this.$nextTick(()=>{this.loadQuizResult=!1,this.selectedQuizResult=o})},selectQuizCommand(o){this.loadQuizCommand=!0,this.$nextTick(()=>{this.loadQuizCommand=!1,this.selectedQuizCommand=o})},selectQuizQuestion(o){this.loadQuizQuestion=!0,this.$nextTick(()=>{this.loadQuizQuestion=!1,this.selectedQuizQuestion=o})},selectQuiz(o){this.loadForm=!0,this.$nextTick(()=>{this.loadForm=!1,this.selectedQuiz=o,this.part=1,this.tab=0})}}},nz=Object.assign(lz,{__name:"Quizzes",setup(o){return(t,s)=>(l(),n(v,null,[t.part===0?(l(),n("div",Pq,[e("div",Uq,[e("div",Oq,[e("button",{type:"button",onClick:s[0]||(s[0]=(...a)=>t.createQuiz&&t.createQuiz(...a)),class:"btn btn-primary"}," Создать новый квиз ")])]),t.loadTable?r("",!0):(l(),$(I9,{key:0,onCreate:t.createQuiz,onSelect:t.selectQuiz,bot:o.bot},null,8,["onCreate","onSelect","bot"]))])):r("",!0),t.part===2?(l(),n("div",Aq,[e("div",Iq,[e("div",Qq,[e("button",{type:"button",onClick:s[1]||(s[1]=a=>t.part=0),class:"btn btn-outline-primary"}," Назад ")])]),t.loadForm?r("",!0):(l(),$(ee,{key:0,onCallback:t.callbackForm,bot:o.bot},null,8,["onCallback","bot"]))])):r("",!0),t.part===1?(l(),n("div",Tq,[e("div",Bq,[e("div",Rq,[e("button",{type:"button",onClick:s[2]||(s[2]=a=>t.part=0),class:"btn btn-outline-primary"}," Назад ")])]),e("ul",Mq,[e("li",{class:"nav-item",onClick:s[3]||(s[3]=a=>t.tab=0)},[e("a",{class:b(["nav-link",{active:t.tab===0}]),"aria-current":"page",href:"javascript:void(0)"},"Информация о квизе",2)]),e("li",{class:"nav-item",onClick:s[4]||(s[4]=a=>t.tab=1)},[e("a",{class:b(["nav-link",{active:t.tab===1}]),href:"javascript:void(0)"},"Вопросы квиза",2)]),e("li",{class:"nav-item",onClick:s[5]||(s[5]=a=>t.tab=2)},[e("a",{class:b(["nav-link",{active:t.tab===2}]),href:"javascript:void(0)"},"Команды на квизе",2)]),e("li",{class:"nav-item",onClick:s[6]||(s[6]=a=>t.tab=3)},[e("a",{class:b(["nav-link",{active:t.tab===3}]),href:"javascript:void(0)"},"Командная статистика",2)])]),t.tab===0?(l(),n("div",Dq,[e("div",Eq,[t.loadForm?r("",!0):(l(),$(ee,{key:0,onCallback:t.callbackForm,quiz:t.selectedQuiz,bot:o.bot},null,8,["onCallback","quiz","bot"]))])])):r("",!0),t.tab===1?(l(),n("div",Lq,[e("div",Kq,[t.loadQuizQuestion?r("",!0):(l(),$(Lj,{key:0,question:t.selectedQuizQuestion,"quiz-id":t.selectedQuiz.id,onCallback:t.callbackQuestionForm,bot:o.bot},null,8,["question","quiz-id","onCallback","bot"]))]),e("div",Nq,[Jq,t.loadQuizQuestionTable?r("",!0):(l(),$(rV,{key:0,"quiz-id":t.selectedQuiz.id,onSelect:t.selectQuizQuestion,bot:o.bot},null,8,["quiz-id","onSelect","bot"]))])])):r("",!0),t.tab===2?(l(),n("div",Hq,[e("div",Yq,[t.loadQuizCommand?r("",!0):(l(),$(HV,{key:0,command:t.selectedQuizCommand,"quiz-id":t.selectedQuiz.id,onCallback:t.callbackCommandForm,bot:o.bot},null,8,["command","quiz-id","onCallback","bot"]))]),e("div",Gq,[Wq,t.loadQuizCommandTable?r("",!0):(l(),$(rq,{key:0,"quiz-id":t.selectedQuiz.id,onSelect:t.selectQuizCommand,bot:o.bot},null,8,["quiz-id","onSelect","bot"]))])])):r("",!0),t.tab===3?(l(),n("div",Xq,[e("div",Zq,[xq,f(zq,{"quiz-id":t.selectedQuiz.id,onSelect:t.selectQuizResult,bot:o.bot},null,8,["quiz-id","onSelect","bot"])])])):r("",!0),t.tab===4?(l(),n("div",ez,oz)):r("",!0)])):r("",!0)],64))}}),iz={class:"row"},az={class:"col-12 mb-3 d-flex align-items-center"},dz={class:"dropdown mr-2"},rz={class:"btn btn-info dropdown-toggle",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},cz={key:0},uz={key:1},mz={class:"dropdown-menu"},_z=["onClick"],hz={class:"dropdown-item",href:"#"},pz=e("p",{class:"mb-0"}," - тип пункта меню",-1),bz={class:"col-12 col-md-12 mb-3"},fz={class:"form-label",id:"service-title"},gz=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),vz=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),$z={class:"col-12 mb-3"},yz={class:"form-label",id:"service-description"},kz=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),Fz=e("div",null," Краткая информация о команде ",-1),wz=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),Cz={key:0,class:"text-gray-400 ml-3",style:{"font-size":"10px"}},Sz={class:"col-12 mb-3"},jz={class:"form-label",id:"service-input_message_content"},Vz=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),qz=e("div",null," Текст, который будет в сообщении после выбора данного пункта меню ",-1),zz=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),Pz={key:0,class:"text-gray-400 ml-3",style:{"font-size":"10px"}},Uz={class:"col-12 mb-3"},Oz={class:"form-check"},Az=e("label",{class:"form-check-label",for:"need_keyboard"}," Нужна клавиатура к тексту ",-1),Iz={key:0,class:"col-12 mb-3"},Qz={class:"card"},Tz={class:"card-body"},Bz={class:"form-check"},Rz=e("label",{class:"form-check-label",for:"need_show_inline_template_selector"}," Выбрать клавиатуру из шаблона ",-1),Mz={class:"col-12 mb-3"},Dz={class:"form-check"},Ez=e("label",{class:"form-check-label",for:"need_custom_settings"}," Нужны дополнительные настройки ",-1),Lz={class:"col-12"},Kz={key:0,class:"card mb-2"},Nz={class:"card-header d-flex justify-content-between align-items-center"},Jz=e("h6",null,"Дополнительная конфигурация",-1),Hz={class:"card-body"},Yz={class:"row mb-2"},Gz={class:"col-5"},Wz={class:"form-label",id:"service-title"},Xz=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),Zz=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),xz=["onUpdate:modelValue"],eP={class:"col-5"},tP={class:"form-label",id:"service-title"},sP=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),oP=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),lP=["onUpdate:modelValue"],nP={class:"col-2 d-flex flex-column justify-content-end align-items-center"},iP=["onClick"],aP={key:1,class:"row mb-2"},dP=e("div",{class:"col-12"},[e("div",{class:"alert alert-info",role:"alert"}," Вы еще не добавили ни одной дополнительной настройки ")],-1),rP=[dP],cP=e("div",{class:"row"},[e("div",{class:"col-12"},[e("button",{type:"submit",class:"btn btn-outline-primary w-100"},"Сохранить пункт меню ")])],-1),uP={props:["item"],data(){return{need_custom_settings:!1,need_keyboard:!1,need_show_inline_template_selector:!1,types:[{title:"Текст",value:0},{title:"Фото",value:1}],itemForm:{id:null,type:0,title:null,description:null,input_message_content:null,inline_keyboard_id:null,inline_keyboard:{menu:null},custom_settings:[]}}},computed:{preparedTypeTile(){return this.types.filter(o=>o.value==this.itemForm.type)[0]||null},uuid(){return Ce()}},watch:{itemForm:{handler(o){this.need_reset=!0},deep:!0}},mounted(){this.item&&this.$nextTick(()=>{console.log("menu",this.item.inline_keyboard),this.itemForm={id:this.item.id||uuid,type:this.item.type||0,title:this.item.title||null,description:this.item.description||null,input_message_content:this.item.input_message_content||null,need_keyboard:this.item.title||!1,inline_keyboard_id:this.item.inline_keyboard_id||null,inline_keyboard:this.item.inline_keyboard?this.item.inline_keyboard:{menu:null},custom_settings:this.item.custom_settings||[]},this.itemForm.inline_keyboard&&(this.need_keyboard=!0),this.itemForm.custom_settings&&(this.need_custom_settings=!0)})},methods:{submitForm(){this.$emit("callback",this.itemForm),this.itemForm={id:null,type:0,title:null,description:null,input_message_content:null,inline_keyboard_id:null,inline_keyboard:{menu:null},custom_settings:[]},this.need_keyboard=!1,this.need_custom_settings=!1,this.need_show_inline_template_selector=!1},addCustomSettings(){this.itemForm.custom_settings.push({key:null,value:null})},removeCustomSetting(o){this.itemForm.custom_settings.splice(o,1)},selectInlineKeyboard(o){this.itemForm.inline_keyboard={id:null,menu:o,slug:null},this.need_show_inline_template_selector=!1}}},mP=Object.assign(uP,{__name:"InlineQueryItemForm",setup(o){return(t,s)=>{const a=V("Popper");return l(),n("form",{onSubmit:s[8]||(s[8]=S((...i)=>t.submitForm&&t.submitForm(...i),["prevent"])),class:"mb-2"},[e("div",iz,[e("div",az,[e("div",dz,[e("button",rz,[t.itemForm.type?(l(),n("span",cz,u(t.preparedTypeTile.title),1)):(l(),n("span",uz,"Тип поля"))]),e("ul",mz,[(l(!0),n(v,null,y(t.types,i=>(l(),n("li",{onClick:d=>t.itemForm.type=i.value},[e("a",hz,u(i.title||"Не указан"),1)],8,_z))),256))])]),pz]),e("div",bz,[e("label",fz,[f(a,{content:"Заголовок"},{default:g(()=>[gz]),_:1}),m(" Заголовок "),vz]),c(e("input",{type:"text",class:"form-control",placeholder:"Заголовок","aria-label":"Заголовок","onUpdate:modelValue":s[0]||(s[0]=i=>t.itemForm.title=i),"aria-describedby":"title",required:""},null,512),[[h,t.itemForm.title]])]),e("div",$z,[e("label",yz,[f(a,null,{content:g(()=>[Fz]),default:g(()=>[kz]),_:1}),m(" Описание команду "),wz,t.itemForm.description?(l(),n("small",Cz," Длина текста "+u(t.itemForm.description.length)+" / 255",1)):r("",!0)]),c(e("textarea",{type:"text",class:"form-control",placeholder:"Описание команды","aria-label":"Описание команды",maxlength:"255","onUpdate:modelValue":s[1]||(s[1]=i=>t.itemForm.description=i),"aria-describedby":"service-description",required:""},`
                    `,512),[[h,t.itemForm.description]])]),e("div",Sz,[e("label",jz,[f(a,null,{content:g(()=>[qz]),default:g(()=>[Vz]),_:1}),m(" Текст после выбора "),zz,t.itemForm.input_message_content?(l(),n("small",Pz," Длина текста "+u(t.itemForm.input_message_content.length)+" / 255",1)):r("",!0)]),c(e("textarea",{type:"text",class:"form-control",placeholder:"Текст поста","aria-label":"Текст поста",maxlength:"255","onUpdate:modelValue":s[2]||(s[2]=i=>t.itemForm.input_message_content=i),"aria-describedby":"service-input_message_content",required:""},`
                    `,512),[[h,t.itemForm.input_message_content]])]),e("div",Uz,[e("div",Oz,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[3]||(s[3]=i=>t.need_keyboard=i),type:"checkbox",id:"need_keyboard"},null,512),[[k,t.need_keyboard]]),Az])]),t.need_keyboard?(l(),n("div",Iz,[e("div",Qz,[e("div",Tz,[e("div",Bz,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[4]||(s[4]=i=>t.need_show_inline_template_selector=i),type:"checkbox",id:"need_show_inline_template_selector"},null,512),[[k,t.need_show_inline_template_selector]]),Rz]),t.need_show_inline_template_selector?(l(),$(T,{key:0,class:"mb-2",type:"inline",onSelect:t.selectInlineKeyboard,"select-mode":!0},null,8,["onSelect"])):(l(),$(A,{key:1,type:"inline",modelValue:t.itemForm.inline_keyboard.menu,"onUpdate:modelValue":s[5]||(s[5]=i=>t.itemForm.inline_keyboard.menu=i)},null,8,["modelValue"]))])])])):r("",!0),e("div",Mz,[e("div",Dz,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[6]||(s[6]=i=>t.need_custom_settings=i),type:"checkbox",id:"need_custom_settings"},null,512),[[k,t.need_custom_settings]]),Ez])]),e("div",Lz,[t.need_custom_settings?(l(),n("div",Kz,[e("div",Nz,[Jz,e("button",{type:"button",onClick:s[7]||(s[7]=(...i)=>t.addCustomSettings&&t.addCustomSettings(...i)),class:"btn btn-outline-primary"},"Добавить настройку ")]),e("div",Hz,[t.itemForm.custom_settings.length>0?(l(!0),n(v,{key:0},y(t.itemForm.custom_settings,(i,d)=>(l(),n("div",Yz,[e("div",Gz,[e("label",Wz,[f(a,{content:"Ключ"},{default:g(()=>[Xz]),_:1}),m(" Ключ "),Zz]),c(e("input",{type:"text",class:"form-control",placeholder:"Ключ","aria-label":"Ключ",min:"0","onUpdate:modelValue":_=>t.itemForm.custom_settings[d].key=_,"aria-describedby":"price",required:""},null,8,xz),[[h,t.itemForm.custom_settings[d].key]])]),e("div",eP,[e("label",tP,[f(a,{content:"Значение"},{default:g(()=>[sP]),_:1}),m(" Значение "),oP]),c(e("input",{type:"text",class:"form-control",placeholder:"Значение","aria-label":"Значение",min:"0","onUpdate:modelValue":_=>t.itemForm.custom_settings[d].value=_,"aria-describedby":"price",required:""},null,8,lP),[[h,t.itemForm.custom_settings[d].value]])]),e("div",nP,[e("button",{onClick:_=>t.removeCustomSetting(d),class:"btn btn-outline-danger"},"Удалить ",8,iP)])]))),256)):(l(),n("div",aP,rP))])])):r("",!0)])]),cP],32)}}}),_P={class:"row"},hP={class:"col-12 mb-3"},pP={class:"form-label",id:"service-title"},bP=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),fP=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),gP={class:"col-12 mb-3"},vP={class:"form-label",id:"service-description"},$P=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),yP=e("div",null," Краткая информация о команде ",-1),kP=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),FP={key:0,class:"text-gray-400 ml-3",style:{"font-size":"10px"}},wP={class:"col-12 mb-2"},CP={key:0},SP={class:"table-responsive"},jP={class:"table"},VP=e("thead",null,[e("tr",null,[e("th",{scope:"col"},"Название"),e("th",{scope:"col"},"Описание"),e("th",{scope:"col"},"Текст"),e("th",{scope:"col"},"Есть клавиатура"),e("th",{scope:"col"},"Есть доп настройки"),e("th",{scope:"col"},"Действие")])],-1),qP=["onClick"],zP=["onClick"],PP=["onClick"],UP={key:0,class:"fa-solid fa-check text-success"},OP={key:1,class:"fa-solid fa-xmark text-danger"},AP={key:0,class:"fa-solid fa-check text-success"},IP={key:1,class:"fa-solid fa-xmark text-danger"},QP={class:"dropdown"},TP=e("button",{class:"btn btn-link",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-solid fa-bars"})],-1),BP={class:"dropdown-menu"},RP=["onClick"],MP={class:"row"},DP={class:"col-12"},EP={type:"submit",class:"btn btn-outline-success w-100 p-3"},LP={key:0},KP={key:1},NP={class:"modal fade",id:"inline-query-item-editor",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},JP={class:"modal-dialog modal-lg"},HP={class:"modal-content"},YP={class:"modal-body"},GP={props:["bot","inlineQuery"],data(){return{load:!1,selectedInlineQueryItem:null,inlineQueryModal:null,inlineQueryForm:{id:null,command:null,description:null,items:[]}}},watch:{inlineQueryForm:{handler(o){this.need_reset=!0},deep:!0}},mounted(){this.inlineQueryModal=new bootstrap.Modal(document.getElementById("inline-query-item-editor"),{}),this.inlineQuery&&this.$nextTick(()=>{this.inlineQueryForm={id:this.inlineQuery.id||null,command:this.inlineQuery.command||null,description:this.inlineQuery.description||null,items:this.inlineQuery.items||[]}})},methods:{removeInlineQueryItem(o){const t=this.inlineQueryForm.items[o];this.inlineQueryForm.items.splice(o,1),this.$store.dispatch("removeInlineQueryItem",{queryItemId:t.id}).then(s=>{this.$notify("Команда успешно удалена")}).catch(s=>{this.$notify("Ошибка удаления команды")})},openModal(){this.load=!0,this.$nextTick(()=>{this.selectedInlineQueryItem=null,this.load=!1,this.inlineQueryModal.show()})},addInlineQueryItem(o){let t=this.inlineQueryForm.items.findIndex(s=>s.id===o.id);t===-1?this.inlineQueryForm.items.push(o):this.inlineQueryForm.items[t]=o},selectInlineQueryItem(o){this.load=!0,this.$nextTick(()=>{this.selectedInlineQueryItem=o,this.load=!1,this.inlineQueryModal.show()})},submitForm(){let o=new FormData;Object.keys(this.inlineQueryForm).forEach(t=>{const s=this.inlineQueryForm[t]||"";typeof s=="object"?o.append(t,JSON.stringify(s)):o.append(t,s)}),o.append("bot_id",this.bot.id),this.$store.dispatch("storeInlineQuery",{inlineQueryForm:o}).then(t=>{this.inlineQueryForm={id:null,command:null,description:null,items:[]},this.$emit("callback",t.data),this.$notify("Команда успешно создана")}).catch(t=>{this.$notify("Ошибка создания команды"),this.$emit("callback",response.data)})}}},WP=Object.assign(GP,{__name:"InlineQueryForm",setup(o){return(t,s)=>{const a=V("Popper");return l(),n(v,null,[e("form",{onSubmit:s[3]||(s[3]=S((...i)=>t.submitForm&&t.submitForm(...i),["prevent"]))},[e("div",_P,[e("div",hP,[e("label",pP,[f(a,{content:"Название оказываемой услуги"},{default:g(()=>[bP]),_:1}),m(" Название команды "),fP]),c(e("input",{type:"text",class:"form-control",placeholder:"Команда","aria-label":"Команда","onUpdate:modelValue":s[0]||(s[0]=i=>t.inlineQueryForm.command=i),maxlength:"255","aria-describedby":"service-title",required:""},null,512),[[h,t.inlineQueryForm.command]])]),e("div",gP,[e("label",vP,[f(a,null,{content:g(()=>[yP]),default:g(()=>[$P]),_:1}),m(" Описание команду "),kP,t.inlineQueryForm.description?(l(),n("small",FP," Длина текста "+u(t.inlineQueryForm.description.length)+" / 255",1)):r("",!0)]),c(e("textarea",{type:"text",class:"form-control",placeholder:"Описание команды","aria-label":"Описание команды",maxlength:"255","onUpdate:modelValue":s[1]||(s[1]=i=>t.inlineQueryForm.description=i),"aria-describedby":"service-description",required:""},`
                    `,512),[[h,t.inlineQueryForm.description]])]),e("div",wP,[e("button",{type:"button",class:"btn btn-outline-primary",onClick:s[2]||(s[2]=(...i)=>t.openModal&&t.openModal(...i))}," Добавление пункта меню ")]),t.inlineQueryForm.items.length>0?(l(),n("div",CP,[e("div",SP,[e("table",jP,[VP,e("tbody",null,[(l(!0),n(v,null,y(t.inlineQueryForm.items,(i,d)=>(l(),n("tr",null,[e("td",{onClick:_=>t.selectInlineQueryItem(i)},u(i.title||"-"),9,qP),e("td",{onClick:_=>t.selectInlineQueryItem(i)},u(i.description||"-"),9,zP),e("td",{onClick:_=>t.selectInlineQueryItem(i)},u(i.input_message_content||"-"),9,PP),e("td",null,[i.inline_keyboard?(l(),n("i",UP)):(l(),n("i",OP))]),e("td",null,[(i.custom_settings||[]).length>0?(l(),n("i",AP)):(l(),n("i",IP))]),e("td",null,[e("div",QP,[TP,e("ul",BP,[e("li",null,[e("a",{class:"dropdown-item",onClick:_=>t.removeInlineQueryItem(d),href:"#"},"Удалить",8,RP)])])])])]))),256))])])])])):r("",!0)]),e("div",MP,[e("div",DP,[e("button",EP,[t.inlineQueryForm.id===null?(l(),n("span",LP,"Создать встроенное меню")):(l(),n("span",KP,"Обновить встроенное меню"))])])])],32),e("div",NP,[e("div",JP,[e("div",HP,[e("div",YP,[t.load?r("",!0):(l(),$(mP,{key:0,item:t.selectedInlineQueryItem,onCallback:t.addInlineQueryItem},null,8,["item","onCallback"]))])])])])],64)}}}),XP={class:"row"},ZP={class:"col-12"},xP={key:0,class:"table"},eU=e("th",{scope:"col",class:"cursor-pointer"},"Кол-во пунктов меню",-1),tU=e("th",{scope:"col"},"Действие",-1),sU={scope:"row"},oU=["onClick"],lU={key:0,class:"dropdown"},nU=e("button",{class:"btn btn-outline-secondary",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-solid fa-ellipsis"})],-1),iU={class:"dropdown-menu"},aU={key:0},dU=["onClick"],rU={key:1},cU={class:"col-12"},uU={props:["bot"],data(){return{direction:"desc",order:"updated_at",show:!0,loading:!0,queries:[],search:null,paginate_object:null}},computed:{...C(["getInlineQueries","getInlineQueriesPaginateObject"])},mounted(){this.loadInlineQueries()},methods:{nextInlineQuery(o){this.loadInlineQueries(o)},selectInlineQuery(o){this.$emit("select",o),this.$notify("Встроенное меню успешно выбрано")},removeInlineQuery(o){this.loading=!0,this.$store.dispatch("removeInlineQuery",{queryId:o}).then(t=>{this.loading=!1,this.loadInlineQueries(0),this.$notify("Встроенное меню успешно удалено")}).catch(()=>{this.loading=!1,this.$notify("Ошибка удаления встроенного меню")})},loadAndOrder(o){this.order=o,this.direction=this.direction==="desc"?"asc":"desc",this.loadInlineQueries(0)},loadInlineQueries(o=0){this.loading=!0,this.$store.dispatch("loadInlineQueries",{dataObject:{bot_id:this.bot.id||null,search:this.search,order:this.order,direction:this.direction},page:o,size:100}).then(t=>{this.loading=!1,this.queries=this.getInlineQueries,this.paginate_object=this.getInlineQueriesPaginateObject}).catch(()=>{this.loading=!1})}}},mU=Object.assign(uU,{__name:"InlineQueryTable",setup(o){return(t,s)=>(l(),n("div",XP,[e("div",ZP,[t.queries.length>0?(l(),n("table",xP,[e("thead",null,[e("tr",null,[e("th",{scope:"col",class:"cursor-pointer",onClick:s[0]||(s[0]=a=>t.loadAndOrder("id"))},"#"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[1]||(s[1]=a=>t.loadAndOrder("command"))},"Команда"),eU,e("th",{scope:"col",class:"cursor-pointer",onClick:s[2]||(s[2]=a=>t.loadAndOrder("description"))},"Описание"),tU])]),e("tbody",null,[(l(!0),n(v,null,y(t.queries,(a,i)=>(l(),n("tr",{class:b({"border-info":a.deleted_at==null,"border-danger":a.deleted_at!=null})},[e("th",sU,u(a.id),1),e("td",{onClick:d=>t.selectInlineQuery(a)},u(a.command||"Не указано"),9,oU),e("td",null,u(a.items.length),1),e("td",null,u(a.description||"Не указано"),1),e("td",null,[a.id?(l(),n("div",lU,[nU,e("ul",iU,[a.deleted_at==null?(l(),n("li",aU,[e("a",{class:"dropdown-item",onClick:d=>t.removeInlineQuery(a.id),href:"javascript:void(0)"},"Удалить",8,dU)])):r("",!0)])])):r("",!0)])],2))),256))])])):(l(),n("p",rU,"На текущий момент нет ни одной созданной команды"))]),e("div",cU,[t.paginate_object?(l(),$(j,{key:0,onPagination_page:t.nextInlineQuery,pagination:t.paginate_object},null,8,["onPagination_page","pagination"])):r("",!0)])]))}}),_U={class:"my-2"},hU={key:0,class:"row mb-2"},pU={class:"col-12"},bU={key:3,class:"spinner-border",role:"status"},fU=e("span",{class:"visually-hidden"},"Loading...",-1),gU=[fU],vU={props:["bot"],data(){return{load:!1,selectedInlineQuery:null}},mounted(){},methods:{selectInlineQuery(o){this.load=!0,this.$nextTick(()=>{this.selectedInlineQuery=o,this.load=!1})},reloadTable(){this.load=!0,this.$nextTick(()=>{this.load=!1})}}},$U=Object.assign(vU,{__name:"InlineQuery",setup(o){return(t,s)=>(l(),n("div",_U,[t.selectedInlineQuery!=null?(l(),n("div",hU,[e("div",pU,[e("button",{type:"button",onClick:s[0]||(s[0]=a=>t.selectInlineQuery(null)),class:"btn btn-primary"}," Добавить новое встроенное меню")])])):r("",!0),t.load?r("",!0):(l(),$(WP,{key:1,bot:o.bot,onCallback:t.reloadTable,"inline-query":t.selectedInlineQuery},null,8,["bot","onCallback","inline-query"])),t.load?r("",!0):(l(),$(mU,{key:2,bot:o.bot,onSelect:t.selectInlineQuery},null,8,["bot","onSelect"])),t.load?(l(),n("div",bU,gU)):r("",!0)]))}}),yU={class:"row"},kU={class:"col-12 mb-3"},FU={class:"form-label",id:"quiz-title"},wU=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),CU=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),SU={class:"col-12 mb-3"},jU={class:"form-label",id:"quiz-description"},VU=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),qU=e("div",null," Краткая информация о назначении промокода ",-1),zU=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),PU={key:0,class:"text-gray-400 ml-3",style:{"font-size":"10px"}},UU={class:"col-12 mb-3"},OU={class:"form-check"},AU=e("label",{class:"form-check-label",for:"is_active"}," Доступен для активации ",-1),IU={class:"col-12 mb-3"},QU={class:"form-label",id:"promoCodeForm-max_activation_count"},TU=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),BU=e("div",null," Максимальное число активация кода ",-1),RU=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),MU={class:"col-12 mb-3"},DU={class:"form-check"},EU=e("label",{class:"form-check-label",for:"promoCodeForm-cashback_amount"}," Нужно начислить CashBack по промокоду ",-1),LU={key:0,class:"col-12 mb-3"},KU={class:"form-label",id:"quiz-time_limit"},NU=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),JU=e("div",null," Сколько % нужно ответить чтоб пройти ",-1),HU=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),YU={key:1,class:"col-12 mb-3"},GU={class:"form-check"},WU=e("label",{class:"form-check-label",for:"promoCodeForm-need_slots"}," Нужны слоты для активации ",-1),XU={key:2,class:"col-12 mb-3"},ZU={class:"form-label",id:"promoCodeForm-slot_amount"},xU=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),eO=e("div",null," Укажите количество слотов, которые получит пользователь при активации (внимание, доступно только для администраторов) ",-1),tO=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),sO={key:0,class:"col-12 mb-3"},oO={class:"form-check"},lO=e("label",{class:"form-check-label",for:"promoCodeForm-need_attach_scripts"}," Нужно добавить скрипты ",-1),nO={key:1,class:"col-12 mb-3"},iO=["onClick"],aO={class:"row"},dO={class:"col-12"},rO={type:"submit",class:"btn btn-outline-success w-100 p-3"},cO={key:0},uO={key:1},mO={props:["code","bot"],data(){return{step:0,load:!1,need_reset:!1,need_cashback:!1,need_slots:!1,need_attach_scripts:!1,promoCodeForm:{id:null,code:null,description:null,slot_amount:0,cashback_amount:0,max_activation_count:1,is_active:!1,scripts:[]}}},computed:{getSelf(){return window.profile}},watch:{promoCodeForm:{handler(o){this.need_reset=!0},deep:!0}},mounted(){this.code&&this.$nextTick(()=>{this.promoCodeForm={id:this.code.id||null,description:this.code.description||null,code:this.code.code||null,slot_amount:this.code.slot_amount||0,cashback_amount:this.code.cashback_amount||0,max_activation_count:this.code.max_activation_count||1,is_active:this.code.is_active||!1,scripts:this.code.scripts||[]},this.promoCodeForm.slot_amount>0&&(this.need_slots=!0),this.promoCodeForm.cashback_amount>0&&(this.need_cashback=!0),this.promoCodeForm.scripts.length>0&&(this.need_attach_scripts=!0)})},methods:{removeSlug(o){this.promoCodeForm.scripts.splice(o,1)},selectSlugsCallback(o){this.promoCodeForm.scripts.findIndex(s=>s.id===o.id)===-1&&this.promoCodeForm.scripts.push(o)},submitForm(){let o=new FormData;Object.keys(this.promoCodeForm).forEach(t=>{const s=this.promoCodeForm[t]||"";typeof s=="object"?o.append(t,JSON.stringify(s)):o.append(t,s)}),o.append("bot_id",this.bot.id),this.$store.dispatch("storePromoCodes",{promoCodeForm:o}).then(t=>{this.promoCodeForm={id:null,code:null,description:null,slot_amount:0,cashback_amount:0,max_activation_count:1,scripts:[],is_active:!1},this.$emit("callback",t.data),this.$notify("Промокод успешно создан")}).catch(t=>{this.$notify("Ошибка создания промокода")})}}},te=Object.assign(mO,{__name:"PromoCodesForm",setup(o){return(t,s)=>{const a=V("Popper");return l(),n("form",{onSubmit:s[9]||(s[9]=S((...i)=>t.submitForm&&t.submitForm(...i),["prevent"])),class:"py-3"},[e("div",yU,[e("div",kU,[e("label",FU,[f(a,{content:"Название вашего квиза"},{default:g(()=>[wU]),_:1}),m(" Промокод (вписать или сгенерировать) "),CU]),c(e("input",{type:"text",class:"form-control",placeholder:"Название","aria-label":"Название","onUpdate:modelValue":s[0]||(s[0]=i=>t.promoCodeForm.code=i),maxlength:"255","aria-describedby":"quiz-title",required:""},null,512),[[h,t.promoCodeForm.code]])]),e("div",SU,[e("label",jU,[f(a,null,{content:g(()=>[qU]),default:g(()=>[VU]),_:1}),m(" Назначение промокода "),zU,t.promoCodeForm.description?(l(),n("small",PU," Длина текста "+u(t.promoCodeForm.description.length)+"/255",1)):r("",!0)]),c(e("textarea",{class:"form-control",placeholder:"Описание промокода","aria-label":"Описание промокода",maxlength:"255","onUpdate:modelValue":s[1]||(s[1]=i=>t.promoCodeForm.description=i),"aria-describedby":"quiz-description",required:""},`
                    `,512),[[h,t.promoCodeForm.description]])]),e("div",UU,[e("div",OU,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[2]||(s[2]=i=>t.promoCodeForm.is_active=i),type:"checkbox",id:"is_active"},null,512),[[k,t.promoCodeForm.is_active]]),AU])]),e("div",IU,[e("label",QU,[f(a,null,{content:g(()=>[BU]),default:g(()=>[TU]),_:1}),m(" Количество активация кода "),RU]),c(e("input",{type:"number",class:"form-control",placeholder:"Число попыток","aria-label":"Число попыток",step:"1",min:"1","onUpdate:modelValue":s[3]||(s[3]=i=>t.promoCodeForm.max_activation_count=i),"aria-describedby":"promoCodeForm-max_activation_count",required:""},null,512),[[h,t.promoCodeForm.max_activation_count]])]),e("div",MU,[e("div",DU,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[4]||(s[4]=i=>t.need_cashback=i),type:"checkbox",id:"promoCodeForm-cashback_amount"},null,512),[[k,t.need_cashback]]),EU])]),t.need_cashback?(l(),n("div",LU,[e("label",KU,[f(a,null,{content:g(()=>[JU]),default:g(()=>[NU]),_:1}),m(" Сколько CashBack начислить по промокоду? "),HU]),c(e("input",{type:"number",class:"form-control",placeholder:"Процент для победы","aria-label":"Процент для победы",step:"1",min:"0","onUpdate:modelValue":s[5]||(s[5]=i=>t.promoCodeForm.cashback_amount=i),"aria-describedby":"promoCodeForm-cashback_amount",required:""},null,512),[[h,t.promoCodeForm.cashback_amount]])])):r("",!0),t.getSelf.is_admin?(l(),n("div",YU,[e("div",GU,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[6]||(s[6]=i=>t.need_slots=i),type:"checkbox",id:"promoCodeForm-need_slots"},null,512),[[k,t.need_slots]]),WU])])):r("",!0),t.need_slots?(l(),n("div",XU,[e("label",ZU,[f(a,null,{content:g(()=>[eO]),default:g(()=>[xU]),_:1}),m(" Сколько нужно добавить слотов? "),tO]),c(e("input",{type:"number",class:"form-control",placeholder:"Количество слотов","aria-label":"Количество слотов",step:"1",min:"0","onUpdate:modelValue":s[7]||(s[7]=i=>t.promoCodeForm.slot_amount=i),"aria-describedby":"promoCodeForm-slot_amount",required:""},null,512),[[h,t.promoCodeForm.slot_amount]])])):r("",!0)]),t.getSelf.is_admin?(l(),n("div",sO,[e("div",oO,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[8]||(s[8]=i=>t.need_attach_scripts=i),type:"checkbox",id:"promoCodeForm-need_attach_scripts"},null,512),[[k,t.need_attach_scripts]]),lO])])):r("",!0),t.need_attach_scripts?(l(),n("div",nO,[e("p",null,[(l(!0),n(v,null,y(t.promoCodeForm.scripts,(i,d)=>(l(),n("span",{class:"badge bg-primary mr-2 mb-2 cursor-pointer",onClick:_=>t.removeSlug(d)},u(i.command||"-"),9,iO))),256))]),o.bot?(l(),$(H,{key:0,"can-add":!0,bot:o.bot,"hide-add-modal":!0,onSelect:t.selectSlugsCallback},null,8,["bot","onSelect"])):r("",!0)])):r("",!0),e("div",aO,[e("div",dO,[e("button",rO,[t.promoCodeForm.id==null?(l(),n("span",cO,"Создать промокод")):(l(),n("span",uO,"Обновить промокод"))])])])],32)}}}),_O={class:"row py-2"},hO={class:"col-12"},pO={class:"input-group mb-3"},bO={class:"col-12"},fO={key:0,class:"table"},gO=e("th",{scope:"col",class:"cursor-pointer"},"Число активаций",-1),vO=e("th",{scope:"col"},"Действие",-1),$O={scope:"row"},yO=["onClick"],kO={key:0},FO={key:0,class:"fa-solid fa-chevron-down text-success"},wO={key:1,class:"fa-solid fa-xmark text-danger"},CO={key:0,class:"dropdown"},SO=e("button",{class:"btn btn-outline-secondary",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-solid fa-ellipsis"})],-1),jO={class:"dropdown-menu"},VO={key:0},qO=["onClick"],zO={key:1},PO=e("div",{class:"alert alert-warning alert-dismissible fade show",role:"alert"},[e("strong",null,"Внимание!"),m(" Вы еще не добавили ни одного промокода! "),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"alert","aria-label":"Close"})],-1),UO={class:"position-relative p-5 text-center text-muted bg-body border border-dashed rounded-2"},OO={class:"d-flex justify-content-center mb-3"},AO={alt:"",width:"100",height:"100"},IO=e("h1",{class:"text-body-emphasis"},"Создание промокода",-1),QO=e("p",{class:"col-lg-8 mx-auto fs-5 text-muted"}," Промокод - это инструмент мотивации пользователей пользоваться вашим сервисом. Он позволяет клиентам получать некоторые бонусы за активацию кода, а вы в свою очередь будете видеть статистику активация прмокода. ",-1),TO={class:"d-inline-flex gap-2 mb-5"},BO=e("a",{href:"#",target:"_blank",class:"d-inline-flex align-items-center btn btn-outline-secondary btn-lg px-4 rounded-pill"}," Подробнее ",-1),RO={key:0,class:"col-12"},MO={props:["bot"],data(){return{direction:"desc",order:"updated_at",show:!0,loading:!0,codes:[],search:null,paginate_object:null}},computed:{...C(["getPromoCodes","getPromoCodesPaginateObject"]),getSelf(){return window.profile}},mounted(){this.loadPromoCodes()},methods:{removeQuiz(o){this.loading=!0,this.$store.dispatch("removePromoCodes",{promoCodeId:o}).then(t=>{this.loading=!1,this.loadPromoCodes(0),this.$notify("Промокод успешно удален")}).catch(()=>{this.loading=!1,this.$notify("Ошибка удаления промокода")})},createPromoCode(){this.$emit("create")},nextPromoCodes(o){this.loadPromoCodes(o)},selectEvent(o){this.$emit("select",o)},loadAndOrder(o){this.order=o,this.direction=this.direction==="desc"?"asc":"desc",this.loadPromoCodes(0)},loadPromoCodes(o=0){this.loading=!0,this.$store.dispatch("loadPromoCodes",{dataObject:{bot_id:this.bot.id||null,search:this.search,order:this.order,direction:this.direction},page:o,size:20}).then(t=>{this.loading=!1,this.codes=this.getPromoCodes,this.paginate_object=this.getPromoCodesPaginateObject}).catch(()=>{this.loading=!1})}}},DO=Object.assign(MO,{__name:"PromoCodesTable",setup(o){return(t,s)=>{const a=I("lazy");return l(),n("div",_O,[e("div",hO,[e("div",pO,[c(e("input",{type:"search",class:"form-control",placeholder:"Поиск кода","aria-label":"Поиск кода","onUpdate:modelValue":s[0]||(s[0]=i=>t.search=i),"aria-describedby":"promocode-search-and-filter"},null,512),[[h,t.search]]),e("button",{class:"btn btn-outline-secondary",onClick:s[1]||(s[1]=i=>t.loadPromoCodes(0)),type:"button",id:"promocode-search-and-filter"},"Найти ")])]),e("div",bO,[t.codes.length>0?(l(),n("table",fO,[e("thead",null,[e("tr",null,[e("th",{scope:"col",class:"cursor-pointer",onClick:s[2]||(s[2]=i=>t.loadAndOrder("id"))},"#"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[3]||(s[3]=i=>t.loadAndOrder("code"))},"Код"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[4]||(s[4]=i=>t.loadAndOrder("description"))},"Описание"),t.getSelf.is_admin?(l(),n("th",{key:0,scope:"col",class:"cursor-pointer",onClick:s[5]||(s[5]=i=>t.loadAndOrder("slot_amount"))},"Число слотов ")):r("",!0),e("th",{scope:"col",class:"cursor-pointer",onClick:s[6]||(s[6]=i=>t.loadAndOrder("cashback_amount"))},"Величина CashBack-а, руб "),e("th",{scope:"col",class:"cursor-pointer",onClick:s[7]||(s[7]=i=>t.loadAndOrder("max_activation_count"))},"Максимальное число активаций "),gO,e("th",{scope:"col",class:"cursor-pointer",onClick:s[8]||(s[8]=i=>t.loadAndOrder("is_active"))},"Активный"),vO])]),e("tbody",null,[(l(!0),n(v,null,y(t.codes,(i,d)=>(l(),n("tr",{class:b({"border-info":i.deleted_at==null,"border-danger":i.deleted_at!=null})},[e("th",$O,u(i.id),1),e("td",{onClick:_=>t.selectEvent(i)},u(i.code||"Не указано"),9,yO),e("td",null,u(i.description||"Не указано"),1),t.getSelf.is_admin?(l(),n("td",kO,u(i.slot_amount),1)):r("",!0),e("td",null,u(i.cashback_amount),1),e("td",null,u(i.max_activation_count),1),e("td",null,u(i.current_activation_count||0),1),e("td",null,[i.is_active?(l(),n("i",FO)):(l(),n("i",wO))]),e("td",null,[i.id?(l(),n("div",CO,[SO,e("ul",jO,[i.deleted_at==null?(l(),n("li",VO,[e("a",{class:"dropdown-item",onClick:_=>t.removeQuiz(i.id),href:"javascript:void(0)"},"Удалить",8,qO)])):r("",!0)])])):r("",!0)])],2))),256))])])):(l(),n("div",zO,[PO,e("div",UO,[e("div",OO,[c(e("img",AO,null,512),[[a,"../images/icon.png"]])]),IO,QO,e("div",TO,[e("button",{onClick:s[9]||(s[9]=(...i)=>t.createPromoCode&&t.createPromoCode(...i)),class:"d-inline-flex align-items-center btn btn-lg px-4 rounded-pill btn-primary",type:"button"}," Добавить "),BO])])]))]),t.codes.length>0?(l(),n("div",RO,[t.paginate_object?(l(),$(j,{key:0,onPagination_page:t.nextPromoCodes,pagination:t.paginate_object},null,8,["onPagination_page","pagination"])):r("",!0)])):r("",!0)])}}}),EO={key:0,class:"py-2"},LO={class:"row"},KO={class:"col-12"},NO={key:1,class:"py-2"},JO={class:"row"},HO={class:"col-12"},YO={key:2,class:"py-2"},GO={class:"row"},WO={class:"col-12"},XO={class:"nav nav-tabs justify-content-center"},ZO={key:0,class:"row py-3"},xO={class:"col-12"},eA={key:1,class:"row py-3"},tA=e("div",{class:"col-12 py-3"},[e("h4",null,"Статистика")],-1),sA=[tA],oA={props:["bot"],data(){return{part:0,tab:0,selectedPromoCode:null,loadForm:!1,loadTable:!1}},methods:{callbackForm(){this.loadTable=!0,this.selectedPromoCode=null,this.part=0,this.$nextTick(()=>{this.loadTable=!1})},createPromoCode(){this.part=2},selectPromoCode(o){this.loadForm=!0,this.$nextTick(()=>{this.loadForm=!1,this.selectedPromoCode=o,this.part=1,this.tab=0})}}},lA=Object.assign(oA,{__name:"PromoCodes",setup(o){return(t,s)=>(l(),n(v,null,[t.part===0?(l(),n("div",EO,[e("div",LO,[e("div",KO,[e("button",{type:"button",onClick:s[0]||(s[0]=(...a)=>t.createPromoCode&&t.createPromoCode(...a)),class:"btn btn-primary"}," Создать новый промокод ")])]),t.loadTable?r("",!0):(l(),$(DO,{key:0,onCreate:t.createPromoCode,onSelect:t.selectPromoCode,bot:o.bot},null,8,["onCreate","onSelect","bot"]))])):r("",!0),t.part===2?(l(),n("div",NO,[e("div",JO,[e("div",HO,[e("button",{type:"button",onClick:s[1]||(s[1]=a=>t.part=0),class:"btn btn-outline-primary"}," Назад ")])]),t.loadForm?r("",!0):(l(),$(te,{key:0,onCallback:t.callbackForm,bot:o.bot},null,8,["onCallback","bot"]))])):r("",!0),t.part===1?(l(),n("div",YO,[e("div",GO,[e("div",WO,[e("button",{type:"button",onClick:s[2]||(s[2]=a=>t.part=0),class:"btn btn-outline-primary"}," Назад ")])]),e("ul",XO,[e("li",{class:"nav-item",onClick:s[3]||(s[3]=a=>t.tab=0)},[e("a",{class:b(["nav-link",{active:t.tab===0}]),"aria-current":"page",href:"javascript:void(0)"},"Информация о Промокоде",2)]),e("li",{class:"nav-item",onClick:s[4]||(s[4]=a=>t.tab=1)},[e("a",{class:b(["nav-link",{active:t.tab===1}]),href:"javascript:void(0)"},"Статистика использования",2)])]),t.tab===0?(l(),n("div",ZO,[e("div",xO,[t.loadForm?r("",!0):(l(),$(te,{key:0,onCallback:t.callbackForm,code:t.selectedPromoCode,bot:o.bot},null,8,["onCallback","code","bot"]))])])):r("",!0),t.tab===1?(l(),n("div",eA,sA)):r("",!0)])):r("",!0)],64))}}),nA={props:["data"],data(){return{hasConnect:!1,bot:null,frontPadForm:{hook_url:null,channel:null,affiliate:null,point:null,token:null,statuses:[{value:null,key:"new",title:"Новый"}],bot_id:null,pays:[{value:null,key:"cash",title:"Наличные"},{value:null,key:"card",title:"Перевод на карту"}]}}},computed:{...C(["getCurrentBot"])},mounted(){this.bot=this.getCurrentBot,this.data?this.$nextTick(()=>{this.frontPadForm.hook_url=this.data.hook_url||null,this.frontPadForm.channel=this.data.channel||null,this.frontPadForm.affiliate=this.data.affiliate||null,this.frontPadForm.point=this.data.point||null,this.frontPadForm.token=this.data.token||null,this.frontPadForm.bot_id=this.data.bot_id||this.bot.id||null,this.data.pays!=null&&(this.frontPadForm.pays=this.data.pays),this.data.statuses!=null&&(this.frontPadForm.statuses=this.data.statuses)}):this.frontPadForm.bot_id=this.bot.id||null},methods:{submit(){let o=new FormData;Object.keys(this.frontPadForm).forEach(t=>{const s=this.frontPadForm[t]||"";typeof s=="object"?o.append(t,JSON.stringify(s)):o.append(t,s)}),this.$store.dispatch("saveFrontPad",{frontPadForm:o}).then(t=>{this.$notify("Данные CRM успешно сохранены")}).catch(t=>{})}}},iA={class:"col-md-6 col-12 mb-2"},aA={class:"form-label",id:"token"},dA=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),rA=e("div",null,"Токен интеграции",-1),cA=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),uA={class:"col-md-6 col-12 mb-2"},mA={class:"form-label",id:"channel"},_A=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),hA=e("div",null,'Данные брать из справочника FrontPad "Каналы продаж". Создать канал. Telegram. Указать значение для API',-1),pA={class:"col-md-6 col-12 mb-2"},bA={class:"form-label",id:"affiliate"},fA=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),gA=e("div",null,"Филиал",-1),vA={class:"col-md-6 col-12 mb-2"},$A={class:"form-label",id:"point"},yA=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),kA=e("div",null,"Филиал",-1),FA={class:"col-12"},wA=e("div",{class:"alert alert-info",role:"alert"},' Данные брать из справочника FrontPad "Статусы". Указать значение для API ',-1),CA={key:0,class:"card mb-2 p-0"},SA=e("div",{class:"card-header"},[e("h6",null,"Статусы")],-1),jA={class:"card-body"},VA={class:"table"},qA=e("thead",null,[e("tr",null,[e("th",{scope:"col"},"Название"),e("th",{scope:"col"},"Ключ"),e("th",{scope:"col"},"Значение")])],-1),zA=["onUpdate:modelValue"],PA={class:"col-12"},UA=e("div",{class:"alert alert-info",role:"alert"},' Данные брать из справочника FrontPad "Варианты оплат". Указать значение для API ',-1),OA={key:0,class:"card mb-2 p-0"},AA=e("div",{class:"card-header"},[e("h6",null,"Типы оплаты")],-1),IA={class:"card-body"},QA={class:"table"},TA=e("thead",null,[e("tr",null,[e("th",{scope:"col"},"Название"),e("th",{scope:"col"},"Ключ"),e("th",{scope:"col"},"Значение")])],-1),BA=["onUpdate:modelValue"],RA=e("div",{class:"col-md-12 col-12"},[e("button",{type:"submit",class:"btn btn-outline-primary p-3 w-100"},[e("i",{class:"fa-solid fa-cloud-arrow-down mr-1"}),m(" Сохранить настройку ")])],-1);function MA(o,t,s,a,i,d){const _=V("Popper");return l(),n("form",{onSubmit:t[4]||(t[4]=S((...p)=>d.submit&&d.submit(...p),["prevent"])),class:"row"},[e("div",iA,[e("label",aA,[f(_,null,{content:g(()=>[rA]),default:g(()=>[dA]),_:1}),m(" Токен интеграции "),cA]),c(e("input",{type:"text",class:"form-control",placeholder:"Токен","aria-label":"Токен","onUpdate:modelValue":t[0]||(t[0]=p=>i.frontPadForm.token=p),"aria-describedby":"token"},null,512),[[h,i.frontPadForm.token]])]),e("div",uA,[e("label",mA,[f(_,null,{content:g(()=>[hA]),default:g(()=>[_A]),_:1}),m(" Канал продаж ")]),c(e("input",{type:"text",class:"form-control",placeholder:"channel","aria-label":"channel","onUpdate:modelValue":t[1]||(t[1]=p=>i.frontPadForm.channel=p),"aria-describedby":"channel"},null,512),[[h,i.frontPadForm.channel]])]),e("div",pA,[e("label",bA,[f(_,null,{content:g(()=>[gA]),default:g(()=>[fA]),_:1}),m(" Филиал ")]),c(e("input",{type:"text",class:"form-control",placeholder:"Филиал","aria-label":"Филиал","onUpdate:modelValue":t[2]||(t[2]=p=>i.frontPadForm.affiliate=p),"aria-describedby":"Филиал"},null,512),[[h,i.frontPadForm.affiliate]])]),e("div",vA,[e("label",$A,[f(_,null,{content:g(()=>[kA]),default:g(()=>[yA]),_:1}),m(" Точка продаж ")]),c(e("input",{type:"text",class:"form-control",placeholder:"Точка продаж","aria-label":"Точка продаж","onUpdate:modelValue":t[3]||(t[3]=p=>i.frontPadForm.point=p),"aria-describedby":"Точка продаж"},null,512),[[h,i.frontPadForm.point]])]),e("div",FA,[wA,i.frontPadForm.statuses?(l(),n("div",CA,[SA,e("div",jA,[e("table",VA,[qA,e("tbody",null,[(l(!0),n(v,null,y(i.frontPadForm.statuses,(p,F)=>(l(),n("tr",null,[e("td",null,u(p.title||"-"),1),e("td",null,u(p.key||"-"),1),e("td",null,[c(e("input",{type:"text",class:"form-control",placeholder:"Статус","aria-label":"Статус","onUpdate:modelValue":w=>i.frontPadForm.statuses[F].value=w,"aria-describedby":"Статус"},null,8,zA),[[h,i.frontPadForm.statuses[F].value]])])]))),256))])])])])):r("",!0)]),e("div",PA,[UA,i.frontPadForm.pays?(l(),n("div",OA,[AA,e("div",IA,[e("table",QA,[TA,e("tbody",null,[(l(!0),n(v,null,y(i.frontPadForm.pays,(p,F)=>(l(),n("tr",null,[e("td",null,u(p.title||"-"),1),e("td",null,u(p.key||"-"),1),e("td",null,[c(e("input",{type:"text",class:"form-control",placeholder:"Статус","aria-label":"Статус","onUpdate:modelValue":w=>i.frontPadForm.pays[F].value=w,"aria-describedby":"Статус"},null,8,BA),[[h,i.frontPadForm.pays[F].value]])])]))),256))])])])])):r("",!0)]),RA],32)}const DA=U(nA,[["render",MA]]);const EA={class:"d-flex custom-dropdown justify-content-between align-items-center"},LA={class:"btn-group"},KA=e("i",{class:"fa-solid fa-info mr-2"},null,-1),NA=e("i",{class:"fa-solid fa-file mr-2"},null,-1),JA={key:0,class:"btn btn-primary",type:"button","data-bs-toggle":"offcanvas","data-bs-target":"#bot-section-menu","aria-controls":"staticBackdrop"},HA=e("i",{class:"fa-solid fa-screwdriver-wrench p-2 text-primary"},null,-1),YA=[HA],GA={key:0,class:"pb-5 mb-5"},WA={key:1,class:"pb-5 mb-5"},XA={key:2,class:"pb-5 mb-5"},ZA={key:3,class:"pb-5 mb-5"},xA={key:4,class:"pb-5 mb-5"},eI={key:5,class:"pb-5 mb-5"},tI={key:6,class:"pb-5 mb-5"},sI={key:7,class:"pb-5 mb-5"},oI={key:8,class:"pb-5 pt-2 mb-5"},lI={key:9,class:"pb-5 mb-5"},nI={key:10,class:"pb-5 mb-5 pt-2"},iI={key:11,class:"pb-5 mb-5"},aI={key:12,class:"pb-5 mb-5 pt-2"},dI={key:13,class:"pb-5 mb-5 pt-2"},rI={key:14,class:"pb-5 mb-5 pt-2"},cI={key:15,class:"row pb-5 mb-5"},uI={key:0,class:"col-12 col-md-12"},mI={key:16,class:"pb-5 mb-5"},_I={class:"offcanvas offcanvas-end","data-bs-scroll":"true","data-bs-backdrop":"false",tabindex:"-1",id:"bot-section-menu","aria-labelledby":"staticBackdropLabel"},hI=e("div",{class:"offcanvas-header"},[e("h5",{class:"offcanvas-title",id:"staticBackdropLabel"},"Меню управления ботом"),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"offcanvas","aria-label":"Close"})],-1),pI={class:"offcanvas-body"},bI={class:"list-group list-group-flush bot-section-menu-group"},fI=e("i",{class:"fa-regular fa-newspaper mr-2"},null,-1),gI=e("i",{class:"fa-regular fa-calendar-days mr-2"},null,-1),vI=e("i",{class:"fa-solid fa-q mr-2"},null,-1),$I=e("i",{class:"fa-solid fa-q mr-2"},null,-1),yI=e("i",{class:"fa-solid fa-clipboard-list mr-2"},null,-1),kI=e("i",{class:"fa-solid fa-code mr-2"},null,-1),FI=e("i",{class:"fa-solid fa-keyboard mr-2"},null,-1),wI=e("i",{class:"fa-solid fa-scroll mr-2"},null,-1),CI=e("i",{class:"fa-solid fa-comment-dots mr-2"},null,-1),SI=e("i",{class:"fa-solid fa-users mr-2"},null,-1),jI=e("i",{class:"fa-solid fa-list-check mr-2"},null,-1),VI=e("i",{class:"fa-solid fa-list-check mr-2"},null,-1),qI=e("i",{class:"fa-solid fa-list-check mr-2"},null,-1),zI=e("i",{class:"fa-brands fa-shopify mr-2"},null,-1),PI=e("i",{class:"fa-brands fa-shopify mr-2"},null,-1),UI={props:["bot"],data(){return{page:null,step:0,load:!1,loadPage:!1}},mounted(){this.setStep(localStorage.getItem("cashman_set_botform_step_index")||0)},methods:{botCallbackUpdate(o){this.$store.dispatch("updateCurrentBot",{bot:o}).then(()=>{}),this.$emit("callback")},hasRole(o){return window.hasRole(o)||!1},setStep(o){this.step=parseInt(o),localStorage.setItem("cashman_set_botform_step_index",o)},pageListCallback(o){this.loadPage=!0,this.page=o,this.$nextTick(()=>{this.loadPage=!1})},pageCallback(o){this.page=o,this.loadPageList=!0,this.$nextTick(()=>{this.loadPageList=!1})},loadCurrentCompany(o=null){this.$store.dispatch("updateCurrentCompany",{company:o}).then(()=>{this.company=this.getCurrentCompany})},companyListCallback(o){this.load=!0,this.loadCurrentCompany(o),this.$nextTick(()=>{this.load=!1})}}},qT=Object.assign(UI,{__name:"BotSection",setup(o){return(t,s)=>(l(),n(v,null,[e("div",EA,[e("div",LA,[e("button",{type:"button",class:b(["btn btn-primary text-primary",{"bg-primary text-white":t.step==0}]),onClick:s[0]||(s[0]=a=>t.setStep(0))},[KA,m("Информация о боте ")],2),e("button",{type:"button",class:b(["btn btn-primary text-primary",{"bg-primary text-white":t.step==4}]),onClick:s[1]||(s[1]=a=>t.setStep(4))},[NA,m("Страницы (кнопки бота) ")],2)]),t.hasRole("admin")?(l(),n("button",JA,YA)):r("",!0)]),t.step===14?(l(),n("div",GA,[t.load?r("",!0):(l(),$(nz,{key:0,bot:o.bot},null,8,["bot"]))])):r("",!0),t.step===16?(l(),n("div",WA,[t.load?r("",!0):(l(),$(lA,{key:0,bot:o.bot},null,8,["bot"]))])):r("",!0),t.step===13?(l(),n("div",XA,[t.load?r("",!0):(l(),$(K8,{key:0,bot:o.bot},null,8,["bot"]))])):r("",!0),t.step===0?(l(),n("div",ZA,[t.load?r("",!0):(l(),$(we,{key:0,onCallback:t.botCallbackUpdate,bot:o.bot},null,8,["onCallback","bot"]))])):r("",!0),t.step===15?(l(),n("div",xA,[t.load?r("",!0):(l(),$($U,{key:0,bot:o.bot},null,8,["bot"]))])):r("",!0),t.step===7?(l(),n("div",eI,[t.load?r("",!0):(l(),$(w0,{key:0,data:o.bot.amo},null,8,["data"]))])):r("",!0),t.step===17?(l(),n("div",tI,[t.load?r("",!0):(l(),$(DA,{key:0,data:o.bot.frontPad},null,8,["data"]))])):r("",!0),t.step===12?(l(),n("div",sI,[t.load?r("",!0):(l(),$(R0,{key:0,data:o.bot.y_clients},null,8,["data"]))])):r("",!0),t.step===11?(l(),n("div",oI,[t.load?r("",!0):(l(),$(bF,{key:0}))])):r("",!0),t.step===8?(l(),n("div",lI,[t.load?r("",!0):(l(),$(xk,{key:0}))])):r("",!0),t.step===10?(l(),n("div",nI,[t.load?r("",!0):(l(),$(B3,{key:0}))])):r("",!0),t.step===1?(l(),n("div",iI,[t.load?r("",!0):(l(),$(T,{key:0,"select-mode":!1}))])):r("",!0),t.step===6?(l(),n("div",aI,[t.load?r("",!0):(l(),$(re,{key:0}))])):r("",!0),t.step===2?(l(),n("div",dI,[t.load?r("",!0):(l(),$(Jn,{key:0}))])):r("",!0),t.step===3?(l(),n("div",rI,[t.load?r("",!0):(l(),$(D,{key:0}))])):r("",!0),t.step===4?(l(),n("div",cI,[t.load?r("",!0):(l(),n("div",uI,[t.loadPage?r("",!0):(l(),$(S$,{key:0,page:t.page,onCallback:t.pageCallback},null,8,["page","onCallback"]))]))])):r("",!0),t.step===9?(l(),n("div",mI,[f(W0,{bot:o.bot},null,8,["bot"])])):r("",!0),e("div",_I,[hI,e("div",pI,[e("ul",bI,[e("li",null,[e("a",{class:"list-group-item list-group-item-action",href:"#bot-news",onClick:s[2]||(s[2]=a=>t.setStep(9))},[fI,m(" Рассылки")])]),e("li",null,[e("a",{class:"list-group-item list-group-item-action",href:"#bot-appointments",onClick:s[3]||(s[3]=a=>t.setStep(13))},[gI,m("Запись на событие (прием)")])]),e("li",null,[e("a",{class:"list-group-item list-group-item-action",href:"#bot-quizzes",onClick:s[4]||(s[4]=a=>t.setStep(14))},[vI,m("Квизы")])]),e("li",null,[e("a",{class:"list-group-item list-group-item-action",href:"#bot-promo-codes",onClick:s[5]||(s[5]=a=>t.setStep(16))},[$I,m("Промокоды")])]),e("li",null,[e("a",{class:"list-group-item list-group-item-action",href:"#bot-inline-queries",onClick:s[6]||(s[6]=a=>t.setStep(15))},[yI,m("Встраиваемые запросы")])]),e("li",null,[e("a",{class:"list-group-item list-group-item-action",href:"#bot-custom-fields",onClick:s[7]||(s[7]=a=>t.setStep(10))},[kI,m("Настраиваемые поля")])]),e("li",null,[e("a",{class:"list-group-item list-group-item-action",href:"#bot-menu-template",onClick:s[8]||(s[8]=a=>t.setStep(1))},[FI,m("Все клавиатуры в боте")])]),e("li",null,[e("a",{class:"list-group-item list-group-item-action",href:"#bot-slugs",onClick:s[9]||(s[9]=a=>t.setStep(2))},[wI,m("Все скрипты в боте")])]),e("li",null,[e("a",{class:"list-group-item list-group-item-action",href:"#bot-dialogs",onClick:s[10]||(s[10]=a=>t.setStep(6))},[CI,m("Все диалоги в боте")])]),e("li",null,[e("a",{class:"list-group-item list-group-item-action",href:"#bot-users",onClick:s[11]||(s[11]=a=>t.setStep(3))},[SI,m("Все пользователи в боте")])]),e("li",null,[e("a",{class:"list-group-item list-group-item-action",href:"#bot-amo",onClick:s[12]||(s[12]=a=>t.setStep(7))},[jI,m(" AMO CRM")])]),e("li",null,[e("a",{class:"list-group-item list-group-item-action",href:"#bot-front-pad",onClick:s[13]||(s[13]=a=>t.setStep(17))},[VI,m(" FrontPad")])]),e("li",null,[e("a",{class:"list-group-item list-group-item-action",href:"#bot-y-clients",onClick:s[14]||(s[14]=a=>t.setStep(12))},[qI,m(" YClients")])]),e("li",null,[e("a",{class:"list-group-item list-group-item-action",href:"#bot-shop",onClick:s[15]||(s[15]=a=>t.setStep(8))},[zI,m(" Магазин")])]),e("li",null,[e("a",{class:"list-group-item list-group-item-action",href:"#bot-media",onClick:s[16]||(s[16]=a=>t.setStep(11))},[PI,m(" Медиа файлы бота")])])])])])],64))}}),OI={key:0},AI={key:0,class:"row"},II={class:"col-md-12"},QI=e("h4",null,"Боты в работе",-1),TI={class:"mb-0"},BI={class:"table mb-5"},RI=e("thead",null,[e("tr",null,[e("th",{scope:"col"},"#"),e("th",{scope:"col"},"Домен"),e("th",{scope:"col"},"Название"),e("th",{scope:"col"},"Шаблон"),e("th",{scope:"col"},"Дата изменения"),e("th",{scope:"col"},"Действие")])],-1),MI={scope:"row"},DI=["onClick"],EI=["onClick"],LI={key:0,class:"badge bg-primary"},KI={key:1},NI={class:"d-flex"},JI=["onClick"],HI=e("i",{class:"fa-regular fa-star"},null,-1),YI=[HI],GI=["onClick"],WI=e("i",{class:"fa-solid fa-chevron-down"},null,-1),XI=[WI],ZI=["onClick"],xI=e("i",{class:"fa-solid fa-chevron-up"},null,-1),eQ=[xI],tQ=e("hr",null,null,-1),sQ={class:"row"},oQ={class:"col-md-12 d-flex flex-column"},lQ={class:"d-flex"},nQ={class:"dropdown mr-2"},iQ=e("button",{class:"btn btn-outline-primary dropdown-toggle",type:"button",id:"dropdownMenuButton1","data-bs-toggle":"dropdown","aria-expanded":"false"}," Фильтры ",-1),aQ={class:"dropdown-menu","aria-labelledby":"dropdownMenuButton1"},dQ=["onClick"],rQ={class:"input-group mb-3"},cQ={key:0,class:"mt-2"},uQ={class:"badge bg-primary mr-1"},mQ=["onClick"],_Q=e("i",{class:"fa-solid fa-xmark"},null,-1),hQ=[_Q],pQ={key:1,class:"row"},bQ={class:"col-12"},fQ=e("h4",null,"Все боты",-1),gQ={class:"mb-0"},vQ={class:"mb-0"},$Q={key:2,class:"row"},yQ={class:"col-12 mb-3"},kQ={key:0,class:"col-12 mb-3"},FQ={class:"table"},wQ=e("th",{scope:"col"},"Действие",-1),CQ={scope:"row"},SQ=["onClick"],jQ=["onClick"],VQ={key:0,class:"badge bg-primary"},qQ={key:1},zQ={class:"d-flex"},PQ=["onClick"],UQ=e("i",{class:"fa-regular fa-star"},null,-1),OQ=[UQ],AQ=["onClick"],IQ=e("i",{class:"fa-regular fa-copy"},null,-1),QQ=[IQ],TQ=["onClick"],BQ=e("i",{class:"fa-solid fa-boxes-packing"},null,-1),RQ=[BQ],MQ=["onClick"],DQ=e("i",{class:"fa-solid fa-box-open"},null,-1),EQ=[DQ],LQ=["onClick"],KQ=e("i",{class:"fa-solid fa-trash-can text-white"},null,-1),NQ=[KQ],JQ={class:"col-lg-4 col-12 mb-3"},HQ={class:"card-body"},YQ=["onClick"],GQ={key:0,class:"badge bg-info"},WQ={class:"card-footer d-flex"},XQ=["onClick"],ZQ=e("i",{class:"fa-regular fa-star"},null,-1),xQ=[ZQ],eT=["onClick"],tT=e("i",{class:"fa-regular fa-copy"},null,-1),sT=[tT],oT=["onClick"],lT=e("i",{class:"fa-solid fa-boxes-packing"},null,-1),nT=[lT],iT=["onClick"],aT=e("i",{class:"fa-solid fa-box-open"},null,-1),dT=[aT],rT=["onClick"],cT=e("i",{class:"fa-solid fa-trash-can text-white"},null,-1),uT=[cT],mT={class:"col-12"},_T={key:3,class:"row"},hT=e("div",{class:"col-12"},[e("div",{class:"alert alert-warning",role:"alert"}," У выбранной компании нет созданных ботов! ")],-1),pT=[hT],bT={props:["companyId","editor"],data(){return{displayType:1,direction:"desc",order:"updated_at",filters:[{name:"Активные",icon:"fa-brands fa-telegram",slug:"active"},{name:"Архивные",icon:"fa-solid fa-box-archive",slug:"archive"}],selectedFilters:[],show:!0,loading:!0,bots:[],favorites:[],search:null,bots_paginate_object:null}},watch:{displayType:function(o,t){localStorage.setItem("cashman_set_botlist_display_type",this.displayType)},selectedFilters:{handler:function(o){this.loadBots()},deep:!0}},computed:{...C(["getBots","getBotsPaginateObject","getCurrentCompany","getBotFavorites","inBotFav"]),filteredBots(){if(!this.bots)return[];if(this.selectedFilters.length===0&&this.search==null)return this.bots;if(this.selectedFilters.length===0&&this.search!=null)return this.bots.filter(t=>(t.bot_domain||"").trim().toLowerCase().indexOf(this.search.trim().toLowerCase())!==-1);let o=[];return this.selectedFilters.forEach(t=>{switch(t.slug){case"active":this.bots.filter(s=>s.deleted_at==null).forEach(s=>{o.push(s)});break;case"archive":this.bots.filter(s=>s.deleted_at!=null).forEach(s=>{o.push(s)});break}}),this.search==null?o:o.filter(t=>(t.bot_domain||"").trim().toLowerCase().indexOf(this.search.trim().toLowerCase())!==-1)}},mounted(){this.selectFilter("active"),this.displayType=parseInt(localStorage.getItem("cashman_set_botlist_display_type")||0)},methods:{hasRole(o){return window.hasRole(o)||!1},loadBotsByIds(){if(this.getBotFavorites.length==0){this.favorites=[];return}this.loading=!0,this.$store.dispatch("loadBotsByIds",{ids:this.getBotFavorites}).then(o=>{this.loading=!1,this.favorites=o}).catch(()=>{this.loading=!1})},prepareFavorites(){this.$store.dispatch("loadBotFavs").then(o=>{this.loadBotsByIds()})},moveOrderFavBot(o,t){this.$store.dispatch("swapBotInFav",{id:o,direction:t}).then(s=>{this.loadBotsByIds()})},addToFavorite(o){if(this.inBotFav(o)){this.$store.dispatch("removeFromBotFavorites",o).then(t=>{this.$notify("Указанный бот успешно удален из избранного"),this.loadBotsByIds()});return}this.$store.dispatch("addBotToFavorites",o).then(t=>{this.$notify("Указанный бот успешно добавлен в избранное"),this.loadBotsByIds()})},duplicate(o){if(!this.getCurrentCompany){this.$notify("У Вас не выбран клиент!");return}this.$store.dispatch("duplicateBot",{dataObject:{bot_id:o,company_id:this.getCurrentCompany.id}}).then(t=>{let s=this.bots_paginate_object.meta.current_page||0;this.loadBots(s),this.$notify("Указанный бот успешно продублирован")})},addToArchive(o){this.$store.dispatch("removeBot",{botId:o}).then(t=>{let s=this.bots_paginate_object.meta.current_page||0;this.$store.dispatch("resetCurrentBot"),this.loadBots(s),this.$notify("Указанный бот успешно перемещен в архив")})},forceDelete(o){this.$store.dispatch("forceDeleteBot",{botId:o}).then(t=>{let s=this.bots_paginate_object.meta.current_page||0;this.$store.dispatch("resetCurrentBot"),this.loadBots(s),this.$notify("Указанный бот успешно перемещен из архива")})},extractFromArchive(o){this.$store.dispatch("restoreBot",{botId:o}).then(t=>{let s=this.bots_paginate_object.meta.current_page||0;this.loadBots(s),this.$notify("Указанный бот успешно перемещен из архива")})},selectFilter(o){let t=this.filters.find(s=>s.slug===o);t&&this.selectedFilters.filter(s=>s.slug===o).length===0&&this.selectedFilters.push(t)},removeSelectedFilter(o){let t=this.selectedFilters.findIndex(s=>s.slug===o);this.selectedFilters.splice(t,1)},selectBot(o){this.$emit("callback",o),this.show=!1,this.$notify("Вы выбрали бота из списка! Все остальные действия будут производится для этого бота.")},nextBots(o){this.loadBots(o)},loadAndOrder(o){this.order=o,this.direction=this.direction==="desc"?"asc":"desc",this.loadBots(0)},loadBots(o=0){this.loading=!0,this.$store.dispatch("loadBots",{dataObject:{companyId:this.companyId||null,search:this.search,order:this.order,direction:this.direction,filters:this.selectedFilters.map(t=>t.slug)},page:o,size:20}).then(t=>{this.loading=!1,this.bots=this.getBots,this.bots_paginate_object=this.getBotsPaginateObject,this.prepareFavorites()}).catch(()=>{this.loading=!1})}}},zT=Object.assign(bT,{__name:"BotList",setup(o){return(t,s)=>t.show?(l(),n("div",OI,[t.favorites.length>0?(l(),n("div",AI,[e("div",II,[QI,e("p",TI,"Количество ботов в работе "+u(t.favorites.length||0),1),e("table",BI,[RI,e("tbody",null,[(l(!0),n(v,null,y(t.favorites,(a,i)=>(l(),n("tr",{class:b({"border-info":a.deleted_at==null,"border-danger":a.deleted_at!=null})},[e("th",MI,u(a.id),1),e("td",{onClick:d=>t.selectBot(a)},[e("i",{class:b([{"text-danger":a.deleted_at!=null},"fa-solid fa-robot mr-2"])},null,2),m(" "+u(a.bot_domain||"Не указано"),1)],8,DI),e("td",{onClick:d=>t.selectBot(a)},u(a.title||"Не указано"),9,EI),e("td",null,[a.is_template?(l(),n("span",LI,u(a.template_description||"Не указано"),1)):(l(),n("span",KI,"Не является шаблоном"))]),e("td",null,u(t.$filters.current(a.updated_at)),1),e("td",null,[e("div",NI,[e("button",{class:b(["btn btn-outline-danger mr-2",{"btn-danger text-white":t.inBotFav(a.id)}]),type:"button",onClick:d=>t.addToFavorite(a.id),title:"Добавить в избранное"},YI,10,JI),t.favorites.length>1?(l(),n("button",{key:0,class:"btn btn-outline-primary mr-2",type:"button",onClick:d=>t.moveOrderFavBot(a.id,1),title:"Переместить вниз"},XI,8,GI)):r("",!0),t.favorites.length>1?(l(),n("button",{key:1,class:"btn btn-outline-primary mr-2",type:"button",onClick:d=>t.moveOrderFavBot(a.id,0),title:"Переместить вверх"},eQ,8,ZI)):r("",!0)])])],2))),256))])]),tQ])])):r("",!0),e("div",sQ,[e("div",oQ,[e("div",lQ,[e("div",nQ,[iQ,e("ul",aQ,[(l(!0),n(v,null,y(t.filters,a=>(l(),n("li",null,[e("a",{class:"dropdown-item",onClick:i=>t.selectFilter(a.slug),href:"#filter"},[e("i",{class:b([a.icon,"mr-2"])},null,2),m(" "+u(a.name||"Не указано"),1)],8,dQ)]))),256))])]),e("div",rQ,[c(e("input",{type:"search",class:"form-control",placeholder:"Поиск бота","aria-label":"Поиск бота","onUpdate:modelValue":s[0]||(s[0]=a=>t.search=a),onKeydown:s[1]||(s[1]=Fe((...a)=>t.loadBots&&t.loadBots(...a),["enter"])),"aria-describedby":"button-addon2"},null,544),[[h,t.search]]),e("button",{class:"btn btn-outline-secondary",onClick:s[2]||(s[2]=(...a)=>t.loadBots&&t.loadBots(...a)),type:"button",id:"button-addon2"},"Найти ")])]),t.selectedFilters.length>0?(l(),n("p",cQ,[(l(!0),n(v,null,y(t.selectedFilters,a=>(l(),n("span",uQ,[m(u(a.name||"не указан")+" ",1),e("a",{onClick:i=>t.removeSelectedFilter(a.slug),class:"ml-1 text-white",href:"#filter"},hQ,8,mQ)]))),256))])):r("",!0)])]),t.bots_paginate_object?(l(),n("div",pQ,[e("div",bQ,[fQ,e("p",gQ,"Количество найденных ботов "+u(t.bots_paginate_object.meta.total||0),1),e("p",vQ,"Количество результатов на странице "+u(t.bots.length||0),1),e("p",null,[m(" Тип отображения списка: "),e("span",{onClick:s[3]||(s[3]=a=>t.displayType=0),class:b([{"bg-primary":t.displayType===0,"bg-secondary":t.displayType!==0},"badge cursor-pointer mr-2"])},"Карточки",2),e("span",{class:b([{"bg-primary":t.displayType===1,"bg-secondary":t.displayType!==1},"badge cursor-pointer mr-2"]),onClick:s[4]||(s[4]=a=>t.displayType=1)},"Таблица",2)])])])):r("",!0),t.bots.length>0?(l(),n("div",$Q,[e("div",yQ,[o.editor?r("",!0):(l(),n("button",{key:0,type:"button",class:"btn btn-outline-info",onClick:s[5]||(s[5]=a=>t.selectBot(null))},"Создать нового бота "))]),t.displayType===1?(l(),n("div",kQ,[e("table",FQ,[e("thead",null,[e("tr",null,[e("th",{scope:"col",class:"cursor-pointer",onClick:s[6]||(s[6]=a=>t.loadAndOrder("id"))},"#"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[7]||(s[7]=a=>t.loadAndOrder("bot_domain"))},"Домен"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[8]||(s[8]=a=>t.loadAndOrder("title"))},"Название"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[9]||(s[9]=a=>t.loadAndOrder("template_description"))},"Шаблон"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[10]||(s[10]=a=>t.loadAndOrder("updated_at"))},"Дата изменения"),wQ])]),e("tbody",null,[(l(!0),n(v,null,y(t.bots,(a,i)=>(l(),n("tr",{class:b({"border-info":a.deleted_at==null,"border-danger":a.deleted_at!=null})},[e("th",CQ,u(a.id),1),e("td",{onClick:d=>t.selectBot(a)},[e("i",{class:b([{"text-danger":a.deleted_at!=null},"fa-solid fa-robot mr-2"])},null,2),m(" "+u(a.bot_domain||"Не указано"),1)],8,SQ),e("td",{onClick:d=>t.selectBot(a)},u(a.title||"Не указано"),9,jQ),e("td",null,[a.is_template?(l(),n("span",VQ,u(a.template_description||"Не указано"),1)):(l(),n("span",qQ,"Не является шаблоном"))]),e("td",null,u(t.$filters.current(a.updated_at)),1),e("td",null,[e("div",zQ,[e("button",{class:b(["btn btn-outline-danger mr-2",{"btn-danger text-white":t.inBotFav(a.id)}]),type:"button",onClick:d=>t.addToFavorite(a.id),title:"Добавить в избранное"},OQ,10,PQ),e("button",{class:"btn btn-outline-info mr-2",type:"button",onClick:d=>t.duplicate(a.id),title:"Дублировать"},QQ,8,AQ),a.deleted_at==null&&t.hasRole("admin")?(l(),n("button",{key:0,class:"btn btn-outline-info",type:"button",onClick:d=>t.addToArchive(a.id),title:"В архив"},RQ,8,TQ)):r("",!0),a.deleted_at!=null&&t.hasRole("admin")?(l(),n("button",{key:1,class:"btn btn-outline-info mr-2",onClick:d=>t.extractFromArchive(a.id),title:"Из архива"},EQ,8,MQ)):r("",!0),a.deleted_at!=null&&t.hasRole("admin")?(l(),n("button",{key:2,class:"btn btn-danger mr-2",onClick:d=>t.forceDelete(a.id),title:"Удалить на совсем"},NQ,8,LQ)):r("",!0)])])],2))),256))])])])):r("",!0),t.displayType===0?(l(!0),n(v,{key:1},y(t.bots,(a,i)=>(l(),n("div",JQ,[e("div",{class:b(["card w-100",{"border-info":a.deleted_at==null,"border-secondary":a.deleted_at!=null}])},[e("div",HQ,[e("p",{class:"d-flex justify-content-between",onClick:d=>t.selectBot(a),style:{"word-wrap":"break-word"}},[e("span",null,[e("i",{class:b([{"text-danger":a.deleted_at!=null},"fa-solid fa-robot mr-2"])},null,2),m(" "+u(a.bot_domain||"Не указано"),1)]),a.is_template?(l(),n("span",GQ,u(a.template_description||"Шаблон без названия"),1)):r("",!0)],8,YQ)]),e("div",WQ,[e("button",{class:b(["btn btn-outline-danger mr-2",{"btn-danger text-white":t.inBotFav(a.id)}]),type:"button",onClick:d=>t.addToFavorite(a.id),title:"Добавить в избранное"},xQ,10,XQ),e("button",{class:"btn btn-outline-info mr-2",type:"button",onClick:d=>t.duplicate(a.id),title:"Дублировать"},sT,8,eT),a.deleted_at==null&&t.hasRole("admin")?(l(),n("button",{key:0,class:"btn btn-outline-info",type:"button",onClick:d=>t.addToArchive(a.id),title:"В архив"},nT,8,oT)):r("",!0),a.deleted_at!=null&&t.hasRole("admin")?(l(),n("button",{key:1,class:"btn btn-outline-info mr-2",onClick:d=>t.extractFromArchive(a.id),title:"Из архива"},dT,8,iT)):r("",!0),a.deleted_at!=null&&t.hasRole("admin")?(l(),n("button",{key:2,class:"btn btn-danger mr-2",onClick:d=>t.forceDelete(a.id),title:"Удалить на совсем"},uT,8,rT)):r("",!0)])],2)]))),256)):r("",!0),e("div",mT,[t.bots_paginate_object?(l(),$(j,{key:0,onPagination_page:t.nextBots,pagination:t.bots_paginate_object},null,8,["onPagination_page","pagination"])):r("",!0)])])):(l(),n("div",_T,pT))])):r("",!0)}});export{zT as _,qT as a,S$ as b,re as c};
