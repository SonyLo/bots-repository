import{_ as C,a as Q}from"./Mail-da542d8c.js";import{e as w,f as S,g as T,h as V,i as j,j as U,_ as I,A as M,Y as A,k as P,l as O,B,d as R,m as N,c as L}from"./BotList-3b5af865.js";import{Y as q,q as l,t as a,v as e,B as p,O as u,D as r,H as h,J as b,y as _,A as n,Q as v,X as D,F as $,C as z,P as g,x as y,K as c}from"./index.es-a464651f.js";import{_ as k}from"./GlobalSlugList-e0ec7e74.js";const E={class:"row"},J={class:"col-12 mb-3"},Y={class:"form-label",id:"quiz-title"},H=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),K=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),X={class:"col-12 mb-3"},G={class:"form-label",id:"quiz-images"},W=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),Z=e("div",null," Изображение, которое видит пользователь при выборе квиза ",-1),x=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),ee={class:"col-12 mb-3"},te={class:"form-label",id:"quiz-description"},se=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),oe=e("div",null," Краткая информация о квизе ",-1),le=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),ie={key:0,class:"text-gray-400 ml-3",style:{"font-size":"10px"}},ne={class:"col-12 mb-3"},ae={class:"form-label",id:"quiz-time_limit"},de=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),re=e("div",null," Время на ответ ",-1),ue=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),ce={class:"col-12 mb-3"},me={class:"form-check"},pe=e("label",{class:"form-check-label",for:"is-group"}," Показывать ответы по окончанию раунда ",-1),he={class:"col-12 mb-3"},be={class:"form-floating"},_e=["value","selected"],fe=e("label",{for:"quiz-display-type"},"Тип вывода вопросов",-1),ye={class:"row"},$e={class:"col-12 mb-3"},ve={class:"form-label",id:"quiz-time_limit"},ke=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),qe=e("div",null," Дата и время начала квиза ",-1),ze=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),ge={class:"col-12 mb-3"},Fe={class:"form-label",id:"quiz-time_limit"},we=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),Ce=e("div",null," Дата и время окончания квиза ",-1),Qe=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),Se={class:"col-12 mb-3"},Te={class:"form-label",id:"quiz-time_limit"},Ve=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),je=e("div",null," Дата и время окончания квиза. Квиз создается на 1 игру. Данное поле заполняется автоматически при прохождении квиза командой. ",-1),Ue={class:"row"},Ie={class:"col-12"},Me={type:"submit",class:"btn btn-outline-success w-100 p-3"},Ae={key:0},Pe={key:1},Oe={props:["quiz","bot"],data(){return{step:0,load:!1,need_reset:!1,need_services:!1,types:["По порядку","Перемешать всё","Перемешать ответы","Перемешать вопросы"],quizForm:{id:null,title:null,image:null,description:null,completed_at:null,start_at:null,end_at:null,display_type:0,time_limit:30,show_answers:!1}}},watch:{quizForm:{handler(o){this.need_reset=!0},deep:!0}},mounted(){this.quiz&&this.$nextTick(()=>{this.quizForm={id:this.quiz.id||null,title:this.quiz.title||null,image:this.quiz.image||null,description:this.quiz.description||null,completed_at:this.$filters.currentFull(this.quiz.completed_at||null),start_at:this.$filters.currentFull(this.quiz.start_at||null),end_at:this.$filters.currentFull(this.quiz.end_at||null),display_type:this.quiz.display_type||0,time_limit:this.quiz.time_limit||30,show_answers:this.quiz.show_answers||!1}})},methods:{selectPhoto(o){this.quizForm.image=o.file_id},submitForm(){let o=new FormData;Object.keys(this.quizForm).forEach(t=>{const s=this.quizForm[t]||"";typeof s=="object"?o.append(t,JSON.stringify(s)):o.append(t,s)}),o.append("bot_id",this.bot.id),this.$store.dispatch("storeQuiz",{quizForm:o}).then(t=>{this.$emit("callback",t.data),this.quizForm={id:null,title:null,image:null,description:null,completed_at:null,start_at:null,end_at:null,display_type:0,time_limit:30,show_answers:!1},this.$notify("Событие успешно создано")}).catch(t=>{this.$notify("Ошибка создания события")})}}},F=Object.assign(Oe,{__name:"QuizForm",setup(o){return(t,s)=>{const d=q("Popper");return l(),a("form",{onSubmit:s[8]||(s[8]=g((...i)=>t.submitForm&&t.submitForm(...i),["prevent"])),class:"py-3"},[e("div",E,[e("div",J,[e("label",Y,[p(d,{content:"Название вашего квиза"},{default:u(()=>[H]),_:1}),r(" Название квиза "),K]),h(e("input",{type:"text",class:"form-control",placeholder:"Название","aria-label":"Название","onUpdate:modelValue":s[0]||(s[0]=i=>t.quizForm.title=i),maxlength:"255","aria-describedby":"quiz-title",required:""},null,512),[[b,t.quizForm.title]])]),e("div",X,[e("label",G,[p(d,null,{content:u(()=>[Z]),default:u(()=>[W]),_:1}),r(" Изображение к квизу "),x]),p(k,{"need-photo":!0,selected:t.quizForm.image,onSelect:t.selectPhoto},null,8,["selected","onSelect"])]),e("div",ee,[e("label",te,[p(d,null,{content:u(()=>[oe]),default:u(()=>[se]),_:1}),r(" Описание события "),le,t.quizForm.description?(l(),a("small",ie," Длина текста "+_(t.quizForm.description.length)+"/255",1)):n("",!0)]),h(e("textarea",{class:"form-control",placeholder:"Описание мероприятия","aria-label":"Описание мероприятия",maxlength:"255","onUpdate:modelValue":s[1]||(s[1]=i=>t.quizForm.description=i),"aria-describedby":"quiz-description",required:""},`
                    `,512),[[b,t.quizForm.description]])]),e("div",ne,[e("label",ae,[p(d,null,{content:u(()=>[re]),default:u(()=>[de]),_:1}),r(" Лимит времени на ответ в секундах "),ue]),h(e("input",{type:"number",class:"form-control",placeholder:"Лимит времени на ответ","aria-label":"Лимит времени на ответ",step:"0.1",min:"0","onUpdate:modelValue":s[2]||(s[2]=i=>t.quizForm.time_limit=i),"aria-describedby":"quiz-time_limit",required:""},null,512),[[b,t.quizForm.time_limit]])]),e("div",ce,[e("div",me,[h(e("input",{class:"form-check-input","onUpdate:modelValue":s[3]||(s[3]=i=>t.quizForm.show_answers=i),type:"checkbox",id:"is-group"},null,512),[[v,t.quizForm.show_answers]]),pe])]),e("div",he,[e("div",be,[h(e("select",{class:"form-select","onUpdate:modelValue":s[4]||(s[4]=i=>t.quizForm.display_type=i),id:"quiz-display-type","aria-label":"quiz-display-type"},[(l(!0),a($,null,z(t.types,(i,m)=>(l(),a("option",{value:m,selected:m==t.quizForm.display_type},_(i),9,_e))),256))],512),[[D,t.quizForm.display_type]]),fe])])]),e("div",ye,[e("div",$e,[e("label",ve,[p(d,null,{content:u(()=>[qe]),default:u(()=>[ke]),_:1}),r(" Дата и время начала начала "),ze]),h(e("input",{type:"datetime-local",class:"form-control",placeholder:"Дата и время начала квиза ","aria-label":"Дата и время начала квиза",maxlength:"255","onUpdate:modelValue":s[5]||(s[5]=i=>t.quizForm.start_at=i),"aria-describedby":"quiz-start_at",required:""},null,512),[[b,t.quizForm.start_at]])]),e("div",ge,[e("label",Fe,[p(d,null,{content:u(()=>[Ce]),default:u(()=>[we]),_:1}),r(" Дата и время окончания квиза "),Qe]),h(e("input",{type:"datetime-local",class:"form-control",placeholder:"Дата и время окончания квиза","aria-label":"Дата и время окончания квиза",maxlength:"255","onUpdate:modelValue":s[6]||(s[6]=i=>t.quizForm.end_at=i),"aria-describedby":"quiz-end_at",required:""},null,512),[[b,t.quizForm.end_at]])]),e("div",Se,[e("label",Te,[p(d,null,{content:u(()=>[je]),default:u(()=>[Ve]),_:1}),r(" Дата и время прохождения квиза ")]),h(e("input",{type:"datetime-local",class:"form-control",placeholder:"Дата и время прохождения квиза","aria-label":"Дата и время прохождения квиза",maxlength:"255","onUpdate:modelValue":s[7]||(s[7]=i=>t.quizForm.completed_at=i),"aria-describedby":"quiz-completed_at"},null,512),[[b,t.quizForm.completed_at]])])]),e("div",Ue,[e("div",Ie,[e("button",Me,[t.quizForm.id==null?(l(),a("span",Ae,"Создать квиз")):(l(),a("span",Pe,"Обновить квиз"))])])])],32)}}}),Be={class:"row py-3"},Re={class:"col-12"},Ne={class:"row"},Le={class:"col-12 mb-3"},De={class:"form-label",id:"quiz-round"},Ee=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),Je=e("div",null," Раунд, в котором будет отображен вопрос ",-1),Ye=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),He={class:"col-12 mb-3"},Ke={class:"form-label",id:"event-on_after_appointment"},Xe=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),Ge=e("div",null," Текст вопроса ",-1),We=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),Ze={key:0,class:"text-gray-400 ml-3",style:{"font-size":"10px"}},xe={class:"col-12 mb-3"},et={class:"form-label",id:"quiz-images"},tt=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),st=e("div",null," Изображение, видео, аудио сопровождение вопроса ",-1),ot={key:0,class:"badge rounded-pill text-bg-info m-0"},lt=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),it={class:"col-12 mb-3"},nt={class:"form-check"},at=e("label",{class:"form-check-label",for:"is_multiply"}," Множественные ответы ",-1),dt={class:"col-12 mb-3"},rt={class:"form-check"},ut=e("label",{class:"form-check-label",for:"is_open"}," Открытый вопрос ",-1),ct={class:"row"},mt={class:"col-12"},pt={class:"col-12"},ht={key:0,class:"table"},bt=e("thead",null,[e("tr",null,[e("th",{scope:"col"},"#"),e("th",{scope:"col"},"Текст вопроса"),e("th",{scope:"col"},"Баллы"),e("th",{scope:"col"},"Контент"),e("th",{scope:"col"},"Тип контента"),e("th",{scope:"col"},"Является верным"),e("th",{scope:"col"},"Действие")])],-1),_t={scope:"row"},ft={class:"form-floating mb-3"},yt=["onUpdate:modelValue","id"],$t=["for"],vt={class:"form-floating mb-3"},kt=["onUpdate:modelValue","id"],qt=["for"],zt=["onClick"],gt={class:"form-check"},Ft=["onUpdate:modelValue","id"],wt=["for"],Ct={class:"dropdown"},Qt=e("button",{class:"btn btn-outline-secondary",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-solid fa-ellipsis"})],-1),St={class:"dropdown-menu"},Tt={key:0},Vt=["onClick"],jt={key:1},Ut=["onClick"],It={key:1},Mt={class:"row"},At={class:"col-12"},Pt={type:"submit",class:"btn btn-outline-success w-100 p-3"},Ot={key:0},Bt={key:1},Rt={class:"modal fade",id:"chooseMediaContent",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},Nt={class:"modal-dialog"},Lt={class:"modal-content"},Dt={key:0,class:"modal-body"},Et=e("div",{class:"modal-footer"},[e("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Закрыть")],-1),Jt={props:["quizId","bot","question"],data(){return{step:0,load:!1,selectedQuestionIndex:null,questionForm:{id:null,text:null,round:null,media_content:null,content_type:null,is_multiply:!1,is_open:!1,answers:[]}}},watch:{questionForm:{handler(o){this.need_reset=!0},deep:!0}},mounted(){this.question&&this.$nextTick(()=>{this.questionForm={id:this.question.id||null,text:this.question.text||null,round:this.question.round||null,media_content:this.question.media_content||null,content_type:this.question.content_type||null,is_multiply:this.question.is_multiply||!1,is_open:this.question.is_open||!1,answers:this.question.answers||[]}})},methods:{chooseMediaContent(o){this.selectedQuestionIndex=null,this.$nextTick(()=>{this.selectedQuestionIndex=o}),new bootstrap.Modal(document.getElementById("chooseMediaContent"),{}).show()},selectMediaForAnswer(o){this.questionForm.answers[this.selectedQuestionIndex].media_content=o.file_id,this.questionForm.answers[this.selectedQuestionIndex].content_type=o.type},selectMedia(o){this.questionForm.media_content=o.file_id,this.questionForm.content_type=o.type},clearQuestionForm(){this.questionForm={id:null,text:null,round:null,media_content:null,content_type:null,is_multiply:!1,is_open:!1,answers:[]}},addNewAnswer(){this.questionForm.answers.push({text:null,media_content:null,content_type:null,is_right_answer:!1,points:0})},removeAnswerFromArray(o){this.questionForm.answers.splice(o,1)},removeAnswer(o){this.$store.dispatch("removeQuizAnswer",{quizAnswerId:o}).then(t=>{this.$notify("Вопрос успешно удален");let s=this.questionForm.answers.findIndex(d=>d.id==o);this.questionForm.answers.splice(s,1)}).catch(t=>{this.$notify("Ошибка удаления вопроса")})},submitForm(){let o=new FormData;Object.keys(this.questionForm).forEach(t=>{const s=this.questionForm[t]||"";typeof s=="object"?o.append(t,JSON.stringify(s)):o.append(t,s)}),o.append("bot_id",this.bot.id),o.append("quiz_id",this.quizId),this.$store.dispatch("storeQuizQuestion",{quizQuestionForm:o}).then(t=>{this.$emit("callback",t.data),this.$notify("Вопрос успешно создан"),this.clearQuestionForm()}).catch(t=>{this.$notify("Ошибка создания вопроса")})}}},Yt=Object.assign(Jt,{__name:"QuizQuestionForm",setup(o){return(t,s)=>{const d=q("Popper");return l(),a($,null,[e("div",Be,[e("div",Re,[e("button",{onClick:s[0]||(s[0]=(...i)=>t.clearQuestionForm&&t.clearQuestionForm(...i)),class:"btn btn-primary"},"Новый вопрос ")])]),e("form",{onSubmit:s[6]||(s[6]=g((...i)=>t.submitForm&&t.submitForm(...i),["prevent"]))},[e("div",Ne,[e("div",Le,[e("label",De,[p(d,null,{content:u(()=>[Je]),default:u(()=>[Ee]),_:1}),r(" Раунд "),Ye]),h(e("input",{type:"number",class:"form-control",placeholder:"Раунд","aria-label":"Раундт",step:"1",min:"1","onUpdate:modelValue":s[1]||(s[1]=i=>t.questionForm.round=i),"aria-describedby":"quiz-round",required:""},null,512),[[b,t.questionForm.round]])]),e("div",He,[e("label",Ke,[p(d,null,{content:u(()=>[Ge]),default:u(()=>[Xe]),_:1}),r(" Текст вопроса "),We,t.questionForm.text?(l(),a("small",Ze," Длина текста "+_(t.questionForm.text.length)+"/255",1)):n("",!0)]),h(e("textarea",{type:"text",class:"form-control",placeholder:"Текст вопроса","aria-label":"Текст вопроса","onUpdate:modelValue":s[2]||(s[2]=i=>t.questionForm.text=i),maxlength:"255","aria-describedby":"review-text",required:""},`
                    `,512),[[b,t.questionForm.text]])]),e("div",xe,[e("label",et,[p(d,null,{content:u(()=>[st]),default:u(()=>[tt]),_:1}),r(" Медиа контент к вопросу "),t.questionForm.content_type?(l(),a("span",ot,_(t.questionForm.content_type),1)):n("",!0),lt]),p(k,{"need-video":!0,"need-video-note":!0,"need-audio":!0,"need-photo":!0,selected:[t.questionForm.media_content],onSelect:t.selectMedia},null,8,["selected","onSelect"])]),e("div",it,[e("div",nt,[h(e("input",{class:"form-check-input","onUpdate:modelValue":s[3]||(s[3]=i=>t.questionForm.is_multiply=i),type:"checkbox",id:"is_multiply"},null,512),[[v,t.questionForm.is_multiply]]),at])]),e("div",dt,[e("div",rt,[h(e("input",{class:"form-check-input","onUpdate:modelValue":s[4]||(s[4]=i=>t.questionForm.is_open=i),type:"checkbox",id:"is_open"},null,512),[[v,t.questionForm.is_open]]),ut])])]),e("div",ct,[e("div",mt,[e("button",{onClick:s[5]||(s[5]=(...i)=>t.addNewAnswer&&t.addNewAnswer(...i)),type:"button",class:"btn btn-outline-success rounded-5"}," Добавить ответы ")]),e("div",pt,[t.questionForm.answers.length>0?(l(),a("table",ht,[bt,e("tbody",null,[(l(!0),a($,null,z(t.questionForm.answers,(i,m)=>(l(),a("tr",{class:y({"border-info":i.deleted_at==null,"border-danger":i.deleted_at!=null})},[e("th",_t,_(i.id||"Новый"),1),e("td",null,[e("div",ft,[h(e("input",{type:"text","onUpdate:modelValue":f=>t.questionForm.answers[m].text=f,class:"form-control",id:"answer-text-"+m,placeholder:"Текст ответа"},null,8,yt),[[b,t.questionForm.answers[m].text]]),e("label",{for:"answer-text-"+m},"Текст ответа",8,$t)])]),e("td",null,[e("div",vt,[h(e("input",{type:"text","onUpdate:modelValue":f=>t.questionForm.answers[m].points=f,class:"form-control",id:"answer-points-"+m,placeholder:"Текст ответа"},null,8,kt),[[b,t.questionForm.answers[m].points]]),e("label",{for:"answer-points-"+m},"Баллы",8,qt)])]),e("td",null,[e("p",{class:"cursor-pointer",onClick:f=>t.chooseMediaContent(m)},_(i.media_content||"Не указано"),9,zt)]),e("td",null,_(i.content_type||"Не указано"),1),e("td",null,[e("div",gt,[h(e("input",{class:"form-check-input","onUpdate:modelValue":f=>t.questionForm.answers[m].is_right_answer=f,type:"checkbox",id:"answer-is_right_answer-"+m},null,8,Ft),[[v,t.questionForm.answers[m].is_right_answer]]),e("label",{class:"form-check-label",for:"answer-is_right_answer-"+m}," Правильный ответ ",8,wt)])]),e("td",null,[e("div",Ct,[Qt,e("ul",St,[i.id==null?(l(),a("li",Tt,[e("a",{class:"dropdown-item",onClick:f=>t.removeAnswerFromArray(m),href:"javascript:void(0)"},"Удалить",8,Vt)])):n("",!0),i.deleted_at==null&&i.id!=null?(l(),a("li",jt,[e("a",{class:"dropdown-item",onClick:f=>t.removeAnswer(i.id),href:"javascript:void(0)"},"Удалить",8,Ut)])):n("",!0)])])])],2))),256))])])):(l(),a("p",It,"На текущий момент нет ни одного созданного ответа"))])]),e("div",Mt,[e("div",At,[e("button",Pt,[t.questionForm.id==null?(l(),a("span",Ot,"Сохранить вопрос")):(l(),a("span",Bt,"Обновить вопрос"))])])])],32),e("div",Rt,[e("div",Nt,[e("div",Lt,[t.selectedQuestionIndex!=null?(l(),a("div",Dt,[p(k,{"need-video":!0,"need-video-note":!0,"need-audio":!0,"need-photo":!0,selected:[t.questionForm.answers[t.selectedQuestionIndex||0].media_content||""],onSelect:t.selectMediaForAnswer},null,8,["selected","onSelect"])])):n("",!0),Et])])])],64)}}}),Ht={class:"row py-3"},Kt={class:"col-12"},Xt={class:"row"},Gt={class:"col-12 mb-3"},Wt={class:"form-label",id:"command-title"},Zt=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),xt=e("div",null," Название команды ",-1),es=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),ts={class:"col-12 mb-3"},ss={class:"form-label",id:"event-on_after_appointment"},os=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),ls=e("div",null," Текст описания команды ",-1),is=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),ns={key:0,class:"text-gray-400 ml-3",style:{"font-size":"10px"}},as=e("div",{class:"col-12 mb-3"},[e("button",{type:"button",class:"btn btn-outline-info rounded-5","data-bs-toggle":"modal","data-bs-target":"#select-players"}," Подобрать участников команды ")],-1),ds={key:0,class:"col-12 mb-3"},rs=e("h4",null,"Пользователи в команде",-1),us={class:"list-group list-group-numbered"},cs={class:"list-group-item d-flex justify-content-between align-items-start"},ms={class:"ms-2 me-auto"},ps={class:"fw-bold"},hs={class:"dropdown"},bs=e("button",{class:"btn btn-outline-secondary",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-solid fa-ellipsis"})],-1),_s={class:"dropdown-menu"},fs=["onClick"],ys={class:"row"},$s={class:"col-12"},vs={type:"submit",class:"btn btn-outline-success w-100 p-3"},ks={key:0},qs={key:1},zs={class:"modal fade",id:"select-players",tabindex:"-1","aria-labelledby":"select-players-label","aria-hidden":"true"},gs={class:"modal-dialog modal-fullscreen"},Fs={class:"modal-content"},ws=e("div",{class:"modal-header"},[e("h1",{class:"modal-title fs-5",id:"select-players-label"},"Подбор участников команды"),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),Cs={class:"modal-body"},Qs=e("div",{class:"modal-footer"},[e("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Закрыть")],-1),Ss={props:["quizId","bot","command"],data(){return{step:0,load:!1,commandForm:{id:null,title:null,description:null,players:[]}}},watch:{commandForm:{handler(o){this.need_reset=!0},deep:!0}},mounted(){this.command&&this.$nextTick(()=>{this.commandForm={id:this.command.id||null,title:this.command.title||null,description:this.command.description||null,players:this.command.players||[]}})},methods:{removePlayerFromCommand(o){},selectBotUser(o){if(this.commandForm.players.findIndex(s=>s.id==o.id)>=0){this.$notify("Такой пользователь уже есть в списке");return}this.$notify("Пользователь успешно добавлен"),this.commandForm.players.push(o)},clearCommandForm(){this.commandForm={id:null,title:null,description:null,players:[]}},submitForm(){let o=new FormData;Object.keys(this.commandForm).forEach(t=>{const s=this.commandForm[t]||"";typeof s=="object"?o.append(t,JSON.stringify(s)):o.append(t,s)}),o.append("bot_id",this.bot.id),o.append("quiz_id",this.quizId),this.$store.dispatch("storeQuizCommand",{quizCommandForm:o}).then(t=>{this.$emit("callback",t.data),this.$notify("Команда успешно создана"),this.clearCommandForm()}).catch(t=>{this.$notify("Ошибка создания команды")})}}},Ts=Object.assign(Ss,{__name:"QuizCommandForm",setup(o){return(t,s)=>{const d=q("Popper");return l(),a($,null,[e("div",Ht,[e("div",Kt,[e("button",{onClick:s[0]||(s[0]=(...i)=>t.clearCommandForm&&t.clearCommandForm(...i)),class:"btn btn-primary"},"Новая команда")])]),e("form",{onSubmit:s[3]||(s[3]=g((...i)=>t.submitForm&&t.submitForm(...i),["prevent"]))},[e("div",Xt,[e("div",Gt,[e("label",Wt,[p(d,null,{content:u(()=>[xt]),default:u(()=>[Zt]),_:1}),r(" Название команды "),es]),h(e("input",{type:"text",class:"form-control",placeholder:"Название команды","aria-label":"Название команды",maxlength:"255","onUpdate:modelValue":s[1]||(s[1]=i=>t.commandForm.title=i),"aria-describedby":"command-title",required:""},null,512),[[b,t.commandForm.title]])]),e("div",ts,[e("label",ss,[p(d,null,{content:u(()=>[ls]),default:u(()=>[os]),_:1}),r(" Описание команды "),is,t.commandForm.description?(l(),a("small",ns," Длина текста "+_(t.commandForm.description.length)+"/255",1)):n("",!0)]),h(e("textarea",{type:"text",class:"form-control",placeholder:"Текст описания","aria-label":"Текст описания","onUpdate:modelValue":s[2]||(s[2]=i=>t.commandForm.description=i),maxlength:"255","aria-describedby":"command-text",required:""},`
                    `,512),[[b,t.commandForm.description]])]),as,t.commandForm.players.length>0?(l(),a("div",ds,[rs,e("ol",us,[(l(!0),a($,null,z(t.commandForm.players,i=>(l(),a("li",cs,[e("div",ms,[e("div",ps,"#"+_(i.id),1),r(" "+_(i.fio_from_telegram||i.telegram_chat_id),1)]),e("div",hs,[bs,e("ul",_s,[e("li",null,[e("a",{class:"dropdown-item",onClick:m=>t.removePlayerFromCommand(i.id),href:"javascript:void(0)"},"Удалить",8,fs)])])])]))),256))])])):n("",!0)]),e("div",ys,[e("div",$s,[e("button",vs,[t.commandForm.id==null?(l(),a("span",ks,"Сохранить команду")):(l(),a("span",qs,"Обновить команду"))])])])],32),e("div",zs,[e("div",gs,[e("div",Fs,[ws,e("div",Cs,[p(w,{simple:!0,onSelect:t.selectBotUser},null,8,["onSelect"])]),Qs])])])],64)}}}),Vs={key:0,class:"py-2"},js={class:"row"},Us={class:"col-12"},Is={key:1,class:"py-2"},Ms={class:"row"},As={class:"col-12"},Ps={key:2,class:"py-2"},Os={class:"row"},Bs={class:"col-12"},Rs={class:"nav nav-tabs justify-content-center"},Ns={key:0,class:"row py-3"},Ls={class:"col-12"},Ds={key:1,class:"row py-3"},Es={class:"col-12"},Js={class:"col-12 py-3"},Ys=e("h4",null,"Доступные вопросы",-1),Hs={key:2,class:"row"},Ks={class:"col-12"},Xs={class:"col-12 py-3"},Gs=e("h4",null,"Команды участники квиза",-1),Ws={key:3,class:"row"},Zs={class:"col-12 py-3"},xs=e("h4",null,"Статистика",-1),eo={key:4,class:"row"},to=e("div",{class:"col-12"},null,-1),so=e("div",{class:"col-12 py-3"},[e("h4",null,"Отзывы к событию")],-1),oo=[to,so],lo={props:["bot"],data(){return{part:0,tab:0,loadTable:!1,loadQuizCommand:!1,loadQuizQuestion:!1,loadQuizQuestionTable:!1,loadQuizCommandTable:!1,loadQuizResult:!1,loadForm:!1,selectedQuiz:null,selectedQuizQuestion:null,selectedQuizCommand:null,selectedQuizResult:null}},mounted(){},methods:{callbackCommandForm(){this.loadQuizCommandTable=!0,this.$nextTick(()=>{this.loadQuizCommandTable=!1})},callbackQuestionForm(){this.loadQuizQuestionTable=!0,this.$nextTick(()=>{this.loadQuizQuestionTable=!1})},callbackForm(){this.loadTable=!0,this.$nextTick(()=>{this.loadTable=!1})},createQuiz(){this.part=2},selectQuizResult(o){this.loadQuizResult=!0,this.$nextTick(()=>{this.loadQuizResult=!1,this.selectedQuizResult=o})},selectQuizCommand(o){this.loadQuizCommand=!0,this.$nextTick(()=>{this.loadQuizCommand=!1,this.selectedQuizCommand=o})},selectQuizQuestion(o){this.loadQuizQuestion=!0,this.$nextTick(()=>{this.loadQuizQuestion=!1,this.selectedQuizQuestion=o})},selectQuiz(o){this.loadForm=!0,this.$nextTick(()=>{this.loadForm=!1,this.selectedQuiz=o,this.part=1,this.tab=0})}}},io=Object.assign(lo,{__name:"Quizzes",setup(o){return(t,s)=>(l(),a($,null,[t.part===0?(l(),a("div",Vs,[e("div",js,[e("div",Us,[e("button",{type:"button",onClick:s[0]||(s[0]=(...d)=>t.createQuiz&&t.createQuiz(...d)),class:"btn btn-primary"}," Создать новый квиз ")])]),t.loadTable?n("",!0):(l(),c(S,{key:0,onCreate:t.createQuiz,onSelect:t.selectQuiz,bot:o.bot},null,8,["onCreate","onSelect","bot"]))])):n("",!0),t.part===2?(l(),a("div",Is,[e("div",Ms,[e("div",As,[e("button",{type:"button",onClick:s[1]||(s[1]=d=>t.part=0),class:"btn btn-outline-primary"}," Назад ")])]),t.loadForm?n("",!0):(l(),c(F,{key:0,onCallback:t.callbackForm,bot:o.bot},null,8,["onCallback","bot"]))])):n("",!0),t.part===1?(l(),a("div",Ps,[e("div",Os,[e("div",Bs,[e("button",{type:"button",onClick:s[2]||(s[2]=d=>t.part=0),class:"btn btn-outline-primary"}," Назад ")])]),e("ul",Rs,[e("li",{class:"nav-item",onClick:s[3]||(s[3]=d=>t.tab=0)},[e("a",{class:y(["nav-link",{active:t.tab===0}]),"aria-current":"page",href:"javascript:void(0)"},"Информация о квизе",2)]),e("li",{class:"nav-item",onClick:s[4]||(s[4]=d=>t.tab=1)},[e("a",{class:y(["nav-link",{active:t.tab===1}]),href:"javascript:void(0)"},"Вопросы квиза",2)]),e("li",{class:"nav-item",onClick:s[5]||(s[5]=d=>t.tab=2)},[e("a",{class:y(["nav-link",{active:t.tab===2}]),href:"javascript:void(0)"},"Команды на квизе",2)]),e("li",{class:"nav-item",onClick:s[6]||(s[6]=d=>t.tab=3)},[e("a",{class:y(["nav-link",{active:t.tab===3}]),href:"javascript:void(0)"},"Командная статистика",2)])]),t.tab===0?(l(),a("div",Ns,[e("div",Ls,[t.loadForm?n("",!0):(l(),c(F,{key:0,onCallback:t.callbackForm,quiz:t.selectedQuiz,bot:o.bot},null,8,["onCallback","quiz","bot"]))])])):n("",!0),t.tab===1?(l(),a("div",Ds,[e("div",Es,[t.loadQuizQuestion?n("",!0):(l(),c(Yt,{key:0,question:t.selectedQuizQuestion,"quiz-id":t.selectedQuiz.id,onCallback:t.callbackQuestionForm,bot:o.bot},null,8,["question","quiz-id","onCallback","bot"]))]),e("div",Js,[Ys,t.loadQuizQuestionTable?n("",!0):(l(),c(T,{key:0,"quiz-id":t.selectedQuiz.id,onSelect:t.selectQuizQuestion,bot:o.bot},null,8,["quiz-id","onSelect","bot"]))])])):n("",!0),t.tab===2?(l(),a("div",Hs,[e("div",Ks,[t.loadQuizCommand?n("",!0):(l(),c(Ts,{key:0,command:t.selectedQuizCommand,"quiz-id":t.selectedQuiz.id,onCallback:t.callbackCommandForm,bot:o.bot},null,8,["command","quiz-id","onCallback","bot"]))]),e("div",Xs,[Gs,t.loadQuizCommandTable?n("",!0):(l(),c(V,{key:0,"quiz-id":t.selectedQuiz.id,onSelect:t.selectQuizCommand,bot:o.bot},null,8,["quiz-id","onSelect","bot"]))])])):n("",!0),t.tab===3?(l(),a("div",Ws,[e("div",Zs,[xs,p(j,{"quiz-id":t.selectedQuiz.id,onSelect:t.selectQuizResult,bot:o.bot},null,8,["quiz-id","onSelect","bot"])])])):n("",!0),t.tab===4?(l(),a("div",eo,oo)):n("",!0)])):n("",!0)],64))}}),no={class:"d-flex custom-dropdown justify-content-between align-items-center"},ao={class:"btn-group"},ro=e("i",{class:"fa-solid fa-info mr-2"},null,-1),uo=e("i",{class:"fa-solid fa-file mr-2"},null,-1),co={key:0,class:"dropdown"},mo=e("button",{type:"button",class:"btn btn-primary dropdown-toggle text-primary p-2",href:"#",role:"button",id:"dropdownMenuLink","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-solid fa-screwdriver-wrench mr-2"})],-1),po={class:"dropdown-menu","aria-labelledby":"dropdownMenuLink"},ho=e("i",{class:"fa-regular fa-calendar-days mr-2"},null,-1),bo=e("i",{class:"fa-solid fa-q mr-2"},null,-1),_o=e("i",{class:"fa-solid fa-code mr-2"},null,-1),fo=e("i",{class:"fa-solid fa-keyboard mr-2"},null,-1),yo=e("i",{class:"fa-solid fa-scroll mr-2"},null,-1),$o=e("i",{class:"fa-solid fa-comment-dots mr-2"},null,-1),vo=e("i",{class:"fa-solid fa-users mr-2"},null,-1),ko=e("i",{class:"fa-regular fa-newspaper mr-2"},null,-1),qo=e("i",{class:"fa-solid fa-list-check mr-2"},null,-1),zo=e("i",{class:"fa-solid fa-list-check mr-2"},null,-1),go=e("i",{class:"fa-brands fa-shopify mr-2"},null,-1),Fo=e("i",{class:"fa-brands fa-shopify mr-2"},null,-1),wo={key:0,class:"pb-5 mb-5"},Co={key:1,class:"pb-5 mb-5"},Qo={key:2,class:"pb-5 mb-5"},So={key:3,class:"pb-5 mb-5"},To={key:4,class:"pb-5 mb-5"},Vo={key:5,class:"pb-5 mb-5"},jo={key:6,class:"pb-5 mb-5"},Uo={key:7,class:"pb-5 mb-5"},Io={key:8,class:"pb-5 mb-5"},Mo={key:9,class:"pb-5 mb-5"},Ao={key:10,class:"pb-5 mb-5"},Po={key:11,class:"pb-5 mb-5"},Oo={key:12,class:"row pb-5 mb-5"},Bo={key:0,class:"col-12 col-md-12"},Ro={key:13,class:"pb-5 mb-5"},No={props:["bot"],data(){return{page:null,step:0,load:!1,loadPage:!1}},mounted(){this.setStep(localStorage.getItem("cashman_set_botform_step_index")||0)},methods:{hasRole(o){return window.hasRole(o)||!1},setStep(o){this.step=parseInt(o),localStorage.setItem("cashman_set_botform_step_index",o)},pageListCallback(o){this.loadPage=!0,this.page=o,this.$nextTick(()=>{this.loadPage=!1})},pageCallback(o){this.page=o,this.loadPageList=!0,this.$nextTick(()=>{this.loadPageList=!1})},loadCurrentCompany(o=null){this.$store.dispatch("updateCurrentCompany",{company:o}).then(()=>{this.company=this.getCurrentCompany})},companyListCallback(o){this.load=!0,this.loadCurrentCompany(o),this.$nextTick(()=>{this.load=!1})}}},Yo=Object.assign(No,{__name:"BotSection",setup(o){return(t,s)=>(l(),a($,null,[e("div",no,[e("div",ao,[e("button",{type:"button",class:y(["btn btn-primary text-primary",{"bg-primary text-white":t.step==0}]),onClick:s[0]||(s[0]=d=>t.setStep(0))},[ro,r("Информация о боте")],2),e("button",{type:"button",class:y(["btn btn-primary text-primary",{"bg-primary text-white":t.step==4}]),onClick:s[1]||(s[1]=d=>t.setStep(4))},[uo,r("Страницы")],2)]),t.hasRole("admin")?(l(),a("div",co,[mo,e("ul",po,[e("li",null,[e("a",{class:"dropdown-item",href:"#bot-appointments",onClick:s[2]||(s[2]=d=>t.setStep(13))},[ho,r("Запись на событие (прием)")])]),e("li",null,[e("a",{class:"dropdown-item",href:"#bot-quizzes",onClick:s[3]||(s[3]=d=>t.setStep(14))},[bo,r("Квизы")])]),e("li",null,[e("a",{class:"dropdown-item",href:"#bot-custom-fields",onClick:s[4]||(s[4]=d=>t.setStep(10))},[_o,r("Настраиваемые поля")])]),e("li",null,[e("a",{class:"dropdown-item",href:"#bot-menu-template",onClick:s[5]||(s[5]=d=>t.setStep(1))},[fo,r("Все клавиатуры в боте")])]),e("li",null,[e("a",{class:"dropdown-item",href:"#bot-slugs",onClick:s[6]||(s[6]=d=>t.setStep(2))},[yo,r("Все скрипты в боте")])]),e("li",null,[e("a",{class:"dropdown-item",href:"#bot-dialogs",onClick:s[7]||(s[7]=d=>t.setStep(6))},[$o,r("Все диалоги в боте")])]),e("li",null,[e("a",{class:"dropdown-item",href:"#bot-users",onClick:s[8]||(s[8]=d=>t.setStep(3))},[vo,r("Все пользователи в боте")])]),e("li",null,[e("a",{class:"dropdown-item",href:"#bot-news",onClick:s[9]||(s[9]=d=>t.setStep(9))},[ko,r(" Новостной канал")])]),e("li",null,[e("a",{class:"dropdown-item",href:"#bot-amo",onClick:s[10]||(s[10]=d=>t.setStep(7))},[qo,r(" AMO CRM")])]),e("li",null,[e("a",{class:"dropdown-item",href:"#bot-y-clients",onClick:s[11]||(s[11]=d=>t.setStep(12))},[zo,r(" YClients")])]),e("li",null,[e("a",{class:"dropdown-item",href:"#bot-shop",onClick:s[12]||(s[12]=d=>t.setStep(8))},[go,r(" Магазин")])]),e("li",null,[e("a",{class:"dropdown-item",href:"#bot-media",onClick:s[13]||(s[13]=d=>t.setStep(11))},[Fo,r(" Медиа файлы бота")])])])])):n("",!0)]),t.step===14?(l(),a("div",wo,[t.load?n("",!0):(l(),c(io,{key:0,bot:o.bot},null,8,["bot"]))])):n("",!0),t.step===13?(l(),a("div",Co,[t.load?n("",!0):(l(),c(U,{key:0,bot:o.bot},null,8,["bot"]))])):n("",!0),t.step===0?(l(),a("div",Qo,[t.load?n("",!0):(l(),c(I,{key:0,bot:o.bot},null,8,["bot"]))])):n("",!0),t.step===7?(l(),a("div",So,[t.load?n("",!0):(l(),c(M,{key:0,data:o.bot.amo},null,8,["data"]))])):n("",!0),t.step===12?(l(),a("div",To,[t.load?n("",!0):(l(),c(A,{key:0,data:o.bot.y_clients},null,8,["data"]))])):n("",!0),t.step===11?(l(),a("div",Vo,[t.load?n("",!0):(l(),c(P,{key:0}))])):n("",!0),t.step===8?(l(),a("div",jo,[t.load?n("",!0):(l(),c(O,{key:0}))])):n("",!0),t.step===10?(l(),a("div",Uo,[t.load?n("",!0):(l(),c(B,{key:0}))])):n("",!0),t.step===1?(l(),a("div",Io,[t.load?n("",!0):(l(),c(C,{key:0,"select-mode":!1}))])):n("",!0),t.step===6?(l(),a("div",Mo,[t.load?n("",!0):(l(),c(R,{key:0}))])):n("",!0),t.step===2?(l(),a("div",Ao,[t.load?n("",!0):(l(),c(N,{key:0}))])):n("",!0),t.step===3?(l(),a("div",Po,[t.load?n("",!0):(l(),c(w,{key:0}))])):n("",!0),t.step===4?(l(),a("div",Oo,[t.load?n("",!0):(l(),a("div",Bo,[t.loadPage?n("",!0):(l(),c(L,{key:0,page:t.page,onCallback:t.pageCallback},null,8,["page","onCallback"]))]))])):n("",!0),t.step===9?(l(),a("div",Ro,[p(Q)])):n("",!0)],64))}});export{Yo as _};
