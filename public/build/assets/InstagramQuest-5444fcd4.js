import{c as a,a as t,t as c,d as l,f as d,w as r,v as m,j as u,o as i}from"./app-3019e453.js";import{s as _}from"./vue3-roulette.esm-c02bb98d.js";const g={class:"container"},b={key:0,class:"row"},y={key:0,class:"col-12 mb-2 mt-2"},v={class:"card"},f={class:"card-body"},w={class:"col-12 mb-2 mt-2"},F={key:0,style:{"text-align":"center","font-size":"larger"}},k={key:1,style:{"text-align":"center","font-size":"larger"}},P={key:1,class:"col-12 d-flex justify-content-center align-items-center"},U={class:"card mb-3"},j=t("div",{class:"card-header"},[t("h6",null,"Выберите фотографию согласно задания квеста")],-1),C={class:"card-body d-flex justify-content-start"},D={for:"photos",style:{"margin-right":"10px"},class:"photo-loader ml-2"},Q={key:0,class:"mb-2 img-preview",style:{"margin-right":"10px"}},O={class:"remove"},S=t("i",{class:"fa-regular fa-trash-can"},null,-1),V=[S],I={key:2,class:"col-12 p-2"},N=t("div",{class:"alert alert-info mb-2",role:"alert"},[t("p",null,"Вы успешно прошли квест")],-1),R=t("h6",{class:"text-center"},"Укажите своё имя, как к Вам может обращаться менеджер?",-1),z={class:"input-group mb-2"},T=t("h6",{class:"text-center"},"Введите свой номер телефона чтобы наш менеджер мог связаться с Вами!",-1),$={class:"input-group mb-2"},q=t("h6",{class:"text-center"},"Оставьте свой комментарий",-1),A={class:"input-group mb-2"},B=t("button",{class:"btn btn-outline-primary p-3 w-100"}," Получить приз ",-1),L={class:"col-12 p-2"},E={key:1,class:"row"},J={class:"col-12"},W={class:"w-100",style:{"object-fit":"cover"},alt:""},x={name:"App",components:{Roulette:_},data(){return{rouletteKey:0,action:null,success:!1,photo:null,instaForm:{comment:null,name:null,phone:null},items:[]}},computed:{canPlay(){return this.action.current_attempts<this.action.max_attempts},tg(){return window.Telegram.WebApp},tgUserId(){return JSON.parse(new URLSearchParams(window.Telegram.WebApp.initData).get("user")).id||null}},mounted(){this.prepare()},methods:{getPhoto(){return{imageUrl:URL.createObjectURL(this.photo)}},onChangePhotos(o){const e=o.target.files;this.photo=e[0]},prepare(){return this.$store.dispatch("instagramQuestPrepare",{prepareForm:{telegram_chat_id:this.tgUserId},botDomain:this.bot.bot_domain}).then(o=>{this.action=o})},submit(){let o=new FormData;Object.keys(this.instaForm).forEach(e=>{const s=this.instaForm[e]||"";typeof s=="object"?o.append(e,JSON.stringify(s)):o.append(e,s)}),o.append("telegram_chat_id",this.tgUserId),o.append("photo",this.photo),this.$store.dispatch("instagramQuestResult",{instaForm:o,botDomain:this.bot.bot_domain}).then(e=>{this.winForm={comment:null,name:null,phone:null},this.photo=null,this.$notify({title:"Instagram Quest",text:"Вы успешно приняли участие в квесте! Наш менеджер свяжется с вами для дальнейших инструкций.",type:"success"}),this.prepare()}).catch(e=>{})},closeQuest(){this.tg.close()}}},G=Object.assign(x,{props:{bot:Object,rules:String},setup(o){return(e,s)=>{const p=u("lazy"),h=u("mask");return i(),a("div",g,[e.action?(i(),a("div",b,[o.rules?(i(),a("div",y,[t("div",v,[t("div",f,[t("p",null,c(o.rules),1)])])])):l("",!0),t("div",w,[e.canPlay?(i(),a("p",F,[d("Ваши попытки: "),t("strong",null,c(e.action.current_attempts||0),1),d(" из "),t("strong",null,c(e.action.max_attempts||1),1)])):(i(),a("p",k,"Вы израсходовали все ваши попытки"))]),e.canPlay&&!e.success?(i(),a("div",P,[t("div",U,[j,t("div",C,[t("label",D,[d(" + "),t("input",{type:"file",id:"photos",accept:"image/*",onChange:s[0]||(s[0]=(...n)=>e.onChangePhotos&&e.onChangePhotos(...n)),style:{display:"none"}},null,32)]),e.photo?(i(),a("div",Q,[r(t("img",null,null,512),[[p,e.getPhoto().imageUrl]]),t("div",O,[t("a",{onClick:s[1]||(s[1]=n=>e.photo=null)},V)])])):l("",!0)])])])):l("",!0),e.canPlay&&e.success?(i(),a("div",I,[N,t("form",{onSubmit:s[5]||(s[5]=(...n)=>e.submit&&e.submit(...n))},[R,t("div",z,[r(t("input",{type:"text",class:"form-control text-center p-3",placeholder:"Петров Петр Семенович","aria-label":"winForm-name","onUpdate:modelValue":s[2]||(s[2]=n=>e.instaForm.name=n),"aria-describedby":"winForm-name",required:""},null,512),[[m,e.instaForm.name]])]),T,t("div",$,[r(t("input",{type:"text",class:"form-control p-3 text-center","onUpdate:modelValue":s[3]||(s[3]=n=>e.instaForm.phone=n),placeholder:"+7(000)000-00-00","aria-label":"winForm-phone","aria-describedby":"vipForm-phone",required:""},null,512),[[h,"+7(###)###-##-##"],[m,e.instaForm.phone]])]),q,t("div",A,[r(t("textarea",{type:"text",class:"form-control p-3 text-center","onUpdate:modelValue":s[4]||(s[4]=n=>e.instaForm.comment=n),"aria-label":"winForm-phone","aria-describedby":"vipForm-phone",required:""},`
                        `,512),[[m,e.instaForm.comment]])]),B],32)])):l("",!0),t("div",L,[t("button",{onClick:s[6]||(s[6]=(...n)=>e.closeQuest&&e.closeQuest(...n)),type:"button",class:"btn btn-outline-success p-3 w-100"}," Вернуться в бота ")])])):(i(),a("div",E,[t("div",J,[r(t("img",W,null,512),[[p,"/images/load.gif"]])])]))])}}});export{G as default};
