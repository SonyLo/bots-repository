import{L as $,q as l,t as a,v as e,H as p,J as f,D as h,y as d,A as c,F as k,C as F,T as V,P as x,G as C,B as v,O as T,u as S,a1 as B,N as I,x as y,R as w,K as j}from"./index.es-f98e90e3.js";import{_ as U}from"./_plugin-vue_export-helper-c27b6911.js";const L={data(){return{companyForm:{id:null,title:null,description:null,address:null,phones:[],links:{vk:null,inst:null,map_link:null},email:null,schedule:[{day:"Понедельник",start_at:"08:00",end_at:"20:00",closed:!1,closed_comment:"Выходной"},{day:"Вторник",start_at:"08:00",end_at:"20:00",closed:!1,closed_comment:"Выходной"},{day:"Среда",start_at:"08:00",end_at:"20:00",closed:!1,closed_comment:"Выходной"},{day:"Четверг",start_at:"08:00",end_at:"20:00",closed:!1,closed_comment:"Выходной"},{day:"Пятница",start_at:"08:00",end_at:"20:00",closed:!1,closed_comment:"Выходной"},{day:"Суббота",start_at:"08:00",end_at:"20:00",closed:!1,closed_comment:"Выходной"},{day:"Воскресенье",start_at:"08:00",end_at:"20:00",closed:!1,closed_comment:"Выходной"}]}}},computed:{currentBot(){return window.currentBot}},mounted(){const s=this.currentBot.company;this.companyForm.id=s.id||null,this.companyForm.title=s.title||null,this.companyForm.description=s.description||null,this.companyForm.email=s.email||null,this.companyForm.address=s.address||null,this.companyForm.phones=s.phones||["+7"];let t=i=>{let o=["inst","vk","map_link"],u=!1,b=0;return Object.keys(i).forEach(r=>{o.indexOf(r)!==-1&&(u=!0,b++)}),u&&b===o.length};this.companyForm.links=t(s.links)?s.links:this.companyForm.links;let n=i=>{if((i||[]).length<7)return!1;let o=!0;return i.forEach(u=>{o=o&&typeof u=="object"}),o};this.companyForm.schedule=n(s.schedule)?s.schedule:this.companyForm.schedule},methods:{submitForm(){let s=new FormData;Object.keys(this.companyForm).forEach(t=>{const n=this.companyForm[t]||"";typeof n=="object"?s.append(t,JSON.stringify(n)):s.append(t,n)}),this.$store.dispatch("updateCompany",{companyForm:s}).then(t=>{this.$notify({title:"Информация о компании",text:"Информация о компании успешно обновлена!",type:"success"}),this.$emit("callback",t.data),window.location.reload()}).catch(t=>{this.$notify({title:"Информация о компании",text:"Ошибка обновления информации о компании",type:"error"})})}}},z={class:"form-floating mb-3"},M={for:"floatingInput"},E={key:0,class:"ml-1",style:{"font-size":"10px"}},O={class:"form-floating"},q={for:"floatingTextarea2"},D={key:0,class:"ml-1",style:{"font-size":"10px"}},A=e("h6",{class:"opacity-75 my-3"},"Контактная информация",-1),N={class:"form-floating mb-2"},H=e("label",{for:"floatingInput"},"Телефон",-1),P={class:"form-floating mb-2"},J=e("label",{for:"floatingInput"},"Инста",-1),R={class:"form-floating mb-2"},W=e("label",{for:"floatingInput"},"Вконтакте",-1),G={class:"form-floating mb-2"},K=e("label",{for:"floatingInput"},"Почта",-1),X=e("h6",{class:"opacity-75 my-3"},"Расположение заведения",-1),Y={class:"form-floating mb-2"},Q={for:"floatingInput"},Z={key:0,class:"ml-1",style:{"font-size":"10px"}},tt={class:"form-floating mb-2"},et=e("label",{for:"floatingInput"},"Виджет с Яндекс.Картой",-1),ot=e("h6",{class:"opacity-75 my-3"},"График работы",-1),st=e("div",{class:"alert alert-light p-2",style:{"font-size":"12px"},role:"alert"},[h(" Укажите график работы вашего заведения. Если в какой-то день ваше заведение "),e("span",{class:"fw-bold"},"закрыто"),h(" - поставьте галочку сбоку от времени и укажите причину. ")],-1),nt={class:"mb-0",style:{"font-size":"12px"}},lt={class:"input-group mb-2"},at={class:"input-group-text"},it=["onUpdate:modelValue"],rt={key:0,class:"form-floating"},ct=["onUpdate:modelValue"],dt=e("label",{for:"floatingInput"},"Начало",-1),mt={key:1,class:"form-floating"},pt=["onUpdate:modelValue"],ht=e("label",{for:"floatingInput"},"Окончание",-1),ut={key:2,class:"form-floating"},ft=["onUpdate:modelValue"],_t=e("label",{for:"floatingInput"},"Причина закрытия",-1),yt=e("button",{style:{"z-index":"100"},type:"submit",class:"btn btn-primary w-100 p-3 mb-3 position-sticky bottom-0"},"Сохранить изменения",-1);function bt(s,t,n,i,o,u){const b=$("mask");return l(),a("form",{onSubmit:t[8]||(t[8]=x((...r)=>u.submitForm&&u.submitForm(...r),["prevent"]))},[e("div",z,[p(e("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=r=>o.companyForm.title=r),maxlength:"255",class:"form-control",id:"floatingInput",placeholder:"name@example.com",required:""},null,512),[[f,o.companyForm.title]]),e("label",M,[h("Название "),(o.companyForm.title||"").length>0?(l(),a("span",E,"("+d(o.companyForm.title.length)+"/255)",1)):c("",!0)])]),e("div",O,[p(e("textarea",{"onUpdate:modelValue":t[1]||(t[1]=r=>o.companyForm.description=r),maxlength:"1000",required:"",class:"form-control",placeholder:"Leave a comment here",id:"floatingTextarea2",style:{height:"200px"}},null,512),[[f,o.companyForm.description]]),e("label",q,[h("Описание "),(o.companyForm.description||"").length>0?(l(),a("span",D,"("+d(o.companyForm.description.length)+"/1000)",1)):c("",!0)])]),A,e("div",N,[p(e("input",{type:"text","onUpdate:modelValue":t[2]||(t[2]=r=>o.companyForm.phones[0]=r),class:"form-control",id:"floatingInput",placeholder:"name@example.com"},null,512),[[b,["+7(###)###-##-##"]],[f,o.companyForm.phones[0]]]),H]),e("div",P,[p(e("input",{type:"text","onUpdate:modelValue":t[3]||(t[3]=r=>o.companyForm.links.inst=r),class:"form-control",id:"floatingInput",placeholder:"name@example.com"},null,512),[[f,o.companyForm.links.inst]]),J]),e("div",R,[p(e("input",{type:"text","onUpdate:modelValue":t[4]||(t[4]=r=>o.companyForm.links.vk=r),class:"form-control",id:"floatingInput",placeholder:"name@example.com"},null,512),[[f,o.companyForm.links.vk]]),W]),e("div",G,[p(e("input",{type:"email","onUpdate:modelValue":t[5]||(t[5]=r=>o.companyForm.email=r),class:"form-control",id:"floatingInput",placeholder:"name@example.com"},null,512),[[f,o.companyForm.email]]),K]),X,e("div",Y,[p(e("input",{type:"text","onUpdate:modelValue":t[6]||(t[6]=r=>o.companyForm.address=r),class:"form-control",id:"floatingInput",placeholder:"name@example.com"},null,512),[[f,o.companyForm.address]]),e("label",Q,[h("Адрес расположения "),(o.companyForm.address||"").length>0?(l(),a("span",Z,"("+d(o.companyForm.address.length)+"/255)",1)):c("",!0)])]),e("div",tt,[p(e("textarea",{"onUpdate:modelValue":t[7]||(t[7]=r=>o.companyForm.links.map_link=r),class:"form-control",placeholder:"Leave a comment here",id:"floatingTextarea2",style:{height:"200px"}},null,512),[[f,o.companyForm.links.map_link]]),et]),ot,st,(l(!0),a(k,null,F(o.companyForm.schedule,(r,m)=>(l(),a(k,null,[e("p",nt,d(o.companyForm.schedule[m].day),1),e("div",lt,[e("div",at,[p(e("input",{class:"form-check-input mt-0","onUpdate:modelValue":_=>o.companyForm.schedule[m].closed=_,type:"checkbox",value:"","aria-label":"Checkbox for following text input"},null,8,it),[[V,o.companyForm.schedule[m].closed]])]),o.companyForm.schedule[m].closed?c("",!0):(l(),a("div",rt,[p(e("input",{type:"time","onUpdate:modelValue":_=>o.companyForm.schedule[m].start_at=_,class:"form-control",id:"floatingInput",placeholder:"name@example.com"},null,8,ct),[[f,o.companyForm.schedule[m].start_at]]),dt])),o.companyForm.schedule[m].closed?c("",!0):(l(),a("div",mt,[p(e("input",{type:"time","onUpdate:modelValue":_=>o.companyForm.schedule[m].end_at=_,class:"form-control",id:"floatingInput",placeholder:"name@example.com"},null,8,pt),[[f,o.companyForm.schedule[m].end_at]]),ht])),o.companyForm.schedule[m].closed?(l(),a("div",ut,[p(e("input",{type:"text","onUpdate:modelValue":_=>o.companyForm.schedule[m].closed_comment=_,class:"form-control",id:"floatingInput",placeholder:"name@example.com"},null,8,ft),[[f,o.companyForm.schedule[m].closed_comment]]),_t])):c("",!0)])],64))),256)),yt],32)}const gt=U(L,[["render",bt]]);const kt=e("title",null,"CashMan - система твоего бизнеса внутри",-1),vt=e("meta",{name:"description",content:"CashMan - система твоего бизнеса внутри"},null,-1),wt={"data-bs-theme":"dark"},Ft={class:"navbar shadow shadow-sm"},Ct={class:"container flex-row-reverse p-2"},Tt={key:0,class:"mb-0 fw-bold d-flex flex-column",style:{"font-size":"12px"}},$t={key:0,class:"text-primary"},Vt=e("i",{class:"fa-solid fa-location-dot mr-1"},null,-1),xt={key:1,class:"text-primary"},St={key:2,class:"small d-flex justify-content-end"},Bt={href:"javascript:void(0)",class:"text-secondary fw-bold"},It={key:1,class:"mb-0 text-primary",style:{"font-size":"12px"}},jt=e("button",{class:"btn btn-link rounded-0 border-0 p-1",type:"button","data-bs-toggle":"offcanvas","data-bs-target":"#sidebar-menu","aria-controls":"sidebar-menu"},[e("span",{class:"navbar-toggler-icon"})],-1),Ut={class:"text-body-secondary",style:{padding:"0px 0px 90px 0px"}},Lt={class:"container g-2 d-flex justify-content-center flex-column align-items-center"},zt={class:"text-center mb-3"},Mt=["innerHTML"],Et={key:0,"data-bs-toggle":"modal","data-bs-target":"#edit-shop-footer-description-modal",href:"javascript:void(0)",class:"text-primary ml-2",style:{"font-size":"12px"}},Ot=e("i",{class:"fa-solid fa-pen-to-square"},null,-1),qt={key:1,class:"mb-3 text-center"},Dt=e("i",{class:"fa-solid fa-map-location-dot mr-2"},null,-1),At={class:"mb-0"},Nt={class:"d-flex justify-content-center my-3"},Ht=e("i",{class:"fa-solid fa-arrow-up mr-2"},null,-1),Pt={class:"offcanvas offcanvas-start custom-offcanvas",style:{width:"70%","border-radius":"0px 10px 10px 0px"},tabindex:"-1",id:"sidebar-menu","aria-labelledby":"offcanvasExampleLabel"},Jt={class:"offcanvas-header"},Rt={class:"offcanvas-title",id:"offcanvasExampleLabel"},Wt=e("button",{type:"button",class:"btn-close","data-bs-dismiss":"offcanvas","aria-label":"Close"},null,-1),Gt={class:"offcanvas-body"},Kt={class:"list-unstyled"},Xt={class:"p-1"},Yt={class:"p-1"},Qt={class:"p-1"},Zt={class:"p-1"},te={key:0,class:"fw-bold"},ee={class:"p-1"},oe={class:"p-1"},se={class:"p-1"},ne=e("div",{class:"border-top my-3"},null,-1),le={key:0,class:"p-2"},ae={class:"list-unstyled"},ie={key:0},re=e("p",{class:"mb-0"},"Телефон",-1),ce=[re],de={key:1,class:"mb-2"},me=["href"],pe={key:2},he=e("p",{class:"mb-0"},"Ссылки",-1),ue=[he],fe={key:3},_e=["href"],ye=e("i",{class:"fa-brands fa-instagram mr-1"},null,-1),be={key:4},ge=["href"],ke=e("i",{class:"fa-brands fa-vk mr-1"},null,-1),ve={key:5},we=e("p",{class:"mb-0"},"Почта",-1),Fe=[we],Ce=["href"],Te={key:1,class:"dropdown"},$e=e("button",{class:"btn btn-light w-100 dropdown-toggle",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"}," Тема оформления ",-1),Ve={class:"dropdown-menu w-100 bg-light"},xe=["onClick"],Se={class:"modal fade",id:"edit-shop-footer-description-modal",tabindex:"-1","aria-labelledby":"edit-shop-footer-description","aria-hidden":"true"},Be={class:"modal-dialog modal-fullscreen"},Ie={class:"modal-content"},je=e("div",{class:"modal-header"},[e("h1",{class:"modal-title fs-5",id:"exampleModalLabel"},"Редактор"),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),Ue={class:"modal-body"},Le=e("div",{class:"modal-footer p-2"},null,-1),ze={data(){return{currentTheme:"",themes:[{title:"Тема 3",href:"/theme5.bootstrap.min.css"},{title:"Тема 4",href:"/theme6.bootstrap.min.css"},{title:"Тема 5",href:"/theme8.bootstrap.min.css"},{title:"Тема 6",href:"/theme9.bootstrap.min.css"},{title:"Тема 7",href:"/theme10.bootstrap.min.css"},{title:"Тема 8",href:"/theme11.bootstrap.min.css"},{title:"Тема 9",href:"/theme12.bootstrap.min.css"},{title:"Тема 10",href:"/theme13.bootstrap.min.css"},{title:"Тема 11",href:"/theme14.bootstrap.min.css"},{title:"Тема 12",href:"/theme15.bootstrap.min.css"},{title:"Тема 13",href:"/theme16.bootstrap.min.css"}]}},watch:{$route(s){let t=localStorage.getItem("cashman_global_client_theme")||null;t&&this.$nextTick(()=>{this.currentTheme=t}),this.$preloader.show(),this.$nextTick(()=>{document.body.scrollTop=document.documentElement.scrollTop=0})}},computed:{...C(["getSelf","cartTotalCount"]),tg(){return window.Telegram.WebApp},bot(){return window.currentBot},links(){return{inst:(this.bot.company.links||{inst:null}).inst||null,vk:(this.bot.company.links||{inst:null}).vk||null,map_link:(this.bot.company.links||{inst:null}).map_link||null}}},mounted(){let s=localStorage.getItem("cashman_global_client_theme")||null;s&&this.$nextTick(()=>{this.currentTheme=s}),this.changeTheme(this.tg.colorScheme),this.tg.BackButton.show(),this.tg.BackButton.onClick(()=>{document.querySelectorAll('[data-bs-dismiss="modal"]').forEach(t=>t.click()),this.$router.back()})},methods:{switchTheme(s){let t=document.querySelector("#theme");t.href=this.themes[s].href,localStorage.setItem("cashman_global_client_theme",t.href),this.$nextTick(()=>{this.currentTheme=t.href})},goTo(s){this.$router.push({name:s})},changeTheme(s){document.querySelectorAll("[data-bs-theme]").forEach(n=>{n.setAttribute("data-bs-theme",s)})},scrollTop(){window.scrollTo(0,80)},openLink(s){this.tg.openLink(s,{try_instant_view:!0})},closeShop(){this.tg.close()}}},Me=Object.assign(ze,{__name:"V2Layout",setup(s){return(t,n)=>(l(),a(k,null,[v(S(B),null,{default:T(()=>[kt,vt]),_:1}),e("header",wt,[e("div",Ft,[e("div",Ct,[t.bot.company?(l(),a("p",Tt,[t.bot.company.address?(l(),a("span",$t,[Vt,h(" "+d(t.bot.company.address),1)])):(l(),a("span",xt,d(t.bot.title||"Магазин"),1)),(t.bot.company.phones||[]).length>0?(l(),a("span",St,[e("a",Bt,d(t.bot.company.phones[0]),1)])):c("",!0)])):(l(),a("p",It,d(t.bot.title||"Бот"),1)),jt])])]),I(t.$slots,"default"),e("footer",Ut,[e("div",Lt,[t.$route.name!="FeedBackV2"?(l(),a("button",{key:0,onClick:n[0]||(n[0]=i=>t.goTo("FeedBackV2")),class:"btn btn-link mb-2 w-100 p-3 text-primary"},"Обратная связь ")):c("",!0),e("p",zt,[e("span",{innerHTML:t.bot.company.description},null,8,Mt),(t.getSelf||{is_admin:!1}).is_admin?(l(),a("a",Et,[Ot,h(" редактировать")])):c("",!0)]),t.bot.company.address?(l(),a("p",qt,[Dt,h(d(t.bot.company.address),1)])):c("",!0),e("p",At,d(t.bot.company.title)+"©"+d(new Date().getFullYear()),1),e("p",Nt,[e("a",{href:"javascript:void(0)",onClick:n[1]||(n[1]=(...i)=>t.scrollTop&&t.scrollTop(...i))},[Ht,h("Вернуться наверх")])])])]),e("div",Pt,[e("div",Jt,[e("h6",Rt,d(t.bot.title||"Магазин"),1),Wt]),e("div",Gt,[e("ul",Kt,[e("li",Xt,[e("a",{class:y([{"fw-bold":t.$route.name==="MenuV2"},"text-decoration-none fw-normal"]),onClick:n[2]||(n[2]=i=>t.goTo("MenuV2")),href:"javascript:void(0)"}," Главное меню",2)]),e("li",Yt,[e("a",{class:y([{"fw-bold":t.$route.name==="ProfileV2"},"text-decoration-none fw-normal"]),onClick:n[3]||(n[3]=i=>t.goTo("ProfileV2")),href:"javascript:void(0)"}," Профиль",2)]),e("li",Qt,[e("a",{class:y([{"fw-bold":t.$route.name==="CatalogV2"},"text-decoration-none fw-normal"]),onClick:n[4]||(n[4]=i=>t.goTo("CatalogV2")),href:"javascript:void(0)"}," Каталог товаров",2)]),e("li",Zt,[e("a",{class:y([{"fw-bold":t.$route.name==="ShopCartV2"},"text-decoration-none fw-normal"]),onClick:n[5]||(n[5]=i=>t.goTo("ShopCartV2")),href:"javascript:void(0)"},[h(" Корзина "),t.cartTotalCount>0?(l(),a("span",te,"("+d(t.cartTotalCount)+")",1)):c("",!0)],2)]),e("li",ee,[e("a",{class:y([{"fw-bold":t.$route.name==="OrdersV2"},"text-decoration-none fw-normal"]),onClick:n[6]||(n[6]=i=>t.goTo("OrdersV2")),href:"javascript:void(0)"}," История заказов",2)]),e("li",oe,[e("a",{class:y([{"fw-bold":t.$route.name==="CashBackV2"},"text-decoration-none fw-normal"]),onClick:n[7]||(n[7]=i=>t.goTo("CashBackV2")),href:"javascript:void(0)"}," CashBack",2)]),e("li",se,[e("a",{class:y([{"fw-bold":t.$route.name==="FeedBackV2"},"text-decoration-none fw-normal"]),onClick:n[8]||(n[8]=i=>t.goTo("FeedBackV2")),href:"javascript:void(0)"}," Оставить отзыв",2)])]),ne,t.bot.company?(l(),a("div",le,[e("ul",ae,[(t.bot.company.phones||[]).length>0?(l(),a("li",ie,ce)):c("",!0),(t.bot.company.phones||[]).length>0?(l(),a("li",de,[e("a",{target:"_blank",href:"tel:"+t.bot.company.phones[0],class:"text-decoration-none fw-bold"},d(t.bot.company.phones[0]||"-"),9,me)])):c("",!0),t.links.inst||t.links.vk?(l(),a("li",pe,ue)):c("",!0),t.links.inst?(l(),a("li",fe,[e("a",{target:"_blank",href:"http://instagram.com/"+t.links.inst,style:{"font-size":"12px"},class:"text-primary"},[ye,h(" "+d(t.links.inst||"ссылка"),1)],8,_e)])):c("",!0),t.links.vk?(l(),a("li",be,[e("a",{target:"_blank",href:"https://vk.com/"+t.links.vk,style:{"font-size":"12px"},class:"text-primary"},[ke,h(" "+d(t.links.vk||"ссылка"),1)],8,ge)])):c("",!0),t.bot.company.email?(l(),a("li",ve,Fe)):c("",!0),e("li",null,[t.bot.company.email?(l(),a("a",{key:0,href:"mailto:"+t.bot.company.email,class:"text-decoration-none fw-bold"},d(t.bot.company.email),9,Ce)):c("",!0)])])])):c("",!0),(t.getSelf||{is_admin:!1}).is_admin?(l(),a("div",Te,[$e,e("ul",Ve,[(l(!0),a(k,null,F(t.themes,(i,o)=>(l(),a("li",null,[e("button",{type:"button",onClick:u=>t.switchTheme(o),class:y([{active:t.currentTheme.indexOf(i.href)!=-1},"list-group-item list-group-item-action p-2 w-100 text-primary"]),"aria-current":"true"},d(i.title||"-"),11,xe)]))),256))])])):c("",!0)])]),e("div",Se,[e("div",Be,[e("div",Ie,[je,e("div",Ue,[v(gt)]),Le])])])],64))}}),Ee={computed:{...C(["getSelf"]),logo(){return`/images-by-bot-id/${this.currentBot.id}/${this.currentBot.image}`},self(){return window.self||null},tg(){return window.Telegram.WebApp},tgUser(){const s=new URLSearchParams(this.tg.initData);return JSON.parse(s.get("user"))},currentBot(){return window.currentBot},qr(){return"https://api.qrserver.com/v1/create-qr-code/?size=450x450&qzone=2&data="+this.link},link(){return"https://t.me/"+this.currentBot.bot_domain+"?start="+btoa("001"+this.self.telegram_chat_id)}},created(){window.currentBot=this.bot.data;const s=window.currentBot.company.schedule||[];if(window.isCorrectSchedule=t=>{if((t||[]).length<7)return!1;let n=!0;return t.forEach(i=>{n=n&&typeof i=="object"}),n},window.isCorrectSchedule(s)){const t=new Date().getDay(),n=new Date().getHours(),i=new Date().getMinutes();let o=s[t-1].start_at||"08:00",u=parseInt(o.split(":")[0]),b=parseInt(o.split(":")[1]),r=s[t-1].end_at||"20:00",m=parseInt(r.split(":")[0]),_=parseInt(r.split(":")[1]),g=!1;u===n&&(g=i>=b),m===n&&(g=i<_),n>u&&n<m&&(g=!0),window.currentBot.company.is_work=!s[t-1].closed&&g}window.currentScript=this.slug_id||null,this.$store.dispatch("loadSelf").then(()=>{window.self=this.getSelf}),this.$notify({title:"Главная",text:"Успешно!",type:"success"})},methods:{open(s){this.tg.openLink(s)}}},De=Object.assign(Ee,{__name:"MainV2",props:{bot:{type:Object},slug_id:{type:String}},setup(s){return(t,n)=>{const i=w("notifications"),o=w("router-view");return l(),j(Me,null,{default:T(()=>[v(i,{position:"top right",width:"100%",speed:"100"}),v(o,{bot:s.bot},null,8,["bot"])]),_:1})}}});export{De as default};
