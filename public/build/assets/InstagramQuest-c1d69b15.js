import{o as a,q as i,t as e,x as c,z as r,C as u,H as l,L as d,K as _,J as p}from"./index.es-0047b125.js";const g={class:"container"},b={key:0,class:"row"},y={key:0,class:"col-12 mb-2 mt-2"},f={class:"card"},v={class:"card-body"},w={class:"col-12 mb-2 mt-2"},F={key:0,style:{"text-align":"center","font-size":"larger"}},P={key:1,style:{"text-align":"center","font-size":"larger"}},k={key:1,class:"col-12"},U=e("h6",{class:"text-center"},"Выберите фотографию согласно задания квеста",-1),j=[U],C={key:2,class:"col-12 d-flex justify-content-center align-items-center"},D={class:"card mb-3"},Q={class:"card-body d-flex justify-content-start"},I={for:"photos",class:"photo-loader ml-2"},O=e("i",{class:"fa-brands fa-instagram"},null,-1),S={key:0,class:"img-preview",style:{"margin-left":"10px"}},V={class:"remove"},z=e("i",{class:"fa-regular fa-trash-can"},null,-1),N=[z],T={key:3,class:"col-12 p-2"},q=e("div",{class:"alert alert-info mb-2",role:"alert"},[e("p",null,"Вы успешно прошли квест")],-1),A=e("h6",{class:"text-center"},"Укажите своё имя, как к Вам может обращаться менеджер?",-1),L={class:"input-group mb-2"},R=e("h6",{class:"text-center"},"Введите свой номер телефона чтобы наш менеджер мог связаться с Вами!",-1),B={class:"input-group mb-2"},J=e("h6",{class:"text-center"},"Оставьте свой комментарий",-1),W={class:"input-group mb-2"},$=e("button",{class:"btn btn-outline-primary p-3 w-100"}," Получить приз ",-1),E={class:"col-12 p-2"},K={key:1,class:"row"},M={class:"col-12"},H=e("h4",{class:"text-center mt-5"},"К сожалению, на текущий момент нет возможности сдать текущее задание. Попробуйте позже!",-1),G={class:"w-100",style:{"object-fit":"cover"},alt:""},X={name:"App",data(){return{rouletteKey:0,action:null,success:!1,photo:null,instaForm:{comment:null,name:null,phone:null},items:[]}},computed:{canPlay(){return this.action.current_attempts<this.action.max_attempts},tg(){return window.Telegram.WebApp},tgUserId(){return window.Telegram.WebApp.initData&&JSON.parse(new URLSearchParams(window.Telegram.WebApp.initData).get("user")).id||null}},mounted(){this.prepare()},methods:{removePhoto(){this.photo=null,this.success=!1},getPhoto(){return{imageUrl:URL.createObjectURL(this.photo)}},onChangePhotos(n){const t=n.target.files;this.photo=t[0],this.success=!0},prepare(){if(this.tgUserId)return this.$store.dispatch("instagramQuestPrepare",{prepareForm:{telegram_chat_id:this.tgUserId},botDomain:this.bot.bot_domain}).then(n=>{this.action=n})},submit(){let n=new FormData;Object.keys(this.instaForm).forEach(t=>{const s=this.instaForm[t]||"";typeof s=="object"?n.append(t,JSON.stringify(s)):n.append(t,s)}),n.append("telegram_chat_id",this.tgUserId),n.append("photo",this.photo),this.$store.dispatch("instagramQuestResult",{instaForm:n,botDomain:this.bot.bot_domain}).then(t=>{this.instaForm={comment:null,name:null,phone:null},this.photo=null,this.$notify({title:"Instagram Quest",text:"Вы успешно приняли участие в квесте! Наш менеджер свяжется с вами для дальнейших инструкций.",type:"success"}),this.prepare()}).catch(t=>{})},closeQuest(){this.tg.close()}}},Z=Object.assign(X,{props:{bot:Object,rules:String},setup(n){return(t,s)=>{const m=p("lazy"),h=p("mask");return a(),i("div",g,[t.action?(a(),i("div",b,[n.rules?(a(),i("div",y,[e("div",f,[e("div",v,[e("p",null,c(n.rules),1)])])])):r("",!0),e("div",w,[t.canPlay&&!t.success?(a(),i("p",F,[u("Ваши попытки: "),e("strong",null,c(t.action.current_attempts||0),1),u(" из "),e("strong",null,c(t.action.max_attempts||1),1)])):(a(),i("p",P,"Вы израсходовали все ваши попытки"))]),t.canPlay&&!t.success?(a(),i("div",k,j)):r("",!0),t.canPlay&&!t.success?(a(),i("div",C,[e("div",D,[e("div",Q,[e("label",I,[O,e("input",{type:"file",id:"photos",accept:"image/*",onChange:s[0]||(s[0]=(...o)=>t.onChangePhotos&&t.onChangePhotos(...o)),style:{display:"none"}},null,32)]),t.photo?(a(),i("div",S,[l(e("img",null,null,512),[[m,t.getPhoto().imageUrl]]),e("div",V,[e("a",{onClick:s[1]||(s[1]=(...o)=>t.removePhoto&&t.removePhoto(...o))},N)])])):r("",!0)])])])):r("",!0),t.canPlay&&t.success?(a(),i("div",T,[q,e("form",{onSubmit:s[5]||(s[5]=_((...o)=>t.submit&&t.submit(...o),["prevent"]))},[A,e("div",L,[l(e("input",{type:"text",class:"form-control text-center p-3",placeholder:"Петров Петр Семенович","aria-label":"winForm-name","onUpdate:modelValue":s[2]||(s[2]=o=>t.instaForm.name=o),"aria-describedby":"instaForm-name",required:""},null,512),[[d,t.instaForm.name]])]),R,e("div",B,[l(e("input",{type:"text",class:"form-control p-3 text-center","onUpdate:modelValue":s[3]||(s[3]=o=>t.instaForm.phone=o),placeholder:"+7(000)000-00-00","aria-label":"winForm-phone","aria-describedby":"instaForm-phone",required:""},null,512),[[h,"+7(###)###-##-##"],[d,t.instaForm.phone]])]),J,e("div",W,[l(e("textarea",{type:"text",class:"form-control p-3",placeholder:"Текст вашего комментария","onUpdate:modelValue":s[4]||(s[4]=o=>t.instaForm.comment=o),"aria-label":"winForm-phone","aria-describedby":"instaForm-comment",required:""},`
                        `,512),[[d,t.instaForm.comment]])]),$],32)])):r("",!0),e("div",E,[e("button",{onClick:s[6]||(s[6]=(...o)=>t.closeQuest&&t.closeQuest(...o)),type:"button",class:"btn btn-outline-success p-3 w-100"}," Вернуться в бота ")])])):(a(),i("div",K,[e("div",M,[H,l(e("img",G,null,512),[[m,"/images/load.gif"]])])]))])}}});export{Z as default};
