import{_ as B,a as U,b as H,c as T,d as me,e as he,f as _e}from"./MailingTable-2d45bcd3.js";import{R as q,q as l,t as i,v as e,B as g,O as f,D as m,H as c,J as _,F as v,C as y,y as u,A as r,S as k,P as S,G as w,x as p,K as $,L as A,z as te,u as M,Y as Q,a3 as z,M as pe,k as be,g as K,o as fe,a8 as ge,a4 as ve,a9 as $e,aa as G,a7 as ye}from"./index.es-b188fb53.js";import{_ as Y}from"./GlobalSlugList-d79d0854.js";import{V as se,T as oe}from"./TelegramChannelHelper-c8506167.js";import{_ as P,B as J}from"./BotMediaList-d7770095.js";import{P as j}from"./Pagination-0b2e35d4.js";import{_ as D,a as le}from"./InlineInjectionsHelper.vue_vue_type_style_index_0_lang-e0106cbd.js";import{_ as ke}from"./BotForm-fdc7c684.js";import{_ as I}from"./_plugin-vue_export-helper-c27b6911.js";import{K as ie}from"./main-1486aa08.js";import{v as Fe}from"./v4-4a60fe23.js";const Ce={class:"row"},we={class:"col-12 mb-3"},Se={class:"form-label",id:"service-title"},je=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),qe=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),ze={class:"col-12 mb-3"},Pe={key:0},Ve=["onClick"],Oe={class:"form-label",id:"service-category"},Ue=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),Ae=e("div",null,"Категория услуги (используется для группировки) ",-1),Ie=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),Qe={class:"col-12 mb-3"},Te={class:"form-label",id:"service-description"},Be=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),Re=e("div",null," Краткая информация об оказываемой услуге ",-1),Me=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),De={key:0,class:"text-gray-400 ml-3",style:{"font-size":"10px"}},Ee={class:"col-12 col-md-6 mb-3"},Le={class:"form-label",id:"service-title"},Ke=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),Ne=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),Je={class:"col-12 col-md-6 mb-3"},Ye={class:"form-label",id:"service-title"},He=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),Ge=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),We={class:"col-12 mb-3"},Xe={class:"form-check"},Ze=e("label",{class:"form-check-label",for:"need_images"}," Необходимо добавить изображения к сервиус ",-1),xe={key:0,class:"col-12 mb-3"},et={class:"form-label",id:"service-images"},tt=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),st=e("div",null," Изображение, которое видит пользователь при выборе услуги ",-1),ot=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),lt={class:"col-12 mb-3"},it={class:"form-check"},nt=e("label",{class:"form-check-label",for:"need_prepayment"}," Необходима предоплата ",-1),at={class:"row"},dt={class:"col-12"},rt={type:"submit",class:"btn btn-outline-success w-100 p-3"},ct={key:0},ut={key:1},mt={props:["eventId","bot","service"],data(){return{load:!1,need_reset:!1,need_images:!1,categories:[],serviceForm:{id:null,title:null,appointment_event_id:null,description:null,category:null,images:[],need_prepayment:!1,price:0,discount_price:0}}},watch:{serviceForm:{handler(s){this.need_reset=!0},deep:!0}},mounted(){this.loadAppointmentServiceCategories(),console.log("Service form",this.service),this.service&&this.$nextTick(()=>{this.serviceForm={id:this.service.id||null,appointment_event_id:this.service.appointment_event_id||null,title:this.service.title||null,category:this.service.category||null,description:this.service.description||null,images:this.service.images||[],need_prepayment:this.service.need_prepayment||!1,price:this.service.price||0,discount_price:this.service.discount_price||0}})},methods:{loadAppointmentServiceCategories(){this.$store.dispatch("loadAppointmentServiceCategories",{dataObject:{bot_id:this.bot.id||null,event_id:this.eventId||null}}).then(s=>{this.categories=s})},selectPhotos(s){this.serviceForm.images||(this.serviceForm.images=[]);let t=this.serviceForm.images.indexOf(s.file_id);t!==-1?this.serviceForm.images.splice(t,1):this.serviceForm.images.push(s.file_id)},resetForm(){},submitForm(){let s=new FormData;Object.keys(this.serviceForm).forEach(t=>{const o=this.serviceForm[t]||"";typeof o=="object"?s.append(t,JSON.stringify(o)):s.append(t,o)}),s.append("bot_id",this.bot.id),s.append("appointment_event_id",this.eventId),this.$store.dispatch(this.serviceForm.id===null?"addAppointmentService":"updateAppointmentService",{appointmentServiceForm:s}).then(t=>{this.$emit("callback",t.data),this.$notify("Услуги успешно создано")}).catch(t=>{this.$notify("Услуги создания события")})}}},ht=Object.assign(mt,{__name:"AppointmentServiceForm",setup(s){return(t,o)=>{const a=q("Popper");return l(),i("form",{onSubmit:o[7]||(o[7]=S((...n)=>t.submitForm&&t.submitForm(...n),["prevent"]))},[e("div",Ce,[e("div",we,[e("label",Se,[g(a,{content:"Название оказываемой услуги"},{default:f(()=>[je]),_:1}),m(" Название услуги "),qe]),c(e("input",{type:"text",class:"form-control",placeholder:"Название","aria-label":"Название","onUpdate:modelValue":o[0]||(o[0]=n=>t.serviceForm.title=n),maxlength:"255","aria-describedby":"service-title",required:""},null,512),[[_,t.serviceForm.title]])]),e("div",ze,[t.categories?(l(),i("p",Pe,[m(" Ранее созданные категории: "),(l(!0),i(v,null,y(t.categories,n=>(l(),i("span",{onClick:d=>t.serviceForm.category=n,class:"badge bg-primary mr-1 cursor-pointer"},u(n),9,Ve))),256))])):r("",!0),e("label",Oe,[g(a,null,{content:f(()=>[Ae]),default:f(()=>[Ue]),_:1}),m(" Категория услуги "),Ie]),c(e("input",{type:"text",class:"form-control",placeholder:"Категория услуги","aria-label":"Категория услуги","onUpdate:modelValue":o[1]||(o[1]=n=>t.serviceForm.category=n),maxlength:"255","aria-describedby":"service-category",required:""},null,512),[[_,t.serviceForm.category]])]),e("div",Qe,[e("label",Te,[g(a,null,{content:f(()=>[Re]),default:f(()=>[Be]),_:1}),m(" Описание услуги "),Me,t.serviceForm.description?(l(),i("small",De," Длина текста "+u(t.serviceForm.description.length)+" / 255",1)):r("",!0)]),c(e("textarea",{type:"text",class:"form-control",placeholder:"Описание услуги","aria-label":"Описание услуги",maxlength:"255","onUpdate:modelValue":o[2]||(o[2]=n=>t.serviceForm.description=n),"aria-describedby":"service-description",required:""},`
                    `,512),[[_,t.serviceForm.description]])]),e("div",Ee,[e("label",Le,[g(a,{content:"Цена оказываемой услуги"},{default:f(()=>[Ke]),_:1}),m(" Цена услуги, руб "),Ne]),c(e("input",{type:"number",class:"form-control",placeholder:"Цена","aria-label":"Цена",min:"0","onUpdate:modelValue":o[3]||(o[3]=n=>t.serviceForm.price=n),"aria-describedby":"price",required:""},null,512),[[_,t.serviceForm.price]])]),e("div",Je,[e("label",Ye,[g(a,{content:"Цена скидки на оказываемую услугу"},{default:f(()=>[He]),_:1}),m(" Цена скидки на услугу, руб "),Ge]),c(e("input",{type:"number",class:"form-control",placeholder:"Цена","aria-label":"Цена",min:"0","onUpdate:modelValue":o[4]||(o[4]=n=>t.serviceForm.discount_price=n),"aria-describedby":"price",required:""},null,512),[[_,t.serviceForm.discount_price]])]),e("div",We,[e("div",Xe,[c(e("input",{class:"form-check-input","onUpdate:modelValue":o[5]||(o[5]=n=>t.need_images=n),type:"checkbox",id:"need_images"},null,512),[[k,t.need_images]]),Ze])]),t.need_images?(l(),i("div",xe,[e("label",et,[g(a,null,{content:f(()=>[st]),default:f(()=>[tt]),_:1}),m(" Изображение к услуге "),ot]),g(P,{"need-photo":!0,selected:t.serviceForm.images,onSelect:t.selectPhotos},null,8,["selected","onSelect"])])):r("",!0),e("div",lt,[e("div",it,[c(e("input",{class:"form-check-input","onUpdate:modelValue":o[6]||(o[6]=n=>t.serviceForm.need_prepayment=n),type:"checkbox",id:"need_prepayment"},null,512),[[k,t.serviceForm.need_prepayment]]),nt])])]),e("div",at,[e("div",dt,[e("button",rt,[t.serviceForm.id===null?(l(),i("span",ct,"Создать услугу")):(l(),i("span",ut,"Обновить услугу"))])])])],32)}}}),_t={props:["param"],data(){return{expressions:[{expression:"{{userName}}",description:"Имя пользователя"},{expression:"{{level_1_percent}}",description:"Процент кэшбэка 1 уровня"},{expression:"{{level_2_percent}}",description:"Процент кэшбэка 2 уровня"},{expression:"{{level_3_percent}}",description:"Процент кэшбэка 3 уровня"},{expression:"{{cashback_fire_percent}}",description:"Процент сжигания кэшбэка"},{expression:"{{is_admin}}",description:"Статус администратора"},{expression:"{{is_work}}",description:"Статус работника"},{expression:"{{is_vip}}",description:"Статус VIP"},{expression:"{{is_manager}}",description:"Статус менеджера"},{expression:"{{is_deliveryman}}",description:"Статус доставщика"},{expression:"{{sex}}",description:"Пол клиента"},{expression:"{{cashback}}",description:"Сумма КэшБэк пользователя"},{expression:"{{telegramChatId}}",description:"Идентификатор чата"},{expression:"{{referralLink}}",description:"Реферальная ссылка"},{expression:"{{referralQr}}",description:"Реферальный QR-код"}]}},methods:{expressionsSelect(s){this.$emit("callback",{param:this.param,text:s.expression})}}},pt={class:"dropdown"},bt=e("button",{class:"btn btn-link dropdown-toggle",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-brands fa-hire-a-helper"})],-1),ft={class:"dropdown-menu item-with-text cursor-pointer text-muted p-2"},gt=["onClick"];function vt(s,t,o,a,n,d){return l(),i("div",pt,[bt,e("div",ft,[e("li",null,[(l(!0),i(v,null,y(n.expressions,h=>(l(),i("a",{class:"dropdown-item",onClick:b=>d.expressionsSelect(h)},u(h.description||"-"),9,gt))),256))])])])}const $t=I(_t,[["render",vt]]),yt={key:0,class:"row"},kt={class:"col-12"},Ft={class:"form-floating mb-3"},Ct=e("label",{for:"floatingInput"},"Быстрый поиск команды",-1),wt={class:"col-12 mb-2"},St={class:"form-check"},jt={class:"form-check-label",for:"need_global"},qt={key:0},zt={key:1},Pt={class:"form-check"},Vt=e("label",{class:"form-check-label",for:"need_show_deleted"}," Удаленные ",-1),Ot={key:0,class:"mb-3 col-12 col-sm-12"},Ut={class:"table"},At=e("thead",null,[e("tr",null,[e("th",{scope:"col"},"#"),e("th",{scope:"col"},"Команда"),e("th",{scope:"col"},"Пояснение")])],-1),It=["onClick"],Qt={key:2,class:"mb-3 col-md-12"},Tt=e("div",{class:"alert alert-danger",role:"alert"}," У Вас еще нет добавленных скриптов! ",-1),Bt=[Tt],Rt={props:["command","canSelect"],data(){return{bot:null,load:!1,need_global:!0,need_show_deleted:!0,slugs:[],ownSearch:null,paginate:[]}},watch:{ownSearch:function(s,t){this.loadSlugs()},need_global:function(s,t){this.loadSlugs()},need_show_deleted:function(s,t){this.loadSlugs()}},computed:{...w(["getCurrentBot","getSlugs","getSlugsPaginateObject"])},mounted(){this.loadCurrentBot().then(()=>{this.loadSlugs()})},methods:{nextSlugs(s){this.loadSlugs(s)},loadSlugs(s=0){return this.$store.dispatch("loadSlugs",{dataObject:{botId:this.bot.id,needGlobal:this.need_global,needDeleted:this.need_show_deleted,search:this.ownSearch},page:s}).then(t=>{this.slugs=this.getSlugs,this.paginate=this.getSlugsPaginateObject})},loadCurrentBot(s=null){return this.$store.dispatch("updateCurrentBot",{bot:s}).then(()=>{this.bot=this.getCurrentBot})},callbackSlugs(){this.loadSlugs()},selectSlug(s){this.$emit("select",s)}}},Mt=Object.assign(Rt,{__name:"BotSlugSimpleTableList",setup(s){return(t,o)=>t.bot?(l(),i("div",yt,[e("div",kt,[e("div",Ft,[c(e("input",{type:"search","onUpdate:modelValue":o[0]||(o[0]=a=>t.ownSearch=a),class:"form-control",id:"floatingInput",placeholder:"name@example.com"},null,512),[[_,t.ownSearch]]),Ct])]),e("div",wt,[e("div",St,[c(e("input",{class:"form-check-input","onUpdate:modelValue":o[1]||(o[1]=a=>t.need_global=a),type:"checkbox",id:"need_global"},null,512),[[k,t.need_global]]),e("label",jt,[t.need_global?(l(),i("span",qt,"Глобальные")):(l(),i("span",zt,"Локальные"))])]),e("div",Pt,[c(e("input",{class:"form-check-input","onUpdate:modelValue":o[2]||(o[2]=a=>t.need_show_deleted=a),type:"checkbox",id:"need_show_deleted"},null,512),[[k,t.need_show_deleted]]),Vt])]),t.slugs?(l(),i("div",Ot,[e("table",Ut,[At,e("tbody",null,[(l(!0),i(v,null,y(t.slugs,(a,n)=>(l(),i("tr",{class:p({"border-info":a.deleted_at==null,"border-danger":a.deleted_at!=null})},[e("th",{scope:"row",class:p({"text-danger":a.deleted_at!=null})},u(a.id||"Нет идентификатора"),3),e("td",{onClick:d=>t.selectSlug(a),class:p({"text-danger":a.deleted_at!=null})},u(a.command||"Нет команды"),11,It),e("td",{class:p({"text-danger":a.deleted_at!=null})},u(a.comment||"Пояснение не указано"),3)],2))),256))])])])):r("",!0),t.paginate?(l(),$(j,{key:1,onPagination_page:t.nextSlugs,pagination:t.paginate},null,8,["onPagination_page","pagination"])):r("",!0),t.slugs.length===0?(l(),i("div",Qt,Bt)):r("",!0)])):r("",!0)}}),Dt={class:"form-floating mb-3"},Et=e("label",{for:"floatingInput"},"Команда",-1),Lt={class:"form-floating mb-3"},Kt=e("label",{for:"floatingInput"},"Мнемоническое имя",-1),Nt={class:"form-floating mb-3"},Jt=e("label",{for:"floatingInput"},"Описание скрипта",-1),Yt=e("h6",null," Параметры скрипта ",-1),Ht=e("div",{class:"alert alert-info",role:"alert"}," Данные параметры используются для настройки скриптов на стороне сервера ",-1),Gt={class:"dropdown"},Wt=e("button",{class:"btn btn-outline-info w-100 dropdown-toggle mb-2",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"}," Добавить ",-1),Xt={class:"dropdown-menu w-100"},Zt=["onClick"],xt={class:"row"},es={class:"col-12"},ts=["onClick"],ss=e("p",null,"Вы можете подгрузить отсутствующие параметры конфигурации",-1),os=e("i",{class:"fa-solid fa-rotate mr-2"},null,-1),ls={key:0,class:"row"},is={class:"col-12"},ns={class:"table"},as=e("thead",null,[e("tr",null,[e("th",{scope:"col"},"Ключ"),e("th",{scope:"col"},"Значение")])],-1),ds={colspan:"2"},rs={class:"w-100 d-flex align-items-center justify-content-between"},cs={class:"dropdown mr-2"},us=e("button",{class:"btn btn-outline-primary",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-solid fa-bars"})],-1),ms={class:"dropdown-menu"},hs=["onClick"],_s=e("i",{class:"fa-solid fa-trash-can"},null,-1),ps=["onClick"],bs=e("i",{class:"fa-solid fa-caret-left"},null,-1),fs=["onClick"],gs=e("i",{class:"fa-solid fa-caret-right"},null,-1),vs=["innerHTML"],$s={key:1,class:"mb-0 font-bold"},ys={class:"dropdown"},ks={class:"btn btn-outline-primary dropdown-toggle w-100 d-flex justify-content-between align-items-center",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},Fs={class:"dropdown-menu"},Cs=["onClick"],ws={style:{width:"300px"}},Ss={class:"form-floating"},js=["onUpdate:modelValue","id"],qs=["for"],zs={key:0,class:"form-floating"},Ps=["id","onUpdate:modelValue"],Vs=["for"],Os={key:1,class:"form-check"},Us=["onUpdate:modelValue","id"],As=["for"],Is={key:2,class:"form-floating"},Qs=["onUpdate:modelValue","id"],Ts=["for"],Bs=["onClick"],Rs={key:0,class:"fa-solid fa-eye mr-2"},Ms={key:1,class:"fa-solid fa-eye-slash mr-2"},Ds={key:2},Es={key:3},Ls=["onClick"],Ks={key:0,class:"fa-solid fa-eye mr-2"},Ns={key:1,class:"fa-solid fa-eye-slash mr-2"},Js={key:2},Ys={key:3},Hs={key:5,class:"form-floating"},Gs=["onUpdate:modelValue","id"],Ws=["for"],Xs=["onClick"],Zs={key:0,class:"fa-solid fa-eye mr-2"},xs={key:1,class:"fa-solid fa-eye-slash mr-2"},eo={key:2},to={key:3},so={key:7,class:"form-check"},oo=["onUpdate:modelValue","id"],lo=["for"],io={key:8,class:"form-floating"},no=["id","onUpdate:modelValue"],ao=["for"],ro=["onClick"],co={key:0,class:"fa-solid fa-eye mr-2"},uo={key:1,class:"fa-solid fa-eye-slash mr-2"},mo={key:2},ho={key:3},_o={colspan:"2"},po={key:0,class:"form-floating mb-3"},bo=["id","onUpdate:modelValue"],fo=["for"],go={key:1,class:"form-floating"},vo=e("label",{class:"form-label",id:"bot-domain"},"JSON-код",-1),$o={key:2,class:"form-floating"},yo=["onUpdate:modelValue","id"],ko=["for"],Fo={key:3,class:"form-floating"},Co=["onUpdate:modelValue","id"],wo=["for"],So={key:1,class:"row"},jo=e("div",{class:"col-12"},[e("p",null,"Параметры скрипта еще не добавлены")],-1),qo=[jo],zo={class:"btn btn-primary text-white w-100 mt-2 p-3"},Po={key:0},Vo={key:1},Oo={props:["item"],components:{Vue3JsonEditor:se},data(){return{filters:[],simple:!0,configTypes:[{title:"Текстовый или числовой параметр",type:"text"},{title:"Большое текстовое поле",type:"large-text"},{title:"Канал обратной связи",type:"channel"},{title:"Логический оператор",type:"boolean"},{title:"Ссылка на изображение",type:"image"},{title:"Цвет",type:"color"},{title:"Geo",type:"geo"},{title:"Номер телефона",type:"phone"},{title:"ID скрипта",type:"script"},{title:"ID страницы",type:"page"},{title:"JSON",type:"json"}],bot:null,photos:[],slugForm:{bot_id:null,id:null,command:null,comment:null,slug:null,parent_id:null,config:[],is_global:!0}}},computed:{...w(["getCurrentBot"]),filteredConfigs(){return this.filters.length==0?this.slugForm.config:this.slugForm.config.filter(s=>this.filters.indexOf(s.type)>=0)}},mounted(){this.loadCurrentBot(),this.item&&(this.slugForm.id=this.item.id||null,this.slugForm.command=this.item.command,this.slugForm.comment=this.item.comment,this.slugForm.bot_id=this.item.bot_id,this.slugForm.slug=this.item.slug,this.slugForm.parent_id=this.item.parent_id||null,this.slugForm.config=this.item.config||[],this.slugForm.is_global=this.item.is_global||!1)},methods:{loadSlugParentParams(){this.$store.dispatch("loadSlugParams",{parentSlugId:this.slugForm.parent_id?this.slugForm.parent_id:this.slugForm.id}).then(s=>{let t=s.config,o=0;t.forEach(a=>{this.slugForm.config.findIndex(d=>d.key===a.key)===-1&&(o++,this.slugForm.config.unshift(a))}),this.$notify({title:"Конструктор команд",text:`Параметры успешно подгружены: Обновлено ${o} параметров`,type:"success"})})},toggleFilter(s){let t=this.filters.indexOf(s);t>=0?this.filters.splice(t,1):this.filters.push(s)},addTextTo(s,t={text:null}){this.slugForm.config[s].value=t.text},loadCurrentBot(s=null){return this.$store.dispatch("updateCurrentBot",{bot:s}).then(()=>{this.bot=this.getCurrentBot})},submit(){let s=new FormData;Object.keys(this.slugForm).forEach(t=>{const o=this.slugForm[t]||"";typeof o=="object"?s.append(t,JSON.stringify(o)):s.append(t,o)}),this.$store.dispatch(this.slugForm.id===null?"createSlug":"updateSlug",{slugForm:s}).then(t=>{this.$notify({title:"Конструктор команд",text:"Команда успешно обновлена",type:"success"}),this.slugForm.id===null&&(this.slugForm.id=null,this.slugForm.command=null,this.slugForm.comment=null,this.slugForm.bot_id=null,this.slugForm.slug=null,this.slugForm.config=[],this.slugForm.is_global=!0),this.$emit("callback")}).catch(t=>{})},onJsonChange(s,t){this.filteredConfigs[t].value=s},addConfig(s){this.slugForm.config.splice(0,0,{key:null,value:null,type:s||"text"})},move(s,t=0){let o=this.slugForm.config[s],a=this.slugForm.config.length||0,n=t===0?s-1>=0?s-1:a-1:s<a-1?s+1:0;this.slugForm.config[s]=this.slugForm.config[n],this.slugForm.config[n]=o},removeConfigItem(s){try{this.slugForm.config.splice(s,1)}catch{this.slugForm.config=[]}},selectSlug(s,t){this.filteredConfigs[t].value=s.id},selectPhoto(s,t){this.filteredConfigs[t].value=s.file_id}}},ne=Object.assign(Oo,{__name:"SlugTableForm",setup(s){return(t,o)=>{const a=A("mask");return l(),i("form",{onSubmit:o[4]||(o[4]=S((...n)=>t.submit&&t.submit(...n),["prevent"]))},[e("div",Dt,[c(e("input",{type:"text","onUpdate:modelValue":o[0]||(o[0]=n=>t.slugForm.command=n),class:"form-control",id:"floatingInput",placeholder:"name@example.com",required:""},null,512),[[_,t.slugForm.command]]),Et]),e("div",Lt,[c(e("input",{type:"text","onUpdate:modelValue":o[1]||(o[1]=n=>t.slugForm.slug=n),class:"form-control",id:"floatingInput",placeholder:"name@example.com",required:""},null,512),[[_,t.slugForm.slug]]),Kt]),e("div",Nt,[c(e("input",{type:"text","onUpdate:modelValue":o[2]||(o[2]=n=>t.slugForm.comment=n),class:"form-control",id:"floatingInput",placeholder:"name@example.com",required:""},null,512),[[_,t.slugForm.comment]]),Jt]),Yt,Ht,e("div",Gt,[Wt,e("ul",Xt,[(l(!0),i(v,null,y(t.configTypes,(n,d)=>(l(),i("li",null,[e("a",{class:"dropdown-item",onClick:h=>t.addConfig(n.type)},u(n.title||"Не установлен"),9,Zt)]))),256))])]),e("div",xt,[e("div",es,[e("p",null,[m("Фильтры: "),(l(!0),i(v,null,y(t.configTypes,(n,d)=>(l(),i("span",{class:p(["badge mb-1 bg-gray-100 cursor-pointer mr-1",{"bg-info":t.filters.indexOf(n.type)>=0}]),onClick:h=>t.toggleFilter(n.type)},u(n.type),11,ts))),256))]),ss,e("button",{type:"button",onClick:o[3]||(o[3]=(...n)=>t.loadSlugParentParams&&t.loadSlugParentParams(...n)),class:"btn btn-outline-info"},[os,m("Загрузить ")])])]),t.filteredConfigs.length>0?(l(),i("div",ls,[e("div",is,[e("table",ns,[as,e("tbody",null,[(l(!0),i(v,null,y(t.filteredConfigs,(n,d)=>(l(),i(v,null,[e("tr",{class:p({"table-light":d%2===0})},[e("td",ds,[e("div",rs,[e("div",cs,[us,e("ul",ms,[e("li",null,[e("a",{class:"dropdown-item",onClick:h=>t.removeConfigItem(d),href:"javascript:void(0)"},[_s,m(" Удалить")],8,hs)]),e("li",null,[e("a",{class:"dropdown-item",onClick:h=>t.move(d,0),href:"javascript:void(0)"},[bs,m(" Вверх")],8,ps)]),e("li",null,[e("a",{class:"dropdown-item",onClick:h=>t.move(d,1),href:"javascript:void(0)"},[gs,m(" Вниз")],8,fs)])])]),t.filteredConfigs[d].description?(l(),i("p",{key:0,class:"mb-0 font-italic font-bold",innerHTML:t.filteredConfigs[d].description},null,8,vs)):(l(),i("p",$s,"без описания")),e("div",ys,[e("button",ks,u(t.filteredConfigs[d].type),1),e("ul",Fs,[(l(!0),i(v,null,y(t.configTypes,h=>(l(),i("li",null,[e("a",{class:"dropdown-item",onClick:b=>t.filteredConfigs[d].type=h.type},u(h.title||n.type),9,Cs)]))),256))])])])])],2),e("tr",{class:p({"table-light":d%2===0})},[e("td",ws,[e("div",Ss,[c(e("input",{type:"text",class:"form-control","onUpdate:modelValue":h=>t.filteredConfigs[d].key=h,id:"field-input-key-"+d,placeholder:"name@example.com"},null,8,js),[[_,t.filteredConfigs[d].key]]),e("label",{for:"field-input-key-"+d},"Ключ",8,qs)])]),e("td",null,[t.filteredConfigs[d].type==="text"||t.filteredConfigs[d].type==="channel"?(l(),i("div",zs,[c(e("input",{type:"text",class:"form-control",id:"field-input-"+d,"onUpdate:modelValue":h=>t.filteredConfigs[d].value=h,placeholder:"name@example.com"},null,8,Ps),[[_,t.filteredConfigs[d].value]]),e("label",{for:"field-input-"+d},"Значение",8,Vs)])):r("",!0),t.filteredConfigs[d].type==="boolean"?(l(),i("div",Os,[c(e("input",{class:"form-check-input","onUpdate:modelValue":h=>t.filteredConfigs[d].value=h,type:"checkbox",value:"false",id:"filtered-config-"+d+"-checkbox"},null,8,Us),[[k,t.filteredConfigs[d].value]]),e("label",{class:"form-check-label",for:"filtered-config-"+d+"-checkbox"},u(t.filteredConfigs[d].value?"Включено":"Выключено"),9,As)])):r("",!0),t.filteredConfigs[d].type==="geo"?(l(),i("div",Is,[c(e("input",{class:"form-control",placeholder:"##.######,##.######","onUpdate:modelValue":h=>t.filteredConfigs[d].value=h,type:"text",id:"filtered-config-"+d+"-geo"},null,8,Qs),[[a,"##.######,##.######"],[_,t.filteredConfigs[d].value]]),e("label",{for:"filtered-config-"+d+"-geo"},"Значение",8,Ts)])):r("",!0),t.filteredConfigs[d].type==="script"?(l(),i("button",{key:3,type:"button",class:"btn btn-outline-light text-primary w-100 py-3",onClick:h=>n.content_show=!n.content_show},[n.content_show?(l(),i("i",Ms)):(l(),i("i",Rs)),n.content_show?(l(),i("span",Es,"Скрыть выбор скриптов")):(l(),i("span",Ds,"Показать выбор скриптов"))],8,Bs)):r("",!0),t.filteredConfigs[d].type==="page"?(l(),i("button",{key:4,type:"button",class:"btn btn-outline-light text-primary w-100 py-3",onClick:h=>n.content_show=!n.content_show},[n.content_show?(l(),i("i",Ns)):(l(),i("i",Ks)),n.content_show?(l(),i("span",Ys,"Скрыть выбор страницы")):(l(),i("span",Js,"Показать выбор страницы"))],8,Ls)):r("",!0),t.filteredConfigs[d].type==="phone"?(l(),i("div",Hs,[c(e("input",{class:"form-control",placeholder:"+7(###)###-##-##","onUpdate:modelValue":h=>t.filteredConfigs[d].value=h,type:"text",id:"filtered-config-"+d+"-phone"},null,8,Gs),[[a,"+7(###)###-##-##"],[_,t.filteredConfigs[d].value]]),e("label",{for:"filtered-config-"+d+"-phone"},"Значение",8,Ws)])):r("",!0),t.filteredConfigs[d].type==="json"?(l(),i("button",{key:6,type:"button",class:"btn btn-outline-light text-primary w-100 py-3",onClick:h=>n.content_show=!n.content_show},[n.content_show?(l(),i("i",xs)):(l(),i("i",Zs)),n.content_show?(l(),i("span",to,"Скрыть редактор JSON")):(l(),i("span",eo,"Показать редактор JSON"))],8,Xs)):r("",!0),t.filteredConfigs[d].type==="color"?(l(),i("div",so,[c(e("input",{class:"form-control","onUpdate:modelValue":h=>t.filteredConfigs[d].value=h,type:"color",id:"filtered-config-"+d+"-color"},null,8,oo),[[_,t.filteredConfigs[d].value]]),e("label",{for:"filtered-config-"+d+"-color"},[e("p",{style:te({color:t.filteredConfigs[d].value})},"Цвет: "+u(t.filteredConfigs[d].value),5)],8,lo)])):r("",!0),t.filteredConfigs[d].type==="large-text"?(l(),i("div",io,[c(e("textarea",{class:"form-control",id:"field-input-"+d,"onUpdate:modelValue":h=>t.filteredConfigs[d].value=h,placeholder:"name@example.com"},`
                            `,8,no),[[_,t.filteredConfigs[d].value]]),e("label",{for:"field-input-"+d},"Значение",8,ao)])):r("",!0),t.filteredConfigs[d].type==="image"?(l(),i("button",{key:9,type:"button",class:"btn btn-outline-light text-primary w-100 py-3",onClick:h=>n.content_show=!n.content_show},[n.content_show?(l(),i("i",uo)):(l(),i("i",co)),n.content_show?(l(),i("span",ho,"Скрыть выбор изображений")):(l(),i("span",mo,"Показать выбор изображений"))],8,ro)):r("",!0)])],2),n.content_show?(l(),i("tr",{key:0,class:p({"table-light":d%2===0})},[e("td",_o,[t.filteredConfigs[d].type==="image"?(l(),i("div",po,[c(e("input",{class:"form-control mb-2",id:"field-input-"+d,type:"text",disabled:"true","onUpdate:modelValue":h=>t.filteredConfigs[d].value=h,placeholder:"name@example.com"},null,8,bo),[[_,t.filteredConfigs[d].value]]),e("label",{for:"field-input-"+d},"FileId ссылка на изображение",8,fo),g(P,{"need-video":!1,"need-photo":!0,selected:[t.filteredConfigs[d].value],onSelect:h=>t.selectPhoto(h,d)},null,8,["selected","onSelect"])])):r("",!0),t.filteredConfigs[d].type==="json"?(l(),i("div",go,[vo,g(M(se),{mode:"form",modelValue:t.filteredConfigs[d].value,"onUpdate:modelValue":h=>t.filteredConfigs[d].value=h,"show-btns":!1,expandedOnStart:!0,onJsonChange:h=>t.onJsonChange(h,d)},null,8,["modelValue","onUpdate:modelValue","onJsonChange"])])):r("",!0),t.filteredConfigs[d].type==="page"?(l(),i("div",$o,[c(e("input",{class:"form-control mb-2","onUpdate:modelValue":h=>t.filteredConfigs[d].value=h,type:"text",id:"filtered-config-"+d+"-script"},null,8,yo),[[_,t.filteredConfigs[d].value]]),e("label",{for:"filtered-config-"+d+"-script"},"Значение",8,ko),g(B,{selected:[t.filteredConfigs[d].value],onCallback:h=>t.selectSlug(h,d),editor:!1},null,8,["selected","onCallback"])])):r("",!0),t.filteredConfigs[d].type==="script"?(l(),i("div",Fo,[c(e("input",{class:"form-control mb-2","onUpdate:modelValue":h=>t.filteredConfigs[d].value=h,type:"text",id:"filtered-config-"+d+"-script"},null,8,Co),[[_,t.filteredConfigs[d].value]]),e("label",{for:"filtered-config-"+d+"-script"},"Значение",8,wo),g(Mt,{onSelect:h=>t.selectSlug(h,d)},null,8,["onSelect"])])):r("",!0)])],2)):r("",!0)],64))),256))])])])])):(l(),i("div",So,qo)),e("button",zo,[t.slugForm.id==null?(l(),i("span",Po," Сохранить команду ")):(l(),i("span",Vo," Обновить команду "))])],32)}}});const Uo={class:"card-header d-flex justify-content-between align-items-center"},Ao={class:"d-flex"},Io=e("i",{class:"fa-solid fa-arrow-left"},null,-1),Qo=[Io],To={class:"dropdown"},Bo=e("i",{class:"fa-solid fa-ellipsis"},null,-1),Ro=[Bo],Mo={class:"dropdown-menu"},Do=["data-bs-target"],Eo=e("i",{class:"fa-regular fa-pen-to-square mr-1"},null,-1),Lo=e("i",{class:"fa-solid fa-clone mr-1"},null,-1),Ko=e("i",{class:"fa-regular fa-trash-can text-danger mr-1"},null,-1),No={key:0,class:"fa-solid fa-arrow-up-short-wide"},Jo={key:1,class:"fa-solid fa-arrow-down-short-wide"},Yo={class:"card-body"},Ho={class:"row"},Go={class:"col-12"},Wo={key:0},Xo={key:1,class:"list-group list-group-numbered"},Zo={class:"list-group-item d-flex justify-content-between align-items-start"},xo={class:"ms-2 me-auto"},el=e("div",{class:"fw-bold"},"Идентификатор",-1),tl={class:"list-group-item d-flex justify-content-between align-items-start"},sl={class:"ms-2 me-auto"},ol=e("div",{class:"fw-bold"},"Команда",-1),ll={class:"list-group-item d-flex justify-content-between align-items-start"},il={class:"ms-2 me-auto"},nl=e("div",{class:"fw-bold"},"Мнемоническое имя",-1),al={class:"list-group-item d-flex justify-content-between align-items-start"},dl={class:"ms-2 me-auto"},rl=e("div",{class:"fw-bold"},"Пояснение",-1),cl={key:0,class:"list-group-item d-flex justify-content-between align-items-start"},ul={class:"ms-2 me-auto"},ml=e("div",{class:"fw-bold"},"Набор параметров скрипта",-1),hl={key:1,class:"list-group-item d-flex justify-content-between align-items-start"},_l=e("div",{class:"ms-2 me-auto"},[e("div",{class:"fw-bold"},"Привязана страница")],-1),pl=[_l],bl={key:2,class:"list-group-item d-flex justify-content-between align-items-start"},fl=e("div",{class:"ms-2 me-auto"},[e("div",{class:"fw-bold"},"Глобальный скрипт")],-1),gl=[fl],vl={class:"list-group-item d-flex justify-content-between align-items-start"},$l={class:"ms-2 me-auto w-100"},yl=e("div",{class:"fw-bold"},"Перенести данные из:",-1),kl=e("option",{value:null},"Не выбрано",-1),Fl=["value"],Cl=e("p",{class:"my-2"},[e("em",null,"Перенос данных затирает текущие данные в данном скрипте")],-1),wl=["disabled"],Sl=["id"],jl={class:"modal-dialog modal-fullscreen"},ql={class:"modal-content"},zl={class:"modal-header"},Pl={class:"modal-title",id:"exampleModalLabel"},Vl=e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),Ol={class:"modal-body"},Ul=e("div",{class:"modal-footer"},[e("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Закрыть")],-1),Al={props:["item","bot","selectMode","isActive"],data(){return{selected_slug_id:null,slugs:[],load:!1,simple:!0}},watch:{simple:function(){this.simple||this.loadAllSlugs()}},mounted(){},methods:{selectCard(){this.$emit("select",this.item)},slugFormCallback(){this.load=!0,this.$emit("callback"),this.$nextTick(()=>{this.load=!1})},editSlug(){this.load=!0,this.$nextTick(()=>{this.load=!1})},selectSlug(){this.load=!0,this.$emit("select",this.item),this.$nextTick(()=>{this.load=!1})},duplicateSlug(){this.load=!0,this.$store.dispatch("duplicateSlug",{dataObject:{slugId:this.item.id}}).then(s=>{this.$notify({title:"Конструктор команд",text:"Команда успешно продублирована",type:"success"}),this.$emit("callback"),this.$nextTick(()=>{this.load=!1})}).catch(s=>{this.$emit("callback"),this.$nextTick(()=>{this.load=!1})}),this.$emit("callback"),this.$nextTick(()=>{this.load=!1})},submitRelocateData(){this.$store.dispatch("relocateSlugActionData",{slug_sender_id:this.selected_slug_id,slug_recipient_id:this.item.id,bot_id:this.bot.id}).then(s=>{this.$notify({title:"Конструктор команд",text:"Данные команды успешно перенесены",type:"success"})}).catch(s=>{this.$notify({title:"Конструктор команд",text:"Ошибка переноса данных",type:"error"})})},loadAllSlugs(){this.$store.dispatch("loadAllSlugs",{botId:this.bot.id}).then(s=>{this.slugs=s.data})},removeSlug(){this.load=!0,this.$store.dispatch("removeSlug",{dataObject:{slugId:this.item.id}}).then(s=>{this.$notify({title:"Конструктор команд",text:"Команда успешно удалена",type:"success"}),this.$emit("callback"),this.$nextTick(()=>{this.load=!1})}).catch(s=>{this.$emit("callback"),this.$nextTick(()=>{this.load=!1})})}}},Il=Object.assign(Al,{__name:"Slug",setup(s){return(t,o)=>(l(),i(v,null,[e("div",{class:p(["card",{"deprecated-slug":s.item.deprecated_at!=null,"global-slug":s.item.is_global,"bg-success text-white":s.isActive}])},[e("div",Uo,[e("div",Ao,[e("button",{onClick:o[0]||(o[0]=(...a)=>t.selectSlug&&t.selectSlug(...a)),type:"button",title:"Выбрать команду",class:p(["btn btn-outline-primary mr-2",{"text-white":s.isActive}])},Qo,2),e("div",To,[e("button",{class:p([{"text-white border-white":s.isActive},"btn btn-outline-secondary"]),type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},Ro,2),e("ul",Mo,[e("li",null,[e("a",{class:"dropdown-item cursor-pointer",onClick:o[1]||(o[1]=(...a)=>t.editSlug&&t.editSlug(...a)),"data-bs-toggle":"modal","data-bs-target":"#edit-slug-"+s.item.id},[Eo,m(" Редактировать")],8,Do)]),e("li",null,[e("a",{class:"dropdown-item cursor-pointer",onClick:o[2]||(o[2]=(...a)=>t.duplicateSlug&&t.duplicateSlug(...a))},[Lo,m(" Дублировать")])]),e("li",null,[e("a",{class:"dropdown-item cursor-pointer",onClick:o[3]||(o[3]=(...a)=>t.removeSlug&&t.removeSlug(...a))},[Ko,m(" Удалить")])])])])]),e("span",null,[e("small",null,[e("strong",null,"#"+u(s.item.id),1)])]),e("button",{type:"button",onClick:o[4]||(o[4]=a=>t.simple=!t.simple),class:p([{"text-white border-white":s.isActive},"btn btn-outline-primary ml-2"])},[t.simple?(l(),i("i",No)):(l(),i("i",Jo))],2)]),e("div",Yo,[e("div",Ho,[e("div",Go,[t.simple?(l(),i("p",Wo,u(s.item.command||"Нет команды"),1)):(l(),i("ol",Xo,[e("li",Zo,[e("div",xo,[el,m(" №"+u(s.item.id||"Нет идентификатора"),1)])]),e("li",tl,[e("div",sl,[ol,m(" "+u(s.item.command||"Нет команды"),1)])]),e("li",ll,[e("div",il,[nl,m(" "+u(s.item.slug||"Slug"),1)])]),e("li",al,[e("div",dl,[rl,m(" "+u(s.item.comment||"Пояснение не указано"),1)])]),s.item.config?(l(),i("li",cl,[e("div",ul,[ml,s.item.config?(l(!0),i(v,{key:0},y(s.item.config,a=>(l(),i("p",null,[e("strong",null,u(a.key||"Ключ не найден")+":",1),m(u(a.value||"Не указано"),1)]))),256)):r("",!0)])])):r("",!0),s.item.page?(l(),i("li",hl,pl)):r("",!0),s.item.is_global?(l(),i("li",bl,gl)):r("",!0),e("li",vl,[e("div",$l,[e("form",{onSubmit:o[6]||(o[6]=S((...a)=>t.submitRelocateData&&t.submitRelocateData(...a),["prevent"]))},[yl,c(e("select",{class:"form-control w-100","onUpdate:modelValue":o[5]||(o[5]=a=>t.selected_slug_id=a),required:""},[kl,(l(!0),i(v,null,y(t.slugs,a=>(l(),i("option",{value:a.id},"#"+u(a.id)+" "+u(a.slug||"Не указан"),9,Fl))),256))],512),[[Q,t.selected_slug_id]]),Cl,e("button",{disabled:t.selected_slug_id==null,class:"btn btn-outline-warning w-100"}," Выполнить перенос ",8,wl)],32)])])]))])])])],2),e("div",{class:"modal fade",id:"edit-slug-"+s.item.id,tabindex:"-1"},[e("div",jl,[e("div",ql,[e("div",zl,[e("h5",Pl,[m("Редактирование команды #"),e("span",null,u(s.item.id),1)]),Vl]),e("div",Ol,[t.load?r("",!0):(l(),$(ne,{key:0,item:s.item,onCallback:t.slugFormCallback},null,8,["item","onCallback"]))]),Ul])])],8,Sl)],64))}}),Ql={key:0,class:"row"},Tl={class:"col-12 mb-2"},Bl={key:0},Rl=e("i",{class:"fa-solid fa-scroll"},null,-1),Ml={key:1},Dl=e("i",{class:"fa-regular fa-square-minus"},null,-1),El={key:0,class:"col-12"},Ll={class:"col-12"},Kl={class:"form-floating mb-3"},Nl=e("label",{for:"floatingInput"},"Быстрый поиск команды",-1),Jl={class:"col-12 mb-2"},Yl={class:"form-check"},Hl={class:"form-check-label",for:"need_global"},Gl={key:0},Wl={key:1},Xl={class:"form-check"},Zl=e("label",{class:"form-check-label",for:"need_show_deleted"}," Удаленные ",-1),xl={key:1,class:"mb-3 col-12 col-sm-12"},ei={class:"table"},ti=e("thead",null,[e("tr",null,[e("th",{scope:"col"},"#"),e("th",{scope:"col"},"Команда"),e("th",{scope:"col"},"Пояснение"),e("th",{scope:"col"},"Глобальный"),e("th",{scope:"col"},"Действия")])],-1),si=["onClick"],oi={key:0},li=e("i",{class:"fa-solid fa-check text-success"},null,-1),ii=[li],ni={key:1},ai=e("i",{class:"fa-solid fa-xmark text-danger"},null,-1),di=[ai],ri={class:"dropdown"},ci=e("button",{class:"btn btn-outline-secondary",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-solid fa-ellipsis"})],-1),ui={class:"dropdown-menu"},mi={key:0},hi=["onClick"],_i=e("i",{class:"fa-solid fa-arrow-left mr-1"},null,-1),pi={key:1},bi=["onClick"],fi=e("a",{class:"dropdown-item cursor-pointer","data-bs-toggle":"modal","data-bs-target":"#edit-table-slug"},[e("i",{class:"fa-regular fa-pen-to-square mr-1"}),m(" Редактировать")],-1),gi=[fi],vi=["onClick"],$i=e("i",{class:"fa-solid fa-clone mr-1"},null,-1),yi=["href"],ki=e("i",{class:"fa-regular fa-file-excel mr-1"},null,-1),Fi={key:2},Ci=["onClick"],wi=e("i",{class:"fa-regular fa-trash-can text-danger mr-1"},null,-1),Si={key:3},ji=["onClick"],qi=e("i",{class:"fa-regular fa-trash-can text-danger mr-1"},null,-1),zi={key:3,class:"mb-3 col-md-12"},Pi=e("div",{class:"alert alert-danger",role:"alert"}," У Вас еще нет добавленных скриптов! ",-1),Vi=[Pi],Oi={class:"modal fade",id:"edit-table-slug",tabindex:"-1"},Ui={class:"modal-dialog modal-fullscreen"},Ai={key:0,class:"modal-content"},Ii={class:"modal-header"},Qi={class:"modal-title",id:"exampleModalLabel"},Ti=e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),Bi={class:"modal-body"},Ri={class:"row"},Mi={class:"col-12"},Di=e("div",{class:"modal-footer"},[e("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Закрыть")],-1),Ei={props:["command","canSelect"],data(){return{bot:null,relocated_slug_id:null,need_global:!0,need_show_deleted:!0,show:!1,load:!1,slugs:[],paginate:[],selectedSlug:null,ownSearch:null,slugForm:{command:null,comment:null,slug:null}}},watch:{ownSearch:function(s,t){this.loadSlugs()},need_global:function(s,t){this.loadSlugs()},need_show_deleted:function(s,t){this.loadSlugs()}},computed:{...w(["getCurrentBot","getSlugs","getSlugsPaginateObject"])},mounted(){this.loadCurrentBot().then(()=>{this.loadSlugs(),this.command&&this.$nextTick(()=>{this.slugForm.command=this.command})})},methods:{nextSlugs(s){this.loadSlugs(s)},loadSlugs(s=0){return this.$store.dispatch("loadSlugs",{dataObject:{botId:this.bot.id,needGlobal:this.need_global,needDeleted:this.need_show_deleted,search:this.ownSearch},page:s}).then(t=>{this.slugs=this.getSlugs,this.paginate=this.getSlugsPaginateObject})},loadCurrentBot(s=null){return this.$store.dispatch("updateCurrentBot",{bot:s}).then(()=>{this.bot=this.getCurrentBot})},callbackSlugs(){this.loadSlugs()},selectSlug(s){this.load=!0,this.$nextTick(()=>{this.selectedSlug=s,this.load=!1}),this.$emit("select",s)},selectCard(){this.$emit("select",this.item)},slugFormCallback(){this.load=!0;const s=this.selectedSlug;this.loadSlugs().then(()=>{let t=this.slugs.find(o=>o.id===s.id);this.selectSlug(t||null)}),this.$emit("callback"),this.$nextTick(()=>{this.load=!1})},editSlug(){this.load=!0,this.$nextTick(()=>{this.load=!1})},duplicateSlug(s){this.load=!0,this.$store.dispatch("duplicateSlug",{dataObject:{slugId:s.id}}).then(t=>{this.$notify({title:"Конструктор команд",text:"Команда успешно продублирована",type:"success"}),this.$emit("callback"),this.$nextTick(()=>{this.load=!1})}).catch(t=>{this.$emit("callback"),this.$nextTick(()=>{this.load=!1})}),this.loadSlugs(),this.$emit("callback"),this.$nextTick(()=>{this.load=!1})},submitRelocateData(){this.$store.dispatch("relocateSlugActionData",{slug_sender_id:this.relocated_slug_id,slug_recipient_id:this.item.id,bot_id:this.bot.id}).then(s=>{this.$notify({title:"Конструктор команд",text:"Данные команды успешно перенесены",type:"success"})}).catch(s=>{this.$notify({title:"Конструктор команд",text:"Ошибка переноса данных",type:"error"})})},restoreSlug(s){this.load=!0,this.$store.dispatch("restoreSlug",{dataObject:{slugId:s.id}}).then(t=>{this.$notify({title:"Конструктор команд",text:"Команда успешно восстановлена",type:"success"}),this.loadSlugs(),this.$nextTick(()=>{this.load=!1})}).catch(t=>{this.$emit("callback"),this.$nextTick(()=>{this.load=!1})})},removeSlug(s){this.load=!0,this.$store.dispatch("removeSlug",{dataObject:{slugId:s.id}}).then(t=>{this.$notify({title:"Конструктор команд",text:"Команда успешно удалена",type:"success"}),this.loadSlugs()}).catch(t=>{this.$emit("callback"),this.$nextTick(()=>{this.load=!1})})}}},Li=Object.assign(Ei,{__name:"BotSlugTableList",setup(s){return(t,o)=>(l(),i(v,null,[t.bot?(l(),i("div",Ql,[e("div",Tl,[e("button",{type:"button",onClick:o[0]||(o[0]=a=>t.show=!t.show),class:"btn btn-outline-success p-3 w-100"},[t.show?(l(),i("span",Ml,[Dl,m(" Свернуть форму добавления")])):(l(),i("span",Bl,[Rl,m(" Добавить глобальный скрипт")]))])]),t.show?(l(),i("div",El,[t.bot?(l(),$(Y,{key:0,"can-add":!0,bot:t.bot,onCallback:t.loadSlugs},null,8,["bot","onCallback"])):r("",!0)])):r("",!0),e("div",Ll,[e("div",Kl,[c(e("input",{type:"search","onUpdate:modelValue":o[1]||(o[1]=a=>t.ownSearch=a),class:"form-control",id:"floatingInput",placeholder:"name@example.com"},null,512),[[_,t.ownSearch]]),Nl])]),e("div",Jl,[e("div",Yl,[c(e("input",{class:"form-check-input","onUpdate:modelValue":o[2]||(o[2]=a=>t.need_global=a),type:"checkbox",id:"need_global"},null,512),[[k,t.need_global]]),e("label",Hl,[t.need_global?(l(),i("span",Gl,"Глобальные")):(l(),i("span",Wl,"Локальные"))])]),e("div",Xl,[c(e("input",{class:"form-check-input","onUpdate:modelValue":o[3]||(o[3]=a=>t.need_show_deleted=a),type:"checkbox",id:"need_show_deleted"},null,512),[[k,t.need_show_deleted]]),Zl])]),t.slugs&&t.bot?(l(),i("div",xl,[e("table",ei,[ti,e("tbody",null,[(l(!0),i(v,null,y(t.slugs,(a,n)=>(l(),i("tr",{class:p({"border-info":a.deleted_at==null,"border-danger":a.deleted_at!=null})},[e("th",{scope:"row",class:p({"text-danger":a.deleted_at!=null})},u(a.id||"Нет идентификатора"),3),e("td",{onClick:d=>t.selectSlug(a),"data-bs-toggle":"modal","data-bs-target":"#edit-table-slug",class:p({"text-danger":a.deleted_at!=null})},u(a.command||"Нет команды"),11,si),e("td",{class:p({"text-danger":a.deleted_at!=null})},u(a.comment||"Пояснение не указано"),3),e("td",null,[a.is_global?(l(),i("span",oi,ii)):(l(),i("span",ni,di))]),e("td",null,[e("div",ri,[ci,e("ul",ui,[s.canSelect?(l(),i("li",mi,[e("a",{onClick:d=>t.selectSlug(a),title:"Выбрать команду",class:"dropdown-item cursor-pointer"},[_i,m(" Выбрать команду ")],8,hi)])):r("",!0),s.canSelect?(l(),i("hr",pi)):r("",!0),e("li",{onClick:d=>t.selectSlug(a)},gi,8,bi),e("li",null,[e("a",{class:"dropdown-item cursor-pointer",onClick:d=>t.duplicateSlug(a)},[$i,m(" Дублировать")],8,vi)]),e("li",null,[e("a",{class:"dropdown-item cursor-pointer",target:"_blank",href:"/admin/slugs/action-data-export/"+a.id},[ki,m(" Скачать данные участников")],8,yi)]),a.deleted_at==null?(l(),i("li",Fi,[e("a",{class:"dropdown-item cursor-pointer",onClick:d=>t.removeSlug(a)},[wi,m(" Удалить")],8,Ci)])):r("",!0),a.deleted_at!=null?(l(),i("li",Si,[e("a",{class:"dropdown-item cursor-pointer",onClick:d=>t.restoreSlug(a)},[qi,m(" Восстановить")],8,ji)])):r("",!0)])])])],2))),256))])])])):r("",!0),t.paginate?(l(),$(j,{key:2,onPagination_page:t.nextSlugs,pagination:t.paginate},null,8,["onPagination_page","pagination"])):r("",!0),t.slugs.length===0?(l(),i("div",zi,Vi)):r("",!0)])):r("",!0),e("div",Oi,[e("div",Ui,[t.selectedSlug&&!t.load?(l(),i("div",Ai,[e("div",Ii,[e("h5",Qi,[m("Редактирование команды #"),e("span",null,u(t.selectedSlug.id),1)]),Ti]),e("div",Bi,[e("div",Ri,[e("div",Mi,[g(ne,{item:t.selectedSlug,onCallback:t.slugFormCallback},null,8,["item","onCallback"])])])]),Di])):r("",!0)])])],64))}}),Ki={class:"row"},Ni={class:"col-12"},Ji=e("h6",null,"Добавление нового скрипта в бота",-1),Yi={key:0,class:"row"},Hi={class:"col-md-6 col-lg-4 col-sm-6 col-12 mb-2"},Gi={key:1,class:"row"},Wi=e("div",{class:"col-12"},[e("div",{class:"alert alert-danger",role:"alert"},' У Вас еще нет добавленных скриптов! Воспользуйтесь разделом "Скрипты" для добавления. ')],-1),Xi=[Wi],Zi={props:["bot","global","selected"],data(){return{load:!1,search:null,slugs:[],paginate:[]}},computed:{...w(["getSlugs","getSlugsPaginateObject"]),filteredSlugs(){return this.slugs?this.slugs.length===0?[]:this.search==null?this.slugs:this.slugs.filter(s=>{let t=s.slug||"",o=s.command||"",a=s.comment||"";return o.toLowerCase().indexOf(this.search.toLowerCase())!==-1||a.toLowerCase().indexOf(this.search.toLowerCase())!==-1||t.toLowerCase().indexOf(this.search.toLowerCase())!==-1}):[]}},mounted(){this.loadSlugs()},methods:{nextSlugs(s){this.loadSlugs(s)},selectSlug(s){this.$emit("callback",{id:s.id||null,slug:s.slug,comment:s.comment,command:s.command}),this.$notify("Вы выбрали скрипт из списка!")},loadSlugs(s=0){this.$store.dispatch("loadSlugs",{dataObject:{botId:this.bot.id,search:this.search,needGlobal:this.global},page:s}).then(t=>{this.slugs=this.getSlugs,this.paginate=this.getSlugsPaginateObject})},callbackSlugs(){}}},xi=Object.assign(Zi,{__name:"BotSlugListSimple",setup(s){return(t,o)=>(l(),i("div",Ki,[e("div",Ni,[Ji,e("div",null,[c(e("input",{type:"text",class:"form-control mt-1 mb-1","onUpdate:modelValue":o[0]||(o[0]=a=>t.search=a),onKeyup:o[1]||(o[1]=(...a)=>t.loadSlugs&&t.loadSlugs(...a)),placeholder:"Поиск нужного скрипта по описанию"},null,544),[[_,t.search]])]),t.slugs.length>0?(l(),i("div",Yi,[(l(!0),i(v,null,y(t.slugs,(a,n)=>(l(),i("div",Hi,[g(Il,{"is-active":(s.selected||[]).indexOf(a.id)!=-1,item:a,bot:s.bot,onCallback:t.callbackSlugs,onSelect:t.selectSlug},null,8,["is-active","item","bot","onCallback","onSelect"])]))),256)),t.paginate?(l(),$(j,{key:0,onPagination_page:t.nextSlugs,pagination:t.paginate},null,8,["onPagination_page","pagination"])):r("",!0)])):(l(),i("div",Gi,Xi))])]))}});const en={props:["param"],data(){return{expressions:[{expression:null,description:"Нет проверки"},{expression:"/([a-z0-9]+)/i",description:"Проверка набора из латинских букв и цифр"},{expression:"/([а-яё0-9]+)/iu",description:"Проверка на кириллицу и цифры"},{expression:"/(?P<digit>\\d+)/",description:"Проверка на число"},{expression:"/^([a-z0-9_-]+.)*[a-z0-9_-]+@[a-z0-9_-]+(.[a-z0-9_-]+)*.[a-z]{2,6}$/",description:"Проверка Email"},{expression:"/^((8|+7)[- ]?)?((?d{3})?[- ]?)?[d- ]{7,10}$/",description:"Проверка номера телефона: +7(982)000-00-00"},{expression:"/^(0[1-9]|[12][0-9]|3[01])[.](0[1-9]|1[012])[.](19|20)dd$/",description:"Проверка даты по формату DD.MM.YYYY"},{expression:"/^[0-9]{4}-(0[1-9]|1[012])-(0[1-9]|1[0-9]|2[0-9]|3[01])$/",description:"Проверка даты по формату YYYY-MM-DD"},{expression:"/^(https?://)?([da-z.-]+).([a-z.]{2,6})([/w .-]*)*/?$/",description:"Проверка доменного имени"}]}},methods:{expressionsSelect(s){this.$emit("callback",{param:this.param,text:s.expression})}}},tn={class:"dropdown"},sn=e("button",{class:"btn btn-link dropdown-toggle",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-regular fa-registered"})],-1),on={class:"dropdown-menu item-with-text cursor-pointer text-muted p-2"},ln=["onClick"];function nn(s,t,o,a,n,d){return l(),i("div",tn,[sn,e("div",on,[e("li",null,[(l(!0),i(v,null,y(n.expressions,h=>(l(),i("a",{class:"dropdown-item",onClick:b=>d.expressionsSelect(h)},u(h.description||"-"),9,ln))),256))])])])}const an=I(en,[["render",nn]]),dn={class:"row mt-2"},rn={class:"col-12 d-flex justify-content-between align-items-center"},cn=["onClick"],un={class:"row mb-2"},mn={class:"col-3"},hn={class:"form-floating"},_n=["onUpdate:modelValue"],pn=e("label",{for:"floatingInput"},"Значение параметра 1",-1),bn={class:"col-3"},fn={class:"form-floating"},gn=["onUpdate:modelValue"],vn=e("option",{value:null,selected:""},"без действия",-1),$n=["value"],yn=e("label",{for:"floatingSelect"},"Доступные операции",-1),kn={class:"col-3"},Fn={class:"form-floating"},Cn=["onUpdate:modelValue"],wn=e("label",{for:"floatingInput"},"Значение параметра 2",-1),Sn={class:"col-3"},jn={class:"form-floating"},qn=["disabled","onUpdate:modelValue"],zn=e("label",{for:"floatingInput"},"Переменная результата",-1),Pn=e("div",{class:"row"},[e("div",{class:"col-6"},[e("h6",null,"Если условие выполнено")]),e("div",{class:"col-6"},[e("h6",null,[m("Если условие "),e("span",{class:"text-danger"},"не"),m(" выполнено")])])],-1),Vn={class:"row"},On={class:"col-6"},Un={class:"form-floating mb-3"},An=["onUpdate:modelValue"],In=e("label",{for:"floatingInput"},"Текст для пользователя",-1),Qn={class:"col-6"},Tn={class:"form-floating mb-3"},Bn=["onUpdate:modelValue"],Rn=e("label",{for:"floatingInput"},"Текст для пользователя",-1),Mn={class:"row"},Dn={class:"col-6"},En={class:"form-check mb-2"},Ln=["onUpdate:modelValue","id"],Kn=["for"],Nn={class:"col-6"},Jn={class:"form-check mb-2"},Yn=["onUpdate:modelValue","id"],Hn=["for"],Gn={key:1,class:"alert alert-primary d-flex align-items-center mt-2",role:"alert"},Wn=e("i",{class:"fa-solid fa-triangle-exclamation mr-2"},null,-1),Xn=e("div",null," Правила не добавлены ",-1),Zn=[Wn,Xn],xn={props:["modelValue"],data(){return{rules:[],operations:[{id:1,title:"Больше"},{id:2,title:"Меньше"},{id:3,title:"Равно"},{id:4,title:"Не равно"},{id:5,title:"Сложить"},{id:6,title:"Вычесть"},{id:7,title:"Логическое И"},{id:8,title:"Логическое ИЛИ"}]}},methods:{addRule(){this.rules.push({param1:null,operation:null,param2:null,use_result_as:null,text_if_true:null,text_if_false:null,keyboard_if_true:null,keyboard_if_false:null,need_keyboard_if_true:!1,need_keyboard_if_false:!1}),this.$notify({title:"Конструктор ботов",text:"Успешная создано новое правило",type:"success"}),this.$emit("update:modelValue",this.rules)},testRule(s){let t=this.rules[s];return t.operation===5||t.operation===6},removeRule(s){this.rules.splice(s,1),this.$notify({title:"Конструктор ботов",text:"Успешная удалено выбранное правило",type:"success"})},saveInlineKeyboard(s,t,o){this.rules[t]["keyboard_if_"+(o?"true":"false")]=s}}},ea=Object.assign(xn,{__name:"BotDialogResultRules",setup(s){return(t,o)=>(l(),i(v,null,[e("button",{type:"button",onClick:o[0]||(o[0]=(...a)=>t.addRule&&t.addRule(...a)),class:"btn btn-outline-info"},"Добавить правило "),t.rules.length>0?(l(!0),i(v,{key:0},y(t.rules,(a,n)=>(l(),i(v,null,[e("div",dn,[e("div",rn,[e("h6",null,"Шаг "+u(n+1),1),e("button",{onClick:d=>t.removeRule(n),type:"button",class:"btn btn-link"},"удалить правило ",8,cn)])]),e("div",un,[e("div",mn,[e("div",hn,[c(e("input",{type:"text",class:"form-control","onUpdate:modelValue":d=>t.rules[n].param1=d,id:"floatingInput",placeholder:"name@example.com"},null,8,_n),[[_,t.rules[n].param1]]),pn])]),e("div",bn,[e("div",fn,[c(e("select",{class:"form-select","onUpdate:modelValue":d=>t.rules[n].operation=d,id:"floatingSelect","aria-label":"Floating label select example"},[vn,(l(!0),i(v,null,y(t.operations,d=>(l(),i("option",{value:d.id},u(d.title||"-"),9,$n))),256))],8,gn),[[Q,t.rules[n].operation]]),yn])]),e("div",kn,[e("div",Fn,[c(e("input",{type:"text","onUpdate:modelValue":d=>t.rules[n].param2=d,class:"form-control",id:"floatingInput",placeholder:"name@example.com"},null,8,Cn),[[_,t.rules[n].param2]]),wn])]),e("div",Sn,[e("div",jn,[c(e("input",{type:"text",disabled:!t.testRule(n),"onUpdate:modelValue":d=>t.rules[n].use_result_as=d,class:"form-control",id:"floatingInput",placeholder:"name@example.com"},null,8,qn),[[_,t.rules[n].use_result_as]]),zn])])]),Pn,e("div",Vn,[e("div",On,[e("div",Un,[c(e("input",{type:"text","onUpdate:modelValue":d=>t.rules[n].text_if_true=d,class:"form-control",id:"floatingInput",placeholder:"name@example.com"},null,8,An),[[_,t.rules[n].text_if_true]]),In])]),e("div",Qn,[e("div",Tn,[c(e("input",{type:"text","onUpdate:modelValue":d=>t.rules[n].text_if_false=d,class:"form-control",id:"floatingInput",placeholder:"name@example.com"},null,8,Bn),[[_,t.rules[n].text_if_false]]),Rn])])]),e("div",Mn,[e("div",Dn,[e("div",En,[c(e("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":d=>t.rules[n].need_keyboard_if_true=d,id:"need-keyboard-if-true-"+n},null,8,Ln),[[k,t.rules[n].need_keyboard_if_true]]),e("label",{class:"form-check-label",for:"need-keyboard-if-true-"+n}," Нужна клавиатура ",8,Kn)]),t.rules[n].need_keyboard_if_true?(l(),$(U,{key:0,type:"inline",onSave:d=>t.saveInlineKeyboard(d,n,!0),"edited-keyboard":t.rules[n].keyboard_if_true},null,8,["onSave","edited-keyboard"])):r("",!0)]),e("div",Nn,[e("div",Jn,[c(e("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":d=>t.rules[n].need_keyboard_if_false=d,id:"need-keyboard-if-false-"+n},null,8,Yn),[[k,t.rules[n].need_keyboard_if_false]]),e("label",{class:"form-check-label",for:"need-keyboard-if-false-"+n}," Нужна клавиатура ",8,Hn)]),t.rules[n].need_keyboard_if_false?(l(),$(U,{key:0,type:"inline",onSave:d=>t.saveInlineKeyboard(d,n,!1),"edited-keyboard":t.rules[n].keyboard_if_false},null,8,["onSave","edited-keyboard"])):r("",!0)])])],64))),256)):(l(),i("div",Gn,Zn))],64))}}),ta={class:"mb-2 px-0"},sa={type:"submit",class:"btn btn-outline-success"},oa=e("i",{class:"fa-regular fa-floppy-disk mr-2"},null,-1),la={key:0},ia={key:1},na={class:"nav nav-tabs"},aa={class:"nav-item"},da=e("i",{class:"fa-regular fa-comment-dots mr-2"},null,-1),ra={class:"nav-item"},ca=e("i",{class:"fa-solid fa-link mr-2"},null,-1),ua={class:"nav-item"},ma=e("i",{class:"fa-brands fa-uncharted mr-2"},null,-1),ha={key:0,class:"nav-item"},_a=e("i",{class:"fa-solid fa-hashtag mr-2"},null,-1),pa={key:0,class:"py-2 px-0"},ba={class:"form-check mb-2"},fa=["id"],ga=["for"],va={class:"form-floating mb-2"},$a=["id"],ya=["for"],ka={key:0,class:"mb-2"},Fa={class:"form-floating"},Ca=e("label",{for:"floatingPassword"},"Сохранить ответ пользователя как внутреннюю переменную",-1),wa={key:1,class:"form-floating mb-2"},Sa=["id"],ja=["for"],qa={key:1,class:"py-2 px-0"},za={key:0,class:"mb-2"},Pa={key:0,class:"row"},Va=e("div",{class:"col-12"},[e("h6",null,"Выбрать следующий диалог:")],-1),Oa={class:"col-md-12 mb-1"},Ua={type:"button",class:"btn btn-outline-primary w-100 d-flex justify-content-between align-items-center",style:{"text-align":"left"}},Aa=["onClick"],Ia={key:0,class:"fa-solid fa-link mr-2 text-success"},Qa={key:1,class:"row"},Ta=e("div",{class:"col-12"},[e("div",{class:"alert alert-danger",role:"alert"}," Диалогов для связывания нет ")],-1),Ba=[Ta],Ra={key:2,class:"py-2 px-0"},Ma={class:"form-check mb-2"},Da=e("label",{class:"form-check-label",for:"need-additional-functions"}," Нужен дополнительный функционал управления ",-1),Ea={key:0,class:"form-floating mb-2"},La=["id"],Ka=["for"],Na={key:1,class:"mb-2"},Ja={class:"d-flex justify-content-between align-items-center"},Ya=e("p",{class:"mb-2"},"Регулярное выражение для валидации данных ",-1),Ha={class:"form-floating"},Ga=["id"],Wa=["for"],Xa={key:2,class:"mb-2"},Za={class:"d-flex justify-content-between align-items-center"},xa=e("p",{class:"mb-2"},"Канал для отправки данных ",-1),ed={class:"form-floating"},td=["id"],sd=["for"],od={key:3,class:"mb-2"},ld={class:"form-floating"},id=e("option",{selected:""},"Не выбрано",-1),nd=["value"],ad=e("label",{for:"store_variants"},"Сохранить в переменную",-1),dd={class:"form-check mb-2"},rd=e("label",{class:"form-check-label",for:"need-dialog-image"}," В диалоге нужно изображение ",-1),cd={key:4,class:"card mb-2"},ud={class:"card-body"},md=e("h6",null,"Фотографии к диалогу",-1),hd={class:"photo-preview d-flex justify-content-start flex-wrap w-100"},_d={for:"location-photos",style:{"margin-right":"10px"},class:"photo-loader ml-2"},pd=e("span",null,"+",-1),bd={class:"mb-2 img-preview",style:{"margin-right":"10px"}},fd={class:"remove"},gd=["onClick"],vd={class:"mb-2 img-preview",style:{"margin-right":"10px"}},$d={class:"remove"},yd=["onClick"],kd={class:"form-check mb-2"},Fd=e("label",{class:"form-check-label",for:"need-dialog-menu-inline"}," В диалоге нужно меню тексту ",-1),Cd={key:5,class:"card mb-2"},wd=e("div",{class:"card-header"},[e("h6",null,"Кнопки к тексту вопроса")],-1),Sd={class:"card-body"},jd={class:"form-check mb-2"},qd=e("label",{class:"form-check-label",for:"need-dialog-menu-reply"}," В диалоге нужно нижнее меню ",-1),zd={key:6,class:"card mb-2"},Pd=e("div",{class:"card-header"},[e("h6",null,"Кнопки в виде нижнего меню")],-1),Vd={class:"card-body"},Od={class:"form-check mb-2"},Ud=e("label",{class:"form-check-label",for:"need-chains"}," Нужны многоуровневые диалоги ",-1),Ad={key:7,class:"mb-2"},Id={key:0,class:"table"},Qd=e("thead",null,[e("tr",null,[e("th",{scope:"col"},"#"),e("th",{scope:"col"},"Ответ"),e("th",{scope:"col"},"Паттерн"),e("th",{scope:"col"},"Следующий диалог"),e("th",{scope:"col",class:"text-center"},"Действие")])],-1),Td={scope:"row"},Bd={class:"form-floating"},Rd=["onUpdate:modelValue"],Md=e("label",{for:"floatingInput"},"Точный текст ответа",-1),Dd={class:"input-group"},Ed={class:"form-floating"},Ld=["onUpdate:modelValue"],Kd=e("label",{for:"floatingInput"},"Шаблон предполагаемого текста",-1),Nd={class:"dropdown d-flex"},Jd=e("button",{class:"btn btn-outline-secondary w-100",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-solid fa-up-right-and-down-left-from-center"})],-1),Yd={class:"dropdown-menu"},Hd=["onClick"],Gd=["onClick"],Wd={class:"input-group"},Xd={class:"form-floating"},Zd=["onUpdate:modelValue"],xd=e("label",{for:"floatingInput"},"Выберите диалог или введите его номер",-1),er={class:"dropdown d-flex"},tr=e("button",{class:"btn btn-outline-secondary w-100","data-bs-auto-close":"outside",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-solid fa-up-right-and-down-left-from-center"})],-1),sr={class:"dropdown-menu p-2",style:{width:"400px","max-height":"300px","overflow-y":"auto"}},or={class:"list-group"},lr=["onClick"],ir=["onClick"],nr={class:"px-3 pt-2"},ar={class:"dropdown d-flex justify-content-center align-items-center"},dr=e("button",{class:"btn btn-link",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-solid fa-bars"})],-1),rr={class:"dropdown-menu"},cr=["onClick"],ur={key:1,class:"alert alert-primary mt-2",role:"alert"},mr={class:"form-check mb-2"},hr=e("label",{class:"form-check-label",for:"need-set-flags"}," Установить флаги в соответствующее значение ",-1),_r={key:8,class:"mb-2"},pr=e("p",null,"Выбрать флаги",-1),br=["onClick"],fr={key:3,class:"py-2 px-0"},gr={props:["item","bot"],data(){return{tab:0,patterns:[{title:"Номер телефона РФ",value:"/^\\s?(\\+\\s?7|8)([- ()]*\\d){10}$/"},{title:"Дата в формате ДД/ММ/ГГГГ",value:"/(\\d{2})\\/(\\d{2})\\/(\\d{4})$/"},{title:"Время в формате ЧЧ:ММ[:СС]",value:"#^[01]?[0-9]|2[0-3]):[0-5][0-9](:[0-5][0-9])?$#"}],test:[],loading:!0,dialog_commands:[],dialog_commands_paginate_object:null,need_images:!1,need_inline_keyboard:!1,need_reply_keyboard:!1,need_additional_functions:!1,need_chains:!1,need_set_flags:!1,flags_variants:[{title:"Является VIP",key:"is_vip",value:null},{title:"Является Админом",key:"is_admin",value:null},{title:"За работой",key:"is_work",value:null},{title:"Является менеджером",key:"is_manager",value:null}],store_variants:[{title:"Имя",key:"name"},{title:"Почта",key:"email"},{title:"Возраст",key:"age"},{title:"Город",key:"city"},{title:"Страна",key:"country"},{title:"Адрес",key:"address"},{title:"Телефон",key:"phone"},{title:"День рождение",key:"birthday"}],commandForm:{id:null,slug:null,pre_text:null,post_text:null,error_text:null,bot_id:null,input_pattern:null,inline_keyboard_id:null,reply_keyboard_id:null,images:null,next_bot_dialog_command_id:null,bot_dialog_group_id:null,is_empty:!1,result_flags:[],store_to:null,use_result_as:null,result_channel:null,inline_keyboard:null,reply_keyboard:null,answers:[],rules:[]},photos:[]}},watch:{need_inline_keyboard:function(s,t){this.need_inline_keyboard||(this.commandForm.inline_keyboard_id=null,this.commandForm.inline_keyboard=null)},need_reply_keyboard:function(s,t){this.need_reply_keyboard||(this.commandForm.reply_keyboard_id=null,this.commandForm.reply_keyboard=null)},need_set_flags:function(s,t){this.need_set_flags||(this.commandForm.result_flags=[])},need_images:function(s,t){this.need_images||(this.commandForm.images=null)}},computed:{...w(["getDialogCommands","getDialogCommandsPaginateObject"]),filteredCommands(){return this.dialog_commands?this.dialog_commands.filter(s=>s.id!=this.commandForm.id):[]}},mounted(){this.item&&this.$nextTick(()=>{this.commandForm={id:this.item.id||null,slug:this.item.slug||null,pre_text:this.item.pre_text||null,post_text:this.item.post_text||null,error_text:this.item.error_text||null,is_empty:this.item.is_empty||!1,input_pattern:this.item.input_pattern||null,inline_keyboard_id:this.item.inline_keyboard_id||null,reply_keyboard_id:this.item.reply_keyboard_id||null,images:this.item.images||[],next_bot_dialog_command_id:this.item.next_bot_dialog_command_id||null,bot_dialog_group_id:this.item.bot_dialog_group_id||null,result_channel:this.item.result_channel||null,inline_keyboard:this.item.inline_keyboard||null,reply_keyboard:this.item.reply_keyboard||null,result_flags:this.item.result_flags||[],store_to:this.item.store_to||null,answers:this.item.answers||[],use_result_as:this.item.use_result_as||null,rules:this.item.rules||[]},this.bot&&(this.commandForm.bot_id=this.bot.id||null),this.commandForm.inline_keyboard_id!=null&&(this.need_inline_keyboard=!0),this.commandForm.reply_keyboard_id!=null&&(this.need_reply_keyboard=!0),this.commandForm.images.length>0&&(this.need_images=!0),this.commandForm.result_flags.length>0&&(this.need_set_flags=!0),this.commandForm.answers.length>0&&(this.need_chains=!0)}),this.bot&&this.$nextTick(()=>{this.commandForm.bot_id=this.bot.id}),this.item&&(this.dialog_commands=this.getDialogCommands,this.dialog_commands_paginate_object=this.getDialogCommandsPaginateObject)},methods:{addAnswer(){this.commandForm.answers.push({id:null,bot_dialog_command_id:null,answer:null,pattern:null,next_bot_dialog_command_id:null})},nextDialogs(s){this.loadDialogs(s)},removeDialogAnswer(s,t){if(s.id==null){this.commandForm.answers.splice(t,1);return}this.commandForm.answers.splice(t,1),this.loading=!0,this.$store.dispatch("removeDialogAnswer",{dataObject:{dialogAnswerId:s.id}}).then(o=>{this.loading=!1,this.loadDialogs()}).catch(()=>{this.loading=!1})},loadDialogs(s=0){this.loading=!0,this.$store.dispatch("loadDialogCommands",{dataObject:{botId:this.bot.id||null,search:this.search},page:s}).then(t=>{this.loading=!1,this.dialog_commands=this.getDialogCommands,this.dialog_commands_paginate_object=this.getDialogCommandsPaginateObject}).catch(()=>{this.loading=!1})},doCommandLink(s){this.loading=!0,this.commandForm.next_bot_dialog_command_id=s},submit(){this.loading=!0;let s=new FormData;if(Object.keys(this.commandForm).forEach(t=>{const o=this.commandForm[t]||"";typeof o=="object"?s.append(t,JSON.stringify(o)):s.append(t,o)}),this.photos){for(let t=0;t<this.photos.length;t++)s.append("files[]",this.photos[t]);s.delete("photos")}this.$store.dispatch(this.commandForm.id?"updateDialogCommand":"createDialogCommand",{dialogCommandForm:s}).then(t=>{this.loading=!1,this.$notify({title:"Конструктор ботов",text:"Успешная обработка диалоговой команды",type:"success"}),this.commandForm.id==null&&(this.commandForm={id:null,slug:null,pre_text:null,post_text:null,error_text:null,input_pattern:null,inline_keyboard_id:null,images:null,next_bot_dialog_command_id:null,bot_dialog_group_id:null,result_channel:null,inline_keyboard:null,is_empty:!1,result_flags:[],answers:[],store_to:null,use_result_as:null},this.photos=[]),this.$emit("callback")}).catch(t=>{this.loading=!1})},getPhoto(s){return{imageUrl:URL.createObjectURL(s)}},removePhoto(s,t){this[s].splice(t,1)},onChangePhotos(s){const t=s.target.files;for(let o=0;o<t.length;o++)this.photos.push(t[o])},saveInlineKeyboard(s){this.commandForm.inline_keyboard=s},saveReplyKeyboard(s){this.commandForm.reply_keyboard=s},addTextTo(s={param:null,text:null}){this.commandForm[s.param]=s.text},selectElementById(s){this.$emit("select-element",s)},selectFlag(s){(!this.commandForm.result_flags||!Array.isArray(this.commandForm.result_flags))&&(this.commandForm.result_flags=[]);let t=this.commandForm.result_flags.indexOf(s.key);t===-1?this.commandForm.result_flags.push(s.key):this.commandForm.result_flags.splice(t,1)}}},W=Object.assign(gr,{__name:"BotDialogCommandForm",setup(s){return(t,o)=>{const a=A("lazy");return l(),i("form",{onSubmit:o[22]||(o[22]=S((...n)=>t.submit&&t.submit(...n),["prevent"]))},[e("div",ta,[e("button",sa,[oa,t.commandForm.id?(l(),i("span",la,"Обновить диалог")):(l(),i("span",ia,"Добавить диалог"))])]),e("ul",na,[e("li",aa,[e("a",{class:p(["nav-link",{active:t.tab===0}]),onClick:o[0]||(o[0]=n=>t.tab=0),"aria-current":"page",href:"javascript:void(0)"},[da,m(" Основное")],2)]),e("li",ra,[e("a",{class:p(["nav-link",{active:t.tab===1}]),onClick:o[1]||(o[1]=n=>t.tab=1),href:"javascript:void(0)"},[ca,m(" Связывание диалогов")],2)]),e("li",ua,[e("a",{class:p(["nav-link",{active:t.tab===2}]),onClick:o[2]||(o[2]=n=>t.tab=2),href:"javascript:void(0)"},[ma,m(" Дополнительное")],2)]),t.commandForm.is_empty?(l(),i("li",ha,[e("a",{class:p(["nav-link",{active:t.tab===3}]),onClick:o[3]||(o[3]=n=>t.tab=3),href:"javascript:void(0)","aria-disabled":"true"},[_a,m(" Вычисление результата")],2)])):r("",!0)]),t.tab===0?(l(),i("div",pa,[e("div",ba,[c(e("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":o[4]||(o[4]=n=>t.commandForm.is_empty=n),id:"need-empty-dialog"+(t.commandForm.id||"new"),checked:""},null,8,fa),[[k,t.commandForm.is_empty]]),e("label",{class:"form-check-label",for:"need-empty-dialog"+(t.commandForm.id||"new")}," Диалог завершает цепочку (только вывод информации) ",8,ga)]),e("div",va,[c(e("textarea",{class:"form-control",id:"commandForm-pre-text-"+t.commandForm.id,placeholder:"Начни с малого...","onUpdate:modelValue":o[5]||(o[5]=n=>t.commandForm.pre_text=n),required:""},`
                `,8,$a),[[_,t.commandForm.pre_text]]),e("label",{for:"commandForm-pre-text-"+t.commandForm.id},"Текст диалога",8,ya)]),t.commandForm.is_empty?r("",!0):(l(),i("div",ka,[e("div",Fa,[c(e("input",{type:"text",class:"form-control",id:"floatingPassword","onUpdate:modelValue":o[6]||(o[6]=n=>t.commandForm.use_result_as=n),placeholder:"Password"},null,512),[[_,t.commandForm.use_result_as]]),Ca])])),t.commandForm.is_empty?r("",!0):(l(),i("div",wa,[c(e("textarea",{class:"form-control",id:"commandForm-post-text-"+t.commandForm.id,placeholder:"Начни с малого...","onUpdate:modelValue":o[7]||(o[7]=n=>t.commandForm.post_text=n)},`
            `,8,Sa),[[_,t.commandForm.post_text]]),e("label",{for:"commandForm-post-text-"+t.commandForm.id},"Текст после успешного завершения диалога",8,ja)]))])):r("",!0),t.tab===1?(l(),i("div",qa,[t.commandForm.id?(l(),i("div",za,[t.filteredCommands.length>0?(l(),i("div",Pa,[Va,(l(!0),i(v,null,y(t.filteredCommands,(n,d)=>(l(),i("div",Oa,[e("button",Ua,[e("span",{onClick:h=>t.doCommandLink(n.id)},[t.commandForm.next_bot_dialog_command_id==n.id?(l(),i("i",Ia)):r("",!0),m(" #"+u(n.id)+" "+u(n.pre_text||"Без текста"),1)],8,Aa),t.commandForm.next_bot_dialog_command_id==n.id?(l(),i("i",{key:0,class:"fa-solid fa-unlink text-danger",onClick:o[8]||(o[8]=h=>t.doCommandLink(null))})):r("",!0)])]))),256)),t.dialog_commands_paginate_object?(l(),$(j,{key:0,onPagination_page:t.nextDialogs,pagination:t.dialog_commands_paginate_object},null,8,["onPagination_page","pagination"])):r("",!0)])):(l(),i("div",Qa,Ba))])):r("",!0)])):r("",!0),t.tab===2?(l(),i("div",Ra,[e("div",Ma,[c(e("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":o[9]||(o[9]=n=>t.need_additional_functions=n),id:"need-additional-functions"},null,512),[[k,t.need_additional_functions]]),Da]),!t.commandForm.is_empty&&t.need_additional_functions?(l(),i("div",Ea,[c(e("textarea",{type:"text",class:"form-control",id:"commandForm-error-text-"+t.commandForm.id,placeholder:"Начни с малого...","onUpdate:modelValue":o[10]||(o[10]=n=>t.commandForm.error_text=n)},`
            `,8,La),[[_,t.commandForm.error_text]]),e("label",{for:"commandForm-error-text-"+t.commandForm.id},"Текст на случай ошибки корректности данных",8,Ka)])):r("",!0),!t.commandForm.is_empty&&t.need_additional_functions?(l(),i("div",Na,[e("div",Ja,[Ya,g(an,{param:"input_pattern",onCallback:t.addTextTo},null,8,["onCallback"])]),e("div",Ha,[c(e("input",{type:"text","onUpdate:modelValue":o[11]||(o[11]=n=>t.commandForm.input_pattern=n),maxlength:"255",class:"form-control",id:"commandForm-input-pattern-"+t.commandForm.id,placeholder:"Регулярное выражение"},null,8,Ga),[[_,t.commandForm.input_pattern]]),e("label",{for:"commandForm-result-channel-"+t.commandForm.id},"Регулярное выражение",8,Wa)])])):r("",!0),t.need_additional_functions?(l(),i("div",Xa,[e("div",Za,[xa,s.bot?(l(),$(oe,{key:0,token:s.bot.bot_token,param:"result_channel",onCallback:t.addTextTo},null,8,["token","onCallback"])):r("",!0)]),e("div",ed,[c(e("input",{type:"number","onUpdate:modelValue":o[12]||(o[12]=n=>t.commandForm.result_channel=n),class:"form-control",id:"commandForm-result-channel-"+t.commandForm.id,placeholder:"id канала"},null,8,td),[[_,t.commandForm.result_channel]]),e("label",{for:"commandForm-result-channel-"+t.commandForm.id},"id канала",8,sd)])])):r("",!0),t.need_additional_functions?(l(),i("div",od,[e("div",ld,[c(e("select",{class:"form-select","onUpdate:modelValue":o[13]||(o[13]=n=>t.commandForm.store_to=n),id:"store_variants","aria-label":"Floating label select example"},[id,(l(!0),i(v,null,y(t.store_variants,n=>(l(),i("option",{value:n.key},u(n.title||"Не указано"),9,nd))),256))],512),[[Q,t.commandForm.store_to]]),ad])])):r("",!0),e("div",dd,[c(e("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":o[14]||(o[14]=n=>t.need_images=n),id:"need-dialog-image",checked:""},null,512),[[k,t.need_images]]),rd]),t.need_images?(l(),i("div",cd,[e("div",ud,[md,e("div",hd,[e("label",_d,[pd,e("input",{type:"file",id:"location-photos",multiple:"",accept:"image/*",onChange:o[15]||(o[15]=(...n)=>t.onChangePhotos&&t.onChangePhotos(...n)),style:{display:"none"}},null,32)]),t.photos.length>0?(l(!0),i(v,{key:0},y(t.photos,(n,d)=>(l(),i("div",bd,[c(e("img",null,null,512),[[a,t.getPhoto(n).imageUrl]]),e("div",fd,[e("a",{onClick:h=>t.removePhoto("photos",d)},"Удалить",8,gd)])]))),256)):r("",!0),t.commandForm.images&&s.bot?(l(!0),i(v,{key:1},y(t.commandForm.images,(n,d)=>(l(),i("div",vd,[c(e("img",null,null,512),[[a,"/images-by-bot-id/"+s.bot.id+"/"+n]]),e("div",$d,[e("a",{onClick:h=>t.removePhoto("images",d)},"Удалить",8,yd)])]))),256)):r("",!0)])])])):r("",!0),e("div",kd,[c(e("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":o[16]||(o[16]=n=>t.need_inline_keyboard=n),id:"need-dialog-menu-inline",checked:""},null,512),[[k,t.need_inline_keyboard]]),Fd]),t.need_inline_keyboard?(l(),i("div",Cd,[wd,e("div",Sd,[g(U,{type:"inline",onSave:t.saveInlineKeyboard,"edited-keyboard":t.commandForm.inline_keyboard},null,8,["onSave","edited-keyboard"])])])):r("",!0),e("div",jd,[c(e("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":o[17]||(o[17]=n=>t.need_reply_keyboard=n),id:"need-dialog-menu-reply",checked:""},null,512),[[k,t.need_reply_keyboard]]),qd]),t.need_reply_keyboard?(l(),i("div",zd,[Pd,e("div",Vd,[g(U,{type:"reply",onSave:t.saveReplyKeyboard,"edited-keyboard":t.commandForm.reply_keyboard},null,8,["onSave","edited-keyboard"])])])):r("",!0),e("div",Od,[c(e("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":o[18]||(o[18]=n=>t.need_chains=n),id:"need-chains",checked:""},null,512),[[k,t.need_chains]]),Ud]),t.need_chains?(l(),i("div",Ad,[e("button",{type:"button",class:"btn btn-outline-primary",onClick:o[19]||(o[19]=(...n)=>t.addAnswer&&t.addAnswer(...n))},"Добавить вариант ответа "),t.commandForm.answers.length>0?(l(),i("table",Id,[Qd,e("tbody",null,[(l(!0),i(v,null,y(t.commandForm.answers,(n,d)=>(l(),i("tr",null,[e("th",Td,u(d+1),1),e("td",null,[e("div",Bd,[c(e("input",{type:"text","onUpdate:modelValue":h=>t.commandForm.answers[d].answer=h,class:"form-control",id:"floatingInput",placeholder:"name@example.com"},null,8,Rd),[[_,t.commandForm.answers[d].answer]]),Md])]),e("td",null,[e("div",Dd,[e("div",Ed,[c(e("input",{type:"text","onUpdate:modelValue":h=>t.commandForm.answers[d].pattern=h,class:"form-control",id:"floatingInput",placeholder:"name@example.com"},null,8,Ld),[[_,t.commandForm.answers[d].pattern]]),Kd]),e("div",Nd,[Jd,e("ul",Yd,[e("li",null,[e("a",{class:"dropdown-item",onClick:h=>t.commandForm.answers[d].pattern=null,href:"javascript:void(0)"},"Не выбран",8,Hd)]),e("li",null,[(l(!0),i(v,null,y(t.patterns,h=>(l(),i("a",{class:"dropdown-item",onClick:b=>t.commandForm.answers[d].pattern=h.value,href:"javascript:void(0)"},u(h.title||"-"),9,Gd))),256))])])])])]),e("td",null,[e("div",Wd,[e("div",Xd,[c(e("input",{type:"text",class:"form-control","onUpdate:modelValue":h=>t.commandForm.answers[d].next_bot_dialog_command_id=h,id:"floatingInput",placeholder:"name@example.com",required:""},null,8,Zd),[[_,t.commandForm.answers[d].next_bot_dialog_command_id]]),xd]),e("div",er,[tr,e("div",sr,[e("ul",or,[e("li",{class:"list-group-item cursor-pointer font-12",onClick:h=>t.commandForm.answers[d].next_bot_dialog_command_id=null},"Не выбран ",8,lr),(l(!0),i(v,null,y(t.getDialogCommands,h=>(l(),i("li",{class:"list-group-item cursor-pointer font-12",style:{"line-height":"100%","text-align":"left"},onClick:b=>t.commandForm.answers[d].next_bot_dialog_command_id=h.id}," #"+u(h.id||"-")+" "+u(h.pre_text||"-"),9,ir))),256))]),e("div",nr,[t.dialog_commands_paginate_object?(l(),$(j,{key:0,onPagination_page:t.nextDialogs,pagination:t.dialog_commands_paginate_object},null,8,["onPagination_page","pagination"])):r("",!0)])])])])]),e("td",null,[e("div",ar,[dr,e("ul",rr,[e("li",null,[e("a",{class:"dropdown-item",onClick:h=>t.removeDialogAnswer(n,d),href:"javascript:void(0)"},"Удалить",8,cr)])])])])]))),256))])])):(l(),i("div",ur," Добавьте один или несколько вариантов ответов "))])):r("",!0),e("div",mr,[c(e("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":o[20]||(o[20]=n=>t.need_set_flags=n),id:"need-set-flags",checked:""},null,512),[[k,t.need_set_flags]]),hr]),t.need_set_flags?(l(),i("div",_r,[pr,(l(!0),i(v,null,y(t.flags_variants,n=>(l(),i("span",{class:p(["badge text-info mr-2",{"bg-info text-white":t.commandForm.result_flags.indexOf(n.key)!=-1}]),onClick:d=>t.selectFlag(n)},u(n.title),11,br))),256))])):r("",!0)])):r("",!0),t.tab===3?(l(),i("div",fr,[g(ea,{modelValue:t.commandForm.rules,"onUpdate:modelValue":o[21]||(o[21]=n=>t.commandForm.rules=n)},null,8,["modelValue"])])):r("",!0)],32)}}});const vr={class:"row"},$r={class:"col-md-2 col-12"},yr=e("i",{class:"fa-regular fa-comment-dots",style:{"margin-right":"10px"}},null,-1),kr={class:"col-md-10 col-12"},Fr={class:"input-group mb-3"},Cr={key:0,class:"row"},wr={class:"col-md-12"},Sr={class:"table"},jr=e("thead",null,[e("tr",null,[e("th",{class:"text-center",scope:"col"}),e("th",{class:"text-center",scope:"col"},"#"),e("th",{class:"text-center",scope:"col"},"Переменная"),e("th",{class:"text-center",scope:"col"},"Текст диалога"),e("th",{class:"text-center",scope:"col"},"Есть ответы"),e("th",{class:"text-center",scope:"col"},"Цепочки"),e("th",{class:"text-center",scope:"col"},"Текст успеха"),e("th",{class:"text-center",scope:"col"},"Текст ошибки"),e("th",{class:"text-center",scope:"col"},"Канал результата"),e("th",{class:"text-center",scope:"col"},"Флаги"),e("th",{class:"text-center",scope:"col"},"Сохранить в"),e("th",{class:"text-center",scope:"col"},"Есть изображения"),e("th",{class:"text-center",scope:"col"},"Есть паттерны"),e("th",{class:"text-center",scope:"col"},"Пустой"),e("th",{class:"text-center",scope:"col"},"Есть кнопки"),e("th",{class:"text-center",scope:"col"},"Есть меню"),e("th",{class:"text-center",scope:"col"},"Команды")])],-1),qr=["onClick"],zr=e("i",{class:"fa-solid fa-toggle-off cursor-pointer text-secondary"},null,-1),Pr=[zr],Vr=["onClick"],Or=e("i",{class:"fa-solid fa-toggle-on cursor-pointer text-primary"},null,-1),Ur=[Or],Ar={scope:"row"},Ir={class:"text-center"},Qr={class:"text-center"},Tr={class:"text-center"},Br={key:0},Rr={key:1},Mr=e("i",{class:"fa-solid fa-xmark text-danger"},null,-1),Dr=[Mr],Er={class:"text-center"},Lr={key:0,class:"badge bg-primary"},Kr={key:1},Nr=e("i",{class:"fa-solid fa-xmark text-danger"},null,-1),Jr=[Nr],Yr={class:"text-center"},Hr={key:0},Gr={key:1},Wr=e("i",{class:"fa-solid fa-xmark text-danger"},null,-1),Xr=[Wr],Zr={class:"text-center"},xr={key:0},ec={key:1},tc=e("i",{class:"fa-solid fa-xmark text-danger"},null,-1),sc=[tc],oc={class:"text-center"},lc={key:0},ic={key:1},nc=e("i",{class:"fa-solid fa-xmark text-danger"},null,-1),ac=[nc],dc={class:"text-center"},rc={key:0},cc={class:"badge bg-primary"},uc={key:1},mc=e("i",{class:"fa-solid fa-xmark text-danger"},null,-1),hc=[mc],_c={class:"text-center"},pc={key:0},bc={key:1},fc=e("i",{class:"fa-solid fa-xmark text-danger"},null,-1),gc=[fc],vc={class:"text-center"},$c={key:0,class:"fa-solid fa-check text-success"},yc={key:1,class:"fa-solid fa-xmark text-danger"},kc={class:"text-center"},Fc={key:0},Cc={key:1},wc=e("i",{class:"fa-solid fa-xmark text-danger"},null,-1),Sc=[wc],jc={class:"text-center"},qc={key:0,class:"fa-solid fa-check text-success"},zc={key:1,class:"fa-solid fa-xmark text-danger"},Pc={class:"text-center"},Vc={key:0,class:"fa-solid fa-check text-success"},Oc={key:1,class:"fa-solid fa-xmark text-danger"},Uc={class:"text-center"},Ac={key:0,class:"fa-solid fa-check text-success"},Ic={key:1,class:"fa-solid fa-xmark text-danger"},Qc={class:"text-center"},Tc={class:"dropdown"},Bc=["disabled"],Rc=e("i",{class:"fa-solid fa-ellipsis"},null,-1),Mc=[Rc],Dc={class:"dropdown-menu"},Ec=["onClick"],Lc=e("i",{class:"fa-solid fa-arrow-left mr-1"},null,-1),Kc=e("hr",null,null,-1),Nc=["onClick"],Jc=e("i",{class:"fa-solid fa-clone mr-1"},null,-1),Yc=["onClick"],Hc=e("i",{class:"fa-solid fa-trash-can mr-1"},null,-1),Gc={key:0},Wc={colspan:"17"},Xc={key:1,class:"row"},Zc=e("div",{class:"col-12"},[e("div",{class:"alert alert-danger",role:"alert"}," Не найдено ни одного диалога! ")],-1),xc=[Zc],eu={class:"modal fade",id:"dialog-command-modal-editor",tabindex:"-1"},tu={class:"modal-dialog modal-fullscreen"},su={class:"modal-content"},ou=e("div",{class:"modal-header"},[e("h1",{class:"modal-title fs-5",id:"staticBackdropLabel"}," Создание диалогового сообщения "),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),lu={class:"modal-body"},iu=e("div",{class:"modal-footer"},[e("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Закрыть")],-1),nu={data(){return{variables:[],bot:null,selected:null,loading:!0,dialog_commands:[],search:null,dialog_commands_paginate_object:null}},computed:{...w(["getDialogCommands","getCurrentBot","getDialogCommandsPaginateObject"])},mounted(){this.loadCurrentBot().then(()=>{this.loadDialogs()})},methods:{openEditor(s){this.loading=!0,s||this.dialog_commands.forEach(t=>{t.in_edit_mode=!1}),this.$nextTick(()=>{this.selected=s,this.loading=!1})},removeCommand(s){this.loading=!0,this.$store.dispatch("removeDialogCommand",{dataObject:{dialogCommandId:s}}).then(t=>{this.loading=!1,this.$notify({title:"Конструктор ботов",text:"Диалоговая команда успешно удалена!",type:"success"}),this.loadDialogs(),this.$emit("callback")}).catch(t=>{this.loading=!1})},duplicate(s){this.loading=!0,this.$store.dispatch("duplicateDialogCommand",{dataObject:{dialogCommandId:s}}).then(t=>{this.loading=!1,this.$notify({title:"Конструктор ботов",text:"Диалоговая команда успешно продублирована!",type:"success"}),this.loadDialogs(),this.$emit("callback")}).catch(t=>{this.loading=!1})},toggleEditMode(s){this.selected=s,s.in_edit_mode=!s.in_edit_mode},loadCurrentBot(s=null){return this.$store.dispatch("updateCurrentBot",{bot:s}).then(()=>{this.bot=this.getCurrentBot})},selectDialog(s){this.$emit("select-dialog",s),this.$notify("Вы выбрали диалог из списка!")},nextDialogs(s){this.loadDialogs(s)},selectElement(s){this.loading=!0,this.$nextTick(()=>{this.selected=this.dialog_commands.find(t=>t.id===s)||null,this.loading=!1})},loadDialogs(s=0){this.$store.dispatch("loadDialogCommands",{dataObject:{botId:this.bot.id||null,search:this.search},page:s}).then(t=>{const o=this.selected;this.dialog_commands=this.getDialogCommands,this.dialog_commands_paginate_object=this.getDialogCommandsPaginateObject,this.loading=!0,this.$nextTick(()=>{o&&(this.selected=this.dialog_commands.find(a=>a.id===o.id)||null,this.selected.in_edit_mode=!1),this.loading=!1})}).catch(()=>{this.loading=!1})}}},ae=Object.assign(nu,{__name:"BotDialogGroupList",setup(s){return(t,o)=>(l(),i(v,null,[e("div",vr,[e("div",$r,[e("button",{type:"button",onClick:o[0]||(o[0]=a=>t.openEditor(null)),"data-bs-toggle":"modal","data-bs-target":"#dialog-command-modal-editor",class:"btn btn-outline-success mb-2 w-100"},[yr,m("Новый диалог ")])]),e("div",kr,[e("div",Fr,[c(e("input",{type:"search",class:"form-control",placeholder:"Поиск диалога","aria-label":"Поиск диалога","onUpdate:modelValue":o[1]||(o[1]=a=>t.search=a),"aria-describedby":"button-addon2"},null,512),[[_,t.search]]),e("button",{class:"btn btn-outline-secondary",onClick:o[2]||(o[2]=a=>t.loadDialogs(0)),type:"button",id:"button-addon2"},"Найти ")])])]),t.dialog_commands.length>0?(l(),i("div",Cr,[e("div",wr,[e("table",Sr,[jr,e("tbody",null,[(l(!0),i(v,null,y(t.dialog_commands,(a,n)=>(l(),i(v,null,[e("tr",null,[e("td",null,[a.in_edit_mode?(l(),i("span",{key:1,onClick:d=>t.toggleEditMode(a)},Ur,8,Vr)):(l(),i("span",{key:0,onClick:d=>t.toggleEditMode(a)},Pr,8,qr))]),e("th",Ar,u(a.id),1),e("td",Ir,u(a.use_result_as||"не задана"),1),e("td",Qr,u(a.pre_text||"-"),1),e("td",Tr,[(a.answers||[]).length>0?(l(),i("p",Br,u(a.answers.length),1)):(l(),i("p",Rr,Dr))]),e("td",Er,[a.next_bot_dialog_command_id?(l(),i("span",Lr,"#"+u(a.next_bot_dialog_command_id||"-")+" ("+u(a.chain.length||0)+")",1)):(l(),i("span",Kr,Jr))]),e("td",Yr,[a.post_text?(l(),i("p",Hr,u(a.post_text),1)):(l(),i("p",Gr,Xr))]),e("td",Zr,[a.error_text?(l(),i("p",xr,u(a.error_text),1)):(l(),i("p",ec,sc))]),e("td",oc,[a.result_channel?(l(),i("p",lc,u(a.result_channel),1)):(l(),i("p",ic,ac))]),e("td",dc,[a.result_flags.length>0?(l(),i("p",rc,[(l(!0),i(v,null,y(a.result_flags,d=>(l(),i("span",cc,u(d||"-"),1))),256))])):(l(),i("p",uc,hc))]),e("td",_c,[a.store_to?(l(),i("p",pc,u(a.store_to),1)):(l(),i("p",bc,gc))]),e("td",vc,[a.images.length>0?(l(),i("i",$c)):(l(),i("i",yc))]),e("td",kc,[a.input_pattern?(l(),i("p",Fc,u(a.input_pattern),1)):(l(),i("p",Cc,Sc))]),e("td",jc,[a.is_empty?(l(),i("i",qc)):(l(),i("i",zc))]),e("td",Pc,[a.inline_keyboard_id!=null?(l(),i("i",Vc)):(l(),i("i",Oc))]),e("td",Uc,[a.reply_keyboard_id!=null?(l(),i("i",Ac)):(l(),i("i",Ic))]),e("td",Qc,[e("div",Tc,[e("button",{disabled:t.loading,class:"btn btn-outline-secondary",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},Mc,8,Bc),e("ul",Dc,[e("li",null,[e("a",{onClick:d=>t.selectDialog(a),title:"Выбрать диалог",class:"dropdown-item cursor-pointer"},[Lc,m(" Выбрать диалог ")],8,Ec)]),Kc,e("li",null,[e("a",{title:"Дублирование команды",onClick:d=>t.duplicate(a.id),class:"dropdown-item cursor-pointer"},[Jc,m(" Дублирование диалога ")],8,Nc)]),e("li",null,[e("a",{onClick:d=>t.removeCommand(a.id),title:"Удаление команды",class:"dropdown-item cursor-pointer"},[Hc,m(" Удаление диалога ")],8,Yc)])])])])]),a.in_edit_mode?(l(),i("tr",Gc,[e("td",Wc,[t.bot&&!t.loading?(l(),$(W,{key:0,item:t.selected,onCallback:t.loadDialogs,onSelectElement:t.selectElement,bot:t.bot},null,8,["item","onCallback","onSelectElement","bot"])):r("",!0)])])):r("",!0)],64))),256))])]),t.dialog_commands_paginate_object?(l(),$(j,{key:0,onPagination_page:t.nextDialogs,pagination:t.dialog_commands_paginate_object},null,8,["onPagination_page","pagination"])):r("",!0)])])):(l(),i("div",Xc,xc)),e("div",eu,[e("div",tu,[e("div",su,[ou,e("div",lu,[t.bot&&!t.loading?(l(),$(W,{key:0,item:t.selected,onCallback:t.loadDialogs,onSelectElement:t.selectElement,bot:t.bot},null,8,["item","onCallback","onSelectElement","bot"])):r("",!0)]),iu])])])],64))}}),au=e("div",{class:"alert alert-success",role:"alert"},' Проверка правил идет по методу "И" - все правила должны выполняться для перехода на данную страницу, иначе будет вызвана страница из блока "иначе". Действия для "иначе" добавлять не обязательно. ',-1),du=e("h6",null,"Блок условий",-1),ru={key:0,class:"py-2"},cu={class:"form-label",id:"bot-domain"},uu=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),mu=e("div",null,"Напишите текст, который будет отображен пользователю вместе с основным контентом в случае если условие будет выполнено ",-1),hu={class:"dropdown mb-2"},_u=e("button",{class:"btn btn-outline-info dropdown-toggle w-100",type:"button",id:"dropdownMenuButton1","data-bs-toggle":"dropdown","aria-expanded":"false"}," Добавить условие ",-1),pu={class:"dropdown-menu","aria-labelledby":"dropdownMenuButton1"},bu=["onClick"],fu={key:1},gu={key:2,class:"list-group"},vu={key:0,class:"list-group-item d-flex justify-content-between align-items-center"},$u={class:"form-check"},yu={class:"form-check-label",for:"bot-user-is-vip"},ku={key:0},Fu={key:1},Cu=e("i",{class:"fa-solid fa-trash-can"},null,-1),wu=[Cu],Su={key:1,class:"list-group-item d-flex justify-content-between align-items-center"},ju={class:"form-check"},qu={class:"form-check-label",for:"bot-user-is-admin"},zu={key:0},Pu={key:1},Vu=e("i",{class:"fa-solid fa-trash-can"},null,-1),Ou=[Vu],Uu={key:2,class:"list-group-item d-flex justify-content-between align-items-center"},Au={class:"form-check"},Iu={class:"form-check-label",for:"bot-user-is-deliveryman"},Qu={key:0},Tu={key:1},Bu=e("i",{class:"fa-solid fa-trash-can"},null,-1),Ru=[Bu],Mu={key:3,class:"list-group-item d-flex justify-content-between align-items-center"},Du={class:"form-check"},Eu={class:"form-check-label",for:"bot-user-is-work"},Lu={key:0},Ku={key:1},Nu=e("i",{class:"fa-solid fa-trash-can"},null,-1),Ju=[Nu],Yu={key:4,class:"list-group-item d-flex justify-content-between align-items-center"},Hu={class:"form-check"},Gu={class:"form-check-label",for:"bot-user-in-location"},Wu={key:0},Xu={key:1},Zu=e("i",{class:"fa-solid fa-trash-can"},null,-1),xu=[Zu],em={key:5,class:"list-group-item d-flex justify-content-between align-items-center"},tm=e("label",{class:"form-label",id:"bot-domain"}," Возраст от ",-1),sm=e("i",{class:"fa-solid fa-trash-can"},null,-1),om=[sm],lm={key:6,class:"list-group-item d-flex justify-content-between align-items-center"},im=e("label",{class:"form-label",id:"bot-domain"}," Только для города ",-1),nm=e("i",{class:"fa-solid fa-trash-can"},null,-1),am=[nm],dm={key:7,class:"list-group-item d-flex justify-content-between align-items-center"},rm={class:"form-check"},cm={class:"form-check-label",for:"bot-user-sex"},um={key:0},mm={key:1},hm=e("i",{class:"fa-solid fa-trash-can"},null,-1),_m=[hm],pm={key:8,class:"list-group-item"},bm={class:"mb-3"},fm={class:"d-flex justify-content-between align-items-center"},gm={class:"form-label d-flex w-100 align-items-center",id:"bot-order-channel"},vm=["onClick"],$m=e("i",{class:"fa-solid fa-trash-can"},null,-1),ym=[$m],km=["onUpdate:modelValue"],Fm={key:3,class:"mt-5"},Cm={key:4,class:"d-flex justify-content-between"},wm={key:6,class:"py-2"},Sm={class:"form-label",id:"bot-domain"},jm=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),qm=e("div",null,'Напишите текст, который будет отображен пользователю вместе с основным контентом в случае если условие не будет выполнено и будет вызван блок "иначе" ',-1),zm={props:["bot","rulesForm"],data(){return{rules:[{id:1,title:"Является администратором",rules_block:"bot_user",rule:{is_admin:!0}},{id:2,title:"Является VIP-пользователем",rules_block:"bot_user",rule:{is_vip:!0}},{id:3,title:"Находится в заведении",rules_block:"bot_user",rule:{user_in_location:!0}},{id:4,title:"За работой",rules_block:"bot_user",rule:{is_work:!0}},{id:5,title:"Возраст от ...",rules_block:"bot_user",rule:{age:18}},{id:6,title:"Находится в городе ...",rules_block:"bot_user",rule:{city:"Краснодар"}},{id:7,title:"Пол",rules_block:"bot_user",rule:{sex:!0}},{id:8,title:"Состоит в канале",rules_block:"channels",rule:{channel:1}},{id:9,title:"Является Менеджером",rules_block:"bot_user",rule:{is_manager:!0}}]}},computed:{rulesForCustomFields(){let s=this.rules.filter(t=>t.key!=null);return console.log("filtered rules",s),s}},mounted(){},methods:{hasRuleKey(s){return this.rulesForm.rules_if==null?!1:(console.log("key=>",s||"-"),Object.keys(this.rulesForm.rules_if.bot_user).find(t=>t===s)!=null)},modifyChannel(s){this.rulesForm.rules_if.channels[s.param]=s.text},removeChannelFromRule(s){this.rulesForm.rules_if.channels.splice(s,1)},removeRule(s){delete this.rulesForm.rules_if.bot_user[s]},addRules(s){this.rulesForm.rules_if||(this.rulesForm.rules_if={bot_user:{},channels:[]}),s.rules_block==="bot_user"&&(this.rulesForm.rules_if.bot_user={...this.rulesForm.rules_if.bot_user,...s.rule}),s.rules_block==="channels"&&this.rulesForm.rules_if.channels.push(s.rule.channel)},loadCurrentBotFields(){return this.$store.dispatch("loadCurrentBotFields",{bot_id:this.bot.id}).then(s=>{(s.data||[]).forEach(o=>{o.is_active&&(this.rules.push({id:this.rules.length+1,title:o.label,key:o.key,type:o.type,rules_block:"bot_user",rule:{}}),o.type===0&&(this.rules[this.rules.length-1].rule[o.key]=""),o.type===1&&(this.rules[this.rules.length-1].rule[o.key]=0),o.type===2&&(this.rules[this.rules.length-1].rule[o.key]=!0))}),console.log("new rules=>",this.rules)})},attachPageToRule(s){s.id!=this.rulesForm.id?this.rulesForm.rules_else_page_id=s.id:this.$notify({title:"Конструктор страниц",text:"Вы не можете связать данную страницу с собой",type:"error"})}}},Pm=Object.assign(zm,{__name:"PageRules",setup(s){return(t,o)=>{const a=q("Popper");return l(),i(v,null,[au,du,s.rulesForm.rules_if?(l(),i("div",ru,[e("label",cu,[g(a,null,{content:f(()=>[mu]),default:f(()=>[uu]),_:1}),m(" Сообщение при успешном прохождении условий (не обязательно) ")]),c(e("textarea",{type:"text",class:"form-control",placeholder:"Текст сообщения","aria-label":"Текст сообщения","onUpdate:modelValue":o[0]||(o[0]=n=>s.rulesForm.rules_if_message=n),maxlength:"255","aria-describedby":"rules-else-message"},`
            `,512),[[_,s.rulesForm.rules_if_message]])])):r("",!0),e("div",hu,[_u,e("ul",pu,[(l(!0),i(v,null,y(t.rules,n=>(l(),i("li",null,[e("a",{onClick:d=>t.addRules(n),class:"dropdown-item",href:"javascript:void(0)"},u(n.title||"Не указан"),9,bu)]))),256))])]),s.rulesForm.rules_if?(l(),i("h6",fu,"Выбранные условия")):r("",!0),s.rulesForm.rules_if?(l(),i("ul",gu,[t.hasRuleKey("is_vip")?(l(),i("li",vu,[e("div",$u,[c(e("input",{class:"form-check-input","onUpdate:modelValue":o[1]||(o[1]=n=>s.rulesForm.rules_if.bot_user.is_vip=n),type:"checkbox",id:"bot-user-is-vip"},null,512),[[k,s.rulesForm.rules_if.bot_user.is_vip]]),e("label",yu,[s.rulesForm.rules_if.bot_user.is_vip?(l(),i("span",ku,"Является VIP-пользователем")):(l(),i("span",Fu,"Не является VIP-пользователем"))])]),e("button",{type:"button",class:"btn btn-outline-info",onClick:o[2]||(o[2]=n=>t.removeRule("is_vip"))},wu)])):r("",!0),t.hasRuleKey("is_admin")?(l(),i("li",Su,[e("div",ju,[c(e("input",{class:"form-check-input","onUpdate:modelValue":o[3]||(o[3]=n=>s.rulesForm.rules_if.bot_user.is_admin=n),type:"checkbox",id:"bot-user-is-admin"},null,512),[[k,s.rulesForm.rules_if.bot_user.is_admin]]),e("label",qu,[s.rulesForm.rules_if.bot_user.is_admin?(l(),i("span",zu,"Является администратором")):(l(),i("span",Pu,"Не является администратором"))])]),e("button",{type:"button",class:"btn btn-outline-info",onClick:o[4]||(o[4]=n=>t.removeRule("is_admin"))},Ou)])):r("",!0),t.hasRuleKey("is_deliveryman")?(l(),i("li",Uu,[e("div",Au,[c(e("input",{class:"form-check-input","onUpdate:modelValue":o[5]||(o[5]=n=>s.rulesForm.rules_if.bot_user.is_deliveryman=n),type:"checkbox",id:"bot-user-is-deliveryman"},null,512),[[k,s.rulesForm.rules_if.bot_user.is_deliveryman]]),e("label",Iu,[s.rulesForm.rules_if.bot_user.is_deliveryman?(l(),i("span",Qu,"Является доставщиком")):(l(),i("span",Tu,"Не является доставщиком"))])]),e("button",{type:"button",class:"btn btn-outline-info",onClick:o[6]||(o[6]=n=>t.removeRule("is_deliveryman"))},Ru)])):r("",!0),t.hasRuleKey("is_work")?(l(),i("li",Mu,[e("div",Du,[c(e("input",{class:"form-check-input","onUpdate:modelValue":o[7]||(o[7]=n=>s.rulesForm.rules_if.bot_user.is_work=n),type:"checkbox",id:"bot-user-is-work"},null,512),[[k,s.rulesForm.rules_if.bot_user.is_work]]),e("label",Eu,[s.rulesForm.rules_if.bot_user.is_work?(l(),i("span",Lu,"За работой")):(l(),i("span",Ku,"Не работает"))])]),e("button",{type:"button",class:"btn btn-outline-info",onClick:o[8]||(o[8]=n=>t.removeRule("is_work"))},Ju)])):r("",!0),t.hasRuleKey("user_in_location")?(l(),i("li",Yu,[e("div",Hu,[c(e("input",{class:"form-check-input","onUpdate:modelValue":o[9]||(o[9]=n=>s.rulesForm.rules_if.bot_user.user_in_location=n),type:"checkbox",id:"bot-user-in-location"},null,512),[[k,s.rulesForm.rules_if.bot_user.user_in_location]]),e("label",Gu,[s.rulesForm.rules_if.bot_user.user_in_location?(l(),i("span",Wu,"Находится в заведении")):(l(),i("span",Xu,"Не находится в заведении"))])]),e("button",{type:"button",class:"btn btn-outline-info",onClick:o[10]||(o[10]=n=>t.removeRule("user_in_location"))},xu)])):r("",!0),t.hasRuleKey("age")?(l(),i("li",em,[e("div",null,[tm,c(e("input",{type:"text",class:"form-control",placeholder:"Возраст от","aria-label":"Возраст от","onUpdate:modelValue":o[11]||(o[11]=n=>s.rulesForm.rules_if.bot_user.age=n),maxlength:"255","aria-describedby":"bot-user-age"},null,512),[[_,s.rulesForm.rules_if.bot_user.age]])]),e("button",{type:"button",class:"btn btn-outline-info",onClick:o[12]||(o[12]=n=>t.removeRule("age"))},om)])):r("",!0),t.hasRuleKey("city")?(l(),i("li",lm,[e("div",null,[im,c(e("input",{type:"text",class:"form-control",placeholder:"Город","aria-label":"Город","onUpdate:modelValue":o[13]||(o[13]=n=>s.rulesForm.rules_if.bot_user.city=n),maxlength:"255","aria-describedby":"bot-user-city"},null,512),[[_,s.rulesForm.rules_if.bot_user.city]])]),e("button",{type:"button",class:"btn btn-outline-info",onClick:o[14]||(o[14]=n=>t.removeRule("city"))},am)])):r("",!0),t.hasRuleKey("sex")?(l(),i("li",dm,[e("div",rm,[c(e("input",{class:"form-check-input","onUpdate:modelValue":o[15]||(o[15]=n=>s.rulesForm.rules_if.bot_user.sex=n),type:"checkbox",id:"bot-user-sex"},null,512),[[k,s.rulesForm.rules_if.bot_user.sex]]),e("label",cm,[s.rulesForm.rules_if.bot_user.sex?(l(),i("span",um,"Только для мужчин")):(l(),i("span",mm,"Только для женщин"))])]),e("button",{type:"button",class:"btn btn-outline-info",onClick:o[16]||(o[16]=n=>t.removeRule("sex"))},_m)])):r("",!0),s.rulesForm.rules_if.channels.length>0?(l(),i("li",pm,[m("Проверка нахождения в канале \\ группе: "),(l(!0),i(v,null,y(s.rulesForm.rules_if.channels,(n,d)=>(l(),i("div",bm,[e("div",fm,[e("label",gm,[g(oe,{token:s.bot.bot_token,param:`${d}`,onCallback:t.modifyChannel},null,8,["token","param","onCallback"]),m(" Канал для проверки ")]),e("button",{type:"button",class:"btn btn-link text-danger",onClick:h=>t.removeChannelFromRule(d)},ym,8,vm)]),c(e("input",{type:"text",class:"form-control",placeholder:"id канала","aria-label":"id канала","onUpdate:modelValue":h=>s.rulesForm.rules_if.channels[d]=h,maxlength:"255","aria-describedby":"bot-order-channel"},null,8,km),[[_,s.rulesForm.rules_if.channels[d]]])]))),256))])):r("",!0)])):r("",!0),s.rulesForm.rules_if?(l(),i("h6",Fm,"Иначе")):r("",!0),s.rulesForm.rules_else_page_id?(l(),i("p",Cm,[m("Вы выбрали страницу #"+u(s.rulesForm.rules_else_page_id)+' в качестве условия "иначе" ',1),e("a",{href:"javascript:void(0)",onClick:o[17]||(o[17]=n=>s.rulesForm.rules_else_page_id=null)},"Очистить")])):r("",!0),s.rulesForm.rules_if?(l(),$(B,{key:5,current:s.rulesForm.id,onCallback:t.attachPageToRule,editor:!1},null,8,["current","onCallback"])):r("",!0),s.rulesForm.rules_if?(l(),i("div",wm,[e("label",Sm,[g(a,null,{content:f(()=>[qm]),default:f(()=>[jm]),_:1}),m(" Сообщение в случае невыполнения условий (не обязательно) ")]),c(e("textarea",{type:"text",class:"form-control",placeholder:"Текст сообщения","aria-label":"Текст сообщения","onUpdate:modelValue":o[18]||(o[18]=n=>s.rulesForm.rules_else_message=n),maxlength:"255","aria-describedby":"rules-else-message"},`
            `,512),[[_,s.rulesForm.rules_else_message]])])):r("",!0)],64)}}}),Vm={class:"page-container"},Om={class:"page-content"},Um={class:"row"},Am={class:"col"},Im={class:"row"},Qm={class:"col"},Tm={class:"row"},Bm={class:"col"},Rm={class:"row"},Mm={class:"col-12"},Dm=["innerHTML"],Em={key:0,class:"row"},Lm={class:"col-12"},Km={key:1,class:"row mt-2"},Nm=e("p",{class:"mb-0"},[e("strong",null,"Нижнее меню")],-1),Jm={class:"col-12"},Ym={props:["page"]},Hm=Object.assign(Ym,{__name:"PagePreview",setup(s){return(t,o)=>{const a=A("lazy");return l(),i("div",Vm,[e("div",Om,[e("div",Um,[s.page.images?(l(!0),i(v,{key:0},y(s.page.images,(n,d)=>(l(),i("div",Am,[c(e("img",null,null,512),[[a,"/images-by-bot-id/"+s.page.bot_id+"/"+n]])]))),256)):r("",!0)]),e("div",Im,[s.page.videos?(l(!0),i(v,{key:0},y(s.page.videos,(n,d)=>(l(),i("div",Qm,[g(J,{content:n,type:"video"},null,8,["content"])]))),256)):r("",!0)]),e("div",Tm,[s.page.audios?(l(!0),i(v,{key:0},y(s.page.audios,(n,d)=>(l(),i("div",Bm,[g(J,{content:n,type:"audio"},null,8,["content"])]))),256)):r("",!0)]),e("div",Rm,[e("div",Mm,[e("p",{innerHTML:s.page.content},null,8,Dm)])])]),s.page.inlineKeyboard?(l(),i("div",Em,[e("div",Lm,[s.page.inlineKeyboard.deleted_at?r("",!0):(l(),$(H,{key:0,simple:!0,"select-mode":!0,keyboard:s.page.inlineKeyboard},null,8,["keyboard"]))])])):r("",!0),s.page.replyKeyboard?(l(),i("div",Km,[Nm,e("div",Jm,[s.page.replyKeyboard.deleted_at?r("",!0):(l(),$(H,{key:0,simple:!0,"select-mode":!0,keyboard:s.page.replyKeyboard},null,8,["keyboard"]))])])):r("",!0)])}}});const Gm={key:0,class:"row pt-3"},Wm={class:"col-12"},Xm={class:"alert alert-info",role:"alert"},Zm=e("strong",null,"Внимание!",-1),xm={style:{"font-size":"16px"}},eh={key:0,class:"row"},th={class:"col-12 mb-2"},sh=e("h6",null,"На странице выбраны следующие разделы",-1),oh={class:"mini-pics justify-content-start d-inline-flex text-primary"},lh=e("i",{class:"fa-regular fa-images"},null,-1),ih=[lh],nh=e("i",{class:"fa-regular fa-note-sticky"},null,-1),ah=[nh],dh=e("i",{class:"fa-solid fa-photo-film"},null,-1),rh=[dh],ch=e("i",{class:"fa-regular fa-file-audio"},null,-1),uh=[ch],mh=e("i",{class:"fa-regular fa-file-word"},null,-1),hh=[mh],_h=e("i",{class:"fa-solid fa-link"},null,-1),ph=[_h],bh=e("i",{class:"fa-solid fa-scroll"},null,-1),fh=[bh],gh=e("i",{class:"fa-regular fa-comment-dots"},null,-1),vh=[gh],$h=e("i",{class:"fa-solid fa-scale-balanced"},null,-1),yh=[$h],kh=e("i",{class:"fa-regular fa-keyboard"},null,-1),Fh=[kh],Ch=e("i",{class:"fa-solid fa-ellipsis"},null,-1),wh=[Ch],Sh={class:"row"},jh={class:"col-md-8 col-12 mb-2"},qh={class:"form-label",id:"bot-domain"},zh=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),Ph=e("div",null,[m(" Команда должна начинаться с символа . и *"),e("br"),m(" Например: .*Меню"),e("br")],-1),Vh=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),Oh={class:"col-md-4 col-12 mb-2 d-flex justify-content-end align-items-end"},Uh={class:"btn-group",style:{background:"white"},role:"group","aria-label":"Basic example"},Ah={key:0,type:"submit",title:"Сохранить страницу",id:"save-page-btn",class:"btn btn-primary min-menu-btn"},Ih=e("i",{class:"fa-regular fa-floppy-disk"},null,-1),Qh=[Ih],Th=e("i",{class:"fa-solid fa-xmark text-danger"},null,-1),Bh=[Th],Rh=e("button",{type:"button",title:"Список страниц","data-bs-toggle":"offcanvas","data-bs-target":"#offcanvas",class:"btn btn-outline-primary text-primary min-menu-btn"},[e("i",{class:"fa-solid fa-list-ol"})],-1),Mh={class:"row"},Dh={class:"col-12 mb-2"},Eh={class:"form-label d-flex justify-content-between align-items-center mb-0",id:"bot-domain"},Lh=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),Kh=e("div",null,[m(" Текстовый редактор. Данный текст будет в таком"),e("br"),m(" же виде отображен в посте в телеграм. ")],-1),Nh=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),Jh={class:"form-floating"},Yh={for:"floatingTextarea2"},Hh={key:0},Gh={class:"col-12 mb-2"},Wh={class:"nav nav-tabs justify-content-center"},Xh=e("i",{class:"fa-regular fa-keyboard"},null,-1),Zh=e("span",null,"Нижнее меню",-1),xh=[Xh,Zh],e_=e("i",{class:"fa-solid fa-ellipsis"},null,-1),t_=e("span",null,"Меню под текстом",-1),s_=[e_,t_],o_=e("i",{class:"fa-regular fa-images"},null,-1),l_=e("span",null,"Изображения",-1),i_=[o_,l_],n_=e("i",{class:"fa-solid fa-photo-film"},null,-1),a_=e("span",null,"Видео",-1),d_=[n_,a_],r_=e("i",{class:"fa-regular fa-note-sticky"},null,-1),c_=e("span",null,"Стикеры",-1),u_=[r_,c_],m_=e("i",{class:"fa-regular fa-file-audio"},null,-1),h_=e("span",null,"Аудио",-1),__=[m_,h_],p_=e("i",{class:"fa-regular fa-file-word"},null,-1),b_=e("span",null,"Документы",-1),f_=[p_,b_],g_=e("i",{class:"fa-solid fa-link"},null,-1),v_=e("span",null,"Другая страница",-1),$_=[g_,v_],y_=e("i",{class:"fa-solid fa-scroll"},null,-1),k_=e("span",null,"Скрипт",-1),F_=[y_,k_],C_=e("i",{class:"fa-regular fa-comment-dots"},null,-1),w_=e("span",null,"Начало диалога",-1),S_=[C_,w_],j_=e("i",{class:"fa-solid fa-scale-balanced"},null,-1),q_=e("span",null,"Правила",-1),z_=[j_,q_],P_={key:0,class:"col-12 mb-2"},V_={class:"form-check"},O_=e("label",{class:"form-check-label",for:"need-reply-menu"}," Нижнее меню страницы ",-1),U_={key:1,class:"col-12 mb-2"},A_={class:"card"},I_={class:"card-header d-flex justify-between align-items-center"},Q_=e("h6",null,"Конструктор нижнего меню",-1),T_={key:0},B_={key:1},R_={class:"card-body"},M_={class:"row"},D_={class:"col-12 mb-2"},E_={class:"form-label",id:"bot-domain"},L_=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),K_=e("div",null," Заголовок для нижнего меню ",-1),N_={key:2,class:"col-12 mb-2"},J_={class:"position-relative p-5 text-center text-muted bg-body border border-dashed rounded-2"},Y_={class:"d-flex justify-content-center mb-3"},H_={alt:"",width:"100",height:"100"},G_=e("h1",{class:"text-body-emphasis"},"Нижнее меню",-1),W_=e("p",{class:"col-lg-8 mx-auto fs-5 text-muted"}," Создание и настройка нижнего меню страницы бота. Добавление и редактирование функций кнопок бота на странице. Данное меню отображается пользователю всегда. ",-1),X_={class:"d-inline-flex gap-2 mb-5"},Z_=["disabled"],x_=e("a",{href:"https://telegra.ph/Nizhnee-menyu-bota-01-03",target:"_blank",class:"d-inline-flex align-items-center btn btn-outline-secondary btn-lg px-4 rounded-pill"}," Подробнее ",-1),ep={key:0,class:"col-12 mb-2"},tp={class:"form-check"},sp=e("label",{class:"form-check-label",for:"need-inline-menu"}," Меню под текстом страницы ",-1),op={key:1,class:"col-12 mb-2"},lp={class:"card"},ip={class:"card-header d-flex justify-between align-items-center"},np=e("h6",null,"Конструктор меню в сообщении",-1),ap={key:0},dp={key:1},rp={class:"card-body"},cp={key:2,class:"col-12 mb-2"},up={class:"position-relative p-5 text-center text-muted bg-body border border-dashed rounded-2"},mp={class:"d-flex justify-content-center mb-3"},hp={alt:"",width:"100",height:"100"},_p=e("h1",{class:"text-body-emphasis"},"Меню под текстом",-1),pp=e("p",{class:"col-lg-8 mx-auto fs-5 text-muted"}," В отличии от нижнего меню, которое отображается всегда, меню под текстом показывается под контентом только в момент отображения этого контента. ",-1),bp={class:"d-inline-flex gap-2 mb-5"},fp=["disabled"],gp=e("a",{href:"https://telegra.ph/Menyu-k-tekstu-01-03",target:"_blank",class:"d-inline-flex align-items-center btn btn-outline-secondary btn-lg px-4 rounded-pill"}," Подробнее ",-1),vp={key:0,class:"col-12 mb-2"},$p={class:"form-check"},yp=e("label",{class:"form-check-label",for:"need-page-images"}," Изображения на странице (максимум 10) ",-1),kp={key:1,class:"col-12 mb-2"},Fp={class:"card mb-3"},Cp=e("div",{class:"card-header"},[e("h6",null,"Загрузите изображения с файловой системы")],-1),wp={class:"card-body d-flex justify-content-start"},Sp={for:"photos",style:{"margin-right":"10px"},class:"photo-loader ml-2"},jp={class:"row"},qp={key:0,class:"col-12 d-flex flex-wrap"},zp={class:"mb-2 img-preview",style:{"margin-right":"10px"}},Pp={class:"remove"},Vp=["onClick"],Op={key:1},Up={key:2,class:"col-12 d-flex flex-wrap"},Ap={class:"mb-2 img-preview",style:{"margin-right":"10px"}},Ip={class:"remove"},Qp=["onClick"],Tp={key:2,class:"col-12 mb-2"},Bp={class:"position-relative p-5 text-center text-muted bg-body border border-dashed rounded-2"},Rp={class:"d-flex justify-content-center mb-3"},Mp={alt:"",width:"100",height:"100"},Dp=e("h1",{class:"text-body-emphasis"},"Изображения",-1),Ep=e("p",{class:"col-lg-8 mx-auto fs-5 text-muted"},[m(" Вы можете добавить к одной странице от "),e("b",null,"1"),m(" до "),e("b",null,"10"),m(" изображений. Изображения (от 2х) будут собраны в группу и показаны под текстовым содержимым страницы. Если изображение одно, то текст будет отображен под ним. ")],-1),Lp={class:"d-inline-flex gap-2 mb-5"},Kp=["disabled"],Np=e("a",{href:"https://telegra.ph/Dobavlenie-izobrazhenij-01-03",target:"_blank",class:"d-inline-flex align-items-center btn btn-outline-secondary btn-lg px-4 rounded-pill"}," Подробнее ",-1),Jp={key:0,class:"col-12 mb-2"},Yp={class:"form-check"},Hp=e("label",{class:"form-check-label",for:"need-page-video"}," Видео к странице ",-1),Gp={key:1,class:"col-12 mb-2"},Wp={key:2,class:"col-12 mb-2"},Xp={class:"position-relative p-5 text-center text-muted bg-body border border-dashed rounded-2"},Zp={class:"d-flex justify-content-center mb-3"},xp={alt:"",width:"100",height:"100"},eb=e("h1",{class:"text-body-emphasis"},"Видео",-1),tb=e("p",{class:"col-lg-8 mx-auto fs-5 text-muted"},[m(" Вы можете добавить к одной странице от "),e("b",null,"1"),m(" до "),e("b",null,"10"),m(" видео. Ролики (от 2х) будут собраны в группу и показаны под текстовым содержимым страницы. ")],-1),sb={class:"d-inline-flex gap-2 mb-5"},ob=["disabled"],lb=e("a",{href:"https://telegra.ph/Dobavlenie-video-na-stranicu-01-03",target:"_blank",class:"d-inline-flex align-items-center btn btn-outline-secondary btn-lg px-4 rounded-pill"}," Подробнее ",-1),ib={key:0,class:"col-12 mb-2"},nb={class:"form-check"},ab=e("label",{class:"form-check-label",for:"need-page-sticker"}," Стикер к странице ",-1),db={key:1,class:"col-12 mb-2"},rb={key:2,class:"col-12 mb-2"},cb={class:"position-relative p-5 text-center text-muted bg-body border border-dashed rounded-2"},ub={class:"d-flex justify-content-center mb-3"},mb={alt:"",width:"100",height:"100"},hb=e("h1",{class:"text-body-emphasis"},"Стикеры",-1),_b=e("p",{class:"col-lg-8 mx-auto fs-5 text-muted"}," Вы можете переслать любой стикер в бота (от лица администратора) и затем этот стикер использовать для взаимодействия с пользователем. ",-1),pb={class:"d-inline-flex gap-2 mb-5"},bb=["disabled"],fb=e("a",{href:"https://telegra.ph/Dobavlenie-stikera-na-stranicu-01-03",target:"_blank",class:"d-inline-flex align-items-center btn btn-outline-secondary btn-lg px-4 rounded-pill"}," Подробнее ",-1),gb={key:0,class:"col-12 mb-2"},vb={class:"form-check"},$b=e("label",{class:"form-check-label",for:"need-page-audio"}," Звук к странице ",-1),yb={key:1,class:"col-12 mb-2"},kb={key:2,class:"col-12 mb-2"},Fb={class:"position-relative p-5 text-center text-muted bg-body border border-dashed rounded-2"},Cb={class:"d-flex justify-content-center mb-3"},wb={alt:"",width:"100",height:"100"},Sb=e("h1",{class:"text-body-emphasis"},"Аудио",-1),jb=e("p",{class:"col-lg-8 mx-auto fs-5 text-muted"},[m(" Вы можете добавить к одной странице от "),e("b",null,"1"),m(" до "),e("b",null,"10"),m(" аудио. Музыка (от 2х) будет собрана в группу и показана под текстовым содержимым страницы. Если вы хотите использовать "),e("b",{class:"text-danger"},"голосовое"),m(", то можно использовать максимум "),e("b",{class:"text-danger"},"одну запись"),m(". Или же, вы можете конвертировать её в mp3 и залить как музыкальный файл в бота. ")],-1),qb={class:"d-inline-flex gap-2 mb-5"},zb=["disabled"],Pb=e("a",{href:"https://telegra.ph/Dobavlenie-audio-na-stranicu-01-03",target:"_blank",class:"d-inline-flex align-items-center btn btn-outline-secondary btn-lg px-4 rounded-pill"}," Подробнее ",-1),Vb={key:0,class:"col-12 mb-2"},Ob={class:"form-check"},Ub=e("label",{class:"form-check-label",for:"need-page-document"}," Документ \\ презентацию к странице \\ картинку в оригинале ",-1),Ab={key:1,class:"col-12 mb-2"},Ib={key:2,class:"col-12 mb-2"},Qb={class:"position-relative p-5 text-center text-muted bg-body border border-dashed rounded-2"},Tb={class:"d-flex justify-content-center mb-3"},Bb={alt:"",width:"100",height:"100"},Rb=e("h1",{class:"text-body-emphasis"},"Документы",-1),Mb=e("p",{class:"col-lg-8 mx-auto fs-5 text-muted"},[m(" Вы можете добавить к одной странице от "),e("b",null,"1"),m(" до "),e("b",null,"10"),m(" документов. Документы (от 2х) будут собраны в группу и показана под текстовым содержимым страницы. В качестве файлов вы можете использовать текстовые документы, презентации, файлы-pdf, изображения в оригинальном размере. ")],-1),Db={class:"d-inline-flex gap-2 mb-5"},Eb=["disabled"],Lb=e("a",{href:"https://telegra.ph/Dobavlenie-dokumenta-01-03",target:"_blank",class:"d-inline-flex align-items-center btn btn-outline-secondary btn-lg px-4 rounded-pill"}," Подробнее ",-1),Kb={class:"col-12 mb-2"},Nb={class:"position-relative p-5 text-center text-muted bg-body border border-dashed rounded-2"},Jb={class:"d-flex justify-content-center mb-3"},Yb={alt:"",width:"100",height:"100"},Hb=e("h1",{class:"text-body-emphasis"},"Связь со страницей",-1),Gb=e("p",{class:"col-lg-8 mx-auto fs-5 text-muted"}," Вы можете привязать вызов другой страницы непосредственно после вызова текущей. Это позволит выводить контент по цепочке для пользователя. ",-1),Wb={key:0,class:"my-3 text-success font-bold"},Xb={class:"d-inline-flex gap-2 mb-5"},Zb={key:1,"data-bs-toggle":"modal","data-bs-target":"#page-list-modal",class:"d-inline-flex align-items-center btn btn-lg px-4 rounded-pill btn-primary",type:"button"},xb=e("a",{href:"https://telegra.ph/Svyazyvanie-so-stranicej-01-03",target:"_blank",class:"d-inline-flex align-items-center btn btn-outline-secondary btn-lg px-4 rounded-pill"}," Подробнее ",-1),ef=e("h6",{class:"mb-3"},"Конструктор цепочек",-1),tf={class:"d-flex justify-content-center align-items-center flex-wrap"},sf=e("span",{class:"px-2"},"Текущая страница",-1),of=e("i",{class:"fa-solid fa-arrow-right"},null,-1),lf={class:"d-flex justify-content-center align-items-center px-3 py-2"},nf=["onClick"],af={class:"position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger"},df={key:0,class:"fa-solid fa-arrow-right ml-2"},rf={key:0,class:"fa-solid fa-arrow-right"},cf=e("button",{type:"button","data-bs-toggle":"modal","data-bs-target":"#page-list-modal",class:"btn btn-outline-secondary position-relative rounded-5 ml-5"},[e("i",{class:"fa-solid fa-plus"})],-1),uf={key:0,class:"col-12 mb-2"},mf=e("div",{class:"alert alert-info",role:"alert"}," Если в вашем боте нет каких-то предустановленных скриптов вы можете найти их в глобальном магазине скриптов ",-1),hf={class:"form-check"},_f=e("label",{class:"form-check-label",for:"need-show-global-slug-list"}," Добавить скрипты из глобального магазина? ",-1),pf={key:1,class:"col-12 mb-2"},bf={class:"form-check"},ff=e("label",{class:"form-check-label",for:"need-slug-attach"}," Привязать скрипт ",-1),gf={key:2,class:"col-12 mb-2"},vf={key:0,class:"alert alert-success d-flex justify-content-between align-items-center",role:"alert"},$f={key:3,class:"col-12 mb-2"},yf={class:"position-relative p-5 text-center text-muted bg-body border border-dashed rounded-2"},kf={class:"d-flex justify-content-center mb-3"},Ff={alt:"",width:"100",height:"100"},Cf=e("h1",{class:"text-body-emphasis"},"Скрипты",-1),wf=e("p",{class:"col-lg-8 mx-auto fs-5 text-muted"}," Скрипты содержат основной функционал системы. Вы можете к каждой странице привязать один скрипт, который будет вызван после вывода основного содержимого страницы. ",-1),Sf={class:"d-inline-flex gap-2 mb-5"},jf=["disabled"],qf=e("a",{href:"https://telegra.ph/Svyazyvanie-so-skriptom-01-03",target:"_blank",class:"d-inline-flex align-items-center btn btn-outline-secondary btn-lg px-4 rounded-pill"}," Подробнее ",-1),zf={key:0,class:"col-12 mb-2"},Pf={class:"form-check"},Vf=e("label",{class:"form-check-label",for:"need-dialog-attach"}," Привязать начало диалога ",-1),Of={key:1,class:"col-12 mb-2"},Uf={key:0},Af={key:2,class:"col-12 mb-2"},If={class:"position-relative p-5 text-center text-muted bg-body border border-dashed rounded-2"},Qf={class:"d-flex justify-content-center mb-3"},Tf={alt:"",width:"100",height:"100"},Bf=e("h1",{class:"text-body-emphasis"},"Диалоги",-1),Rf=e("p",{class:"col-lg-8 mx-auto fs-5 text-muted"}," Диалоги страницы - это инструмент запроса данных от пользователя. Вы можете привязать начало диалога к странице, а сам диалог будет вызван по цепочке. ",-1),Mf={class:"d-inline-flex gap-2 mb-5"},Df=["disabled"],Ef=e("a",{href:"https://telegra.ph/Dobavlenie-dialoga-01-03",target:"_blank",class:"d-inline-flex align-items-center btn btn-outline-secondary btn-lg px-4 rounded-pill"}," Подробнее ",-1),Lf={key:0,class:"col-12 mb-2"},Kf={class:"form-check"},Nf=e("label",{class:"form-check-label",for:"need-rules"}," Нужны правила загрузки страницы ",-1),Jf={key:1,class:"col-12 mb-2"},Yf={key:2,class:"col-12 mb-2"},Hf={class:"position-relative p-5 text-center text-muted bg-body border border-dashed rounded-2"},Gf={class:"d-flex justify-content-center mb-3"},Wf={alt:"",width:"100",height:"100"},Xf=e("h1",{class:"text-body-emphasis"},"Правила отображения страницы",-1),Zf=e("p",{class:"col-lg-8 mx-auto fs-5 text-muted"}," Вы можете создать правила, согласно которым будет отображена та или иная страница. Вы можете перенаправить пользователя с одной страницы на другую, в случае если ваше условие не выполнено. ",-1),xf={class:"d-inline-flex gap-2 mb-5"},eg=["disabled"],tg=e("a",{href:"https://telegra.ph/Pravila-na-stranice-01-03",target:"_blank",class:"d-inline-flex align-items-center btn btn-outline-secondary btn-lg px-4 rounded-pill"}," Подробнее ",-1),sg=e("div",{class:"row"},[e("div",{class:"col-12"},[e("div",{class:"alert alert-info",role:"alert"},[e("h6",null,"Страница поддерживает комбинации клавиш:"),e("ul",{class:"mb-0 mr-0 p-0"},[e("li",null,[e("strong",null,"Ctrl+S"),m(" - открыть\\закрыть окно сохранения")]),e("li",null,[e("strong",null,"Ctrl+D"),m(" - просмотр страницы (для сохраненных страниц)")]),e("li",null,[e("strong",null,"Ctrl+пробел"),m(" - открыть\\закрыть список страниц")]),e("li",null,[e("strong",null,"Ctrl+backspace"),m(" - очистить страницу\\новая страница")]),e("li",null,[e("strong",null,"Ctrl+стрелка вправо"),m(" - переключение между вкладка вперед")]),e("li",null,[e("strong",null,"Ctrl+стрелка влево"),m(" - переключение между вкладка назад")])])])])],-1),og={class:"modal fade",id:"save-modal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},lg={class:"modal-dialog"},ig={class:"modal-content"},ng=e("div",{class:"modal-header"},[e("h5",{class:"modal-title",id:"exampleModalLabel"},"Сохранение страницы"),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),ag={class:"modal-body"},dg={key:0,class:"row"},rg={class:"col-12 mb-2"},cg={class:"d-flex justify-between"},ug=["href"],mg={class:"col-12 mb-2"},hg=e("h6",null,"На странице выбраны следующие разделы",-1),_g={class:"mini-pics text-primary"},pg=e("i",{class:"fa-regular fa-images"},null,-1),bg=[pg],fg=e("i",{class:"fa-regular fa-note-sticky"},null,-1),gg=[fg],vg=e("i",{class:"fa-solid fa-photo-film"},null,-1),$g=[vg],yg=e("i",{class:"fa-regular fa-file-audio"},null,-1),kg=[yg],Fg=e("i",{class:"fa-regular fa-file-word"},null,-1),Cg=[Fg],wg=e("i",{class:"fa-solid fa-link"},null,-1),Sg=[wg],jg=e("i",{class:"fa-solid fa-scroll"},null,-1),qg=[jg],zg=e("i",{class:"fa-regular fa-comment-dots"},null,-1),Pg=[zg],Vg=e("i",{class:"fa-solid fa-scale-balanced"},null,-1),Og=[Vg],Ug=e("i",{class:"fa-regular fa-keyboard"},null,-1),Ag=[Ug],Ig=e("i",{class:"fa-solid fa-ellipsis"},null,-1),Qg=[Ig],Tg={key:0,class:"col-12 mb-2"},Bg={class:"form-check"},Rg=e("label",{class:"form-check-label",for:"need-show-qr-and-link"}," Показать ссылку на страницу и QR-код ",-1),Mg={key:1,class:"col-12 mb-2"},Dg={class:"d-flex justify-content-center"},Eg={style:{width:"200px",height:"200px"}},Lg={class:"col-12 mb-2"},Kg={class:"form-label",id:"bot-domain"},Ng=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),Jg=e("div",null,"Напишите для себя пояснение для чего нужна данная страница. Это поможет другим менеджерам лучше понять Вас. ",-1),Yg=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),Hg={class:"col-12"},Gg={class:"form-check"},Wg=e("label",{class:"form-check-label",for:"is-external"}," Внешнее управление страницей ",-1),Xg={key:0,class:"alert alert-danger",role:"alert"},Zg={key:0,class:"mb-0"},xg=e("strong",null,'"Информация о боте"',-1),e1=e("strong",null,"Другие настройки",-1),t1=e("strong",null,'"Ссылка на внешний сервис обработки данных"',-1),s1={class:"col-12"},o1={class:"form-check"},l1=e("label",{class:"form-check-label",for:"need_log_user_action"}," Логгировать действия пользователя в канал при переходе ",-1),i1={class:"col-12"},n1={class:"form-check"},a1=e("label",{class:"form-check-label",for:"need-stay-after-save"}," Остаться на текущей странице после сохранения ",-1),d1=e("div",{class:"col-12"},[e("button",{type:"submit",id:"submit-page",class:"btn btn-success w-100 p-3"},"Сохранить ")],-1),r1=e("div",{class:"modal-footer"},[e("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Не сохранять")],-1),c1={class:"modal fade",id:"page-list-modal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},u1={class:"modal-dialog"},m1={class:"modal-content"},h1={class:"modal-body"},_1={class:"modal fade",id:"page-preview-modal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},p1={class:"modal-dialog"},b1={class:"modal-content"},f1={class:"modal-body"},g1={key:1},v1={class:"offcanvas offcanvas-end w-25",tabindex:"-1",id:"offcanvas","data-bs-keyboard":"true","data-bs-scroll":"true","data-bs-backdrop":"true"},$1=e("div",{class:"offcanvas-header"},[e("h6",{class:"offcanvas-title d-none d-sm-block",id:"offcanvas"},"Ваши страницы (кнопки)"),e("button",{type:"button",class:"btn-close text-reset","data-bs-dismiss":"offcanvas","aria-label":"Close"})],-1),y1={class:"offcanvas-body"},k1={class:"row"},F1={class:"col-12"},C1={data(){return{tab:0,links:[],saveModal:null,pageModal:null,pagePreviewModal:null,page:null,need_show_qr_and_link:!1,need_stay_after_save:!0,need_show_global_slug_list:!1,need_clean:!1,load:!1,photos:[],showReplyTemplateSelector:!1,showInlineTemplateSelector:!1,loaded_page_list:!0,load_slug_simple_list:!0,showMenu:!1,need_page_sticker:!1,need_page_audios:!1,need_page_documents:!1,need_page_video:!1,need_page_images:!1,need_inline_menu:!1,need_reply_menu:!1,need_attach_page:!1,need_attach_dialog:!1,need_attach_slug:!1,need_rules:!1,bot:null,pageForm:{id:null,content:"",command:null,slug:null,comment:null,videos:[],images:[],audios:[],documents:[],sticker:null,reply_keyboard_title:null,reply_keyboard:null,reply_keyboard_settings:null,inline_keyboard:null,is_external:!1,need_log_user_action:!1,next_page_id:null,next_bot_dialog_command_id:null,next_bot_menu_slug_id:null,rules_if:null,rules_else_page_id:null,rules_if_message:null,rules_else_message:null}}},watch:{need_page_images:function(s,t){this.need_page_images||(this.photos=[],this.pageForm.images=[])},need_page_audios:function(s,t){this.need_page_audios||(this.pageForm.audios=[])},need_page_documents:function(s,t){this.need_page_documents||(this.pageForm.documents=[])},need_page_sticker:function(s,t){this.need_page_sticker||(this.pageForm.sticker=null)},need_page_video:function(s,t){this.need_page_video||(this.pageForm.videos=[])},need_inline_menu:function(s,t){this.need_inline_menu||(this.pageForm.inline_keyboard=null,this.pageForm.inline_keyboard_id=null)},need_rules:function(s,t){this.need_rules||(this.pageForm.rules_if=null,this.pageForm.rules_else_page_id=null,this.pageForm.rules_if_message=null,this.pageForm.rules_else_message=null)},need_reply_menu:function(s,t){this.need_reply_menu||(this.pageForm.reply_keyboard=null,this.pageForm.reply_keyboard_id=null)},need_attach_page:function(s,t){this.need_attach_page||(this.pageForm.next_page_id=null)},need_attach_dialog:function(s,t){this.need_attach_dialog||(this.pageForm.next_bot_dialog_command_id=null)},need_attach_slug:function(s,t){this.need_attach_slug||(this.pageForm.next_bot_menu_slug_id=null)},pageForm:{handler:function(s){this.pageForm.reply_keyboard!=null&&(this.need_reply_menu=!0),this.pageForm.inline_keyboard!=null&&(this.need_inline_menu=!0),this.pageForm.images.length>0&&(this.need_page_images=!0),this.pageForm.next_bot_dialog_command_id!=null&&(this.need_attach_dialog=!0),this.pageForm.next_bot_menu_slug_id!=null&&(this.need_attach_slug=!0),this.pageForm.next_page_id!=null&&(this.need_attach_page=!0),this.pageForm.rules_if!=null&&(this.need_rules=!0),this.pageForm.videos.length>0&&(this.need_page_video=!0),this.pageForm.audios.length>0&&(this.need_page_audios=!0),this.pageForm.documents.length>0&&(this.need_page_documents=!0),this.pageForm.sticker&&(this.need_page_sticker=!0),this.need_clean=!0},deep:!0}},computed:{...w(["getCurrentBot"]),qr(){return"https://api.qrserver.com/v1/create-qr-code/?size=450x450&qzone=2&data="+this.link},selectedLinkIds(){let s=this.links.map(t=>t.id);return this.page==null?s:this.page.id!=null?[this.page.id,...s]:s},hasParts(){return this.need_page_sticker||this.need_page_audios||this.need_page_documents||this.need_page_video||this.need_page_images||this.need_inline_menu||this.need_reply_menu||this.need_attach_page||this.need_attach_dialog||this.need_attach_slug||this.need_rules},pageLink(){if(!this.pageForm.id)return"Ссылка недоступна";let s="";for(let t=0;t<10-(""+this.pageForm.id).length;t++)s+="0";return s+=this.pageForm.id,"https://t.me/"+this.getCurrentBot.bot_domain+"?start="+btoa("004"+s)}},mounted(){this.page?this.preparePageForm(this.page):this.clearForm(),this.loadCurrentBot().then(()=>{this.saveModal=new bootstrap.Modal(document.getElementById("save-modal"),{})}),this.pageModal=new bootstrap.Offcanvas(document.getElementById("offcanvas"),{scroll:!0}),this.pagePreviewModal=new bootstrap.Modal(document.getElementById("page-preview-modal"),{}),window.addEventListener("keydown",s=>{if(s.ctrlKey&&s.keyCode==8&&(s.preventDefault(),this.clearForm()),s.ctrlKey&&s.code=="KeyD"&&(s.preventDefault(),this.pagePreviewModal.toggle()),s.ctrlKey&&s.keyCode==32&&(s.preventDefault(),this.pageModal.toggle()),s.ctrlKey&&s.code=="KeyS"){s.preventDefault();const t=document.querySelector("#save-page-btn");t?t.click():this.$notify({title:"Конструктор страниц",text:"Вы еще не начали создавать страницу!",type:"warning"})}s.ctrlKey&&s.keyCode==39&&(s.preventDefault(),this.tab===10?this.tab=0:this.tab++),s.ctrlKey&&s.keyCode==37&&(s.preventDefault(),this.tab===0?this.tab=10:this.tab--)})},methods:{chainCollapseTest(s){return this.page==null?this.links.filter(t=>t.id==s.id).length>1:[this.page,...this.links].filter(t=>t.id==s.id).length>1},loadPageChains(){return this.$store.dispatch("loadPageChains",{dataObject:{start_page_id:this.page.id}}).then(s=>{this.links=s.data})},removeLink(s){this.links.splice(s,1)},loadSlugs(){this.load_slug_simple_list=!1,this.need_show_global_slug_list=!1,this.$nextTick(()=>{this.load_slug_simple_list=!0})},preparePageForm(s){this.links=[],this.page=s,this.photos=[],this.$nextTick(()=>{this.pageForm={id:s.id,slug_id:s.slug?s.slug.id:null,content:s.content,command:s.slug?s.slug.command:null,slug:s.slug?s.slug.slug:null,comment:s.slug?s.slug.comment:null,images:s.images||[],sticker:s.sticker||null,reply_keyboard_title:s.reply_keyboard_title||null,reply_keyboard_id:s.reply_keyboard_id||null,inline_keyboard_id:s.inline_keyboard_id||null,reply_keyboard:s.replyKeyboard||null,inline_keyboard:s.inlineKeyboard||null,next_page_id:s.next_page_id||null,next_bot_dialog_command_id:s.next_bot_dialog_command_id||null,next_bot_menu_slug_id:s.next_bot_menu_slug_id||null,is_external:s.is_external||!1,need_log_user_action:s.need_log_user_action||!1,rules_if:s.rules_if||null,rules_else_page_id:s.rules_else_page_id||null,audios:s.audios||[],documents:s.documents||[],videos:s.videos||[],rules_if_message:s.rules_if_message||null,rules_else_message:s.rules_else_message||null},this.pageForm.id!=null&&this.pageForm.next_page_id!=null&&this.loadPageChains()})},copyToClipBoard(s){navigator.clipboard.writeText(s).then(()=>{this.$notify({title:"Копирование",text:"Ссылка скопирована в буфер"})}).catch(t=>{this.$notify({title:"Копирование",text:"Ошибка копирования",type:"error"})})},associateDialog(s){this.pageForm.next_bot_dialog_command_id=s.id},associateSlug(s){this.pageForm.next_bot_menu_slug_id=s.id},loadCurrentBot(s=null){return this.$store.dispatch("updateCurrentBot",{bot:s}).then(()=>{this.bot=this.getCurrentBot})},clearLinks(){this.links=[],this.pageForm.next_page_id=null},attachPage(s){this.links.length==0&&(s.id!=this.pageForm.id?(this.$notify({title:"Конструктор страниц",text:"Вы успешно связали страницы!",type:"success"}),this.pageForm.next_page_id=s.id):this.$notify({title:"Конструктор страниц",text:"Вы не можете связать данную страницу с собой",type:"error"})),(this.page==null?this.links.findIndex(o=>o.id===s.id)!=-1:this.links.findIndex(o=>o.id===s.id)!=-1||s.id===this.page.id)||this.links.push(s)},injectContent(s){this.pageForm.content?this.pageForm.content+=s.text:this.pageForm.content=s.text},clearForm(){this.photos=[],this.pageForm={id:null,content:null,command:null,slug:null,comment:null,sticker:null,images:[],reply_keyboard:null,inline_keyboard:null,is_external:!1,need_log_user_action:!1,videos:[],audios:[],documents:[],reply_keyboard_title:null,reply_keyboard_id:null,inline_keyboard_id:null,next_page_id:null,next_menu_slug:null,next_bot_dialog_command_id:null,next_bot_menu_slug_id:null,rules_if_message:null,rules_else_message:null},this.photos=[],this.showReplyTemplateSelector=!1,this.showInlineTemplateSelector=!1,this.need_page_images=!1,this.need_page_video=!1,this.need_inline_menu=!1,this.need_reply_menu=!1,this.need_attach_page=!1,this.need_attach_dialog=!1,this.need_attach_slug=!1,this.need_rules=!1,this.need_page_audios=!1,this.need_page_documents=!1,this.need_page_sticker=!1,this.links=[],this.$nextTick(()=>{this.need_clean=!1})},openSaveModal(){(this.pageForm.comment||"").length===0&&(this.pageForm.comment=this.pageForm.command),this.saveModal.show()},submitPage(){let s=new FormData;if(Object.keys(this.pageForm).forEach(t=>{const o=this.pageForm[t]||"";typeof o=="object"?s.append(t,JSON.stringify(o)):s.append(t,o)}),this.bot&&s.append("bot_id",this.bot.id),this.photos.length>0)for(let t=0;t<this.photos.length;t++)s.append("photos[]",this.photos[t]);this.$store.dispatch(this.pageForm.id==null?"createPage":"updatePage",{pageForm:s}).then(t=>{this.pageForm.id==null&&this.preparePageForm(t.data),this.links.length>0&&this.$store.dispatch("storePageChains",{dataObject:{start_page_id:t.data.id,links:this.links.map(o=>o.id)}}),this.need_stay_after_save||(this.load=!0,this.$nextTick(()=>{this.load=!1,this.clearForm()})),this.loaded_page_list=!1,this.$nextTick(()=>{this.loaded_page_list=!0}),this.saveModal.hide(),this.$emit("callback",t.data),this.$notify({title:"Конструктор ботов",text:this.pageForm.id==null?"Страница успешно создана!":"Страница успешно обновлена!",type:"success"}),this.$store.dispatch("loadPages",{dataObject:{botId:this.bot.id,needNewFirst:!0},page:localStorage.getItem(`cashman_pagelist_${this.bot.id}_page_index`)||0})}).catch(t=>{})},saveInlineKeyboard(s){this.pageForm.inline_keyboard=s},selectReplyKeyboard(s){this.pageForm.reply_keyboard=s,this.showReplyTemplateSelector=!1},selectInlineKeyboard(s){this.pageForm.inline_keyboard=s,this.showInlineTemplateSelector=!1},saveReplyKeyboard(s){this.pageForm.reply_keyboard=s},saveReplyKeyboardSettings(s){this.pageForm.reply_keyboard_settings=s},getPhoto(s){return{imageUrl:URL.createObjectURL(s)}},removePhoto(s){this.photos.splice(s,1)},removeImage(s){this.pageForm.images.splice(s,1)},onChangePhotos(s){const t=s.target.files;for(let o=0;o<t.length;o++)this.photos.push(t[o])},onChange(s){this.pageForm.content=s},selectPhoto(s){this.pageForm.images||(this.pageForm.images=[]);let t=this.pageForm.images.indexOf(s.file_id);t!==-1?this.pageForm.images.splice(t,1):this.pageForm.images.push(s.file_id)},selectSticker(s){this.pageForm.sticker=s.file_id},selectVideo(s){this.pageForm.videos||(this.pageForm.videos=[]);let t=this.pageForm.videos.indexOf(s.file_id);t!==-1?this.pageForm.videos.splice(t,1):this.pageForm.videos.push(s.file_id)},selectAudio(s){this.pageForm.audios||(this.pageForm.audios=[]);let t=this.pageForm.audios.indexOf(s.file_id);if(s.type==="voice"){if(t!==-1){this.pageForm.audios.splice(t,1);return}this.pageForm.audios=[s.file_id];return}t!==-1?this.pageForm.audios.splice(t,1):this.pageForm.audios.push(s.file_id)},selectDocument(s){this.pageForm.documents||(this.pageForm.documents=[]);let t=this.pageForm.documents.indexOf(s.file_id);t!==-1?this.pageForm.documents.splice(t,1):this.pageForm.documents.push(s.file_id)},pageListCallback(s){this.$notify("Вы выбрали страницу из списка! Все остальные действия будут производится для этой страницы"),this.load=!0,this.preparePageForm(s),this.$nextTick(()=>{this.load=!1})}}},w1=Object.assign(C1,{__name:"Page",setup(s){return(t,o)=>{const a=q("Popper"),n=A("lazy");return l(),i(v,null,[t.pageForm.id?(l(),i("div",Gm,[e("div",Wm,[e("div",Xm,[Zm,m(" Вы в режиме редактирования страницы (кнопки) "),e("strong",xm,u(t.page.slug?t.page.slug.command:"Без названия"),1),m(", если хотите создать новую нажмите "),e("a",{href:"javascript:void(0)",class:"btn btn-primary ml-2",onClick:o[0]||(o[0]=(...d)=>t.clearForm&&t.clearForm(...d))},"Создать новую страницу")])])])):r("",!0),t.bot?(l(),i("form",{key:1,id:"page-construct",class:"py-3",onSubmit:o[43]||(o[43]=S((...d)=>t.openSaveModal&&t.openSaveModal(...d),["prevent"]))},[t.hasParts?(l(),i("div",eh,[e("div",th,[sh,e("ul",oh,[e("li",{class:p(["mr-1",{active:t.need_page_images}]),title:"Изображения"},ih,2),e("li",{class:p(["mr-1",{active:t.need_page_sticker}]),title:"Стикеры"},ah,2),e("li",{class:p(["mr-1",{active:t.need_page_video}]),title:"Видео"},rh,2),e("li",{class:p(["mr-1",{active:t.need_page_audios}]),title:"Аудио"},uh,2),e("li",{class:p(["mr-1",{active:t.need_page_documents}]),title:"Документы"},hh,2),e("li",{class:p(["mr-1",{active:t.need_attach_page}]),title:"Страницы"},ph,2),e("li",{class:p(["mr-1",{active:t.need_attach_slug}]),title:"Скрипты"},fh,2),e("li",{class:p(["mr-1",{active:t.need_attach_dialog}]),title:"Диалоги"},vh,2),e("li",{class:p(["mr-1",{active:t.need_rules}]),title:"Правила"},yh,2),e("li",{class:p(["mr-1",{active:t.need_reply_menu}]),title:"Нижнее меню"},Fh,2),e("li",{title:"Текстовое меню",class:p({active:t.need_inline_menu})},wh,2)])])])):r("",!0),e("div",Sh,[e("div",jh,[e("label",qh,[g(a,null,{content:f(()=>[Ph]),default:f(()=>[zh]),_:1}),m(" Команда "),Vh]),c(e("input",{type:"text",class:"form-control",placeholder:"Команда","aria-label":"Команда","onUpdate:modelValue":o[1]||(o[1]=d=>t.pageForm.command=d),maxlength:"255","aria-describedby":"bot-domain",required:""},null,512),[[_,t.pageForm.command]])]),e("div",Oh,[e("div",Uh,[t.pageForm.id||t.need_clean?(l(),i("button",Ah,Qh)):r("",!0),t.pageForm.id||t.need_clean?(l(),i("button",{key:1,type:"button",onClick:o[2]||(o[2]=(...d)=>t.clearForm&&t.clearForm(...d)),title:"Очистить \\ Новая страница",class:"btn btn-outline-primary min-menu-btn"},Bh)):r("",!0),Rh])])]),c(e("div",Mh,[e("div",Dh,[e("label",Eh,[e("div",null,[g(a,null,{content:f(()=>[Kh]),default:f(()=>[Lh]),_:1}),m(" Текстовое содержимое страницы "),Nh]),g($t,{param:"content",onCallback:t.injectContent},null,8,["onCallback"])]),e("div",Jh,[c(e("textarea",{class:"form-control","onUpdate:modelValue":o[3]||(o[3]=d=>t.pageForm.content=d),maxlength:"4096",placeholder:"Введите текст",id:"floatingTextarea2",style:{"min-height":"150px"}},null,512),[[_,t.pageForm.content]]),e("label",Yh,[m("Содержимое страницы "),t.pageForm.content?(l(),i("span",Hh,u(t.pageForm.content.length)+"/4096 ",1)):r("",!0)])])]),e("div",Gh,[e("ul",Wh,[e("li",{class:"nav-item",onClick:o[4]||(o[4]=d=>t.tab=0)},[e("a",{class:p([{active:t.tab===0,"primary-mark":t.need_reply_menu},"nav-link d-flex flex-column justify-content-center align-items-center font-12"]),href:"javascript:void(0)"},xh,2)]),e("li",{class:"nav-item",onClick:o[5]||(o[5]=d=>t.tab=1)},[e("a",{class:p([{active:t.tab===1,"primary-mark":t.need_inline_menu},"nav-link d-flex flex-column justify-content-center align-items-center font-12"]),href:"javascript:void(0)"},s_,2)]),e("li",{class:"nav-item",onClick:o[6]||(o[6]=d=>t.tab=2)},[e("a",{class:p([{active:t.tab===2,"primary-mark":t.need_page_images},"nav-link d-flex flex-column justify-content-center align-items-center font-12"]),href:"javascript:void(0)"},i_,2)]),e("li",{class:"nav-item",onClick:o[7]||(o[7]=d=>t.tab=3)},[e("a",{class:p([{active:t.tab===3,"primary-mark":t.need_page_video},"nav-link d-flex flex-column justify-content-center align-items-center font-12"]),href:"javascript:void(0)"},d_,2)]),e("li",{class:"nav-item",onClick:o[8]||(o[8]=d=>t.tab=4)},[e("a",{class:p([{active:t.tab===4,"primary-mark":t.need_page_sticker},"nav-link d-flex flex-column justify-content-center align-items-center font-12"]),href:"javascript:void(0)"},u_,2)]),e("li",{class:"nav-item",onClick:o[9]||(o[9]=d=>t.tab=5)},[e("a",{class:p([{active:t.tab===5,"primary-mark":t.need_page_audios},"nav-link d-flex flex-column justify-content-center align-items-center font-12"]),href:"javascript:void(0)"},__,2)]),e("li",{class:"nav-item",onClick:o[10]||(o[10]=d=>t.tab=6)},[e("a",{class:p([{active:t.tab===6,"primary-mark":t.need_page_documents},"nav-link d-flex flex-column justify-content-center align-items-center font-12"]),href:"javascript:void(0)"},f_,2)]),e("li",{class:"nav-item",onClick:o[11]||(o[11]=d=>t.tab=7)},[e("a",{class:p([{active:t.tab===7,"primary-mark":t.need_attach_page},"nav-link d-flex flex-column justify-content-center align-items-center font-12"]),href:"javascript:void(0)"},$_,2)]),e("li",{class:"nav-item",onClick:o[12]||(o[12]=d=>t.tab=8)},[e("a",{class:p([{active:t.tab===8,"primary-mark":t.need_attach_slug},"nav-link d-flex flex-column justify-content-center align-items-center font-12"]),href:"javascript:void(0)"},F_,2)]),e("li",{class:"nav-item",onClick:o[13]||(o[13]=d=>t.tab=9)},[e("a",{class:p([{active:t.tab===9,"primary-mark":t.need_attach_dialog},"nav-link d-flex flex-column justify-content-center align-items-center font-12"]),href:"javascript:void(0)"},S_,2)]),e("li",{class:"nav-item",onClick:o[14]||(o[14]=d=>t.tab=10)},[e("a",{class:p([{active:t.tab===10,"primary-mark":t.need_rules},"nav-link d-flex flex-column justify-content-center align-items-center font-12"]),href:"javascript:void(0)"},z_,2)])])]),c(e("div",null,[t.need_reply_menu?(l(),i("div",P_,[e("div",V_,[c(e("input",{class:"form-check-input","onUpdate:modelValue":o[15]||(o[15]=d=>t.need_reply_menu=d),type:"checkbox",id:"need-reply-menu"},null,512),[[k,t.need_reply_menu]]),O_])])):r("",!0),t.need_reply_menu?(l(),i("div",U_,[e("div",A_,[e("div",I_,[Q_,e("button",{class:p(["btn",{"btn-outline-primary":!t.showReplyTemplateSelector,"btn-primary":t.showReplyTemplateSelector}]),type:"button",onClick:o[16]||(o[16]=d=>t.showReplyTemplateSelector=!t.showReplyTemplateSelector)},[t.showReplyTemplateSelector?(l(),i("span",B_," Скрыть шаблоны меню")):(l(),i("span",T_," Открыть шаблоны меню"))],2)]),e("div",R_,[e("div",M_,[e("div",D_,[e("label",E_,[g(a,null,{content:f(()=>[K_]),default:f(()=>[L_]),_:1}),m(" Заголовок ")]),c(e("input",{type:"text",class:"form-control",placeholder:"Заголовок меню","aria-label":"Заголовок меню","onUpdate:modelValue":o[17]||(o[17]=d=>t.pageForm.reply_keyboard_title=d),maxlength:"255","aria-describedby":"bot-domain"},null,512),[[_,t.pageForm.reply_keyboard_title]])])]),t.showReplyTemplateSelector?(l(),$(T,{key:0,class:"mb-2",type:"reply",onSelect:t.selectReplyKeyboard,"select-mode":!0},null,8,["onSelect"])):(l(),$(U,{key:1,type:"reply",onSave:t.saveReplyKeyboard,onSaveSettings:t.saveReplyKeyboardSettings,"edited-keyboard":t.pageForm.reply_keyboard},null,8,["onSave","onSaveSettings","edited-keyboard"]))])])])):(l(),i("div",N_,[e("div",J_,[e("div",Y_,[c(e("img",H_,null,512),[[n,"../images/icon.png"]])]),G_,W_,e("div",X_,[e("button",{disabled:t.need_reply_menu,onClick:o[18]||(o[18]=d=>t.need_reply_menu=!0),class:p([{"btn-primary":!t.need_reply_menu,"btn-outline-secondary":t.need_reply_menu},"d-inline-flex align-items-center btn btn-lg px-4 rounded-pill"]),type:"button"}," Добавить ",10,Z_),x_])])]))],512),[[z,t.tab===0]]),c(e("div",null,[t.need_inline_menu?(l(),i("div",ep,[e("div",tp,[c(e("input",{class:"form-check-input","onUpdate:modelValue":o[19]||(o[19]=d=>t.need_inline_menu=d),type:"checkbox",id:"need-inline-menu"},null,512),[[k,t.need_inline_menu]]),sp])])):r("",!0),t.need_inline_menu?(l(),i("div",op,[e("div",lp,[e("div",ip,[np,e("button",{class:p(["btn",{"btn-outline-primary":!t.showInlineTemplateSelector,"btn-primary":t.showInlineTemplateSelector}]),type:"button",onClick:o[20]||(o[20]=d=>t.showInlineTemplateSelector=!t.showInlineTemplateSelector)},[t.showInlineTemplateSelector?(l(),i("span",dp," Скрыть шаблоны меню")):(l(),i("span",ap," Открыть шаблоны меню"))],2)]),e("div",rp,[t.showInlineTemplateSelector?(l(),$(T,{key:0,class:"mb-2",type:"inline",onSelect:t.selectInlineKeyboard,"select-mode":!0},null,8,["onSelect"])):(l(),$(U,{key:1,type:"inline",onSave:t.saveInlineKeyboard,"edited-keyboard":t.pageForm.inline_keyboard},null,8,["onSave","edited-keyboard"]))])])])):(l(),i("div",cp,[e("div",up,[e("div",mp,[c(e("img",hp,null,512),[[n,"../images/icon.png"]])]),_p,pp,e("div",bp,[e("button",{disabled:t.need_inline_menu,onClick:o[21]||(o[21]=d=>t.need_inline_menu=!0),class:p([{"btn-primary":!t.need_inline_menu,"btn-outline-secondary":t.need_inline_menu},"d-inline-flex align-items-center btn btn-lg px-4 rounded-pill"]),type:"button"}," Добавить ",10,fp),gp])])]))],512),[[z,t.tab===1]]),c(e("div",null,[t.need_page_images?(l(),i("div",vp,[e("div",$p,[c(e("input",{class:"form-check-input","onUpdate:modelValue":o[22]||(o[22]=d=>t.need_page_images=d),type:"checkbox",id:"need-page-images"},null,512),[[k,t.need_page_images]]),yp])])):r("",!0),t.need_page_images?(l(),i("div",kp,[e("div",Fp,[Cp,e("div",wp,[e("label",Sp,[m(" + "),e("input",{type:"file",id:"photos",multiple:"",accept:"image/*",onChange:o[23]||(o[23]=(...d)=>t.onChangePhotos&&t.onChangePhotos(...d)),style:{display:"none"}},null,32)]),e("div",jp,[t.photos.length>0?(l(),i("div",qp,[(l(!0),i(v,null,y(t.photos,(d,h)=>(l(),i("div",zp,[c(e("img",null,null,512),[[n,t.getPhoto(d).imageUrl]]),e("div",Pp,[e("a",{onClick:b=>t.removePhoto(h)},"Удалить",8,Vp)])]))),256))])):r("",!0),t.pageForm.images.length>0?(l(),i("h6",Op,"Ранее загруженные фотографии")):r("",!0),t.pageForm.images.length>0?(l(),i("div",Up,[(l(!0),i(v,null,y(t.pageForm.images,(d,h)=>(l(),i("div",Ap,[c(e("img",null,null,512),[[n,"/images-by-bot-id/"+t.bot.id+"/"+d]]),e("div",Ip,[e("a",{onClick:b=>t.removeImage(h)},"Удалить",8,Qp)])]))),256))])):r("",!0)])])])])):(l(),i("div",Tp,[e("div",Bp,[e("div",Rp,[c(e("img",Mp,null,512),[[n,"../images/icon.png"]])]),Dp,Ep,e("div",Lp,[e("button",{disabled:t.need_page_images,onClick:o[24]||(o[24]=d=>t.need_page_images=!0),class:p([{"btn-primary":!t.need_page_images,"btn-outline-secondary":t.need_page_images},"d-inline-flex align-items-center btn btn-lg px-4 rounded-pill"]),type:"button"}," Добавить ",10,Kp),Np])])]))],512),[[z,t.tab===2]]),c(e("div",null,[t.need_page_video?(l(),i("div",Jp,[e("div",Yp,[c(e("input",{class:"form-check-input","onUpdate:modelValue":o[25]||(o[25]=d=>t.need_page_video=d),type:"checkbox",id:"need-page-video"},null,512),[[k,t.need_page_video]]),Hp])])):r("",!0),t.need_page_video?(l(),i("div",Gp,[g(P,{"need-video":!0,"need-video-note":!0,selected:t.pageForm.videos,onSelect:t.selectVideo},null,8,["selected","onSelect"])])):(l(),i("div",Wp,[e("div",Xp,[e("div",Zp,[c(e("img",xp,null,512),[[n,"../images/icon.png"]])]),eb,tb,e("div",sb,[e("button",{disabled:t.need_page_video,onClick:o[26]||(o[26]=d=>t.need_page_video=!0),class:p([{"btn-primary":!t.need_page_video,"btn-outline-secondary":t.need_page_video},"d-inline-flex align-items-center btn btn-lg px-4 rounded-pill"]),type:"button"}," Добавить ",10,ob),lb])])]))],512),[[z,t.tab===3]]),c(e("div",null,[t.need_page_sticker?(l(),i("div",ib,[e("div",nb,[c(e("input",{class:"form-check-input","onUpdate:modelValue":o[27]||(o[27]=d=>t.need_page_sticker=d),type:"checkbox",id:"need-page-sticker"},null,512),[[k,t.need_page_sticker]]),ab])])):r("",!0),t.need_page_sticker?(l(),i("div",db,[g(P,{"need-sticker":!0,selected:[t.pageForm.sticker],onSelect:t.selectSticker},null,8,["selected","onSelect"])])):(l(),i("div",rb,[e("div",cb,[e("div",ub,[c(e("img",mb,null,512),[[n,"../images/icon.png"]])]),hb,_b,e("div",pb,[e("button",{disabled:t.need_page_sticker,onClick:o[28]||(o[28]=d=>t.need_page_sticker=!0),class:p([{"btn-primary":!t.need_page_sticker,"btn-outline-secondary":t.need_page_sticker},"d-inline-flex align-items-center btn btn-lg px-4 rounded-pill"]),type:"button"}," Добавить ",10,bb),fb])])]))],512),[[z,t.tab===4]]),c(e("div",null,[t.need_page_audios?(l(),i("div",gb,[e("div",vb,[c(e("input",{class:"form-check-input","onUpdate:modelValue":o[29]||(o[29]=d=>t.need_page_audios=d),type:"checkbox",id:"need-page-audio"},null,512),[[k,t.need_page_audios]]),$b])])):r("",!0),t.need_page_audios?(l(),i("div",yb,[g(P,{"need-audio":!0,selected:t.pageForm.audios,onSelect:t.selectAudio},null,8,["selected","onSelect"])])):(l(),i("div",kb,[e("div",Fb,[e("div",Cb,[c(e("img",wb,null,512),[[n,"../images/icon.png"]])]),Sb,jb,e("div",qb,[e("button",{disabled:t.need_page_audios,onClick:o[30]||(o[30]=d=>t.need_page_audios=!0),class:p([{"btn-primary":!t.need_page_audios,"btn-outline-secondary":t.need_page_audios},"d-inline-flex align-items-center btn btn-lg px-4 rounded-pill"]),type:"button"}," Добавить ",10,zb),Pb])])]))],512),[[z,t.tab===5]]),c(e("div",null,[t.need_page_documents?(l(),i("div",Vb,[e("div",Ob,[c(e("input",{class:"form-check-input","onUpdate:modelValue":o[31]||(o[31]=d=>t.need_page_documents=d),type:"checkbox",id:"need-page-document"},null,512),[[k,t.need_page_documents]]),Ub])])):r("",!0),t.need_page_documents?(l(),i("div",Ab,[g(P,{"need-document":!0,selected:t.pageForm.documents,onSelect:t.selectDocument},null,8,["selected","onSelect"])])):(l(),i("div",Ib,[e("div",Qb,[e("div",Tb,[c(e("img",Bb,null,512),[[n,"../images/icon.png"]])]),Rb,Mb,e("div",Db,[e("button",{disabled:t.need_page_documents,onClick:o[32]||(o[32]=d=>t.need_page_documents=!0),class:p([{"btn-primary":!t.need_page_documents,"btn-outline-secondary":t.need_page_documents},"d-inline-flex align-items-center btn btn-lg px-4 rounded-pill"]),type:"button"}," Добавить ",10,Eb),Lb])])]))],512),[[z,t.tab===6]]),c(e("div",null,[e("div",Kb,[e("div",Nb,[e("div",Jb,[c(e("img",Yb,null,512),[[n,"../images/icon.png"]])]),Hb,Gb,t.pageForm.next_page_id?(l(),i("p",Wb,"Связано со страницей #"+u(t.pageForm.next_page_id),1)):r("",!0),e("div",Xb,[t.pageForm.next_page_id?(l(),i("button",{key:0,class:"d-inline-flex align-items-center btn btn-lg px-4 rounded-pill btn-danger",type:"button",onClick:o[33]||(o[33]=(...d)=>t.clearLinks&&t.clearLinks(...d))},"Очистить ")):(l(),i("button",Zb," Связать ")),xb]),ef,e("div",tf,[sf,of,(l(!0),i(v,null,y(t.links,(d,h)=>(l(),i("div",lf,[e("button",{type:"button",onClick:b=>t.removeLink(h),class:p([{"btn-danger":t.chainCollapseTest(d)},"btn btn-primary position-relative rounded-5"])},[m(u(d.slug.command||"-")+" ",1),e("span",af," #"+u(d.id),1)],10,nf),h<t.links.length-1?(l(),i("i",df)):r("",!0)]))),256)),t.links.length>0?(l(),i("i",rf)):r("",!0),cf])])])],512),[[z,t.tab===7]]),c(e("div",null,[t.need_attach_slug?(l(),i("div",uf,[mf,e("div",hf,[c(e("input",{class:"form-check-input","onUpdate:modelValue":o[34]||(o[34]=d=>t.need_show_global_slug_list=d),type:"checkbox",id:"need-show-global-slug-list"},null,512),[[k,t.need_show_global_slug_list]]),_f]),t.bot&&t.need_show_global_slug_list?(l(),$(Y,{key:0,"can-add":!0,bot:t.bot,onCallback:t.loadSlugs},null,8,["bot","onCallback"])):r("",!0)])):r("",!0),t.need_attach_slug?(l(),i("div",pf,[e("div",bf,[c(e("input",{class:"form-check-input","onUpdate:modelValue":o[35]||(o[35]=d=>t.need_attach_slug=d),type:"checkbox",id:"need-slug-attach"},null,512),[[k,t.need_attach_slug]]),ff])])):r("",!0),t.need_attach_slug?(l(),i("div",gf,[t.pageForm.next_bot_menu_slug_id?(l(),i("div",vf,[m(" Связано со скриптом #"+u(t.pageForm.next_bot_menu_slug_id)+" ",1),e("a",{class:"btn btn-link text-danger",onClick:o[36]||(o[36]=d=>t.pageForm.next_bot_menu_slug_id=null)},"Очистить")])):r("",!0),t.bot&&t.load_slug_simple_list?(l(),$(xi,{key:1,global:!0,selected:[t.pageForm.next_bot_menu_slug_id],onCallback:t.associateSlug,bot:t.bot},null,8,["selected","onCallback","bot"])):r("",!0)])):(l(),i("div",$f,[e("div",yf,[e("div",kf,[c(e("img",Ff,null,512),[[n,"../images/icon.png"]])]),Cf,wf,e("div",Sf,[e("button",{disabled:t.need_attach_slug,onClick:o[37]||(o[37]=d=>t.need_attach_slug=!0),class:p([{"btn-primary":!t.need_attach_slug,"btn-outline-secondary":t.need_attach_slug},"d-inline-flex align-items-center btn btn-lg px-4 rounded-pill"]),type:"button"}," Добавить ",10,jf),qf])])]))],512),[[z,t.tab===8]]),c(e("div",null,[t.need_attach_dialog?(l(),i("div",zf,[e("div",Pf,[c(e("input",{class:"form-check-input","onUpdate:modelValue":o[38]||(o[38]=d=>t.need_attach_dialog=d),type:"checkbox",id:"need-dialog-attach"},null,512),[[k,t.need_attach_dialog]]),Vf])])):r("",!0),t.need_attach_dialog?(l(),i("div",Of,[t.pageForm.next_bot_dialog_command_id?(l(),i("p",Uf,[m("Связано с диалогом #"+u(t.pageForm.next_bot_dialog_command_id)+" ",1),e("a",{class:"btn btn-link",onClick:o[39]||(o[39]=d=>t.pageForm.next_bot_dialog_command_id=null)},"Очистить")])):r("",!0),t.bot?(l(),$(ae,{key:1,onSelectDialog:t.associateDialog,bot:t.bot},null,8,["onSelectDialog","bot"])):r("",!0)])):(l(),i("div",Af,[e("div",If,[e("div",Qf,[c(e("img",Tf,null,512),[[n,"../images/icon.png"]])]),Bf,Rf,e("div",Mf,[e("button",{disabled:t.need_attach_dialog,onClick:o[40]||(o[40]=d=>t.need_attach_dialog=!0),class:p([{"btn-primary":!t.need_attach_dialog,"btn-outline-secondary":t.need_attach_dialog},"d-inline-flex align-items-center btn btn-lg px-4 rounded-pill"]),type:"button"}," Добавить ",10,Df),Ef])])]))],512),[[z,t.tab===9]]),c(e("div",null,[t.need_rules?(l(),i("div",Lf,[e("div",Kf,[c(e("input",{class:"form-check-input","onUpdate:modelValue":o[41]||(o[41]=d=>t.need_rules=d),type:"checkbox",id:"need-rules"},null,512),[[k,t.need_rules]]),Nf])])):r("",!0),t.need_rules?(l(),i("div",Jf,[g(Pm,{bot:t.bot,"rules-form":t.pageForm},null,8,["bot","rules-form"])])):(l(),i("div",Yf,[e("div",Hf,[e("div",Gf,[c(e("img",Wf,null,512),[[n,"../images/icon.png"]])]),Xf,Zf,e("div",xf,[e("button",{disabled:t.need_rules,onClick:o[42]||(o[42]=d=>t.need_rules=!0),class:p([{"btn-primary":!t.need_rules,"btn-outline-secondary":t.need_rules},"d-inline-flex align-items-center btn btn-lg px-4 rounded-pill"]),type:"button"}," Добавить ",10,eg),tg])])]))],512),[[z,t.tab===10]])],512),[[z,!t.pageForm.is_external]])],32)):r("",!0),sg,e("div",og,[e("div",lg,[e("div",ig,[ng,e("div",ag,[t.bot?(l(),i("div",dg,[e("div",rg,[e("h6",cg,[e("span",null,[m("Вы создаете страницу для "),e("a",{href:"https://t.me/"+t.bot.bot_domain,target:"_blank"},u(t.bot.bot_domain),9,ug)])])])])):r("",!0),e("form",{onSubmit:o[50]||(o[50]=S((...d)=>t.submitPage&&t.submitPage(...d),["prevent"])),class:"row"},[e("div",mg,[hg,e("ul",_g,[e("li",{class:p({active:t.need_page_images})},bg,2),e("li",{class:p({active:t.need_page_sticker})},gg,2),e("li",{class:p({active:t.need_page_video})},$g,2),e("li",{class:p({active:t.need_page_audios})},kg,2),e("li",{class:p({active:t.need_page_documents})},Cg,2),e("li",{class:p({active:t.need_attach_page})},Sg,2),e("li",{class:p({active:t.need_attach_slug})},qg,2),e("li",{class:p({active:t.need_attach_dialog})},Pg,2),e("li",{class:p({active:t.need_rules})},Og,2),e("li",{class:p({active:t.need_reply_menu})},Ag,2),e("li",{class:p({active:t.need_inline_menu})},Qg,2)])]),t.pageForm.id?(l(),i("div",Tg,[e("div",Bg,[c(e("input",{class:"form-check-input","onUpdate:modelValue":o[44]||(o[44]=d=>t.need_show_qr_and_link=d),type:"checkbox",id:"need-show-qr-and-link"},null,512),[[k,t.need_show_qr_and_link]]),Rg])])):r("",!0),t.pageForm.id&&t.need_show_qr_and_link?(l(),i("div",Mg,[e("p",null,[m("Ссылка на текущую страницу: "),e("span",{class:"bg-secondary font-bold cursor-pointer",onClick:o[45]||(o[45]=d=>t.copyToClipBoard(t.pageLink))},u(t.pageLink),1)]),e("div",Dg,[c(e("img",Eg,null,512),[[n,t.qr]])])])):r("",!0),e("div",Lg,[e("label",Kg,[g(a,null,{content:f(()=>[Jg]),default:f(()=>[Ng]),_:1}),m(" Описание страницы "),Yg]),c(e("textarea",{type:"text",class:"form-control",placeholder:"Описание страницы","aria-label":"Описание страницы","onUpdate:modelValue":o[46]||(o[46]=d=>t.pageForm.comment=d),maxlength:"255","aria-describedby":"bot-domain",required:""},`
            `,512),[[_,t.pageForm.comment]])]),e("div",Hg,[e("div",Gg,[c(e("input",{class:"form-check-input","onUpdate:modelValue":o[47]||(o[47]=d=>t.pageForm.is_external=d),type:"checkbox",id:"is-external"},null,512),[[k,t.pageForm.is_external]]),Wg]),t.pageForm.is_external?(l(),i("div",Xg,[m(" Обработка ссылок передана на внешний адрес, указанный в настройках бота! Все запросы по данной кнопке будут отправлены на указанный URL-адрес: "),e("strong",null,u(t.bot.callback_link||"не указано")+".",1),t.bot.callback_link?r("",!0):(l(),i("p",Zg,[m("Внешня ссылка не установлена! Перейдите в раздел "),xg,m(", затем "),e1,m(" и установите ссылку для внешнего управления в поле "),t1,m("!")]))])):r("",!0)]),e("div",s1,[e("div",o1,[c(e("input",{class:"form-check-input","onUpdate:modelValue":o[48]||(o[48]=d=>t.pageForm.need_log_user_action=d),type:"checkbox",id:"need_log_user_action"},null,512),[[k,t.pageForm.need_log_user_action]]),l1])]),e("div",i1,[e("div",n1,[c(e("input",{class:"form-check-input","onUpdate:modelValue":o[49]||(o[49]=d=>t.need_stay_after_save=d),type:"checkbox",id:"need-stay-after-save"},null,512),[[k,t.need_stay_after_save]]),a1])]),d1],32)]),r1])])]),e("div",c1,[e("div",u1,[e("div",m1,[e("div",h1,[g(B,{current:t.pageForm.id,selected:t.selectedLinkIds,onCallback:t.attachPage,editor:!1},null,8,["current","selected","onCallback"])])])])]),e("div",_1,[e("div",p1,[e("div",b1,[e("div",f1,[t.page?(l(),$(Hm,{key:0,page:t.page},null,8,["page"])):(l(),i("p",g1,"Сперва сохраните страницу"))])])])]),m("- "),e("div",v1,[$1,e("div",y1,[e("div",k1,[e("div",F1,[t.loaded_page_list?(l(),$(B,{key:0,editor:!0,current:t.page,onCallback:t.pageListCallback},null,8,["current","onCallback"])):r("",!0)])])])])],64)}}}),S1={props:["bot","item"],data(){return{sectionForm:{section:null},categoryForm:{label:null},tab:0,types:[{title:"Готовый продукт",value:1},{title:"Товар на вес",value:2},{title:"Конструктор товара",value:3}],productCategories:[],sections:["Общие характеристики","Дополнительная информация"],photos:[],categories:[],removed_options:[],productForm:{article:null,vk_product_id:null,frontpad_article:null,iiko_article:null,title:null,description:null,images:[],type:1,old_price:null,current_price:null,variants:[],in_stop_list_at:null,bot_id:null,options:[],reviews:[],categories:[]}}},computed:{...w(["getProductCategories"]),filteredCategories(){return this.productCategories.length===0?this.categories:this.categories.filter(s=>this.productCategories.indexOf(s.value)===-1)}},mounted(){this.loadProductCategories(),this.item&&this.$nextTick(()=>{this.productForm={id:this.item.id||null,article:this.item.article||null,vk_product_id:this.item.vk_product_id||null,frontpad_article:this.item.frontpad_article||null,iiko_article:this.item.iiko_article||null,title:this.item.title||null,description:this.item.description||null,images:this.item.images||null,type:this.item.type||1,old_price:this.item.old_price||null,current_price:this.item.current_price||null,variants:this.item.variants||null,in_stop_list_at:this.item.in_stop_list_at||null,bot_id:this.item.bot_id||null,options:this.item.options||null,reviews:this.item.reviews||null},this.options=[],this.item.categories.forEach(s=>{this.productCategories.push(s.id)})})},methods:{prepareCategoryName(s){let t=this.categories.find(o=>o.value===s);return console.log(t),t?t.label:s},addCategory(){const s=this.categoryForm.label;this.productCategories.push(s),this.categoryForm.label=null},selectCategory(s){this.productCategories.push(s.value)},submit(){let s=new FormData;if(Object.keys(this.productForm).forEach(t=>{const o=this.productForm[t]||"";typeof o=="object"?s.append(t,JSON.stringify(o)):s.append(t,o)}),this.bot&&s.append("bot_id",this.bot.id),this.photos.length>0)for(let t=0;t<this.photos.length;t++)s.append("photos[]",this.photos[t]);this.removed_options.length>0&&s.append("removed_options",JSON.stringify(this.removed_options)),this.productCategories.length>0&&s.append("categories",JSON.stringify(this.productCategories)),this.$store.dispatch("saveProduct",{productForm:s}).then(t=>{this.load=!0,this.$notify({title:"Конструктор ботов",text:"Продукт успешно сохранен!",type:"success"}),this.clearForm(),this.$emit("refresh")}).catch(t=>{})},onChangePhotos(s){const t=s.target.files;for(let o=0;o<t.length;o++)this.photos.push(t[o])},loadProductCategories(){this.$store.dispatch("loadProductCategories",{dataObject:{bot_id:this.bot.id}}).then(()=>{this.getProductCategories.forEach(t=>{this.categories.push({value:t.id,label:t.title})})})},getPhoto(s){return{imageUrl:URL.createObjectURL(s)}},removeSection(s){this.sections.splice(s,1)},addSection(){this.sections.push(this.sectionForm.section),this.sectionForm.section=null},addOption(){this.productForm.options||(this.productForm.options=[]),this.productForm.options.push({id:null,key:null,value:null,title:null,section:null})},addVariant(){this.productForm.variants||(this.productForm.variants=[]),this.productForm.variants.push({key:null,value:null})},removeProductCategory(s){this.productCategories.splice(s,1)},removeVariant(s){this.productForm.variants.splice(s,1)},removeOption(s){this.productForm.options[s].id&&this.removed_options.push(this.productForm.options[s].id),this.productForm.options.splice(s,1)},removeImage(s){this.productForm.images.splice(s,1)},removePhoto(s){this.photos.splice(s,1)},clearForm(){const s={article:null,vk_product_id:null,title:null,description:null,images:[],type:1,old_price:null,current_price:null,variants:[],in_stop_list_at:null,bot_id:null,options:[],reviews:[],categories:[]};this.photos=[],this.removed_options=[],this.productCategories=[],this.productForm=s}}},j1={class:"nav nav-tabs"},q1={class:"nav-item"},z1={class:"nav-item"},P1={class:"nav-item"},V1={key:0},O1={class:"col-md-8 d-flex align-items-center"},U1={class:"form-check"},A1=e("label",{class:"form-check-label",for:"in-stop-list"}," Товар находится в стоп-листе ",-1),I1={class:"col-md-4 d-flex justify-content-end"},Q1={class:"col-md-12 mb-3"},T1=["onClick"],B1={class:"dropdown"},R1=e("button",{type:"button",class:"btn btn-outline-info w-100","data-bs-toggle":"dropdown","data-bs-display":"static","aria-expanded":"false"},[e("p",{class:"mb-0"},"Выберите категорию")],-1),M1={class:"dropdown-menu w-100",style:{"overflow-y":"scroll",height:"300px"}},D1={class:"p-3"},E1=e("label",{for:"exampleDropdownFormEmail1",class:"form-label"},"Новая категория",-1),L1={class:"p-3"},K1=e("li",null,[e("hr",{class:"dropdown-divider"})],-1),N1=["onClick"],J1={class:"col-md-6"},Y1={class:"form-floating mb-3"},H1=e("label",{for:"article"},"Артикул товара",-1),G1={class:"col-md-6"},W1={class:"form-floating mb-3"},X1=e("label",{for:"article"},"Артикул товара FrontPad",-1),Z1={class:"col-md-6"},x1={class:"form-floating mb-3"},ev=e("label",{for:"article"},"Артикул товара в IIKO",-1),tv={class:"col-md-6"},sv={class:"form-floating mb-3"},ov=e("label",{for:"vk-product-id"},"Идентификатор товара VK",-1),lv={class:"col-md-6"},iv={class:"form-floating mb-3"},nv=e("label",{for:"title"},"Названи товара",-1),av={class:"col-md-6"},dv={class:"form-floating mb-3"},rv=["value"],cv=e("label",{for:"type"},"Тип товара",-1),uv={class:"col-md-12"},mv={class:"form-floating mb-3"},hv=e("label",{for:"description"},"Описание товара",-1),_v={class:"col-md-6"},pv={class:"form-floating mb-3"},bv=e("label",{for:"current-price"},"Актуальная цена",-1),fv={class:"col-md-6"},gv={class:"form-floating mb-3"},vv=e("label",{for:"old-price"},"Старая цена",-1),$v={class:"col-md-12 mb-3"},yv={class:"card"},kv={class:"card-header"},Fv={key:0},Cv={class:"card-body"},wv={class:"row"},Sv={class:"col-12 mb-3"},jv={class:"col-md-6 mb-3"},qv={class:"card w-100"},zv={class:"card-body"},Pv={class:"form-floating mb-3"},Vv=["onUpdate:modelValue","id"],Ov=["for"],Uv={class:"form-floating mb-3"},Av=["onUpdate:modelValue","id"],Iv=["for"],Qv={class:"card-footer"},Tv=["onClick"],Bv=e("i",{class:"fa-solid fa-trash-can"},null,-1),Rv=[Bv],Mv={class:"col-md-12 mb-3"},Dv={class:"card"},Ev=e("div",{class:"card-header"},[e("h6",null,"Характеристики товара")],-1),Lv={class:"card-body"},Kv={class:"row mb-3"},Nv={class:"col-12"},Jv=e("button",{class:"btn btn-outline-info",type:"submit",id:"button-addon2"},"Добавить секцию ",-1),Yv={class:"badge bg-info mr-1"},Hv=["onClick"],Gv=e("i",{class:"fa-solid fa-xmark"},null,-1),Wv=[Gv],Xv={class:"row"},Zv={class:"col-md-4 mb-3"},xv={class:"card w-100"},e$={class:"card-body"},t$={class:"form-floating mb-3"},s$=["onUpdate:modelValue","id"],o$=["for"],l$={class:"form-floating mb-3"},i$=["onUpdate:modelValue","id"],n$=["for"],a$={class:"form-floating mb-3"},d$=["onUpdate:modelValue","id"],r$=e("option",{value:null},"Без секции",-1),c$=["value"],u$=["for"],m$={class:"card-footer"},h$=["onClick"],_$=e("i",{class:"fa-solid fa-trash-can"},null,-1),p$=[_$],b$={class:"row"},f$={class:"col-12"},g$={class:"col-md-12 mb-3"},v$=e("h6",null,"Фотографии товара",-1),$$={class:"photo-preview d-flex justify-content-start flex-wrap w-100"},y$={for:"location-photos",style:{"margin-right":"10px"},class:"photo-loader ml-2"},k$=e("span",null,"+",-1),F$={class:"mb-2 img-preview",style:{"margin-right":"10px"}},C$={class:"remove"},w$=["onClick"],S$={class:"mb-2 img-preview",style:{"margin-right":"10px"}},j$={class:"remove"},q$=["onClick"],z$=e("div",{class:"col-12"},[e("button",{type:"submit",class:"btn btn-outline-primary w-100 p-3"},"Сохранить ")],-1),P$={key:1};function V$(s,t,o,a,n,d){const h=A("lazy");return l(),i(v,null,[e("ul",j1,[e("li",q1,[e("a",{class:p(["nav-link",{active:n.tab===0}]),onClick:t[0]||(t[0]=b=>n.tab=0),"aria-current":"page",href:"#product-form-info"},"Информация о товаре",2)]),e("li",z1,[e("a",{class:p(["nav-link",{active:n.tab===1}]),onClick:t[1]||(t[1]=b=>n.tab=1),href:"#product-reviews"},"Комментарии",2)]),e("li",P1,[e("a",{class:p(["nav-link",{active:n.tab===2}]),onClick:t[2]||(t[2]=b=>n.tab=2),href:"#product-reviews"},"Заказы",2)])]),n.tab===0?(l(),i("div",V1,[e("form",{onSubmit:t[21]||(t[21]=S((...b)=>d.submit&&d.submit(...b),["prevent"])),class:"row"},[e("div",O1,[e("div",U1,[c(e("input",{class:"form-check-input","onUpdate:modelValue":t[3]||(t[3]=b=>n.productForm.in_stop_list_at=b),type:"checkbox",value:"false",id:"in-stop-list"},null,512),[[k,n.productForm.in_stop_list_at]]),A1])]),e("div",I1,[e("a",{href:"#",class:"btn btn-link",onClick:t[4]||(t[4]=(...b)=>d.clearForm&&d.clearForm(...b))},"Новый товар")]),e("div",Q1,[(l(!0),i(v,null,y(n.productCategories,(b,F)=>(l(),i("span",{class:"badge bg-info mr-1 mb-1 cursor-pointer",onClick:C=>d.removeProductCategory(F)},u(d.prepareCategoryName(b)),9,T1))),256)),e("div",B1,[R1,e("ul",M1,[e("div",D1,[E1,c(e("input",{type:"text",class:"form-control","onUpdate:modelValue":t[5]||(t[5]=b=>n.categoryForm.label=b),id:"exampleDropdownFormEmail1",placeholder:"Название категории"},null,512),[[_,n.categoryForm.label]])]),e("div",L1,[e("button",{class:"btn btn-primary w-100",type:"button",onClick:t[6]||(t[6]=(...b)=>d.addCategory&&d.addCategory(...b))},"Добавить категорию ")]),K1,(l(!0),i(v,null,y(d.filteredCategories,b=>(l(),i("li",null,[e("button",{class:"dropdown-item",type:"button",onClick:F=>d.selectCategory(b)},u(b.label),9,N1)]))),256))])])]),e("div",J1,[e("div",Y1,[c(e("input",{type:"text","onUpdate:modelValue":t[7]||(t[7]=b=>n.productForm.article=b),class:"form-control",id:"article",placeholder:"name@example.com"},null,512),[[_,n.productForm.article]]),H1])]),e("div",G1,[e("div",W1,[c(e("input",{type:"text","onUpdate:modelValue":t[8]||(t[8]=b=>n.productForm.frontpad_article=b),class:"form-control",id:"article",placeholder:"name@example.com"},null,512),[[_,n.productForm.frontpad_article]]),X1])]),e("div",Z1,[e("div",x1,[c(e("input",{type:"text","onUpdate:modelValue":t[9]||(t[9]=b=>n.productForm.iiko_article=b),class:"form-control",id:"article",placeholder:"name@example.com"},null,512),[[_,n.productForm.iiko_article]]),ev])]),e("div",tv,[e("div",sv,[c(e("input",{type:"text","onUpdate:modelValue":t[10]||(t[10]=b=>n.productForm.vk_product_id=b),disabled:!0,class:"form-control",id:"vk-product-id",placeholder:"name@example.com"},null,512),[[_,n.productForm.vk_product_id]]),ov])]),e("div",lv,[e("div",iv,[c(e("input",{type:"text","onUpdate:modelValue":t[11]||(t[11]=b=>n.productForm.title=b),class:"form-control",id:"title",placeholder:"name@example.com"},null,512),[[_,n.productForm.title]]),nv])]),e("div",av,[e("div",dv,[c(e("select",{class:"form-select","onUpdate:modelValue":t[12]||(t[12]=b=>n.productForm.type=b),id:"type","aria-label":"Floating label select example"},[(l(!0),i(v,null,y(n.types,(b,F)=>(l(),i("option",{value:b.value},u(b.title),9,rv))),256))],512),[[Q,n.productForm.type]]),cv])]),e("div",uv,[e("div",mv,[c(e("textarea",{class:"form-control","onUpdate:modelValue":t[13]||(t[13]=b=>n.productForm.description=b),placeholder:"Leave a comment here",id:"description"},null,512),[[_,n.productForm.description]]),hv])]),e("div",_v,[e("div",pv,[c(e("input",{type:"number","onUpdate:modelValue":t[14]||(t[14]=b=>n.productForm.current_price=b),class:"form-control",id:"current-price",placeholder:"name@example.com"},null,512),[[_,n.productForm.current_price]]),bv])]),e("div",fv,[e("div",gv,[c(e("input",{type:"number","onUpdate:modelValue":t[15]||(t[15]=b=>n.productForm.old_price=b),class:"form-control",id:"old-price",placeholder:"name@example.com"},null,512),[[_,n.productForm.old_price]]),vv])]),e("div",$v,[e("div",yv,[e("div",kv,[e("h6",null,[m("Варианты товара "),n.productForm.variants?(l(),i("span",Fv,"("+u(n.productForm.variants.length)+")",1)):r("",!0)])]),e("div",Cv,[e("div",wv,[e("div",Sv,[e("button",{type:"button",class:"btn btn-outline-info w-100",onClick:t[16]||(t[16]=(...b)=>d.addVariant&&d.addVariant(...b))},"Добавить вариант ")]),(l(!0),i(v,null,y(n.productForm.variants,(b,F)=>(l(),i("div",jv,[e("div",qv,[e("div",zv,[e("div",Pv,[c(e("input",{type:"text","onUpdate:modelValue":C=>n.productForm.variants[F].key=C,class:"form-control",id:"variant-key-"+F,placeholder:"name@example.com",required:""},null,8,Vv),[[_,n.productForm.variants[F].key]]),e("label",{for:"variant-key-"+F},"Ключ",8,Ov)]),e("div",Uv,[c(e("input",{type:"text","onUpdate:modelValue":C=>n.productForm.variants[F].value=C,class:"form-control",id:"variant-value-"+F,placeholder:"name@example.com",required:""},null,8,Av),[[_,n.productForm.variants[F].value]]),e("label",{for:"variant-value-"+F},"Значение",8,Iv)])]),e("div",Qv,[e("button",{type:"button",class:"btn btn-outline-danger",onClick:C=>d.removeVariant(F)},Rv,8,Tv)])])]))),256))])])])]),e("div",Mv,[e("div",Dv,[Ev,e("div",Lv,[e("div",Kv,[e("div",Nv,[e("form",{onSubmit:t[18]||(t[18]=S((...b)=>d.addSection&&d.addSection(...b),["prevent"])),class:"input-group mb-3"},[c(e("input",{type:"text","onUpdate:modelValue":t[17]||(t[17]=b=>n.sectionForm.section=b),class:"form-control border-info",placeholder:"Название секции","aria-label":"Recipient's username","aria-describedby":"button-addon2",required:""},null,512),[[_,n.sectionForm.section]]),Jv],32),(l(!0),i(v,null,y(n.sections,(b,F)=>(l(),i("span",Yv,[m(u(b)+" ",1),e("strong",{onClick:C=>d.removeSection(F)},Wv,8,Hv)]))),256))])]),e("div",Xv,[(l(!0),i(v,null,y(n.productForm.options,(b,F)=>(l(),i("div",Zv,[e("div",xv,[e("div",e$,[e("div",t$,[c(e("input",{type:"text","onUpdate:modelValue":C=>n.productForm.options[F].title=C,class:"form-control",id:"option-title-"+F,placeholder:"name@example.com"},null,8,s$),[[_,n.productForm.options[F].title]]),e("label",{for:"option-title-"+F},"Название характеристики",8,o$)]),e("div",l$,[c(e("input",{type:"text","onUpdate:modelValue":C=>n.productForm.options[F].value=C,class:"form-control",id:"option-value-"+F,placeholder:"name@example.com"},null,8,i$),[[_,n.productForm.options[F].value]]),e("label",{for:"option-value-"+F},"Значение характеристики",8,n$)]),e("div",a$,[c(e("select",{class:"form-select","onUpdate:modelValue":C=>n.productForm.options[F].section=C,id:"option-section-"+F,"aria-label":"Floating label select example"},[r$,(l(!0),i(v,null,y(n.sections,C=>(l(),i("option",{value:C},u(C),9,c$))),256))],8,d$),[[Q,n.productForm.options[F].section]]),e("label",{for:"option-section-"+F},"Секция товара",8,u$)])]),e("div",m$,[e("button",{type:"button",class:"btn btn-outline-danger",onClick:C=>d.removeOption(F)},p$,8,h$)])])]))),256))]),e("div",b$,[e("div",f$,[e("button",{type:"button",class:"btn btn-outline-info w-100",onClick:t[19]||(t[19]=(...b)=>d.addOption&&d.addOption(...b))},"Добавить характеристику ")])])])])]),e("div",g$,[v$,e("div",$$,[e("label",y$,[k$,e("input",{type:"file",id:"location-photos",multiple:"",accept:"image/*",onChange:t[20]||(t[20]=(...b)=>d.onChangePhotos&&d.onChangePhotos(...b)),style:{display:"none"}},null,32)]),n.productForm.images?(l(!0),i(v,{key:0},y(n.productForm.images,(b,F)=>(l(),i("div",F$,[c(e("img",null,null,512),[[h,b]]),e("div",C$,[e("a",{onClick:C=>d.removeImage(F)},"Удалить",8,w$)])]))),256)):r("",!0),n.photos.length>0?(l(!0),i(v,{key:1},y(n.photos,(b,F)=>(l(),i("div",S$,[c(e("img",null,null,512),[[h,d.getPhoto(b).imageUrl]]),e("div",j$,[e("a",{onClick:C=>d.removePhoto(F)},"Удалить",8,q$)])]))),256)):r("",!0)])]),z$],32)])):r("",!0),n.tab===1?(l(),i("div",P$," Отзывы ")):r("",!0)],64)}const O$=I(S1,[["render",V$]]);({...w(["getCurrentBot"])});const U$=e("button",{class:"btn btn-outline-info",type:"submit",id:"button-addon2"}," Найти ",-1),A$={key:0},I$={class:"row"},Q$={class:"col-12"},T$={class:"table"},B$=e("thead",null,[e("tr",null,[e("th",{scope:"col"},"#"),e("th",{scope:"col"},"Название"),e("th",{scope:"col"},"Картинка"),e("th",{scope:"col"},"Действия")])],-1),R$={scope:"row"},M$=["onClick"],D$=["src"],E$={key:1},L$={class:"d-flex"},K$=e("i",{class:"fa-regular fa-copy"},null,-1),N$=[K$],J$=e("i",{class:"fa-solid fa-trash-can"},null,-1),Y$=[J$],H$={props:["bot"],data(){return{search:null,products:[],paginate:null}},computed:{...w(["getProducts","getProductsPaginateObject"]),filteredProducts(){return this.search?this.products.filter(s=>s.title.toLowerCase().trim().indexOf(this.search.toLowerCase().trim())>=0):this.products}},mounted(){this.loadProducts()},methods:{selectProduct(s){this.$emit("select",s)},nextProducts(s){this.loadProducts(s)},preparedImgUrl(s){return s.toLocaleLowerCase().startsWith("https://")||s.toLocaleLowerCase().startsWith("http://")?s:"/images-by-bot-id/"+this.bot.id+"/"+s},removeProduct(s){this.$store.dispatch("removeProduct",s.id).then(t=>{this.$notify({title:"Конструктор ботов",text:"Продукт успешно удален!",type:"success"})}).catch(t=>{})},duplicateProduct(s){this.$store.dispatch("duplicateProduct",s.id).then(t=>{this.$notify({title:"Конструктор ботов",text:"Продукт успешно продублирован!",type:"success"})}).catch(t=>{})},loadProducts(s=0){return this.$store.dispatch("loadProducts",{dataObject:{bot_id:this.bot.id,search:this.search},page:s}).then(()=>{this.products=this.getProducts,this.paginate=this.getProductsPaginateObject})}}},G$=Object.assign(H$,{__name:"ProductTableList",setup(s){return(t,o)=>(l(),i(v,null,[e("form",{class:"input-group mb-3",onSubmit:o[1]||(o[1]=S(a=>t.loadProducts(0),["prevent"]))},[c(e("input",{type:"text",class:"form-control border-info",placeholder:"Поиск товара","aria-label":"Поиск товара","onUpdate:modelValue":o[0]||(o[0]=a=>t.search=a),"aria-describedby":"button-addon2",required:""},null,512),[[_,t.search]]),U$],32),e("p",null,[m("Всего товаров: "),t.paginate?(l(),i("span",A$,u(t.paginate.meta.total||0),1)):r("",!0)]),e("div",I$,[e("div",Q$,[e("table",T$,[B$,e("tbody",null,[(l(!0),i(v,null,y(t.filteredProducts,(a,n)=>(l(),i("tr",null,[e("th",R$,u(a.id),1),e("td",null,[e("a",{href:"javascript:void(0)",onClick:d=>t.selectProduct(a),"data-bs-toggle":"modal","data-bs-target":"#product-form-edit"},null,8,M$),m(u(a.title),1)]),e("td",null,[(a.images||[]).length>0?(l(),i("img",{key:0,src:t.preparedImgUrl(a.images[0]),style:{width:"100px",height:"100px","object-fit":"cover"},class:"d-block",alt:"..."},null,8,D$)):(l(),i("p",E$,"Не добавлено"))]),e("td",null,[e("div",L$,[e("button",{title:"Дублировать товар",onClick:o[2]||(o[2]=(...d)=>t.duplicateProduct&&t.duplicateProduct(...d)),class:"btn btn-outline-info mr-1"},N$),e("button",{title:"Удалить товар",onClick:o[3]||(o[3]=(...d)=>t.removeProduct&&t.removeProduct(...d)),class:"btn btn-outline-danger"},Y$)])])]))),256))])])])]),t.paginate?(l(),$(j,{key:0,onPagination_page:t.nextProducts,pagination:t.paginate},null,8,["onPagination_page","pagination"])):r("",!0)],64))}}),W$=e("button",{class:"btn btn-outline-info",type:"submit",id:"button-addon2"}," Найти ",-1),X$={key:0},Z$={class:"row"},x$={class:"col-12"},ey={class:"table"},ty=e("thead",null,[e("tr",null,[e("th",{scope:"col"},"#"),e("th",{scope:"col"},"Название"),e("th",{scope:"col"},"Состояние"),e("th",{scope:"col"},"Действия")])],-1),sy={scope:"row"},oy=["onClick"],ly=["onClick"],iy={key:0},ny={key:1},ay=["onClick"],dy=e("i",{class:"fa-solid fa-trash-can"},null,-1),ry=[dy],cy={props:["bot"],data(){return{search:null,categories:[],paginate:null}},computed:{...w(["getProductCategories","getProductCategoriesPaginateObject"]),filteredProductCategories(){return this.search?this.categories.filter(s=>s.title.toLowerCase().trim().indexOf(this.search.toLowerCase().trim())>=0):this.categories}},mounted(){this.loadProductCategories()},methods:{changeCategoryStatus(s){let t=this.categories.findIndex(o=>s.id===o.id);t!==-1&&(this.categories[t].is_active=!this.categories[t].is_active,this.$store.dispatch("changeProductCategoryStatus",s.id).then(o=>{this.$notify({title:"Конструктор ботов",text:"Статус категории успешно изменен!",type:"success"})}).catch(o=>{}))},selectProductCategory(s){this.$emit("select",s)},nextProductCategories(s){this.loadProductCategories(s)},removeProductCategory(s){this.$store.dispatch("removeProductCategory",s.id).then(t=>{this.$notify({title:"Конструктор ботов",text:"Продукт успешно удален!",type:"success"})}).catch(t=>{})},loadProductCategories(s=0){return this.$store.dispatch("loadProductCategories",{dataObject:{bot_id:this.bot.id,search:this.search},page:s}).then(()=>{this.categories=this.getProductCategories,this.paginate=this.getProductCategoriesPaginateObject})}}},uy=Object.assign(cy,{__name:"ProductCategoryTableList",setup(s){return(t,o)=>(l(),i(v,null,[e("form",{class:"input-group mb-3",onSubmit:o[1]||(o[1]=S(a=>t.loadProductCategories(0),["prevent"]))},[c(e("input",{type:"text",class:"form-control border-info",placeholder:"Поиск категории товара","aria-label":"Поиск категории товара","onUpdate:modelValue":o[0]||(o[0]=a=>t.search=a),"aria-describedby":"button-addon2",required:""},null,512),[[_,t.search]]),W$],32),e("p",null,[m("Всего категорий: "),t.paginate?(l(),i("span",X$,u(t.paginate.meta.total||0),1)):r("",!0)]),e("div",Z$,[e("div",x$,[e("table",ey,[ty,e("tbody",null,[(l(!0),i(v,null,y(t.filteredProductCategories,(a,n)=>(l(),i("tr",null,[e("th",sy,u(a.id),1),e("td",null,[e("a",{href:"javascript:void(0)",onClick:d=>t.selectProductCategory(a),"data-bs-toggle":"modal","data-bs-target":"#product-form-edit"},null,8,oy),m(u(a.title),1)]),e("td",null,[e("button",{type:"button",onClick:d=>t.changeCategoryStatus(a),class:"btn btn-outline-success"},[a.is_active?(l(),i("span",iy,"Активная")):(l(),i("span",ny,"Не активная"))],8,ly)]),e("td",null,[e("button",{title:"Удалить товар",onClick:d=>t.removeProductCategory(a),class:"btn btn-outline-danger"},ry,8,ay)])]))),256))])])])]),t.paginate?(l(),$(j,{key:0,onPagination_page:t.nextProductCategories,pagination:t.paginate},null,8,["onPagination_page","pagination"])):r("",!0)],64))}}),my={class:"nav nav-tabs my-3"},hy={class:"nav-item"},_y={class:"nav-item"},py={class:"nav-item"},by={class:"nav-item"},fy={key:0},gy={class:"card mb-2"},vy=e("div",{class:"card-header"},[e("h6",null,"Управление магазином")],-1),$y={class:"card-body"},yy={class:"row"},ky={class:"col-12"},Fy={class:"form-label d-flex justify-content-between mt-2",id:"bot-level-3"},Cy=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),wy=e("div",null,"Ссылка на страницу ВК с товарами для вашего магазина в боте ",-1),Sy=e("a",{href:"https://vk.com/groups?w=groups_create",target:"_blank"},"Создать",-1),jy=["disabled"],qy=e("i",{class:"fa-regular fa-floppy-disk mr-2"},null,-1),zy={class:"row mb-3"},Py={class:"col-md-3"},Vy=["href"],Oy=pe('<div class="col-md-3"><button class="btn btn-outline-info w-100">Экспорт в XLS</button></div><div class="col-md-3"><button class="btn btn-outline-info w-100">Импорт из XLS</button></div><div class="col-md-3"><button class="btn btn-outline-danger w-100">Удалить товары</button></div>',3),Uy=e("div",{class:"row"},[e("div",{class:"col-md-3"},[e("button",{class:"btn btn-outline-info w-100"},"Экспортировать заказы")])],-1),Ay={key:1},Iy={class:"modal fade",id:"product-form-edit",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},Qy={class:"modal-dialog"},Ty={class:"modal-content"},By=e("div",{class:"modal-header"},[e("h1",{class:"modal-title fs-5",id:"exampleModalLabel"},"Modal title"),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),Ry={class:"modal-body"},My=e("div",{class:"modal-footer"},[e("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Close"),e("button",{type:"button",class:"btn btn-primary"},"Save changes")],-1),Dy={key:2},Ey={key:3},Ly={data(){return{load:!1,tab:0,url:null,link:null,bot:null,selectedProduct:null,selectedCategory:null,botForm:{vk_shop_link:null}}},computed:{...w(["getCurrentBot"])},mounted(){this.bot=this.getCurrentBot,this.botForm.vk_shop_link=this.bot.vk_shop_link||null,this.updateProducts()},methods:{updateShopLink(){this.load=!0,this.botForm.bot_id=this.bot.id,this.$store.dispatch("updateShopLink",{botForm:this.botForm}).then(s=>{this.load=!1,this.updateProducts(),this.$notify({title:"Менеджер магазина",text:"Ссылка на источник в ВК обновлена"})}).catch(()=>{this.load=!1})},refresh(){this.load=!0,this.selectedProduct=null,this.$nextTick(()=>{this.load=!1})},selectProduct(s){this.load=!0,this.$nextTick(()=>{this.selectedProduct=s,this.load=!1})},selectProductCategory(s){this.load=!0,this.$nextTick(()=>{this.selectedCategory=s,this.load=!1})},updateProducts(){this.load=!0,this.$store.dispatch("updateProductsFromVk",{dataObject:{bot_domain:this.getCurrentBot.bot_domain}}).then(s=>{this.link=s.data.url,this.load=!1,this.url=null}).catch(()=>{this.load=!1})}}},Ky=Object.assign(Ly,{__name:"Shop",setup(s){return(t,o)=>{const a=q("Popper");return l(),i(v,null,[e("ul",my,[e("li",hy,[e("a",{class:p(["nav-link",{active:t.tab===0}]),onClick:o[0]||(o[0]=n=>t.tab=0),"aria-current":"page",href:"#"},"Товары",2)]),e("li",_y,[e("a",{class:p(["nav-link",{active:t.tab===3}]),onClick:o[1]||(o[1]=n=>t.tab=3),href:"#"},"Категории товаров",2)]),e("li",py,[e("a",{class:p(["nav-link",{active:t.tab===1}]),onClick:o[2]||(o[2]=n=>t.tab=1),href:"#"},"Настройка&Обновление",2)]),e("li",by,[e("a",{class:p(["nav-link",{active:t.tab===2}]),onClick:o[3]||(o[3]=n=>t.tab=2),href:"#"},"Заказы",2)])]),t.tab===1?(l(),i("div",fy,[e("div",gy,[vy,e("div",$y,[e("div",yy,[e("div",ky,[e("form",{onSubmit:o[5]||(o[5]=S((...n)=>t.updateShopLink&&t.updateShopLink(...n),["prevent"])),class:"mb-2"},[e("label",Fy,[e("div",null,[g(a,null,{content:f(()=>[wy]),default:f(()=>[Cy]),_:1}),m(" ВК-группа ")]),Sy]),c(e("input",{type:"url",class:"form-control",placeholder:"Ссылка на группу ВК","aria-label":"ссылка на группу ВК","onUpdate:modelValue":o[4]||(o[4]=n=>t.botForm.vk_shop_link=n),"aria-describedby":"vk_shop_link"},null,512),[[_,t.botForm.vk_shop_link]]),e("button",{disabled:t.load,class:"btn btn-outline-primary mt-2 mb-2 w-100"},[qy,m(" Сохранить ")],8,jy)],32)])]),e("div",zy,[e("div",Py,[e("a",{target:"_blank",href:t.link,class:"btn btn-primary w-100"}," Обновить товар ",8,Vy)]),Oy]),Uy])])])):r("",!0),t.tab===0?(l(),i("div",Ay,[t.bot&&!t.load?(l(),$(G$,{key:0,bot:t.bot,onSelect:t.selectProduct},null,8,["bot","onSelect"])):r("",!0),e("div",Iy,[e("div",Qy,[e("div",Ty,[By,e("div",Ry,[t.bot&&!t.load?(l(),$(O$,{key:0,bot:t.bot,item:t.selectedProduct,onRefresh:t.refresh},null,8,["bot","item","onRefresh"])):r("",!0)]),My])])])])):r("",!0),t.tab===2?(l(),i("div",Dy)):r("",!0),t.tab===3?(l(),i("div",Ey,[t.bot&&!t.load?(l(),$(uy,{key:0,bot:t.bot,onSelect:t.selectProductCategory},null,8,["bot","onSelect"])):r("",!0)])):r("",!0)],64)}}}),Ny={props:["data"],data(){return{hasConnect:!1,bot:null,amoForm:{client_id:null,client_secret:null,auth_code:null,redirect_uri:null,subdomain:null,bot_id:null}}},computed:{...w(["getCurrentBot"])},mounted(){this.bot=this.getCurrentBot,this.data?this.$nextTick(()=>{this.amoForm.client_id=this.data.client_id||null,this.amoForm.client_secret=this.data.client_secret||null,this.amoForm.auth_code=this.data.auth_code||null,this.amoForm.redirect_uri=this.data.redirect_uri||null,this.amoForm.subdomain=this.data.subdomain||null,this.amoForm.bot_id=this.data.bot_id||this.bot.id||null}):this.amoForm.bot_id=this.bot.id||null},methods:{submitAmo(){let s=new FormData;Object.keys(this.amoForm).forEach(t=>{const o=this.amoForm[t]||"";typeof o=="object"?s.append(t,JSON.stringify(o)):s.append(t,o)}),this.$store.dispatch("saveAmoCRM",{amoForm:s}).then(t=>{this.$notify("Данные CRM успешно сохранены")}).catch(t=>{})}}},Jy=e("div",{class:"col-12"},[e("p",null,[e("a",{target:"_blank",href:"https://www.amocrm.ru/developers/content/oauth/step-by-step"},"Документация для разработчика "),m(" по шагам")])],-1),Yy={class:"col-md-6 col-12 mb-2"},Hy={class:"form-label",id:"client_id"},Gy=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),Wy=e("div",null,"ID интеграции",-1),Xy=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),Zy={class:"col-md-6 col-12 mb-2"},xy={class:"form-label",id:"client_secret"},e2=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),t2=e("div",null,"Секрет интеграции",-1),s2=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),o2={class:"col-md-6 mb-2"},l2={class:"form-label",id:"auth_code"},i2=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),n2=e("div",null,"Полученный код авторизации",-1),a2=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),d2={class:"col-md-6 col-12 mb-2"},r2={class:"form-label",id:"subdomain2"},c2=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),u2=e("div",null,"Ваш поддомен в системе AMO CRM",-1),m2=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),h2=e("div",{class:"col-md-12 col-12"},[e("button",{type:"submit",class:"btn btn-outline-primary p-3 w-100"},[e("i",{class:"fa-solid fa-cloud-arrow-down mr-1"}),m(" Сохранить настройку AMO ")])],-1);function _2(s,t,o,a,n,d){const h=q("Popper");return l(),i("form",{onSubmit:t[4]||(t[4]=S((...b)=>d.submitAmo&&d.submitAmo(...b),["prevent"])),class:"row"},[Jy,e("div",Yy,[e("label",Hy,[g(h,null,{content:f(()=>[Wy]),default:f(()=>[Gy]),_:1}),m(" client_id "),Xy]),c(e("input",{type:"text",class:"form-control",placeholder:"client_id","aria-label":"client_id","onUpdate:modelValue":t[0]||(t[0]=b=>n.amoForm.client_id=b),"aria-describedby":"client_id"},null,512),[[_,n.amoForm.client_id]])]),e("div",Zy,[e("label",xy,[g(h,null,{content:f(()=>[t2]),default:f(()=>[e2]),_:1}),m(" client_secret "),s2]),c(e("input",{type:"text",class:"form-control",placeholder:"client_secret","aria-label":"client_secret","onUpdate:modelValue":t[1]||(t[1]=b=>n.amoForm.client_secret=b),"aria-describedby":"client_secret"},null,512),[[_,n.amoForm.client_secret]])]),e("div",o2,[e("label",l2,[g(h,null,{content:f(()=>[n2]),default:f(()=>[i2]),_:1}),m(" auth_code "),a2]),c(e("textarea",{class:"form-control",placeholder:"auth_code","aria-label":"auth_code","onUpdate:modelValue":t[2]||(t[2]=b=>n.amoForm.auth_code=b),"aria-describedby":"auth_code"},`
                                    `,512),[[_,n.amoForm.auth_code]])]),e("div",d2,[e("label",r2,[g(h,null,{content:f(()=>[u2]),default:f(()=>[c2]),_:1}),m(" subdomain "),m2]),c(e("input",{type:"text",class:"form-control",placeholder:"subdomain","aria-label":"subdomain","onUpdate:modelValue":t[3]||(t[3]=b=>n.amoForm.subdomain=b),"aria-describedby":"subdomain"},null,512),[[_,n.amoForm.subdomain]])]),h2],32)}const p2=I(Ny,[["render",_2]]),b2={props:["data"],data(){return{load:!1,bot:null,yClientsForm:{login:null,password:null,partner_token:null,company:null}}},computed:{...w(["getCurrentBot"])},mounted(){this.bot=this.getCurrentBot,this.data&&this.$nextTick(()=>{this.yClientsForm.login=this.data.login||null,this.yClientsForm.password=this.data.password||null,this.yClientsForm.partner_token=this.data.partner_token||null,this.yClientsForm.company=this.data.company||null})},methods:{submitYClients(){let s=new FormData;Object.keys(this.yClientsForm).forEach(t=>{const o=this.yClientsForm[t]||"";typeof o=="object"?s.append(t,JSON.stringify(o)):s.append(t,o)}),s.append("bot_id",this.bot.id),this.$store.dispatch("saveYClients",{yClientsForm:s}).then(t=>{this.$notify({title:"Работа с YClients",text:"Данные YClients успешно сохранены",type:"success"})}).catch(t=>{this.$notify({title:"Работа с YClients",text:"Ошибка сохранения данных",type:"error"})})}}},f2=e("h6",null,"Настройка YClients",-1),g2={class:"row"},v2={class:"col-md-12"},$2={class:"mb-2"},y2=e("label",{class:"form-label d-flex justify-content-between mt-2",for:"login"},[m(" Логин "),e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно")],-1),k2={class:"mb-2"},F2=e("label",{class:"form-label d-flex justify-content-between mt-2",for:"password"},[m(" Пароль "),e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно")],-1),C2={class:"mb-2"},w2=e("label",{class:"form-label d-flex justify-content-between mt-2",for:"partner_token"},[m(" Партнерский тоукен "),e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно")],-1),S2={class:"mb-2"},j2=e("label",{class:"form-label d-flex justify-content-between mt-2",for:"partner_token"},[m(" ID компании, в которую записывать клиентов "),e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно")],-1),q2=e("button",{class:"btn btn-success w-100 r mb-3 text-uppercase font-900"}," Сохранить ",-1);function z2(s,t,o,a,n,d){return l(),i(v,null,[f2,e("form",{onSubmit:t[4]||(t[4]=S((...h)=>d.submitYClients&&d.submitYClients(...h),["prevent"]))},[e("div",g2,[e("div",v2,[e("div",$2,[y2,c(e("input",{type:"text",id:"login",class:"form-control",placeholder:"Ваш логин","aria-label":"Ваш логин","onUpdate:modelValue":t[0]||(t[0]=h=>n.yClientsForm.login=h),"aria-describedby":"Ваш логин",required:""},null,512),[[_,n.yClientsForm.login]])]),e("div",k2,[F2,c(e("input",{type:"text",id:"password",class:"form-control",placeholder:"Ваш пароль","aria-label":"Ваш пароль","onUpdate:modelValue":t[1]||(t[1]=h=>n.yClientsForm.password=h),"aria-describedby":"Ваш пароль",required:""},null,512),[[_,n.yClientsForm.password]])]),e("div",C2,[w2,c(e("input",{type:"text",id:"partner_token",class:"form-control",placeholder:"Ваш партнерский тоукен","aria-label":"Ваш партнерский тоукен","onUpdate:modelValue":t[2]||(t[2]=h=>n.yClientsForm.partner_token=h),"aria-describedby":"Ваш партнерский тоукен",required:""},null,512),[[_,n.yClientsForm.partner_token]])]),e("div",S2,[j2,c(e("input",{type:"number",id:"throttle",class:"form-control",placeholder:"ID компании","aria-label":"ID компании","onUpdate:modelValue":t[3]||(t[3]=h=>n.yClientsForm.company=h),"aria-describedby":"ID компании",required:""},null,512),[[_,n.yClientsForm.company]])])])]),q2],32)],64)}const P2=I(b2,[["render",z2]]),V2={class:"py-2"},O2={class:"nav nav-tabs"},U2={class:"nav-item"},A2={class:"nav-item"},I2={key:0,class:"row"},Q2={class:"col-12 py-2"},T2={key:1,class:"row"},B2={class:"col-12 py-2"},R2={class:"col-12"},M2={props:["bot"],data(){return{tab:1,load:!1,loadMailingTable:!1}},mounted(){},methods:{callbackPersonalMail(){this.loadMailingTable=!0,this.$nextTick(()=>{this.loadMailingTable=!1})}}},D2=Object.assign(M2,{__name:"Mail",setup(s){return(t,o)=>(l(),i("div",V2,[e("ul",O2,[e("li",U2,[e("a",{class:p(["nav-link",{active:t.tab===0}]),onClick:o[0]||(o[0]=a=>t.tab=0),"aria-current":"page",href:"#"},"Рассылка в канал",2)]),e("li",A2,[e("a",{class:p(["nav-link",{active:t.tab===1}]),onClick:o[1]||(o[1]=a=>t.tab=1),href:"#"},"Рассылка в бота",2)])]),t.tab===0?(l(),i("div",I2,[e("div",Q2,[g(me)])])):r("",!0),t.tab===1?(l(),i("div",T2,[e("div",B2,[g(he,{onCallback:t.callbackPersonalMail},null,8,["onCallback"])]),e("div",R2,[t.loadMailingTable?r("",!0):(l(),$(_e,{key:0,bot:s.bot},null,8,["bot"]))])])):r("",!0)]))}}),E2={data(){return{load:!1,bot:null,fieldTypes:[{title:"Текст",value:0},{title:"Число",value:1},{title:"Логический",value:2},{title:"Дата и время",value:3}],fieldForm:{fields:[]}}},computed:{...w(["getCurrentBot"])},mounted(){this.loadCurrentBot().then(()=>{this.bot=this.getCurrentBot,this.$nextTick(()=>{this.fieldForm.fields=this.bot.field_settings||[]}),this.loadCurrentBotFields()})},methods:{loadCurrentBotFields(){return this.$store.dispatch("loadCurrentBotFields",{bot_id:this.bot.id}).then(s=>{this.fieldForm.fields=s.data||[]})},loadCurrentBot(s=null){return this.$store.dispatch("updateCurrentBot",{bot:s}).then(()=>{this.bot=this.getCurrentBot})},removeField(s){this.fieldForm.fields.splice(s,1)},submit(){let s=new FormData;Object.keys(this.fieldForm).forEach(t=>{const o=this.fieldForm[t]||"";typeof o=="object"?s.append(t,JSON.stringify(o)):s.append(t,o)}),s.append("bot_id",this.bot.id),this.$store.dispatch("storeBotFields",{dataObject:s}).then(t=>{this.$notify({title:"Конструктор ботов",text:"Поля успешно обновлены",type:"success"}),this.fieldForm.fields=[],this.fieldForm.fields=t.data}).catch(t=>{this.$notify({title:"Конструктор ботов",text:"Ошибка обновления полей",type:"error"})})},addField(){if(this.fieldForm.fields||(this.fieldForm.fields=[]),this.fieldForm.fields.length>0&&this.fieldForm.fields.findIndex(t=>t.key==null)!==-1){this.$notify({title:"Настраиваемые поля",text:"У вас есть пустые ключевые поля!",type:"error"});return}this.fieldForm.fields.push({key:null,type:0,label:null,description:null,required:!1,validate_pattern:null})}}},L2={class:"mb-2"},K2={class:"d-flex justify-content-between"},N2=e("h6",null,"Настройка полей пользователя бота",-1),J2=e("i",{class:"fa-solid fa-plus mr-2"},null,-1),Y2=e("p",null,[e("em",null,"Данные поля будут добавлены пользователю бота и будут автоматически учитываться в условиях страниц, скриптах (в формах заполнения данных), диалогах. Ключи должны быть уникальные для каждого бота. Если ключ дублируется, то будет использовано более позднее его значение. Если поле добавлено и сохранено, то удалить его уже нельзя, только скрыть. "),m(". "),e("br"),e("span",{class:"text-danger"},"*"),m(" - обязательное поле ")],-1),H2={class:"table"},G2=e("thead",null,[e("tr",null,[e("th",{scope:"col"},"#"),e("th",{scope:"col"},[m("Ключ"),e("span",{class:"text-danger"},"*")]),e("th",{scope:"col"},[m("Подпись поля"),e("span",{class:"text-danger"},"*")]),e("th",{scope:"col"},[m("Тип поля"),e("span",{class:"text-danger"},"*")]),e("th",{scope:"col"},"Паттерн"),e("th",{scope:"col"},"Обязательный"),e("th",{scope:"col"},[m("Вопрос для анкеты"),e("span",{class:"text-danger"},"*")]),e("th",{scope:"col"})])],-1),W2={scope:"row"},X2={scope:"col"},Z2=["onUpdate:modelValue"],x2={scope:"col"},ek=["onUpdate:modelValue"],tk={scope:"col"},sk=["onUpdate:modelValue"],ok=["value"],lk={scope:"col"},ik=["disabled","onUpdate:modelValue"],nk={scope:"col"},ak={class:"form-check"},dk=["onUpdate:modelValue","id"],rk=["for"],ck={key:0},uk={key:1},mk={scope:"col"},hk=["onUpdate:modelValue"],_k={scope:"col"},pk=["onClick"],bk=e("i",{class:"fa-regular fa-trash-can"},null,-1),fk=[bk],gk={key:1,class:"form-check mt-2"},vk=["onUpdate:modelValue","id"],$k=["for"],yk={key:0},kk=e("i",{class:"fa-solid fa-eye text-success"},null,-1),Fk=[kk],Ck={key:1},wk=e("i",{class:"fa-solid fa-eye-slash text-danger"},null,-1),Sk=[wk],jk=e("button",{type:"submit",class:"btn btn-success w-100 p-3"}," Сохранить поля ",-1);function qk(s,t,o,a,n,d){return l(),i("div",L2,[e("div",K2,[N2,e("button",{type:"button",onClick:t[0]||(t[0]=h=>d.addField()),class:"btn mb-2 rounded-sm btn-outline-info"},[J2,m(" Добавить параметр ")])]),Y2,e("form",{onSubmit:t[1]||(t[1]=S((...h)=>d.submit&&d.submit(...h),["prevent"]))},[e("table",H2,[G2,e("tbody",null,[(l(!0),i(v,null,y(n.fieldForm.fields,(h,b)=>(l(),i("tr",null,[e("th",W2,u(b+1),1),e("th",X2,[c(e("input",{type:"text",class:"form-control mb-2 w-100",placeholder:"Ключ","aria-label":"Ключ",maxlength:"255","onUpdate:modelValue":F=>n.fieldForm.fields[b].key=F,required:""},null,8,Z2),[[_,n.fieldForm.fields[b].key]])]),e("th",x2,[c(e("input",{type:"text",class:"form-control mb-2 w-100",placeholder:"Подпись поля","aria-label":"Название поля",maxlength:"255","onUpdate:modelValue":F=>n.fieldForm.fields[b].label=F,required:""},null,8,ek),[[_,n.fieldForm.fields[b].label]])]),e("th",tk,[c(e("select",{class:"form-select","onUpdate:modelValue":F=>n.fieldForm.fields[b].type=F},[(l(!0),i(v,null,y(n.fieldTypes,F=>(l(),i("option",{value:F.value},u(F.title||"Не указан"),9,ok))),256))],8,sk),[[Q,n.fieldForm.fields[b].type]])]),e("th",lk,[c(e("input",{type:"text",class:"form-control mb-2 w-100",placeholder:"Паттерн","aria-label":"Паттерн",maxlength:"255",disabled:n.fieldForm.fields[b].type===2,"onUpdate:modelValue":F=>n.fieldForm.fields[b].validate_pattern=F},null,8,ik),[[_,n.fieldForm.fields[b].validate_pattern]])]),e("th",nk,[e("div",ak,[c(e("input",{class:"form-check-input","onUpdate:modelValue":F=>n.fieldForm.fields[b].required=F,type:"checkbox",value:"",id:"field-required"+b},null,8,dk),[[k,n.fieldForm.fields[b].required]]),e("label",{class:"form-check-label",for:"field-required"+b},[n.fieldForm.fields[b].required?(l(),i("span",ck,"Да")):r("",!0),n.fieldForm.fields[b].required?r("",!0):(l(),i("span",uk,"Нет"))],8,rk)])]),e("th",mk,[c(e("input",{type:"text",class:"form-control mb-2 w-100",placeholder:"Описание вопроса","aria-label":"Описание вопроса",maxlength:"255","onUpdate:modelValue":F=>n.fieldForm.fields[b].description=F,required:""},null,8,hk),[[_,n.fieldForm.fields[b].description]])]),e("th",_k,[n.fieldForm.fields[b].id?(l(),i("div",gk,[c(e("input",{class:"form-check-input d-none","onUpdate:modelValue":F=>n.fieldForm.fields[b].is_active=F,type:"checkbox",value:"",id:"field-is_active-"+b},null,8,vk),[[k,n.fieldForm.fields[b].is_active]]),e("label",{class:"form-check-label",for:"field-is_active-"+b},[n.fieldForm.fields[b].is_active?(l(),i("span",yk,Fk)):r("",!0),n.fieldForm.fields[b].is_active?r("",!0):(l(),i("span",Ck,Sk))],8,$k)])):(l(),i("button",{key:0,type:"button",onClick:F=>d.removeField(b),class:"btn btn-link text-danger"},fk,8,pk))])]))),256))])]),jk],32)])}const zk=I(E2,[["render",qk]]),Pk={class:"row"},Vk={class:"input-group mb-3"},Ok={key:0,class:"row"},Uk={class:"col-12 col-md-12 mb-3"},Ak={class:"table"},Ik=e("thead",null,[e("tr",null,[e("th",{scope:"col"},"#"),e("th",{scope:"col"},"Тип"),e("th",{scope:"col"},"Подпись"),e("th",{scope:"col"},"File Id"),e("th",{scope:"col"},"Действия")])],-1),Qk={scope:"row"},Tk={class:"badge bg-info rounded-pill"},Bk={style:{"word-break":"break-all"}},Rk={style:{"word-break":"break-all"}},Mk={style:{"min-width":"200px"}},Dk=["onClick"],Ek=e("i",{class:"fa-solid fa-eye"},null,-1),Lk=[Ek],Kk=["onClick"],Nk=e("i",{class:"fa-brands fa-telegram"},null,-1),Jk=[Nk],Yk=["onClick"],Hk=e("i",{class:"fa-solid fa-trash"},null,-1),Gk=[Hk],Wk={class:"col-12"},Xk={key:1,class:"row"},Zk=e("div",{class:"col-12"},[e("div",{class:"alert alert-warning",role:"alert"}," У выбранного бота нет медиа-файлов ")],-1),xk=[Zk],e0={class:"modal fade",id:"preview-modal",tabindex:"-1","aria-labelledby":"preview-modal-label","aria-hidden":"true"},t0={class:"modal-dialog"},s0={class:"modal-content"},o0={class:"modal-body"},l0={key:0,class:"d-flex justify-content-center align-items-center"},i0=e("div",{class:"modal-footer"},[e("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Закрыть")],-1),n0={data(){return{bot:null,previewContent:null,loading:!0,media:[],search:null,media_paginate_object:null}},computed:{...w(["getMedia","getMediaPaginateObject","getCurrentBot"])},mounted(){this.loadCurrentBot().then(()=>{this.loadMedia()})},methods:{selectMedia(s){this.$emit("select",s)},loadCurrentBot(s=null){return this.$store.dispatch("updateCurrentBot",{bot:s}).then(()=>{this.bot=this.getCurrentBot})},nextMedia(s){this.loadMedia(s)},remove(s){this.$store.dispatch("removeMedia",{dataObject:{mediaId:s}}).then(t=>{this.loadMedia(),this.$notify({title:"Удаление медиа-контента",text:"Медиа контент удален"})}).catch(()=>{})},showPreview(s){this.previewContent=null,this.$nextTick(()=>{this.previewContent=s,new bootstrap.Modal("#preview-modal",{}).show()})},showPreviewInTg(s){this.$store.dispatch("showMediaPreview",{dataObject:{mediaId:s}}).then(t=>{this.$notify({title:"Превью медиа-контента",text:"Отправлено в бота"})}).catch(()=>{})},loadMedia(s=0){this.loading=!0,this.$store.dispatch("loadMedia",{dataObject:{bot_id:this.bot.id||null,search:this.search,needVideo:!0,needVideoNote:!0,needPhoto:!0,needAudio:!0,needDocument:!0,needSticker:!0},page:s}).then(t=>{this.loading=!1,this.media=this.getMedia,this.media_paginate_object=this.getMediaPaginateObject}).catch(()=>{this.loading=!1})}}},a0=Object.assign(n0,{__name:"BotMediaTable",setup(s){return(t,o)=>(l(),i(v,null,[e("div",Pk,[e("div",Vk,[c(e("input",{type:"search",class:"form-control",placeholder:"Поиск файла","aria-label":"Поиск файла","onUpdate:modelValue":o[0]||(o[0]=a=>t.search=a)},null,512),[[_,t.search]]),e("button",{class:"btn btn-outline-secondary",onClick:o[1]||(o[1]=a=>t.loadMedia(0)),type:"button",id:"button-addon2"},"Найти ")])]),t.media.length>0?(l(),i("div",Ok,[e("div",Uk,[e("table",Ak,[Ik,e("tbody",null,[(l(!0),i(v,null,y(t.media,(a,n)=>(l(),i("tr",null,[e("th",Qk,u(a.id),1),e("td",null,[e("span",Tk,u(a.type),1)]),e("td",null,[e("p",Bk,u(a.caption??"Без подписи"),1)]),e("td",null,[e("p",Rk,u(a.file_id),1)]),e("td",null,[e("div",Mk,[e("a",{href:"javascript:void(0)",class:"btn btn-info mr-2",onClick:d=>t.showPreview(a)},Lk,8,Dk),e("a",{href:"javascript:void(0)",class:"btn btn-info mr-2",onClick:d=>t.showPreviewInTg(a.id)},Jk,8,Kk),e("a",{href:"javascript:void(0)",class:"btn btn-outline-danger text-danger",onClick:d=>t.remove(a.id)},Gk,8,Yk)])])]))),256))])])]),e("div",Wk,[t.media_paginate_object?(l(),$(j,{key:0,onPagination_page:t.nextMedia,pagination:t.media_paginate_object},null,8,["onPagination_page","pagination"])):r("",!0)])])):(l(),i("div",Xk,xk)),e("div",e0,[e("div",t0,[e("div",s0,[e("div",o0,[t.previewContent!=null?(l(),i("div",l0,[g(J,{type:t.previewContent.type,content:t.previewContent.file_id},null,8,["type","content"])])):r("",!0)]),i0])])])],64))}}),d0={class:"row py-3"},r0={class:"col-12"},c0={class:"row"},u0={class:"col-12"},m0={key:0},h0={key:1},_0={key:0,class:"col-12 mb-3"},p0={class:"col-12 mb-3"},b0={key:0},f0={key:1},g0={key:1,class:"col-12 mb-3"},v0={class:"row py-3"},$0=e("div",{class:"col-12"},[e("p",{class:"mb-0"},"Выбор статуса")],-1),y0={class:"col-md-3"},k0=["onClick"],F0={class:"row"},C0={class:"col-12 mb-3"},w0={class:"form-label",id:"service-title"},S0=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),j0=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),q0={class:"col-12 mb-3"},z0={class:"form-label",id:"service-title"},P0=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),V0=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),O0={class:"col-12 mb-3"},U0={class:"form-label",id:"appointment-info"},A0=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),I0=e("div",null," Краткая информация от клиента ",-1),Q0=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),T0={key:0,class:"text-gray-400 ml-3",style:{"font-size":"10px"}},B0={class:"row"},R0={class:"col-12"},M0={type:"submit",class:"btn btn-outline-success w-100 p-3"},D0={key:0},E0={key:1},L0={props:["eventId","bot","appointment"],data(){return{step:0,load:!1,selected_schedule_time:null,selected_bot_user:null,need_load_users:!1,need_schedule_time:!1,statuses:[{value:0,title:"Новая запись"},{value:1,title:"Подтверждение записи"},{value:2,title:"Прохождение по записи"},{value:3,title:"Отмена записи"}],days:["понедельник","вторник","среду","четверг","пятницу","субботу","воскресенье"],appointmentForm:{id:null,appointment_event_id:null,appointment_schedule_id:null,bot_user_id:null,status:0,name:null,phone:null,info:null}}},mounted(){this.appointment&&this.$nextTick(()=>{this.appointmentForm={id:this.appointment.id||null,appointment_event_id:this.appointment.appointment_event_id||null,appointment_schedule_id:this.appointment.appointment_schedule_id||null,bot_user_id:this.appointment.bot_user_id||null,status:this.appointment.status||0,name:this.appointment.name||null,phone:this.appointment.phone||null,info:this.appointment.info||null},this.selected_schedule_time=this.appointment.schedule||null,this.selected_bot_user=this.appointment.botUser||null})},methods:{selectScheduleTime(s){if(s.appointment){this.$notify("Данное время уже занято!");return}this.selected_schedule_time=s,this.need_schedule_time=!1},selectBotUser(s){this.selected_bot_user=s,this.need_load_users=!1},clearAppointmentForm(){this.appointmentForm={id:null,appointment_event_id:null,appointment_schedule_id:null,bot_user_id:null,status:0},this.selected_schedule_time=null,this.selected_bot_user=null},submitForm(){this.appointmentForm.bot_user_id=this.selected_bot_user.id,this.appointmentForm.appointment_schedule_id=this.selected_schedule_time.id,this.appointmentForm.appointment_event_id=this.eventId;let s=new FormData;Object.keys(this.appointmentForm).forEach(t=>{const o=this.appointmentForm[t]||"";typeof o=="object"?s.append(t,JSON.stringify(o)):s.append(t,o)}),s.append("bot_id",this.bot.id),this.$store.dispatch("storeAppointment",{dataObject:{appointmentForm:s}}).then(t=>{this.clearAppointmentForm(),this.$emit("callback"),this.$notify("Запись успешно создана")}).catch(t=>{this.$notify("Ошибка создания записи")})}}},K0=Object.assign(L0,{__name:"AppointmentForm",setup(s){return(t,o)=>{const a=q("Popper"),n=A("mask");return l(),i(v,null,[e("div",d0,[e("div",r0,[e("button",{onClick:o[0]||(o[0]=(...d)=>t.clearAppointmentForm&&t.clearAppointmentForm(...d)),class:"btn btn-primary"},"Новая заявка ")])]),e("form",{onSubmit:o[6]||(o[6]=S((...d)=>t.submitForm&&t.submitForm(...d),["prevent"]))},[e("div",c0,[e("div",u0,[e("a",{href:"javascript:void(0)",class:"btn btn-link",onClick:o[1]||(o[1]=d=>t.need_load_users=!t.need_load_users)},[t.selected_bot_user==null?(l(),i("span",m0,"Выберите пользователя")):r("",!0),t.selected_bot_user?(l(),i("span",h0," Пользователь "+u(t.selected_bot_user.name||t.selected_bot_user.fio_from_telegram||t.selected_bot_user.telegram_chat_id||"-"),1)):r("",!0)])]),t.need_load_users?(l(),i("div",_0,[g(D,{simple:!0,onSelect:t.selectBotUser},null,8,["onSelect"])])):r("",!0),e("div",p0,[e("a",{href:"javascript:void(0)",class:"btn btn-link",onClick:o[2]||(o[2]=d=>t.need_schedule_time=!t.need_schedule_time)},[t.selected_schedule_time==null?(l(),i("span",b0,"Выберите время в расписании")):r("",!0),t.selected_schedule_time?(l(),i("span",f0," Запись на "+u(t.days[t.selected_schedule_time.day-1]||"-")+" с "+u(t.selected_schedule_time.start_time||"-")+" до "+u(t.selected_schedule_time.end_time||"-"),1)):r("",!0)])]),t.need_schedule_time?(l(),i("div",g0,[g(le,{"event-id":s.eventId,bot:s.bot,onSelect:t.selectScheduleTime},null,8,["event-id","bot","onSelect"])])):r("",!0)]),e("div",v0,[$0,(l(!0),i(v,null,y(t.statuses,d=>(l(),i("div",y0,[e("button",{type:"button",class:p([{"btn-success text-white":t.appointmentForm.status==d.value},"btn btn-outline-success w-100"]),onClick:h=>t.appointmentForm.status=d.value},u(d.title||"не указано"),11,k0)]))),256))]),e("div",F0,[e("div",C0,[e("label",w0,[g(a,{content:"ФИО человека, который посетит запись"},{default:f(()=>[S0]),_:1}),m(" Ф.И.О. посетителя "),j0]),c(e("input",{type:"text",class:"form-control",placeholder:"Иванов Иван Иванович","aria-label":"ФИО","onUpdate:modelValue":o[3]||(o[3]=d=>t.appointmentForm.name=d),maxlength:"255","aria-describedby":"appointment-name",required:""},null,512),[[_,t.appointmentForm.name]])]),e("div",q0,[e("label",z0,[g(a,{content:"Номер телефона человека, который посетит запись"},{default:f(()=>[P0]),_:1}),m(" Телефонный номер "),V0]),c(e("input",{type:"text",class:"form-control",placeholder:"+7(000)000-00-00","aria-label":"номер телефона","onUpdate:modelValue":o[4]||(o[4]=d=>t.appointmentForm.phone=d),maxlength:"255","aria-describedby":"appointment-phone",required:""},null,512),[[n,"+7(###)###-##-##"],[_,t.appointmentForm.phone]])]),e("div",O0,[e("label",U0,[g(a,null,{content:f(()=>[I0]),default:f(()=>[A0]),_:1}),m(" Описание услуги "),Q0,t.appointmentForm.info?(l(),i("small",T0," Длина текста "+u(t.appointmentForm.info.length)+" / 255",1)):r("",!0)]),c(e("textarea",{type:"text",class:"form-control",placeholder:"Информация от клиента","aria-label":"Информация от клиента",maxlength:"255","onUpdate:modelValue":o[5]||(o[5]=d=>t.appointmentForm.info=d),"aria-describedby":"appointment-info",required:""},`
                    `,512),[[_,t.appointmentForm.info]])])]),e("div",B0,[e("div",R0,[e("button",M0,[t.appointmentForm.id==null?(l(),i("span",D0,"Записаться")):(l(),i("span",E0,"Обновить запись"))])])])],32)],64)}}}),N0={class:"row"},J0={class:"col-12"},Y0={key:0,class:"table"},H0=e("th",{scope:"col"},"Действие",-1),G0=["onClick"],W0={scope:"row"},X0={key:0},Z0={key:0,class:"dropdown"},x0=e("button",{class:"btn btn-outline-secondary",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-solid fa-ellipsis"})],-1),e3={class:"dropdown-menu"},t3={key:0},s3=["onClick"],o3={key:1},l3={class:"col-12"},i3={props:["bot","eventId"],data(){return{direction:"desc",order:"updated_at",show:!0,is_group:!1,loading:!0,services:[],search:null,statuses:["Новая запись","Подтверждение записи","Прохождение по записи","Отмена записи"],days:["понедельник","вторник","среду","четверг","пятницу","субботу","воскресенье"],paginate_object:null}},computed:{...w(["getAppointments","getAppointmentsPaginateObject"])},mounted(){this.loadAppointments()},methods:{nextAppointments(s){this.loadAppointments(s)},selectAppointment(s){this.$emit("select",s)},loadAndOrder(s){this.order=s,this.direction=this.direction==="desc"?"asc":"desc",this.loadAppointments(0)},removeAppointment(s){this.loading=!0,this.$store.dispatch("removeAppointment",{dataObject:{appointmentId:s}}).then(t=>{this.loading=!1,this.loadAppointments(0),this.$notify("Запись успешно удалена")}).catch(()=>{this.loading=!1,this.$notify("Ошибка удаления записи")})},loadAppointments(s=0){this.loading=!0,this.$store.dispatch("loadAppointments",{dataObject:{event_id:this.eventId,bot_id:this.bot.id||null,search:this.search,order:this.order,direction:this.direction},page:s,size:100}).then(t=>{this.loading=!1,this.services=this.getAppointments,this.paginate_object=this.getAppointmentsPaginateObject}).catch(()=>{this.loading=!1})}}},n3=Object.assign(i3,{__name:"AppointmentsTable",setup(s){return(t,o)=>(l(),i("div",N0,[e("div",J0,[t.services.length>0?(l(),i("table",Y0,[e("thead",null,[e("tr",null,[e("th",{scope:"col",class:"cursor-pointer",onClick:o[0]||(o[0]=a=>t.loadAndOrder("id"))},"#"),e("th",{scope:"col",class:"cursor-pointer",onClick:o[1]||(o[1]=a=>t.loadAndOrder("bot_user_id"))},"Пользователь"),e("th",{scope:"col",class:"cursor-pointer",onClick:o[2]||(o[2]=a=>t.loadAndOrder("appointment_schedule_id"))},"Дата записи "),e("th",{scope:"col",class:"cursor-pointer",onClick:o[3]||(o[3]=a=>t.loadAndOrder("status"))},"Статус"),e("th",{scope:"col",class:"cursor-pointer",onClick:o[4]||(o[4]=a=>t.loadAndOrder("name"))},"Посетитель"),e("th",{scope:"col",class:"cursor-pointer",onClick:o[5]||(o[5]=a=>t.loadAndOrder("phone"))},"Телефон посетителя"),e("th",{scope:"col",class:"cursor-pointer",onClick:o[6]||(o[6]=a=>t.loadAndOrder("info"))},"Доп.инф"),e("th",{scope:"col",class:"cursor-pointer",onClick:o[7]||(o[7]=a=>t.loadAndOrder("updated_at"))},"Дата изменения"),H0])]),e("tbody",null,[(l(!0),i(v,null,y(t.services,(a,n)=>(l(),i("tr",{onClick:d=>t.selectAppointment(a),class:p({"border-info":a.deleted_at==null,"border-danger":a.deleted_at!=null})},[e("th",W0,u(a.id),1),e("td",null,u(a.botUser.fio_from_telegram||a.botUser.telegram_chat_id||"Не указано"),1),e("td",null,[a.schedule?(l(),i("p",X0," Запись на "+u(t.days[a.schedule.day-1]||"Не указано")+" с "+u(a.schedule.start_time||"Не указано")+" до "+u(a.schedule.end_time||"Не указано"),1)):r("",!0)]),e("td",null,u(t.statuses[a.status]),1),e("td",null,u(t.$filters.current(a.updated_at)),1),e("td",null,u(a.name||"не указано"),1),e("td",null,u(a.phone||"не указано"),1),e("td",null,u(a.info||"не указано"),1),e("td",null,[a.id?(l(),i("div",Z0,[x0,e("ul",e3,[a.deleted_at==null?(l(),i("li",t3,[e("a",{class:"dropdown-item",onClick:d=>t.removeAppointment(a.id),href:"javascript:void(0)"},"Удалить",8,s3)])):r("",!0)])])):r("",!0)])],10,G0))),256))])])):(l(),i("p",o3,"На текущий момент нет ни одного созданного сервиса"))]),e("div",l3,[t.paginate_object?(l(),$(j,{key:0,onPagination_page:t.nextAppointments,pagination:t.paginate_object},null,8,["onPagination_page","pagination"])):r("",!0)])]))}}),a3={class:"row py-2"},d3={class:"col-12"},r3={class:"input-group mb-3"},c3={class:"col-12"},u3={key:0,class:"table"},m3=e("th",{scope:"col"},"Действие",-1),h3={scope:"row"},_3=["onClick"],p3={key:0,class:"fa-solid fa-chevron-down text-success"},b3={key:1,class:"fa-solid fa-xmark text-danger"},f3={key:0,class:"dropdown"},g3=e("button",{class:"btn btn-outline-secondary",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-solid fa-ellipsis"})],-1),v3={class:"dropdown-menu"},$3={key:0},y3=["onClick"],k3={key:1},F3=["onClick"],C3={key:1},w3={class:"col-12"},S3={props:["bot"],data(){return{direction:"desc",order:"updated_at",show:!0,is_group:!1,loading:!0,events:[],search:null,paginate_object:null}},computed:{...w(["getAppointmentEvents","getAppointmentEventsPaginateObject"])},mounted(){this.loadAppointmentEvents()},methods:{duplicateAppointmentEvent(s){this.loading=!0,this.$store.dispatch("duplicateAppointmentEvent",{dataObject:{appointmentEventId:s,bot_id:this.bot.id}}).then(t=>{this.loading=!1,this.loadAppointmentEvents(0),this.$notify("Событие успешно продублировано")}).catch(()=>{this.loading=!1,this.$notify("Ошибка дублирования события")})},removeAppointmentEvent(s){this.loading=!0,this.$store.dispatch("removeAppointmentEvent",{dataObject:{appointmentEventId:s}}).then(t=>{this.loading=!1,this.loadAppointmentEvents(0),this.$notify("Событие успешно удалено")}).catch(()=>{this.loading=!1,this.$notify("Ошибка удаления события")})},nextAppointmentEvents(s){this.loadAppointmentEvents(s)},selectEvent(s){this.$emit("select",s)},loadAndOrder(s){this.order=s,this.direction=this.direction==="desc"?"asc":"desc",this.loadAppointmentEvents(0)},loadAppointmentEvents(s=0){this.loading=!0,this.$store.dispatch("loadAppointmentEvents",{dataObject:{bot_id:this.bot.id||null,search:this.search,is_group:this.is_group,order:this.order,direction:this.direction},page:s,size:20}).then(t=>{this.loading=!1,this.events=this.getAppointmentEvents,this.paginate_object=this.getAppointmentEventsPaginateObject}).catch(()=>{this.loading=!1})}}},j3=Object.assign(S3,{__name:"AppointmentEventTable",setup(s){return(t,o)=>(l(),i("div",a3,[e("div",d3,[e("div",r3,[c(e("input",{type:"search",class:"form-control",placeholder:"Поиск события","aria-label":"Поиск события","onUpdate:modelValue":o[0]||(o[0]=a=>t.search=a),"aria-describedby":"appointment-search-event"},null,512),[[_,t.search]]),e("button",{class:"btn btn-outline-secondary",onClick:o[1]||(o[1]=a=>t.loadAppointmentEvents(0)),type:"button",id:"appointment-search-event"},"Найти ")])]),e("div",c3,[t.events.length>0?(l(),i("table",u3,[e("thead",null,[e("tr",null,[e("th",{scope:"col",class:"cursor-pointer",onClick:o[2]||(o[2]=a=>t.loadAndOrder("id"))},"#"),e("th",{scope:"col",class:"cursor-pointer",onClick:o[3]||(o[3]=a=>t.loadAndOrder("title"))},"Название"),e("th",{scope:"col",class:"cursor-pointer",onClick:o[4]||(o[4]=a=>t.loadAndOrder("subtitle"))},"Подзаголовок"),e("th",{scope:"col",class:"cursor-pointer",onClick:o[5]||(o[5]=a=>t.loadAndOrder("address"))},"Адрес"),e("th",{scope:"col",class:"cursor-pointer",onClick:o[6]||(o[6]=a=>t.loadAndOrder("description"))},"Описание"),e("th",{scope:"col",class:"cursor-pointer",onClick:o[7]||(o[7]=a=>t.loadAndOrder("is_group"))},"Групповое"),e("th",{scope:"col",class:"cursor-pointer",onClick:o[8]||(o[8]=a=>t.loadAndOrder("updated_at"))},"Дата изменения"),m3])]),e("tbody",null,[(l(!0),i(v,null,y(t.events,(a,n)=>(l(),i("tr",{class:p({"border-info":a.deleted_at==null,"border-danger":a.deleted_at!=null})},[e("th",h3,u(a.id),1),e("td",{onClick:d=>t.selectEvent(a)},u(a.title||"Не указано"),9,_3),e("td",null,u(a.subtitle||"Не указано"),1),e("td",null,u(a.address||"Не указано"),1),e("td",null,u(a.description||"Не указано"),1),e("td",null,[a.is_group?(l(),i("i",p3)):(l(),i("i",b3))]),e("td",null,u(t.$filters.current(a.updated_at)),1),e("td",null,[a.id?(l(),i("div",f3,[g3,e("ul",v3,[a.deleted_at==null?(l(),i("li",$3,[e("a",{class:"dropdown-item",onClick:d=>t.removeAppointmentEvent(a.id),href:"javascript:void(0)"},"Удалить",8,y3)])):r("",!0),a.deleted_at==null?(l(),i("li",k3,[e("a",{class:"dropdown-item",onClick:d=>t.duplicateAppointmentEvent(a.id),href:"javascript:void(0)"},"Дублировать",8,F3)])):r("",!0)])])):r("",!0)])],2))),256))])])):(l(),i("p",C3,"На текущий момент нет событий в вашем списке"))]),e("div",w3,[t.paginate_object?(l(),$(j,{key:0,onPagination_page:t.nextAppointmentEvents,pagination:t.paginate_object},null,8,["onPagination_page","pagination"])):r("",!0)])]))}}),q3={class:"row"},z3={class:"col-12"},P3={key:0,class:"table"},V3=e("th",{scope:"col"},"Действие",-1),O3={scope:"row"},U3=["onClick"],A3={key:0,class:"fa-solid fa-chevron-down text-success"},I3={key:1,class:"fa-solid fa-xmark text-danger"},Q3={key:0,class:"dropdown"},T3=e("button",{class:"btn btn-outline-secondary",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-solid fa-ellipsis"})],-1),B3={class:"dropdown-menu"},R3={key:0},M3=["onClick"],D3={key:1},E3={class:"col-12"},L3={props:["bot","eventId"],data(){return{direction:"desc",order:"updated_at",show:!0,is_group:!1,loading:!0,services:[],search:null,paginate_object:null}},computed:{...w(["getAppointmentServices","getAppointmentServicesPaginateObject"])},mounted(){this.loadAppointmentServices()},methods:{nextAppointmentService(s){this.loadAppointmentServices(s)},selectService(s){this.$emit("select",s)},removeAppointmentService(s){this.loading=!0,this.$store.dispatch("removeAppointmentService",{dataObject:{appointmentServiceId:s}}).then(t=>{this.loading=!1,this.loadAppointmentServices(0),this.$notify("Сервис успешно удален")}).catch(()=>{this.loading=!1,this.$notify("Ошибка удаления сервиса")})},loadAndOrder(s){this.order=s,this.direction=this.direction==="desc"?"asc":"desc",this.loadAppointmentServices(0)},loadAppointmentServices(s=0){this.loading=!0,this.$store.dispatch("loadAppointmentServices",{dataObject:{event_id:this.eventId,bot_id:this.bot.id||null,search:this.search,order:this.order,direction:this.direction},page:s,size:100}).then(t=>{this.loading=!1,this.services=this.getAppointmentServices,this.paginate_object=this.getAppointmentServicesPaginateObject}).catch(()=>{this.loading=!1})}}},K3=Object.assign(L3,{__name:"AppointmentServicesTable",setup(s){return(t,o)=>(l(),i("div",q3,[e("div",z3,[t.services.length>0?(l(),i("table",P3,[e("thead",null,[e("tr",null,[e("th",{scope:"col",class:"cursor-pointer",onClick:o[0]||(o[0]=a=>t.loadAndOrder("id"))},"#"),e("th",{scope:"col",class:"cursor-pointer",onClick:o[1]||(o[1]=a=>t.loadAndOrder("title"))},"Название"),e("th",{scope:"col",class:"cursor-pointer",onClick:o[2]||(o[2]=a=>t.loadAndOrder("subtitle"))},"Подзаголовок"),e("th",{scope:"col",class:"cursor-pointer",onClick:o[3]||(o[3]=a=>t.loadAndOrder("description"))},"Описание"),e("th",{scope:"col",class:"cursor-pointer",onClick:o[4]||(o[4]=a=>t.loadAndOrder("is_group"))},"Групповое"),e("th",{scope:"col",class:"cursor-pointer",onClick:o[5]||(o[5]=a=>t.loadAndOrder("updated_at"))},"Дата изменения"),V3])]),e("tbody",null,[(l(!0),i(v,null,y(t.services,(a,n)=>(l(),i("tr",{class:p({"border-info":a.deleted_at==null,"border-danger":a.deleted_at!=null})},[e("th",O3,u(a.id),1),e("td",{onClick:d=>t.selectService(a)},u(a.title||"Не указано"),9,U3),e("td",null,u(a.subtitle||"Не указано"),1),e("td",null,u(a.description||"Не указано"),1),e("td",null,[a.is_group?(l(),i("i",A3)):(l(),i("i",I3))]),e("td",null,u(t.$filters.current(a.updated_at)),1),e("td",null,[a.id?(l(),i("div",Q3,[T3,e("ul",B3,[a.deleted_at==null?(l(),i("li",R3,[e("a",{class:"dropdown-item",onClick:d=>t.removeAppointmentService(a.id),href:"javascript:void(0)"},"Удалить",8,M3)])):r("",!0)])])):r("",!0)])],2))),256))])])):(l(),i("p",D3,"На текущий момент нет ни одного созданого сервиса"))]),e("div",E3,[t.paginate_object?(l(),$(j,{key:0,onPagination_page:t.nextAppointmentService,pagination:t.paginate_object},null,8,["onPagination_page","pagination"])):r("",!0)])]))}}),N3={class:"row"},J3={class:"col-12 mb-3"},Y3={class:"form-label",id:"event-title"},H3=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),G3=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),W3={class:"col-12 mb-3"},X3={class:"form-label",id:"event-subtitle"},Z3=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),x3=e("div",null,"Подзаголовок события или доп. инфа под названием события ",-1),eF=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),tF={class:"col-12 mb-3"},sF={class:"form-check"},oF=e("label",{class:"form-check-label",for:"need_add_address"}," Нужно указать адрес и координат мероприятия ",-1),lF={key:0,class:"col-12 mb-3"},iF={class:"form-label",id:"event-address"},nF=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),aF=e("div",null,"Адрес, указывающий точное место проведения события \\ мероприятия ",-1),dF={key:1,class:"col-12 mb-3"},rF={class:"form-label",id:"event-coords"},cF=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),uF=e("div",null,"Координаты мероприятия ",-1),mF={class:"col-12 mb-3"},hF={class:"form-label",id:"event-description"},_F=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),pF=e("div",null," Краткая информация о происходящем мероприятии ",-1),bF=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),fF={key:0,class:"text-gray-400 ml-3",style:{"font-size":"10px"}},gF={class:"col-12 mb-3"},vF={class:"form-label",id:"event-on_start_appointment"},$F=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),yF=e("div",null," Текст, который будет отображен клиенту, когда тот записался ",-1),kF=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),FF={key:0,class:"text-gray-400 ml-3",style:{"font-size":"10px"}},CF={class:"col-12 mb-3"},wF={class:"form-label",id:"event-on_cancel_appointment"},SF=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),jF=e("div",null," Текст, который будет отображен клиенту, когда тот отменил запись ",-1),qF=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),zF={key:0,class:"text-gray-400 ml-3",style:{"font-size":"10px"}},PF={class:"col-12 mb-3"},VF={class:"form-label",id:"event-on_after_appointment"},OF=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),UF=e("div",null," Текст, который будет отображен клиенту, когда тот прошел событие успешно ",-1),AF=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),IF={key:0,class:"text-gray-400 ml-3",style:{"font-size":"10px"}},QF={class:"col-12 mb-3"},TF={class:"form-label",id:"event-on_repeat_appointment"},BF=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),RF=e("div",null," Текст, который будет отображен клиенту, когда тот записывается 2й и более раз ",-1),MF=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),DF={key:0,class:"text-gray-400 ml-3",style:{"font-size":"10px"}},EF={class:"col-12 mb-3"},LF={class:"form-check"},KF=e("label",{class:"form-check-label",for:"need_media"}," Нужно изображение к событию ",-1),NF={key:2,class:"col-12 mb-3"},JF={class:"form-label",id:"event-images"},YF=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),HF=e("div",null," Изображение, которое видит пользователь при выборе события ",-1),GF=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),WF={class:"col-12 mb-3"},XF={class:"form-check"},ZF=e("label",{class:"form-check-label",for:"is-group"}," Является групповым мероприятием ",-1),xF={key:3,class:"col-md-6 col-12 mb-3"},e5={class:"form-label",id:"event-min_people"},t5=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),s5=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),o5={key:4,class:"col-md-6 col-12 mb-3"},l5={class:"form-label",id:"event-max_people"},i5=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),n5=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),a5={class:"row"},d5={class:"col-12"},r5={type:"submit",class:"btn btn-outline-success w-100 p-3"},c5={key:0},u5={key:1},m5={props:["event","bot"],data(){return{step:0,load:!1,need_reset:!1,need_services:!1,need_add_address:!1,need_media:!1,eventForm:{id:null,title:null,subtitle:null,description:null,address:null,coords:null,images:[],services:[],times:[],is_group:!1,max_people:0,min_people:0,on_start_appointment:null,on_cancel_appointment:null,on_after_appointment:null,on_repeat_appointment:null}}},watch:{eventForm:{handler(s){this.need_reset=!0},deep:!0}},mounted(){this.event&&this.$nextTick(()=>{this.eventForm={id:this.event.id||null,title:this.event.title||null,subtitle:this.event.subtitle||null,description:this.event.description||null,images:this.event.images||[],is_group:this.event.is_group||!1,address:this.event.address||null,coords:this.event.coords||null,max_people:this.event.max_people||0,min_people:this.event.min_people||0,on_start_appointment:this.event.on_start_appointment||null,on_cancel_appointment:this.event.on_cancel_appointment||null,on_after_appointment:this.event.on_after_appointment||null,on_repeat_appointment:this.event.on_repeat_appointment||null}})},methods:{selectPhotos(s){this.eventForm.images||(this.eventForm.images=[]);let t=this.eventForm.images.indexOf(s.file_id);t!==-1?this.eventForm.images.splice(t,1):this.eventForm.images.push(s.file_id)},resetForm(){},submitForm(){let s=new FormData;Object.keys(this.eventForm).forEach(t=>{const o=this.eventForm[t]||"";typeof o=="object"?s.append(t,JSON.stringify(o)):s.append(t,o)}),s.append("bot_id",this.bot.id),this.$store.dispatch(this.eventForm.id===null?"addAppointmentEvent":"updateAppointmentEvent",{appointmentEventForm:s}).then(t=>{this.$emit("callback",t.data),this.$nextTick(()=>{this.eventForm={id:null,title:null,subtitle:null,description:null,address:null,coords:null,images:[],services:[],times:[],is_group:!1,max_people:0,min_people:0,on_start_appointment:null,on_cancel_appointment:null,on_after_appointment:null,on_repeat_appointment:null}}),this.$notify("Событие успешно создано")}).catch(t=>{this.$notify("Ошибка создания события")})}}},X=Object.assign(m5,{__name:"AppointmentEventForm",setup(s){return(t,o)=>{const a=q("Popper"),n=A("mask");return l(),i("form",{onSubmit:o[14]||(o[14]=S((...d)=>t.submitForm&&t.submitForm(...d),["prevent"]))},[e("div",N3,[e("div",J3,[e("label",Y3,[g(a,{content:"Название вашего события (или специалиста), на которое планируется осуществить запись"},{default:f(()=>[H3]),_:1}),m(" Название события "),G3]),c(e("input",{type:"text",class:"form-control",placeholder:"Название","aria-label":"Название","onUpdate:modelValue":o[0]||(o[0]=d=>t.eventForm.title=d),maxlength:"255","aria-describedby":"event-title",required:""},null,512),[[_,t.eventForm.title]])]),e("div",W3,[e("label",X3,[g(a,null,{content:f(()=>[x3]),default:f(()=>[Z3]),_:1}),m(" Подзаголовок события "),eF]),c(e("input",{type:"text",class:"form-control",placeholder:"Подзаголовок","aria-label":"Подзаголовок","onUpdate:modelValue":o[1]||(o[1]=d=>t.eventForm.subtitle=d),maxlength:"255","aria-describedby":"event-subtitle",required:""},null,512),[[_,t.eventForm.subtitle]])]),e("div",tF,[e("div",sF,[c(e("input",{class:"form-check-input","onUpdate:modelValue":o[2]||(o[2]=d=>t.need_add_address=d),type:"checkbox",id:"need_add_address"},null,512),[[k,t.need_add_address]]),oF])]),t.need_add_address?(l(),i("div",lF,[e("label",iF,[g(a,null,{content:f(()=>[aF]),default:f(()=>[nF]),_:1}),m(" Адрес события \\ мероприятия ")]),c(e("input",{type:"text",class:"form-control",placeholder:"Адрес события","aria-label":"Адрес события","onUpdate:modelValue":o[3]||(o[3]=d=>t.eventForm.address=d),maxlength:"255","aria-describedby":"event-address",required:""},null,512),[[_,t.eventForm.address]])])):r("",!0),t.need_add_address?(l(),i("div",dF,[e("label",rF,[g(a,null,{content:f(()=>[uF]),default:f(()=>[cF]),_:1}),m(" Координаты мероприятия: широта, долгота ")]),c(e("input",{type:"text",class:"form-control",placeholder:"00.0000,00.0000","aria-label":"Координаты события","onUpdate:modelValue":o[4]||(o[4]=d=>t.eventForm.coords=d),maxlength:"255","aria-describedby":"event-coords",required:""},null,512),[[_,t.eventForm.coords],[n,"##.####,##.####"]])])):r("",!0),e("div",mF,[e("label",hF,[g(a,null,{content:f(()=>[pF]),default:f(()=>[_F]),_:1}),m(" Описание события "),bF,t.eventForm.description?(l(),i("small",fF," Длина текста "+u(t.eventForm.description.length)+"/255",1)):r("",!0)]),c(e("textarea",{type:"text",class:"form-control",placeholder:"Описание мероприятия","aria-label":"Описание мероприятия",maxlength:"255","onUpdate:modelValue":o[5]||(o[5]=d=>t.eventForm.description=d),"aria-describedby":"event-description",required:""},`
                    `,512),[[_,t.eventForm.description]])]),e("div",gF,[e("label",vF,[g(a,null,{content:f(()=>[yF]),default:f(()=>[$F]),_:1}),m(" Текст при записи на событие "),kF,t.eventForm.on_start_appointment?(l(),i("small",FF," Длина текста "+u(t.eventForm.on_start_appointment.length)+"/255",1)):r("",!0)]),c(e("textarea",{type:"text",class:"form-control",placeholder:"Текст при записи на событие","aria-label":"Текст при записи на событие","onUpdate:modelValue":o[6]||(o[6]=d=>t.eventForm.on_start_appointment=d),maxlength:"255","aria-describedby":"event-on_start_appointment",required:""},`
                    `,512),[[_,t.eventForm.on_start_appointment]])]),e("div",CF,[e("label",wF,[g(a,null,{content:f(()=>[jF]),default:f(()=>[SF]),_:1}),m(" Текст при отмене записи на событие "),qF,t.eventForm.on_cancel_appointment?(l(),i("small",zF," Длина текста "+u(t.eventForm.on_cancel_appointment.length)+"/255",1)):r("",!0)]),c(e("textarea",{type:"text",class:"form-control",placeholder:"Текст при отмене записи на событие","aria-label":"Текст при отмене записи на событие","onUpdate:modelValue":o[7]||(o[7]=d=>t.eventForm.on_cancel_appointment=d),maxlength:"255","aria-describedby":"event-on_cancel_appointment",required:""},`
                    `,512),[[_,t.eventForm.on_cancel_appointment]])]),e("div",PF,[e("label",VF,[g(a,null,{content:f(()=>[UF]),default:f(()=>[OF]),_:1}),m(" Текст после прохождения события "),AF,t.eventForm.on_after_appointment?(l(),i("small",IF," Длина текста "+u(t.eventForm.on_after_appointment.length)+"/255",1)):r("",!0)]),c(e("textarea",{type:"text",class:"form-control",placeholder:"Текст после прохождения события","aria-label":"Текст после прохождения события","onUpdate:modelValue":o[8]||(o[8]=d=>t.eventForm.on_after_appointment=d),maxlength:"255","aria-describedby":"event-on_after_appointment",required:""},`
                    `,512),[[_,t.eventForm.on_after_appointment]])]),e("div",QF,[e("label",TF,[g(a,null,{content:f(()=>[RF]),default:f(()=>[BF]),_:1}),m(" Текст при повторной записи на событие "),MF,t.eventForm.on_repeat_appointment?(l(),i("small",DF," Длина текста "+u(t.eventForm.on_repeat_appointment.length)+"/255",1)):r("",!0)]),c(e("textarea",{type:"text",class:"form-control",placeholder:" Текст при повторной записи на событие","aria-label":" Текст при повторной записи на событие","onUpdate:modelValue":o[9]||(o[9]=d=>t.eventForm.on_repeat_appointment=d),maxlength:"255","aria-describedby":"event-on_repeat_appointment",required:""},`
                    `,512),[[_,t.eventForm.on_repeat_appointment]])]),e("div",EF,[e("div",LF,[c(e("input",{class:"form-check-input","onUpdate:modelValue":o[10]||(o[10]=d=>t.need_media=d),type:"checkbox",id:"need_media"},null,512),[[k,t.need_media]]),KF])]),t.need_media?(l(),i("div",NF,[e("label",JF,[g(a,null,{content:f(()=>[HF]),default:f(()=>[YF]),_:1}),m(" Изображение к событию "),GF]),g(P,{"need-photo":!0,selected:t.eventForm.images,onSelect:t.selectPhotos},null,8,["selected","onSelect"])])):r("",!0),e("div",WF,[e("div",XF,[c(e("input",{class:"form-check-input","onUpdate:modelValue":o[11]||(o[11]=d=>t.eventForm.is_group=d),type:"checkbox",id:"is-group"},null,512),[[k,t.eventForm.is_group]]),ZF])]),t.eventForm.is_group?(l(),i("div",xF,[e("label",e5,[g(a,{content:"Минимально необходимое число людей, для начала 1 мероприятия"},{default:f(()=>[t5]),_:1}),m(" Минимальное число посетителей в группе "),s5]),c(e("input",{type:"number",class:"form-control",placeholder:"Минимальное число посетителей","aria-label":"Название","onUpdate:modelValue":o[12]||(o[12]=d=>t.eventForm.min_people=d),"aria-describedby":"event-min_people",required:""},null,512),[[_,t.eventForm.min_people]])])):r("",!0),t.eventForm.is_group?(l(),i("div",o5,[e("label",l5,[g(a,{content:"Количество людей, которые могут посетить мероприятие за 1 сеанс"},{default:f(()=>[i5]),_:1}),m(" Максимальное число посетителей в группе "),n5]),c(e("input",{type:"number",class:"form-control",placeholder:"Максимальное число посетителей","aria-label":"Название","onUpdate:modelValue":o[13]||(o[13]=d=>t.eventForm.max_people=d),"aria-describedby":"event-max_people",required:""},null,512),[[_,t.eventForm.max_people]])])):r("",!0)]),e("div",a5,[e("div",d5,[e("button",r5,[t.eventForm.id==null?(l(),i("span",c5,"Создать событие")):(l(),i("span",u5,"Обновить событие"))])])])],32)}}}),h5={class:"row pt-3"},_5={class:"col-md-4"},p5={class:"form-floating mb-3"},b5=e("label",{for:"config-step"},"Шаг, минуты",-1),f5={class:"col-md-4"},g5={class:"form-floating mb-3"},v5=e("label",{for:"config-start-time"},"Начало, часы",-1),$5={class:"col-md-4"},y5={class:"form-floating mb-3"},k5=["min"],F5=e("label",{for:"config-end-time"},"Конец, часы",-1),C5=e("hr",null,null,-1),w5={key:0,class:"row"},S5={class:"col-12 d-flex justify-content-end pb-3"},j5={class:"row"},q5={class:"col-md-4 text-center"},z5={key:0,class:"fa-solid fa-arrow-down-short-wide"},P5={key:1,class:"fa-solid fa-arrow-up-wide-short"},V5={class:"col-md-4 text-center"},O5={key:0,class:"fa-solid fa-arrow-down-short-wide"},U5={key:1,class:"fa-solid fa-arrow-up-wide-short"},A5={class:"col-md-4 text-center"},I5={key:0,class:"fa-solid fa-arrow-down-short-wide"},Q5={key:1,class:"fa-solid fa-arrow-up-wide-short"},T5={class:"col-md-4"},B5={class:"form-floating"},R5=["onUpdate:modelValue","id"],M5=["for"],D5={class:"col-md-4"},E5={class:"form-floating"},L5=["onUpdate:modelValue","id"],K5=["for"],N5={class:"col-md-4"},J5={class:"form-floating"},Y5=["onUpdate:modelValue","id"],H5=["for"],G5={class:"row mt-3"},W5={class:"col-12"},X5={class:"row"},Z5={class:"col-12"},x5={class:"col-12"},eC={class:"text-center"},tC={class:"row d-flex justify-content-center"},sC={class:"col-md-4"},oC={class:"table"},lC=e("th",{scope:"col"},"#",-1),iC={scope:"col"},nC={scope:"row"},aC=["onClick"],dC={key:0,class:"fa-solid fa-check"},rC={key:1,class:"fa-solid fa-xmark"},cC={components:{VueDatePicker:ie},props:["eventId","bot"],data(){return{date:null,load:!1,step:30,start:8,end:18,order:null,direction:null,paginate_object:null,years:[2024,2025],months:["Январь","Февраль","Март","Апрель","Май","Июнь","Июль","Август","Сентябрь","октябрь","Ноябрь","Декабрь"],days:["Понедельник","Вторник","Среда","Четверг","Пятница","Суббота","Воскресенье"],schedule:[],added_schedule:[]}},watch:{date:{handler:function(s){this.loadAppointmentSchedules()},deep:!0}},computed:{...w(["getAppointmentSchedules","getAppointmentSchedulesPaginateObject"]),currentWeek(){return new Date().getWeek()},currentMonthWeek(){return new Date().getMonthWeek()},currentMonth(){return new Date().getMonth()},currentYear(){return new Date().getFullYear()},times(){let s=this.step,t=[],o=0,a=0;for(let n=0;o<24*60;n++){let d=Math.floor(o/60);if(d>=this.start&&d<=this.end){let h=o%60;t[a]=("0"+d).slice(-2)+":"+("0"+h).slice(-2),a++}o=o+s}return t}},mounted(){this.date=new Date,this.loadAppointmentSchedules()},methods:{removeAppointmentSchedule(s){this.loading=!0,this.$store.dispatch("removeAppointmentSchedule",{dataObject:{appointmentScheduleId:s}}).then(t=>{this.loading=!1,this.loadAppointmentSchedules(0),this.$notify("Время успешно удалено")}).catch(()=>{this.loading=!1,this.$notify("Ошибка удаления времени")})},loadAndOrder(s){this.order=s,this.direction=this.direction==="desc"?"asc":"desc",this.loadAppointmentSchedules(0)},nextAppointmentSchedule(s){this.loadAppointmentSchedules(s)},loadAppointmentSchedules(s=0){this.loading=!0,this.$store.dispatch("loadAppointmentSchedules",{dataObject:{date:this.date||null,event_id:this.eventId,bot_id:this.bot.id||null,order:this.order,direction:this.direction},page:s,size:20}).then(t=>{this.loading=!1,this.schedule=this.getAppointmentSchedules,this.paginate_object=this.getAppointmentSchedulesPaginateObject}).catch(()=>{this.loading=!1})},storeSchedule(){this.$store.dispatch("storeAppointmentSchedule",{dataObject:{schedule:[...this.schedule,...this.added_schedule],bot_id:this.bot.id,appointment_event_id:this.eventId}}).then(()=>{this.$notify("Расписание успешно сохранено"),this.loadAppointmentSchedules(),this.added_schedule=[]}).catch(()=>{this.$notify("Ошибка сохраения расписания")})},inScheduleRow(s){return this.schedule.findIndex(t=>t.start_time==this.times[s])!=-1||this.added_schedule.findIndex(t=>t.start_time==this.times[s])!=-1},inSchedule(s,t){return this.schedule.findIndex(o=>o.day==t&&o.start_time==this.times[s])!=-1||this.added_schedule.findIndex(o=>o.day==t&&o.start_time==this.times[s])!=-1},setScheduleItem(s,t){let o=this.schedule.findIndex(a=>a.day==t&&a.start_time==this.times[s]);if(o!==-1){this.schedule.splice(o,1);return}if(o=this.added_schedule.findIndex(a=>a.day==t&&a.start_time==this.times[s]),o!==-1){this.added_schedule.splice(o,1);return}this.added_schedule.push({day:t,start_time:this.times[s]||null,end_time:this.times[s+1]||null,week:this.date==null?this.currentWeek:new Date(this.date).getWeek(),month:this.date==null?this.currentMonth:new Date(this.date).getMonth(),year:this.date==null?this.currentYear:new Date(this.date).getFullYear()})}}},uC=Object.assign(cC,{__name:"AppointmentScheduleForm",setup(s){return(t,o)=>(l(),i(v,null,[e("div",h5,[e("div",_5,[e("div",p5,[c(e("input",{type:"number",class:"form-control","onUpdate:modelValue":o[0]||(o[0]=a=>t.step=a),min:"0",id:"config-step",placeholder:"30 минут"},null,512),[[_,t.step]]),b5])]),e("div",f5,[e("div",g5,[c(e("input",{type:"number","onUpdate:modelValue":o[1]||(o[1]=a=>t.start=a),min:"0",max:"23",class:"form-control",id:"config-start-time",placeholder:"Часы"},null,512),[[_,t.start]]),v5])]),e("div",$5,[e("div",y5,[c(e("input",{type:"number","onUpdate:modelValue":o[2]||(o[2]=a=>t.end=a),min:t.start,max:"23",class:"form-control",id:"config-end-time",placeholder:"Часы"},null,8,k5),[[_,t.end]]),F5])])]),C5,t.schedule.length>0||t.added_schedule.length>0?(l(),i("div",w5,[e("div",S5,[e("button",{onClick:o[3]||(o[3]=(...a)=>t.storeSchedule&&t.storeSchedule(...a)),class:"btn btn-primary"},"Сохранить текущий график ")]),e("div",j5,[e("div",q5,[e("a",{onClick:o[4]||(o[4]=a=>t.loadAndOrder("day")),href:"javascript:void(0)"},[m("День "),t.order==="day"&&t.direction==="asc"?(l(),i("i",z5)):r("",!0),t.order==="day"&&t.direction==="desc"?(l(),i("i",P5)):r("",!0)])]),e("div",V5,[e("a",{onClick:o[5]||(o[5]=a=>t.loadAndOrder("start_time")),href:"javascript:void(0)"},[m("Начало "),t.order==="start_time"&&t.direction==="asc"?(l(),i("i",O5)):r("",!0),t.order==="start_time"&&t.direction==="desc"?(l(),i("i",U5)):r("",!0)])]),e("div",A5,[e("a",{onClick:o[6]||(o[6]=a=>t.loadAndOrder("end_time")),href:"javascript:void(0)"},[m("Конец "),t.order==="end_time"&&t.direction==="asc"?(l(),i("i",I5)):r("",!0),t.order==="end_time"&&t.direction==="desc"?(l(),i("i",Q5)):r("",!0)])])])])):r("",!0),(l(!0),i(v,null,y([...t.schedule,...t.added_schedule],(a,n)=>(l(),i("div",{class:p(["row py-2",{"bg-warning":a.id==null}])},[e("div",T5,[e("div",B5,[c(e("input",{type:"text","onUpdate:modelValue":d=>t.days[a.day-1]=d,class:"form-control",id:"day-of-week-"+n,placeholder:"День недели"},null,8,R5),[[_,t.days[a.day-1]]]),e("label",{for:"day-of-week-"+n},"День недели",8,M5)])]),e("div",D5,[e("div",E5,[c(e("input",{type:"text","onUpdate:modelValue":d=>a.start_time=d,class:"form-control",id:"day-of-start-at-"+n,placeholder:"Время начало"},null,8,L5),[[_,a.start_time]]),e("label",{for:"day-of-start-at-"+n},"Начало",8,K5)])]),e("div",N5,[e("div",J5,[c(e("input",{type:"text","onUpdate:modelValue":d=>a.end_time=d,class:"form-control",id:"day-of-end-at-"+n,placeholder:"Время окончания"},null,8,Y5),[[_,a.end_time]]),e("label",{for:"day-of-end-at-"+n},"Окончание",8,H5)])])],2))),256)),e("div",G5,[e("div",W5,[t.paginate_object?(l(),$(j,{key:0,onPagination_page:t.nextAppointmentSchedule,pagination:t.paginate_object},null,8,["onPagination_page","pagination"])):r("",!0)])]),e("div",X5,[e("div",Z5,[e("button",{class:"btn btn-primary",onClick:o[7]||(o[7]=a=>t.schedule=[])},"Очистить таблицу")]),e("div",x5,[e("p",eC,[m(" Год: "),e("strong",null,u(t.currentYear),1),m(" Месяц: "),e("strong",null,u(t.months[t.currentMonth]),1),m(" Неделя: "),e("strong",null,u(t.currentWeek),1)])])]),e("div",tC,[e("div",sC,[g(M(ie),{modelValue:t.date,"onUpdate:modelValue":o[8]||(o[8]=a=>t.date=a)},null,8,["modelValue"])])]),e("table",oC,[e("thead",null,[e("tr",null,[lC,(l(!0),i(v,null,y(t.days,a=>(l(),i("th",iC,u(a),1))),256))])]),e("tbody",null,[(l(!0),i(v,null,y(t.times,(a,n)=>(l(),i("tr",{class:p({"table-light":t.inScheduleRow(n)})},[e("th",nC,u(a),1),(l(),i(v,null,y(7,d=>e("td",null,[e("button",{class:p([{"btn-primary text-white":t.inSchedule(n,d)},"btn btn-outline-primary"]),onClick:h=>t.setScheduleItem(n,d)},[t.inSchedule(n,d)?(l(),i("i",dC)):(l(),i("i",rC))],10,aC)])),64))],2))),256))])])],64))}});(function(){try{if(typeof document<"u"){var s=document.createElement("style");s.appendChild(document.createTextNode(".vue3-star-ratings[data-v-7fab3f62]{width:fit-content;overflow:hidden;position:relative;white-space:nowrap}.vue3-star-ratings *[data-v-7fab3f62]{box-sizing:border-box;margin:0;padding:0;line-height:1}.vue3-star-ratings__inner[data-v-7fab3f62],.vue3-star-ratings__outer[data-v-7fab3f62]{height:inherit}.vue3-star-ratings__outer[data-v-7fab3f62]{position:absolute;top:0;left:0;width:var(--vue3StarRatingOuterWidth);max-width:100%;overflow:hidden;color:var(--vue3StarRatingsOuterColor);transition:width .32s cubic-bezier(.075,.82,.165,1)}.vue3-star-ratings__inner[data-v-7fab3f62]{color:var(--vue3StarRatingsInnerColor)}.vue3-star-ratings__icon[data-v-7fab3f62]{fill:currentColor;width:var(--vue3StarRatingIconSize);aspect-ratio:1;cursor:pointer;display:inline-block}")),document.head.appendChild(s)}}catch(t){console.error("vite-plugin-css-injected-by-js",t)}})();const de=(s,t)=>{const o=s.__vccOpts||s;for(const[a,n]of t)o[a]=n;return o},mC={},hC={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512.002 512.002"},_C=e("path",{d:"M511.267 197.258a14.995 14.995 0 00-12.107-10.209l-158.723-23.065-70.985-143.827a14.998 14.998 0 00-26.901 0l-70.988 143.827-158.72 23.065a14.998 14.998 0 00-8.312 25.585l114.848 111.954-27.108 158.083a14.999 14.999 0 0021.763 15.812l141.967-74.638 141.961 74.637a15 15 0 0021.766-15.813l-27.117-158.081 114.861-111.955a14.994 14.994 0 003.795-15.375z"},null,-1),pC=[_C];function bC(s,t){return l(),i("svg",hC,pC)}const Z=de(mC,[["render",bC]]),fC={class:"vue3-star-ratings__outer"},gC={class:"vue3-star-ratings__inner"},vC=be({__name:"Vue3StarRatings",props:{modelValue:{default:0},numberOfStars:{default:5},starColor:{default:"#ff9800"},inactiveColor:{default:"#333333"},starSize:{default:24},disableClick:{type:Boolean},customSvg:{default:Z}},emits:["update:modelValue"],setup(s,{emit:t}){const o=s,a=K(()=>o.customSvg||Z),n={rounded(C,O){const V=Math.pow(10,O);return Math.round(C*V)/V}},d=fe(),h=K({get(){return o.modelValue},set(C){const O=n.rounded(C,1);t("update:modelValue",O)}});function b(C){if(o.disableClick)return;const O=this.getBoundingClientRect(),{pageX:V}=C,L=V-O.left,re=O.width,ce=o.numberOfStars,ue=L/re*ce;h.value=ue}const F=K(()=>(h.value<0?0:h.value>o.numberOfStars?o.numberOfStars:h.value)/o.numberOfStars*100);return ge(()=>{var C;const O={"--vue3StarRatingsInnerColor":o.inactiveColor,"--vue3StarRatingsOuterColor":o.starColor,"--vue3StarRatingOuterWidth":`${F.value}%`,"--vue3StarRatingIconSize":`${o.starSize}px`};for(const[V,L]of Object.entries(O))(C=d.value)==null||C.style.setProperty(V,L)}),ve(()=>{var C;(C=d.value)==null||C.addEventListener("click",b)}),$e(()=>{var C;(C=d.value)==null||C.removeEventListener("click",b)}),(C,O)=>(l(),i("div",{class:"vue3-star-ratings",ref_key:"starsContainer",ref:d,style:te({pointerEvents:C.disableClick?"none":"auto"})},[e("div",fC,[(l(!0),i(v,null,y(C.numberOfStars,V=>(l(),$(G(a.value),{key:V,class:"vue3-star-ratings__icon"}))),128))]),e("div",gC,[(l(!0),i(v,null,y(C.numberOfStars,V=>(l(),$(G(a.value),{key:V,class:"vue3-star-ratings__icon"}))),128))])],4))}}),E=de(vC,[["__scopeId","data-v-7fab3f62"]]),$C={class:"row py-3"},yC={class:"col-12"},kC={class:"row"},FC={class:"col-12"},CC={key:0},wC={key:1},SC={key:0,class:"col-12 mb-3"},jC={class:"col-12 mb-3"},qC={key:0},zC={key:1},PC={key:1,class:"col-12 mb-3"},VC={class:"col-12 mb-3"},OC={class:"col-12 mb-3"},UC={class:"form-label",id:"event-on_after_appointment"},AC=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),IC=e("div",null," Текст, который пользователь оставляет после прохождения услуги ",-1),QC=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),TC={key:0,class:"text-gray-400 ml-3",style:{"font-size":"10px"}},BC={class:"row"},RC={class:"col-12"},MC={type:"submit",class:"btn btn-outline-success w-100 p-3"},DC={key:0},EC={key:1},LC={props:["eventId","bot","review"],components:{vue3starRatings:E},data(){return{step:0,load:!1,selected_schedule_time:null,selected_bot_user:null,need_load_users:!1,need_schedule_time:!1,days:["понедельник","вторник","среду","четверг","пятницу","субботу","воскресенье"],reviewForm:{id:null,appointment_event_id:null,appointment_schedule_id:null,bot_user_id:null,rating:null,text:null}}},watch:{reviewForm:{handler(s){this.need_reset=!0},deep:!0}},mounted(){this.review&&this.$nextTick(()=>{this.reviewForm={id:this.review.id||null,appointment_event_id:this.review.appointment_event_id||null,appointment_schedule_id:this.review.appointment_schedule_id||null,bot_user_id:this.review.bot_user_id||null,rating:this.review.rating||null,text:this.review.text||null},this.selected_schedule_time=this.review.schedule||null,this.selected_bot_user=this.review.botUser||null})},methods:{selectScheduleTime(s){this.selected_schedule_time=s,this.need_schedule_time=!1},selectBotUser(s){this.selected_bot_user=s,this.need_load_users=!1},clearReviewForm(){this.reviewForm={id:null,appointment_event_id:null,appointment_schedule_id:null,bot_user_id:null,rating:null,text:null},this.selected_schedule_time=null,this.selected_bot_user=null},submitForm(){this.reviewForm.bot_user_id=this.selected_bot_user.id,this.reviewForm.appointment_schedule_id=this.selected_schedule_time.id,this.reviewForm.appointment_event_id=this.eventId;let s=new FormData;Object.keys(this.reviewForm).forEach(t=>{const o=this.reviewForm[t]||"";typeof o=="object"?s.append(t,JSON.stringify(o)):s.append(t,o)}),s.append("bot_id",this.bot.id),this.$store.dispatch("storeAppointmentReview",{dataObject:{appointmentReviewForm:s}}).then(t=>{this.$emit("callback",t.data),this.$notify("Отзыв успешно создан"),this.clearReviewForm()}).catch(t=>{this.$notify("Ошибка создания отзыва")})}}},KC=Object.assign(LC,{__name:"AppointmentReviewForm",setup(s){return(t,o)=>{const a=q("Popper");return l(),i(v,null,[e("div",$C,[e("div",yC,[e("button",{onClick:o[0]||(o[0]=(...n)=>t.clearReviewForm&&t.clearReviewForm(...n)),class:"btn btn-primary"},"Новый отзыв")])]),e("form",{onSubmit:o[5]||(o[5]=S((...n)=>t.submitForm&&t.submitForm(...n),["prevent"]))},[e("div",kC,[e("div",FC,[e("a",{href:"javascript:void(0)",class:"btn btn-link",onClick:o[1]||(o[1]=n=>t.need_load_users=!t.need_load_users)},[t.selected_bot_user==null?(l(),i("span",CC,"Выберите пользователя")):r("",!0),t.selected_bot_user?(l(),i("span",wC," Пользователь "+u(t.selected_bot_user.name||t.selected_bot_user.fio_from_telegram||t.selected_bot_user.telegram_chat_id||"-"),1)):r("",!0)])]),t.need_load_users?(l(),i("div",SC,[g(D,{simple:!0,onSelect:t.selectBotUser},null,8,["onSelect"])])):r("",!0),e("div",jC,[e("a",{href:"javascript:void(0)",class:"btn btn-link",onClick:o[2]||(o[2]=n=>t.need_schedule_time=!t.need_schedule_time)},[t.selected_schedule_time==null?(l(),i("span",qC,"Выберите время в расписании")):r("",!0),t.selected_schedule_time?(l(),i("span",zC," Запись на "+u(t.days[t.selected_schedule_time.day-1]||"-")+" с "+u(t.selected_schedule_time.start_time||"-")+" до "+u(t.selected_schedule_time.end_time||"-"),1)):r("",!0)])]),t.need_schedule_time?(l(),i("div",PC,[g(le,{"event-id":s.eventId,bot:s.bot,onSelect:t.selectScheduleTime},null,8,["event-id","bot","onSelect"])])):r("",!0),e("div",VC,[e("p",null," Рейтинг: "+u(t.reviewForm.rating||0),1),g(M(E),{modelValue:t.reviewForm.rating,"onUpdate:modelValue":o[3]||(o[3]=n=>t.reviewForm.rating=n)},null,8,["modelValue"])]),e("div",OC,[e("label",UC,[g(a,null,{content:f(()=>[IC]),default:f(()=>[AC]),_:1}),m(" Текст отзыва "),QC,t.reviewForm.text?(l(),i("small",TC," Длина текста "+u(t.reviewForm.text.length)+"/255",1)):r("",!0)]),c(e("textarea",{type:"text",class:"form-control",placeholder:"Текст отзыва","aria-label":"Текст отзыва","onUpdate:modelValue":o[4]||(o[4]=n=>t.reviewForm.text=n),maxlength:"255","aria-describedby":"review-text",required:""},`
                    `,512),[[_,t.reviewForm.text]])])]),e("div",BC,[e("div",RC,[e("button",MC,[t.reviewForm.id==null?(l(),i("span",DC,"Оставить отзыв")):(l(),i("span",EC,"Обновить отзыв"))])])])],32)],64)}}}),NC={class:"row"},JC={class:"col-12"},YC={key:0,class:"table"},HC=e("th",{scope:"col"},"Действие",-1),GC=["onClick"],WC={scope:"row"},XC={class:"d-flex align-items-center"},ZC={class:"ml-2"},xC={key:0,class:"dropdown"},ew=e("button",{class:"btn btn-outline-secondary",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-solid fa-ellipsis"})],-1),tw={class:"dropdown-menu"},sw={key:0},ow=["onClick"],lw={key:1},iw={class:"col-12"},nw={props:["bot","eventId"],components:{vue3starRatings:E},data(){return{direction:"desc",order:"updated_at",show:!0,is_group:!1,loading:!0,reviews:[],search:null,paginate_object:null}},computed:{...w(["getAppointmentReviews","getAppointmentReviewsPaginateObject"])},mounted(){this.loadAppointmentReviews()},methods:{nextAppointmentReviews(s){this.loadAppointmentReviews(s)},selectReview(s){this.$emit("select",s)},loadAndOrder(s){this.order=s,this.direction=this.direction==="desc"?"asc":"desc",this.loadAppointmentReviews(0)},removeAppointmentReview(s){this.loading=!0,this.$store.dispatch("removeAppointmentReview",{dataObject:{appointmentReviewId:s}}).then(t=>{this.loadAppointmentReviews(0),this.$notify("Сервис успешно удален"),this.loading=!1}).catch(()=>{this.loading=!1,this.$notify("Ошибка удаления сервиса")})},loadAppointmentReviews(s=0){this.loading=!0,this.$store.dispatch("loadAppointmentReviews",{dataObject:{event_id:this.eventId,bot_id:this.bot.id||null,search:this.search,order:this.order,direction:this.direction},page:s,size:100}).then(t=>{this.loading=!1,this.reviews=this.getAppointmentReviews,this.paginate_object=this.getAppointmentReviewsPaginateObject}).catch(()=>{this.loading=!1})}}},aw=Object.assign(nw,{__name:"AppointmentReviewsTable",setup(s){return(t,o)=>(l(),i("div",NC,[e("div",JC,[t.reviews.length>0?(l(),i("table",YC,[e("thead",null,[e("tr",null,[e("th",{scope:"col",class:"cursor-pointer",onClick:o[0]||(o[0]=a=>t.loadAndOrder("id"))},"#"),e("th",{scope:"col",class:"cursor-pointer",onClick:o[1]||(o[1]=a=>t.loadAndOrder("bot_user_id"))},"Пользователь"),e("th",{scope:"col",class:"cursor-pointer",onClick:o[2]||(o[2]=a=>t.loadAndOrder("rating"))},"Рейтинг"),e("th",{scope:"col",class:"cursor-pointer",onClick:o[3]||(o[3]=a=>t.loadAndOrder("text"))},"Текст"),e("th",{scope:"col",class:"cursor-pointer",onClick:o[4]||(o[4]=a=>t.loadAndOrder("updated_at"))},"Дата изменения"),HC])]),e("tbody",null,[(l(!0),i(v,null,y(t.reviews,(a,n)=>(l(),i("tr",{onClick:d=>t.selectReview(a),class:p({"border-info":a.deleted_at==null,"border-danger":a.deleted_at!=null})},[e("th",WC,u(a.id),1),e("td",null,u(a.botUser.fio_from_telegram||a.botUser.telegram_chat_id||"Не указано"),1),e("td",null,[e("p",XC,[g(M(E),{disableClick:!0,modelValue:a.rating,"onUpdate:modelValue":d=>a.rating=d},null,8,["modelValue","onUpdate:modelValue"]),e("span",ZC,u(a.rating||0),1)])]),e("td",null,u(a.text||"Не указано"),1),e("td",null,u(t.$filters.current(a.updated_at)),1),e("td",null,[a.id?(l(),i("div",xC,[ew,e("ul",tw,[a.deleted_at==null?(l(),i("li",sw,[e("a",{class:"dropdown-item",onClick:d=>t.removeAppointmentReview(a.id),href:"javascript:void(0)"},"Удалить",8,ow)])):r("",!0)])])):r("",!0)])],10,GC))),256))])])):(l(),i("p",lw,"На текущий момент нет ни одного созданного отзыва"))]),e("div",iw,[t.paginate_object?(l(),$(j,{key:0,onPagination_page:t.nextAppointmentReviews,pagination:t.paginate_object},null,8,["onPagination_page","pagination"])):r("",!0)])]))}}),dw={key:0,class:"py-2"},rw={class:"row"},cw={class:"col-12"},uw={key:1,class:"py-2"},mw={class:"row"},hw={class:"col-12"},_w={key:2,class:"py-2"},pw={class:"row"},bw={class:"col-12"},fw={class:"nav nav-tabs justify-content-center"},gw={key:0,class:"row py-3"},vw={class:"col-12"},$w={key:1,class:"row py-3"},yw={class:"col-12"},kw={class:"col-12 py-3"},Fw=e("h4",null,"Доступные сервисы в событии",-1),Cw={key:2,class:"row"},ww={class:"col-12"},Sw={key:3,class:"row"},jw={class:"col-12"},qw={class:"col-12 py-3"},zw=e("h4",null,"Актуальные записи на событие",-1),Pw={key:4,class:"row"},Vw={class:"col-12"},Ow={class:"col-12 py-3"},Uw=e("h4",null,"Отзывы к событию",-1),Aw={props:["bot"],data(){return{part:0,tab:0,loadTable:!1,loadService:!1,loadReviewForm:!1,loadAppointments:!1,loadReviews:!1,loadAppointmentForm:!1,loadForm:!1,selectedEvent:null,selectedService:null,selectedAppointment:null,selectedReview:null}},computed:{...w(["getAppointmentEvents","getAppointmentEventsPaginateObject"])},mounted(){},methods:{callbackForm(){this.loadTable=!0,this.$nextTick(()=>{this.loadTable=!1})},callbackAppointment(){this.loadAppointments=!0,this.$nextTick(()=>{this.loadAppointments=!1})},callbackReview(){this.loadReviews=!0,this.$nextTick(()=>{this.loadReviews=!1})},createEvent(){this.part=2},selectAppointment(s){this.loadAppointmentForm=!0,this.selectedAppointment=s,this.$nextTick(()=>{this.loadAppointmentForm=!1})},selectService(s){this.loadService=!0,this.selectedService=s,this.$nextTick(()=>{this.loadService=!1})},selectReview(s){this.loadReviewForm=!0,this.selectedReview=s,this.$nextTick(()=>{this.loadReviewForm=!1})},selectEvent(s){this.loadForm=!0,this.$nextTick(()=>{this.loadForm=!1,this.selectedEvent=s,this.part=1,this.tab=0})}}},Iw=Object.assign(Aw,{__name:"Appointment",setup(s){return(t,o)=>(l(),i(v,null,[t.part===0?(l(),i("div",dw,[e("div",rw,[e("div",cw,[e("button",{type:"button",onClick:o[0]||(o[0]=(...a)=>t.createEvent&&t.createEvent(...a)),class:"btn btn-primary"}," Создать новое событие ")])]),t.loadTable?r("",!0):(l(),$(j3,{key:0,onSelect:t.selectEvent,bot:s.bot},null,8,["onSelect","bot"]))])):r("",!0),t.part===2?(l(),i("div",uw,[e("div",mw,[e("div",hw,[e("button",{type:"button",onClick:o[1]||(o[1]=a=>t.part=0),class:"btn btn-outline-primary"}," Назад ")])]),t.loadForm?r("",!0):(l(),$(X,{key:0,onCallback:t.callbackForm,bot:s.bot},null,8,["onCallback","bot"]))])):r("",!0),t.part===1?(l(),i("div",_w,[e("div",pw,[e("div",bw,[e("button",{type:"button",onClick:o[2]||(o[2]=a=>t.part=0),class:"btn btn-outline-primary"}," Назад ")])]),e("ul",fw,[e("li",{class:"nav-item",onClick:o[3]||(o[3]=a=>t.tab=0)},[e("a",{class:p(["nav-link",{active:t.tab===0}]),"aria-current":"page",href:"javascript:void(0)"},"Информация о событии",2)]),e("li",{class:"nav-item",onClick:o[4]||(o[4]=a=>t.tab=1)},[e("a",{class:p(["nav-link",{active:t.tab===1}]),href:"javascript:void(0)"},"Сервисы в событии",2)]),e("li",{class:"nav-item",onClick:o[5]||(o[5]=a=>t.tab=2)},[e("a",{class:p(["nav-link",{active:t.tab===2}]),href:"javascript:void(0)"},"График",2)]),e("li",{class:"nav-item",onClick:o[6]||(o[6]=a=>t.tab=3)},[e("a",{class:p(["nav-link",{active:t.tab===3}]),href:"javascript:void(0)"},"Записи на событие",2)]),e("li",{class:"nav-item",onClick:o[7]||(o[7]=a=>t.tab=4)},[e("a",{class:p(["nav-link",{active:t.tab===4}]),href:"javascript:void(0)"},"Отзывы о событии",2)])]),t.tab===0?(l(),i("div",gw,[e("div",vw,[t.loadForm?r("",!0):(l(),$(X,{key:0,onCallback:t.callbackForm,event:t.selectedEvent,bot:s.bot},null,8,["onCallback","event","bot"]))])])):r("",!0),t.tab===1?(l(),i("div",$w,[e("div",yw,[t.loadService?r("",!0):(l(),$(ht,{key:0,service:t.selectedService,"event-id":t.selectedEvent.id,bot:s.bot},null,8,["service","event-id","bot"]))]),e("div",kw,[Fw,g(K3,{"event-id":t.selectedEvent.id,onSelect:t.selectService,bot:s.bot},null,8,["event-id","onSelect","bot"])])])):r("",!0),t.tab===2?(l(),i("div",Cw,[e("div",ww,[g(uC,{"event-id":t.selectedEvent.id,bot:s.bot},null,8,["event-id","bot"])])])):r("",!0),t.tab===3?(l(),i("div",Sw,[e("div",jw,[t.loadAppointmentForm?r("",!0):(l(),$(K0,{key:0,bot:s.bot,onCallback:t.callbackAppointment,"event-id":t.selectedEvent.id,appointment:t.selectedAppointment},null,8,["bot","onCallback","event-id","appointment"]))]),e("div",qw,[zw,t.loadAppointments?r("",!0):(l(),$(n3,{key:0,"event-id":t.selectedEvent.id,onSelect:t.selectAppointment,bot:s.bot},null,8,["event-id","onSelect","bot"]))])])):r("",!0),t.tab===4?(l(),i("div",Pw,[e("div",Vw,[t.loadReviewForm?r("",!0):(l(),$(KC,{key:0,review:t.selectedReview,bot:s.bot,onCallback:o[8]||(o[8]=a=>t.callbackReview()),"event-id":t.selectedEvent.id},null,8,["review","bot","event-id"]))]),e("div",Ow,[Uw,t.loadReviews?r("",!0):(l(),$(aw,{key:0,bot:s.bot,onSelect:t.selectReview,"event-id":t.selectedEvent.id},null,8,["bot","onSelect","event-id"]))])])):r("",!0)])):r("",!0)],64))}}),Qw={props:["param"],data(){return{htmlInjections:[{title:"Кнопка синяя",value:"<a href='http://test.com/test' class='w-100 btn btn-primary'>Текст кнопки</a>"},{title:"Кнопка без цвета",value:"<a href='http://test.com/test' class='w-100 btn btn-link'>Текст кнопки</a>"},{title:"Кнопка с синей обводкой",value:"<a href='http://test.com/test' class='w-100 btn btn-outline-primary'>Текст кнопки</a>"}]}},mounted(){},methods:{attachTo(s){this.$emit("callback",{param:this.param||null,value:s})}}},Tw={class:"dropdown"},Bw=e("button",{class:"btn btn-link dropdown-toggle",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"}," Кнопки ",-1),Rw={class:"dropdown-menu"},Mw=["onClick"],Dw={class:"dropdown-item",href:"javascript:void(0)"};function Ew(s,t,o,a,n,d){return l(),i("div",Tw,[Bw,e("ul",Rw,[(l(!0),i(v,null,y(n.htmlInjections,h=>(l(),i("li",{onClick:b=>d.attachTo(h.value)},[e("a",Dw,u(h.title||"Не указано"),1)],8,Mw))),256))])])}const R=I(Qw,[["render",Ew]]),Lw={class:"row"},Kw={class:"col-12 mb-3"},Nw={class:"form-label",id:"quiz-title"},Jw=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),Yw=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),Hw={class:"col-12 mb-3"},Gw={class:"form-check"},Ww=e("label",{class:"form-check-label",for:"need_media"}," Нужен медиа-контент ",-1),Xw={key:0,class:"col-12 mb-3"},Zw={class:"form-label",id:"quiz-images"},xw=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),e4=e("div",null," Изображение, которое видит пользователь при выборе квиза ",-1),t4=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),s4={class:"col-12 mb-3"},o4={class:"form-label",id:"quiz-description"},l4=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),i4=e("div",null," Краткая информация о квизе ",-1),n4=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),a4={key:0,class:"text-gray-400 ml-3",style:{"font-size":"10px"}},d4={class:"col-12 mb-3"},r4={class:"form-check"},c4=e("label",{class:"form-check-label",for:"polling_mode"}," Квиз в режиме опроса (без команд и таймеров) ",-1),u4={key:1,class:"col-12 mb-3"},m4={class:"form-label",id:"quiz-time_limit"},h4=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),_4=e("div",null," Время на ответ ",-1),p4=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),b4={class:"col-12 mb-3"},f4={class:"form-check"},g4=e("label",{class:"form-check-label",for:"is-group"}," Показывать ответы по окончанию раунда ",-1),v4={class:"col-12 mb-3"},$4={class:"form-check"},y4=e("label",{class:"form-check-label",for:"is_active"}," Квиз виден пользователям ",-1),k4={key:2,class:"col-12 mb-3"},F4={class:"form-check"},C4=e("label",{class:"form-check-label",for:"round_mode"}," Использовать систему раундов ",-1),w4={class:"col-12 mb-3"},S4={class:"form-label",id:"quiz-time_limit"},j4=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),q4=e("div",null," Число попыток прохождения квиза ",-1),z4=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),P4={class:"col-12 mb-3"},V4={class:"form-label",id:"quiz-time_limit"},O4=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),U4=e("div",null," Сколько % нужно ответить чтоб пройти ",-1),A4=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),I4={class:"row"},Q4={class:"col-12 py-2"},T4={class:"col-12 mb-3"},B4={class:"row"},R4={class:"col-10"},M4={class:"d-flex justify-content-between"},D4={class:"form-label",id:"quiz-success_message"},E4=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),L4=e("div",null," Текст в случае успешного прохождения квиза ",-1),K4=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),N4={key:0,class:"text-gray-400 ml-3",style:{"font-size":"10px"}},J4=["onUpdate:modelValue"],Y4={class:"col-2 d-flex align-items-center justify-content-center"},H4=["disabled","onClick"],G4={class:"row"},W4={class:"col-12 mb-2"},X4={class:"form-check"},Z4=e("label",{class:"form-check-label",for:"need_inline_menu_on_success"}," Меню под текстом страницы при выигрыше ",-1),x4={key:0,class:"col-12 mb-2"},e8={class:"card"},t8={class:"card-header d-flex justify-between align-items-center"},s8=e("h6",null,"Конструктор меню в сообщении",-1),o8={key:0},l8={key:1},i8={class:"card-body"},n8={class:"row"},a8={class:"col-12 py-2"},d8={class:"col-12 mb-3"},r8={class:"row"},c8={class:"col-10"},u8={class:"d-flex justify-content-between"},m8=["id"],h8=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),_8=e("div",null," Текст в случае неудачного прохождения квиза ",-1),p8=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),b8={key:0,class:"text-gray-400 ml-3",style:{"font-size":"10px"}},f8=["onUpdate:modelValue"],g8={class:"col-2 d-flex align-items-center justify-content-center"},v8=["disabled","onClick"],$8={class:"row"},y8={class:"col-12 mb-2"},k8={class:"form-check"},F8=e("label",{class:"form-check-label",for:"need_template_selector_on_failure"}," Меню под текстом страницы при проигрыше ",-1),C8={key:0,class:"col-12 mb-2"},w8={class:"card"},S8={class:"card-header d-flex justify-between align-items-center"},j8=e("h6",null,"Конструктор меню в сообщении",-1),q8={key:0},z8={key:1},P8={class:"card-body"},V8={class:"row"},O8={class:"col-12 mb-3"},U8={class:"form-floating"},A8=["value","selected"],I8=e("label",{for:"quiz-display-type"},"Тип вывода вопросов",-1),Q8={class:"row"},T8={class:"col-12"},B8={type:"submit",class:"btn btn-outline-success w-100 p-3"},R8={key:0},M8={key:1},D8={props:["quiz","bot"],data(){return{step:0,load:!1,need_reset:!1,need_services:!1,need_media:!1,need_inline_menu_on_success:!1,need_template_selector_on_success:!1,need_template_selector_on_failure:!1,need_inline_menu_on_failure:!1,types:["По порядку","Перемешать всё","Перемешать ответы","Перемешать вопросы"],quizForm:{id:null,title:null,image:null,description:null,completed_at:null,start_at:null,end_at:null,display_type:0,time_limit:30,show_answers:!1,polling_mode:!1,round_mode:!0,is_active:!1,try_count:1,success_percent:50,success_message:["Задание успешно пройдено!"],failure_message:["К сожалению вы не прошли задание!"],success_inline_keyboard_id:null,success_inline_keyboard:null,failure_inline_keyboard_id:null,failure_inline_keyboard:null}}},watch:{quizForm:{handler(s){this.need_reset=!0},deep:!0},"quizForm.polling_mode":{handler(s){this.quizForm.round_mode=!1},deep:!0}},mounted(){this.quiz&&this.$nextTick(()=>{this.quizForm={id:this.quiz.id||null,title:this.quiz.title||null,image:this.quiz.image||null,description:this.quiz.description||null,completed_at:this.quiz.completed_at?this.$filters.currentFull(this.quiz.completed_at):null,start_at:this.quiz.start_at?this.$filters.currentFull(this.quiz.start_at):null,end_at:this.quiz.end_at?this.$filters.currentFull(this.quiz.end_at):null,display_type:this.quiz.display_type||0,time_limit:this.quiz.time_limit||30,show_answers:this.quiz.show_answers||!1,polling_mode:this.quiz.polling_mode||!1,round_mode:this.quiz.round_mode||!1,is_active:this.quiz.is_active||!1,try_count:this.quiz.try_count||1,success_inline_keyboard_id:this.quiz.success_inline_keyboard_id||null,success_inline_keyboard:this.quiz.success_inline_keyboard||null,failure_inline_keyboard_id:this.quiz.failure_inline_keyboard_id||null,failure_inline_keyboard:this.quiz.failure_inline_keyboard||null,success_percent:this.quiz.success_percent||50,success_message:this.quiz.success_message||["Задание успешно пройдено!"],failure_message:this.quiz.failure_message||["К сожалению вы не прошли задание!"]},this.quizForm.success_inline_keyboard&&(this.need_inline_menu_on_success=!0),this.quizForm.failure_inline_keyboard&&(this.need_inline_menu_on_failure=!0)})},methods:{saveInlineKeyboardOnSuccess(s){this.quizForm.success_inline_keyboard=s},saveInlineKeyboardOnFailure(s){this.quizForm.failure_inline_keyboard=s},selectInlineKeyboardOnSuccess(s){this.quizForm.success_inline_keyboard=s,this.need_template_selector_on_success=!1},selectInlineKeyboardOnFailure(s){this.quizForm.failure_inline_keyboard=s,this.need_template_selector_on_failure=!1},attachTo(s,t){this.quizForm[s.param][t]==null?this.quizForm[s.param][t]=s.value:this.quizForm[s.param][t]+=s.value},selectPhoto(s){this.quizForm.image=s.file_id},removeMessage(s,t){this.quizForm[s||"success_message"].splice(t,1)},addMessage(s,t){this.quizForm[s||"success_message"].push(t)},submitForm(){let s=new FormData;Object.keys(this.quizForm).forEach(t=>{const o=this.quizForm[t]||"";typeof o=="object"?s.append(t,JSON.stringify(o)):s.append(t,o)}),s.append("bot_id",this.bot.id),this.$store.dispatch("storeQuiz",{quizForm:s}).then(t=>{this.quizForm={id:null,title:null,image:null,description:null,completed_at:null,start_at:null,end_at:null,display_type:0,time_limit:30,show_answers:!1,polling_mode:!1,round_mode:!1,is_active:!1,try_count:1,success_percent:50,success_inline_keyboard_id:null,success_inline_keyboard:null,failure_inline_keyboard_id:null,failure_inline_keyboard:null,success_message:["Задание успешно пройдено!"],failure_message:["К сожалению вы не прошли задание!"]},this.$emit("callback",t.data),this.$notify("Событие успешно создано")}).catch(t=>{this.$notify("Ошибка создания события")})}}},x=Object.assign(D8,{__name:"QuizForm",setup(s){return(t,o)=>{const a=q("Popper");return l(),i("form",{onSubmit:o[17]||(o[17]=S((...n)=>t.submitForm&&t.submitForm(...n),["prevent"])),class:"py-3"},[e("div",Lw,[e("div",Kw,[e("label",Nw,[g(a,{content:"Название вашего квиза"},{default:f(()=>[Jw]),_:1}),m(" Название квиза "),Yw]),c(e("input",{type:"text",class:"form-control",placeholder:"Название","aria-label":"Название","onUpdate:modelValue":o[0]||(o[0]=n=>t.quizForm.title=n),maxlength:"255","aria-describedby":"quiz-title",required:""},null,512),[[_,t.quizForm.title]])]),e("div",Hw,[e("div",Gw,[c(e("input",{class:"form-check-input","onUpdate:modelValue":o[1]||(o[1]=n=>t.need_media=n),type:"checkbox",id:"need_media"},null,512),[[k,t.need_media]]),Ww])]),t.need_media?(l(),i("div",Xw,[e("label",Zw,[g(a,null,{content:f(()=>[e4]),default:f(()=>[xw]),_:1}),m(" Изображение к квизу "),t4]),g(P,{"need-photo":!0,selected:t.quizForm.image,onSelect:t.selectPhoto},null,8,["selected","onSelect"])])):r("",!0),e("div",s4,[e("label",o4,[g(a,null,{content:f(()=>[i4]),default:f(()=>[l4]),_:1}),m(" Описание события "),n4,t.quizForm.description?(l(),i("small",a4," Длина текста "+u(t.quizForm.description.length)+"/255",1)):r("",!0)]),c(e("textarea",{class:"form-control",placeholder:"Описание мероприятия","aria-label":"Описание мероприятия",maxlength:"255","onUpdate:modelValue":o[2]||(o[2]=n=>t.quizForm.description=n),"aria-describedby":"quiz-description",required:""},`
                    `,512),[[_,t.quizForm.description]])]),e("div",d4,[e("div",r4,[c(e("input",{class:"form-check-input","onUpdate:modelValue":o[3]||(o[3]=n=>t.quizForm.polling_mode=n),type:"checkbox",id:"polling_mode"},null,512),[[k,t.quizForm.polling_mode]]),c4])]),t.quizForm.polling_mode?r("",!0):(l(),i("div",u4,[e("label",m4,[g(a,null,{content:f(()=>[_4]),default:f(()=>[h4]),_:1}),m(" Лимит времени на ответ в секундах "),p4]),c(e("input",{type:"number",class:"form-control",placeholder:"Лимит времени на ответ","aria-label":"Лимит времени на ответ",step:"0.1",min:"0","onUpdate:modelValue":o[4]||(o[4]=n=>t.quizForm.time_limit=n),"aria-describedby":"quiz-time_limit",required:""},null,512),[[_,t.quizForm.time_limit]])])),e("div",b4,[e("div",f4,[c(e("input",{class:"form-check-input","onUpdate:modelValue":o[5]||(o[5]=n=>t.quizForm.show_answers=n),type:"checkbox",id:"is-group"},null,512),[[k,t.quizForm.show_answers]]),g4])]),e("div",v4,[e("div",$4,[c(e("input",{class:"form-check-input","onUpdate:modelValue":o[6]||(o[6]=n=>t.quizForm.is_active=n),type:"checkbox",id:"is_active"},null,512),[[k,t.quizForm.is_active]]),y4])]),t.quizForm.polling_mode?r("",!0):(l(),i("div",k4,[e("div",F4,[c(e("input",{class:"form-check-input","onUpdate:modelValue":o[7]||(o[7]=n=>t.quizForm.round_mode=n),type:"checkbox",id:"round_mode"},null,512),[[k,t.quizForm.round_mode]]),C4])])),e("div",w4,[e("label",S4,[g(a,null,{content:f(()=>[q4]),default:f(()=>[j4]),_:1}),m(" Количество попыток "),z4]),c(e("input",{type:"number",class:"form-control",placeholder:"Число попыток","aria-label":"Число попыток",step:"1",min:"1","onUpdate:modelValue":o[8]||(o[8]=n=>t.quizForm.try_count=n),"aria-describedby":"quiz-try_count",required:""},null,512),[[_,t.quizForm.try_count]])]),e("div",P4,[e("label",V4,[g(a,null,{content:f(()=>[U4]),default:f(()=>[O4]),_:1}),m(" % для прохождения "),A4]),c(e("input",{type:"number",class:"form-control",placeholder:"Процент для победы","aria-label":"Процент для победы",step:"1",min:"0","onUpdate:modelValue":o[9]||(o[9]=n=>t.quizForm.success_percent=n),"aria-describedby":"quiz-success_percent",required:""},null,512),[[_,t.quizForm.success_percent]])])]),e("div",I4,[e("div",Q4,[e("button",{class:"btn btn-outline-info rounded-5",type:"button",onClick:o[10]||(o[10]=n=>t.addMessage("success_message",null))},"Добавить еще вариант текста ")]),(l(!0),i(v,null,y(t.quizForm.success_message,(n,d)=>(l(),i("div",T4,[e("div",B4,[e("div",R4,[e("div",M4,[e("label",D4,[g(a,null,{content:f(()=>[L4]),default:f(()=>[E4]),_:1}),m(" Текст при победе "),K4,t.quizForm.success_message[d]?(l(),i("small",N4," Длина текста "+u(t.quizForm.success_message[d].length)+"/255",1)):r("",!0)]),g(R,{param:"success_message",onCallback:h=>t.attachTo(h,d)},null,8,["onCallback"])]),c(e("textarea",{class:"form-control",placeholder:"Текст при победе","aria-label":"Текст при победе",maxlength:"255","onUpdate:modelValue":h=>t.quizForm.success_message[d]=h,"aria-describedby":"quiz-success_message",required:""},`
                    `,8,J4),[[_,t.quizForm.success_message[d]]])]),e("div",Y4,[e("button",{class:"btn btn-outline-danger",disabled:t.quizForm.success_message.length<=1,onClick:h=>t.removeMessage("success_message",d)},"Удалить ",8,H4)])])]))),256))]),e("div",G4,[e("div",W4,[e("div",X4,[c(e("input",{class:"form-check-input","onUpdate:modelValue":o[11]||(o[11]=n=>t.need_inline_menu_on_success=n),type:"checkbox",id:"need_inline_menu_on_success"},null,512),[[k,t.need_inline_menu_on_success]]),Z4])]),t.need_inline_menu_on_success?(l(),i("div",x4,[e("div",e8,[e("div",t8,[s8,e("button",{class:p(["btn",{"btn-outline-primary":!t.need_template_selector_on_success,"btn-primary":t.need_template_selector_on_success}]),type:"button",onClick:o[12]||(o[12]=n=>t.need_template_selector_on_success=!t.need_template_selector_on_success)},[t.need_template_selector_on_success?(l(),i("span",l8," Скрыть шаблоны меню")):(l(),i("span",o8," Открыть шаблоны меню"))],2)]),e("div",i8,[t.need_template_selector_on_success?(l(),$(T,{key:0,class:"mb-2",type:"inline",onSelect:t.selectInlineKeyboardOnSuccess,"select-mode":!0},null,8,["onSelect"])):(l(),$(U,{key:1,type:"inline",onSave:t.saveInlineKeyboardOnSuccess,"edited-keyboard":t.quizForm.success_inline_keyboard},null,8,["onSave","edited-keyboard"]))])])])):r("",!0)]),e("div",n8,[e("div",a8,[e("button",{class:"btn btn-outline-info rounded-5",type:"button",onClick:o[13]||(o[13]=n=>t.addMessage("failure_message",null))},"Добавить еще вариант текста ")]),(l(!0),i(v,null,y(t.quizForm.failure_message,(n,d)=>(l(),i("div",d8,[e("div",r8,[e("div",c8,[e("div",u8,[e("label",{class:"form-label",id:"quiz-failure_message"+d},[g(a,null,{content:f(()=>[_8]),default:f(()=>[h8]),_:1}),m(" Текст при проигрыше "),p8,t.quizForm.failure_message[d]?(l(),i("small",b8," Длина текста "+u(t.quizForm.failure_message[d].length)+"/255",1)):r("",!0)],8,m8),g(R,{param:"failure_message",onCallback:h=>t.attachTo(h,d)},null,8,["onCallback"])]),c(e("textarea",{class:"form-control",placeholder:"Текст при проигрыше","aria-label":"Текст при проигрыше",maxlength:"255","onUpdate:modelValue":h=>t.quizForm.failure_message[d]=h,"aria-describedby":"quiz-success_message",required:""},`
                    `,8,f8),[[_,t.quizForm.failure_message[d]]])]),e("div",g8,[e("button",{class:"btn btn-outline-danger",disabled:t.quizForm.failure_message.length<=1,onClick:h=>t.removeMessage("failure_message",d)},"Удалить ",8,v8)])])]))),256))]),e("div",$8,[e("div",y8,[e("div",k8,[c(e("input",{class:"form-check-input","onUpdate:modelValue":o[14]||(o[14]=n=>t.need_inline_menu_on_failure=n),type:"checkbox",id:"need_template_selector_on_failure"},null,512),[[k,t.need_inline_menu_on_failure]]),F8])]),t.need_inline_menu_on_failure?(l(),i("div",C8,[e("div",w8,[e("div",S8,[j8,e("button",{class:p(["btn",{"btn-outline-primary":!t.need_template_selector_on_failure,"btn-primary":t.need_template_selector_on_failure}]),type:"button",onClick:o[15]||(o[15]=n=>t.need_template_selector_on_failure=!t.need_template_selector_on_failure)},[t.need_template_selector_on_failure?(l(),i("span",z8," Скрыть шаблоны меню")):(l(),i("span",q8," Открыть шаблоны меню"))],2)]),e("div",P8,[t.need_template_selector_on_failure?(l(),$(T,{key:0,class:"mb-2",type:"inline",onSelect:t.selectInlineKeyboardOnFailure,"select-mode":!0},null,8,["onSelect"])):(l(),$(U,{key:1,type:"inline",onSave:t.saveInlineKeyboardOnFailure,"edited-keyboard":t.quizForm.failure_inline_keyboard},null,8,["onSave","edited-keyboard"]))])])])):r("",!0)]),e("div",V8,[e("div",O8,[e("div",U8,[c(e("select",{class:"form-select","onUpdate:modelValue":o[16]||(o[16]=n=>t.quizForm.display_type=n),id:"quiz-display-type","aria-label":"quiz-display-type"},[(l(!0),i(v,null,y(t.types,(n,d)=>(l(),i("option",{value:d,selected:d==t.quizForm.display_type},u(n),9,A8))),256))],512),[[Q,t.quizForm.display_type]]),I8])])]),e("div",Q8,[e("div",T8,[e("button",B8,[t.quizForm.id==null?(l(),i("span",R8,"Создать квиз")):(l(),i("span",M8,"Обновить квиз"))])])])],32)}}}),E8={class:"row py-2"},L8={class:"col-12"},K8={class:"input-group mb-3"},N8={class:"col-12"},J8={key:0,class:"table"},Y8=e("th",{scope:"col"},"Число вопросов",-1),H8=e("th",{scope:"col"},"Число команд",-1),G8=e("th",{scope:"col"},"Действие",-1),W8={scope:"row"},X8=["onClick"],Z8={key:0,style:{width:"50px",height:"50px"},alt:""},x8={key:1},e6={key:0,class:"mb-0"},t6={key:1},s6={key:0,class:"mb-0"},o6={key:1},l6={key:0,class:"mb-0"},i6={key:1},n6={key:0,class:"fa-solid fa-chevron-down text-success"},a6={key:1,class:"fa-solid fa-xmark text-danger"},d6={key:0,class:"fa-solid fa-chevron-down text-success"},r6={key:1,class:"fa-solid fa-xmark text-danger"},c6={key:0,class:"dropdown"},u6=e("button",{class:"btn btn-outline-secondary",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-solid fa-ellipsis"})],-1),m6={class:"dropdown-menu"},h6={key:0},_6=["onClick"],p6={key:1},b6=e("div",{class:"alert alert-warning alert-dismissible fade show",role:"alert"},[e("strong",null,"Внимание!"),m(" Вы еще не добавили ни одного квиза! "),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"alert","aria-label":"Close"})],-1),f6={class:"position-relative p-5 text-center text-muted bg-body border border-dashed rounded-2"},g6={class:"d-flex justify-content-center mb-3"},v6={alt:"",width:"100",height:"100"},$6=e("h1",{class:"text-body-emphasis"},"Создание Квиза",-1),y6=e("p",{class:"col-lg-8 mx-auto fs-5 text-muted"}," Квиз - это игра. Создавайте игры и делитесь с клиентами ссылкой на игру. Формируйте команды, начисляйте баллы, меняйте баллы на вкусные призы. Всё в ваших руках. ",-1),k6={class:"d-inline-flex gap-2 mb-5"},F6=e("a",{href:"https://telegra.ph/Sozdanie-Kviza-01-13",target:"_blank",class:"d-inline-flex align-items-center btn btn-outline-secondary btn-lg px-4 rounded-pill"}," Подробнее ",-1),C6={key:0,class:"col-12"},w6={props:["bot"],data(){return{direction:"desc",order:"updated_at",show:!0,loading:!0,quizzes:[],search:null,paginate_object:null}},computed:{...w(["getQuizzes","getQuizzesPaginateObject"])},mounted(){this.loadQuizzes()},methods:{removeQuiz(s){this.loading=!0,this.$store.dispatch("removeQuiz",{quizId:s}).then(t=>{this.loading=!1,this.loadQuizzes(0),this.$notify("Событие успешно удалено")}).catch(()=>{this.loading=!1,this.$notify("Ошибка удаления события")})},createQuiz(){this.$emit("create")},nextQuizzes(s){this.loadQuizzes(s)},selectEvent(s){this.$emit("select",s)},loadAndOrder(s){this.order=s,this.direction=this.direction==="desc"?"asc":"desc",this.loadQuizzes(0)},loadQuizzes(s=0){this.loading=!0,this.$store.dispatch("loadQuizzes",{dataObject:{bot_id:this.bot.id||null,search:this.search,order:this.order,direction:this.direction},page:s,size:20}).then(t=>{this.loading=!1,this.quizzes=this.getQuizzes,this.paginate_object=this.getQuizzesPaginateObject}).catch(()=>{this.loading=!1})}}},S6=Object.assign(w6,{__name:"QuizTable",setup(s){return(t,o)=>{const a=A("lazy");return l(),i("div",E8,[e("div",L8,[e("div",K8,[c(e("input",{type:"search",class:"form-control",placeholder:"Поиск квиза","aria-label":"Поиск квиза","onUpdate:modelValue":o[0]||(o[0]=n=>t.search=n),"aria-describedby":"quiz-search-quiz"},null,512),[[_,t.search]]),e("button",{class:"btn btn-outline-secondary",onClick:o[1]||(o[1]=n=>t.loadQuizzes(0)),type:"button",id:"quiz-search-quiz"},"Найти ")])]),e("div",N8,[t.quizzes.length>0?(l(),i("table",J8,[e("thead",null,[e("tr",null,[e("th",{scope:"col",class:"cursor-pointer",onClick:o[2]||(o[2]=n=>t.loadAndOrder("id"))},"#"),e("th",{scope:"col",class:"cursor-pointer",onClick:o[3]||(o[3]=n=>t.loadAndOrder("title"))},"Название"),Y8,H8,e("th",{scope:"col",class:"cursor-pointer",onClick:o[4]||(o[4]=n=>t.loadAndOrder("image"))},"Изображение к квизу"),e("th",{scope:"col",class:"cursor-pointer",onClick:o[5]||(o[5]=n=>t.loadAndOrder("description"))},"Описание"),e("th",{scope:"col",class:"cursor-pointer",onClick:o[6]||(o[6]=n=>t.loadAndOrder("completed_at"))},"Квиз пройден"),e("th",{scope:"col",class:"cursor-pointer",onClick:o[7]||(o[7]=n=>t.loadAndOrder("start_at"))},"Дата и время начала"),e("th",{scope:"col",class:"cursor-pointer",onClick:o[8]||(o[8]=n=>t.loadAndOrder("end_at"))},"Дата и время завершения"),e("th",{scope:"col",class:"cursor-pointer",onClick:o[9]||(o[9]=n=>t.loadAndOrder("display_type"))},"Тип отображения"),e("th",{scope:"col",class:"cursor-pointer",onClick:o[10]||(o[10]=n=>t.loadAndOrder("show_answers"))},"Показывать ответы по окончанию раунда "),e("th",{scope:"col",class:"cursor-pointer",onClick:o[11]||(o[11]=n=>t.loadAndOrder("is_active"))},"Активный "),e("th",{scope:"col",class:"cursor-pointer",onClick:o[12]||(o[12]=n=>t.loadAndOrder("updated_at"))},"Дата изменения"),G8])]),e("tbody",null,[(l(!0),i(v,null,y(t.quizzes,(n,d)=>(l(),i("tr",{class:p({"border-info":n.deleted_at==null,"border-danger":n.deleted_at!=null})},[e("th",W8,u(n.id),1),e("td",{onClick:h=>t.selectEvent(n)},u(n.title||"Не указано"),9,X8),e("td",null,u((n.questions||[]).length),1),e("td",null,u((n.commands||[]).length),1),e("td",null,[n.image!=null?c((l(),i("img",Z8,null,512)),[[a,"/file-by-file-id/"+n.image]]):(l(),i("p",x8,"не указано"))]),e("td",null,u(n.description||"Не указано"),1),e("td",null,[n.completed_at?(l(),i("p",e6,u(t.$filters.currentFull(n.completed_at)),1)):(l(),i("p",t6,"Не задано"))]),e("td",null,[n.start_at?(l(),i("p",s6,u(t.$filters.currentFull(n.start_at)),1)):(l(),i("p",o6,"Не задано"))]),e("td",null,[n.end_at?(l(),i("p",l6,u(t.$filters.currentFull(n.end_at)),1)):(l(),i("p",i6,"Не задано"))]),e("td",null,u(n.display_type),1),e("td",null,u(n.time_limit),1),e("td",null,[n.show_answers?(l(),i("i",n6)):(l(),i("i",a6))]),e("td",null,[n.is_active?(l(),i("i",d6)):(l(),i("i",r6))]),e("td",null,u(t.$filters.current(n.updated_at)),1),e("td",null,[n.id?(l(),i("div",c6,[u6,e("ul",m6,[n.deleted_at==null?(l(),i("li",h6,[e("a",{class:"dropdown-item",onClick:h=>t.removeQuiz(n.id),href:"javascript:void(0)"},"Удалить",8,_6)])):r("",!0)])])):r("",!0)])],2))),256))])])):(l(),i("div",p6,[b6,e("div",f6,[e("div",g6,[c(e("img",v6,null,512),[[a,"../images/icon.png"]])]),$6,y6,e("div",k6,[e("button",{onClick:o[13]||(o[13]=(...n)=>t.createQuiz&&t.createQuiz(...n)),class:"d-inline-flex align-items-center btn btn-lg px-4 rounded-pill btn-primary",type:"button"}," Добавить "),F6])])]))]),t.quizzes.length>0?(l(),i("div",C6,[t.paginate_object?(l(),$(j,{key:0,onPagination_page:t.nextQuizzes,pagination:t.paginate_object},null,8,["onPagination_page","pagination"])):r("",!0)])):r("",!0)])}}}),j6={props:{type:String,value:String}},q6={class:"d-flex mb-2"},z6={class:"form-floating mb-3"},P6=["value"],V6=e("label",{for:"custom-url-link-for-success"},"Ссылка на файл",-1);function O6(s,t,o,a,n,d){return l(),i(v,null,[e("div",q6,[e("span",{class:p(["badge bg-secondary cursor-pointer mr-1",{"bg-success":o.type=="video"}]),onClick:t[0]||(t[0]=h=>s.$emit("update:type","video"))},"Видео",2),e("span",{class:p(["badge bg-secondary cursor-pointer mr-1",{"bg-success":o.type=="video_note"}]),onClick:t[1]||(t[1]=h=>s.$emit("update:type","video_note"))},"Кружок",2),e("span",{class:p(["badge bg-secondary cursor-pointer mr-1",{"bg-success":o.type=="photo"}]),onClick:t[2]||(t[2]=h=>s.$emit("update:type","photo"))},"Изображение",2),e("span",{class:p(["badge bg-secondary cursor-pointer mr-1",{"bg-success":o.type=="audio"}]),onClick:t[3]||(t[3]=h=>s.$emit("update:type","audio"))},"Звук",2)]),e("div",z6,[e("input",{type:"text",class:"form-control",value:o.value,onInput:t[4]||(t[4]=h=>s.$emit("update:value",h.target.value)),id:"custom-url-link-for-success",placeholder:"https://...."},null,40,P6),V6])],64)}const N=I(j6,[["render",O6]]),U6={class:"row py-3"},A6={class:"col-12"},I6={class:"row"},Q6={class:"col-12 mb-3"},T6={key:0},B6=["onClick"],R6={class:"form-label",id:"quiz-round"},M6=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),D6=e("div",null," Раунд, в котором будет отображен вопрос ",-1),E6=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),L6={class:"col-12 mb-3"},K6={class:"form-label",id:"event-on_after_appointment"},N6=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),J6=e("div",null," Текст вопроса ",-1),Y6=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),H6={key:0,class:"text-gray-400 ml-3",style:{"font-size":"10px"}},G6={class:"col-12 mb-3"},W6={class:"form-check"},X6=e("label",{class:"form-check-label",for:"need_media"}," Нужен медиа-контент ",-1),Z6={key:0,class:"col-12 mb-3"},x6={class:"form-label",id:"quiz-images"},e7=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),t7=e("div",null," Изображение, видео, аудио сопровождение вопроса ",-1),s7={key:0,class:"badge rounded-pill text-bg-info m-0"},o7=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),l7=e("h6",null,"Вставьте ссылку на контент...",-1),i7=e("h6",null,"...или выберите из доступных",-1),n7={class:"col-12 mb-3"},a7={class:"form-check"},d7=e("label",{class:"form-check-label",for:"is_multiply"}," Множественные ответы ",-1),r7={class:"col-12 mb-3"},c7={class:"form-check"},u7=e("label",{class:"form-check-label",for:"is_open"}," Открытый вопрос ",-1),m7={class:"col-12 mb-3"},h7={class:"d-flex justify-content-between"},_7={class:"form-label",id:"quiz-description"},p7=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),b7=e("div",null," Текст при выборе правильного ответа ",-1),f7=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),g7={key:0,class:"text-gray-400 ml-3",style:{"font-size":"10px"}},v7={class:"col-12 mb-3"},$7={class:"form-check"},y7=e("label",{class:"form-check-label",for:"need_media_for_success"}," Нужен медиа-контент при правильном ответе ",-1),k7={key:1,class:"col-12 mb-3"},F7=e("h6",null,"Вставьте ссылку на контент...",-1),C7=e("h6",null,"...или выберите из доступных",-1),w7={class:"col-12 mb-3"},S7={class:"d-flex justify-content-between"},j7={class:"form-label",id:"quiz-description"},q7=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),z7=e("div",null," Текст в выбора неправильного ответа ",-1),P7=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),V7={key:0,class:"text-gray-400 ml-3",style:{"font-size":"10px"}},O7={class:"col-12 mb-3"},U7={class:"form-check"},A7=e("label",{class:"form-check-label",for:"need_media_for_failed"}," Нужен медиа-контент при неправильном ответе ",-1),I7={key:2,class:"col-12 mb-3"},Q7=e("h6",null,"Вставьте ссылку на контент...",-1),T7=e("h6",null,"...или выберите из доступных",-1),B7={class:"row"},R7={class:"col-12"},M7={class:"col-12"},D7={key:0,class:"table"},E7=e("thead",null,[e("tr",null,[e("th",{scope:"col"},"#"),e("th",{scope:"col"},"Текст вопроса"),e("th",{scope:"col"},"Баллы"),e("th",{scope:"col"},"Контент"),e("th",{scope:"col"},"Тип контента"),e("th",{scope:"col"},"Является верным"),e("th",{scope:"col"},"Действие")])],-1),L7={scope:"row"},K7={class:"form-floating mb-3"},N7=["onUpdate:modelValue","id"],J7=["for"],Y7={class:"form-floating mb-3"},H7=["onUpdate:modelValue","id"],G7=["for"],W7=["onClick"],X7={class:"form-check"},Z7=["onUpdate:modelValue","id"],x7=["for"],e9={class:"dropdown"},t9=e("button",{class:"btn btn-outline-secondary",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-solid fa-ellipsis"})],-1),s9={class:"dropdown-menu"},o9={key:0},l9=["onClick"],i9={key:1},n9=["onClick"],a9={key:1},d9={class:"row"},r9={class:"col-12"},c9={type:"submit",class:"btn btn-outline-success w-100 p-3"},u9={key:0},m9={key:1},h9={class:"modal fade",id:"chooseMediaContent",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},_9={class:"modal-dialog"},p9={class:"modal-content"},b9={key:0,class:"modal-body"},f9=e("div",{class:"modal-footer"},[e("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Закрыть")],-1),g9={class:"modal fade",id:"chooseSuccessMediaContent",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},v9={class:"modal-dialog"},$9={class:"modal-content"},y9={class:"modal-body"},k9=e("div",{class:"modal-footer"},[e("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Закрыть")],-1),F9={class:"modal fade",id:"chooseFailureMediaContent",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},C9={class:"modal-dialog"},w9={class:"modal-content"},S9={class:"modal-body"},j9=e("div",{class:"modal-footer"},[e("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Закрыть")],-1),q9={class:"modal fade",id:"chooseBaseMediaContent",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},z9={class:"modal-dialog"},P9={class:"modal-content"},V9={class:"modal-body"},O9=e("div",{class:"modal-footer"},[e("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Закрыть")],-1),U9={props:["quizId","bot","question"],data(){return{step:0,load:!1,selectedQuestionIndex:null,need_media:!1,need_media_for_success:!1,need_media_for_failed:!1,rounds:[],questionForm:{id:null,text:null,round:null,media_content:null,content_type:null,is_multiply:!1,is_open:!1,answers:[],success_message:null,failure_message:null,success_media_content:null,failure_media_content:null,success_media_content_type:null,failure_media_content_type:null}}},watch:{questionForm:{handler(s){this.need_reset=!0},deep:!0},need_media:function(s,t){this.need_page_images||(this.questionForm.media_content=null,this.questionForm.content_type=null)},need_media_for_success:function(s,t){this.need_page_images||(this.questionForm.success_media_content=null,this.questionForm.success_media_content_type=null)},need_media_for_failed:function(s,t){this.need_page_images||(this.questionForm.failure_media_content=null,this.questionForm.failure_media_content_type=null)}},mounted(){this.loadQuizRounds(),this.question&&(this.question.media_content!=null&&(this.need_media=!0),this.question.success_media_content!=null&&(this.need_media_for_success=!0),this.question.failure_media_content!=null&&(this.need_media_for_failed=!0),this.$nextTick(()=>{this.questionForm={id:this.question.id||null,text:this.question.text||null,round:this.question.round||null,media_content:this.question.media_content||null,content_type:this.question.content_type||null,is_multiply:this.question.is_multiply||!1,is_open:this.question.is_open||!1,answers:this.question.answers||[],success_message:this.question.success_message||null,failure_message:this.question.failure_message||null,success_media_content:this.question.success_media_content||null,failure_media_content:this.question.failure_media_content||null,success_media_content_type:this.question.success_media_content_type||null,failure_media_content_type:this.question.failure_media_content_type||null}}))},methods:{attachTo(s){this.questionForm[s.param]==null?this.questionForm[s.param]=s.value:this.questionForm[s.param]+=s.value},loadQuizRounds(){this.$store.dispatch("loadQuizRounds",{dataObject:{bot_id:this.bot.id||null,quiz_id:this.quizId||null}}).then(s=>{this.rounds=s})},chooseBaseMediaContent(s){new bootstrap.Modal(document.getElementById("chooseBaseMediaContent"),{}).show()},chooseSuccessMediaContent(s){new bootstrap.Modal(document.getElementById("chooseSuccessMediaContent"),{}).show()},chooseFailureMediaContent(s){new bootstrap.Modal(document.getElementById("chooseFailureMediaContent"),{}).show()},chooseMediaContent(s){this.selectedQuestionIndex=null,this.$nextTick(()=>{this.selectedQuestionIndex=s}),new bootstrap.Modal(document.getElementById("chooseMediaContent"),{}).show()},selectMediaForFailure(s){this.questionForm.failure_media_content=s.file_id,this.questionForm.failure_media_content_type=s.type},selectMediaForSuccess(s){this.questionForm.success_media_content=s.file_id,this.questionForm.success_media_content_type=s.type},selectMediaForAnswer(s){this.questionForm.answers[this.selectedQuestionIndex].media_content=s.file_id,this.questionForm.answers[this.selectedQuestionIndex].content_type=s.type},selectMedia(s){this.questionForm.media_content=s.file_id,this.questionForm.content_type=s.type},clearQuestionForm(){this.questionForm={id:null,text:null,round:null,media_content:null,content_type:null,is_multiply:!1,is_open:!1,answers:[],success_message:null,failure_message:null,success_media_content:null,failure_media_content:null,success_media_content_type:null,failure_media_content_type:null}},addNewAnswer(){this.questionForm.answers.push({text:null,media_content:null,content_type:null,is_right_answer:!1,points:0})},removeAnswerFromArray(s){this.questionForm.answers.splice(s,1)},removeAnswer(s){this.$store.dispatch("removeQuizAnswer",{quizAnswerId:s}).then(t=>{this.$notify("Вопрос успешно удален");let o=this.questionForm.answers.findIndex(a=>a.id==s);this.questionForm.answers.splice(o,1)}).catch(t=>{this.$notify("Ошибка удаления вопроса")})},submitForm(){let s=new FormData;Object.keys(this.questionForm).forEach(t=>{const o=this.questionForm[t]||"";typeof o=="object"?s.append(t,JSON.stringify(o)):s.append(t,o)}),s.append("bot_id",this.bot.id),s.append("quiz_id",this.quizId),this.$store.dispatch("storeQuizQuestion",{quizQuestionForm:s}).then(t=>{this.$emit("callback",t.data),this.$notify("Вопрос успешно создан"),this.clearQuestionForm(),this.loadQuizRounds()}).catch(t=>{this.$notify("Ошибка создания вопроса")})}}},A9=Object.assign(U9,{__name:"QuizQuestionForm",setup(s){return(t,o)=>{const a=q("Popper");return l(),i(v,null,[e("div",U6,[e("div",A6,[e("button",{onClick:o[0]||(o[0]=(...n)=>t.clearQuestionForm&&t.clearQuestionForm(...n)),class:"btn btn-primary"},"Новый вопрос ")])]),e("form",{onSubmit:o[20]||(o[20]=S((...n)=>t.submitForm&&t.submitForm(...n),["prevent"]))},[e("div",I6,[e("div",Q6,[t.rounds.length>0?(l(),i("p",T6,[m(" Ранее созданные раунды: "),(l(!0),i(v,null,y(t.rounds,n=>(l(),i("span",{onClick:d=>t.questionForm.round=n,class:"badge bg-primary mr-1 cursor-pointer"},u(n),9,B6))),256))])):r("",!0),e("label",R6,[g(a,null,{content:f(()=>[D6]),default:f(()=>[M6]),_:1}),m(" Раунд "),E6]),c(e("input",{type:"number",class:"form-control",placeholder:"Раунд","aria-label":"Раундт",step:"1",min:"1","onUpdate:modelValue":o[1]||(o[1]=n=>t.questionForm.round=n),"aria-describedby":"quiz-round",required:""},null,512),[[_,t.questionForm.round]])]),e("div",L6,[e("label",K6,[g(a,null,{content:f(()=>[J6]),default:f(()=>[N6]),_:1}),m(" Текст вопроса "),Y6,t.questionForm.text?(l(),i("small",H6," Длина текста "+u(t.questionForm.text.length)+"/255",1)):r("",!0)]),c(e("textarea",{type:"text",class:"form-control",placeholder:"Текст вопроса","aria-label":"Текст вопроса","onUpdate:modelValue":o[2]||(o[2]=n=>t.questionForm.text=n),maxlength:"255","aria-describedby":"review-text",required:""},`
                    `,512),[[_,t.questionForm.text]])]),e("div",G6,[e("div",W6,[c(e("input",{class:"form-check-input","onUpdate:modelValue":o[3]||(o[3]=n=>t.need_media=n),type:"checkbox",id:"need_media"},null,512),[[k,t.need_media]]),X6])]),t.need_media?(l(),i("div",Z6,[e("label",x6,[g(a,null,{content:f(()=>[t7]),default:f(()=>[e7]),_:1}),m(" Медиа контент к вопросу "),t.questionForm.content_type?(l(),i("span",s7,u(t.questionForm.content_type),1)):r("",!0),o7]),l7,g(N,{value:t.questionForm.media_content,type:t.questionForm.content_type,"onUpdate:type":o[4]||(o[4]=n=>t.questionForm.content_type=n),"onUpdate:value":o[5]||(o[5]=n=>t.questionForm.media_content=n)},null,8,["value","type"]),i7,e("button",{type:"button",onClick:o[6]||(o[6]=(...n)=>t.chooseBaseMediaContent&&t.chooseBaseMediaContent(...n)),class:"btn btn-outline-info rounded-lg"},"Выбрать медиа-файл ")])):r("",!0),e("div",n7,[e("div",a7,[c(e("input",{class:"form-check-input","onUpdate:modelValue":o[7]||(o[7]=n=>t.questionForm.is_multiply=n),type:"checkbox",id:"is_multiply"},null,512),[[k,t.questionForm.is_multiply]]),d7])]),e("div",r7,[e("div",c7,[c(e("input",{class:"form-check-input","onUpdate:modelValue":o[8]||(o[8]=n=>t.questionForm.is_open=n),type:"checkbox",id:"is_open"},null,512),[[k,t.questionForm.is_open]]),u7])]),e("div",m7,[e("div",h7,[e("label",_7,[g(a,null,{content:f(()=>[b7]),default:f(()=>[p7]),_:1}),m(" Текст при выборе правильного ответа "),f7,t.questionForm.success_message?(l(),i("small",g7," Длина текста "+u(t.questionForm.success_message.length)+"/255",1)):r("",!0)]),g(R,{param:"success_message",onCallback:t.attachTo},null,8,["onCallback"])]),c(e("textarea",{class:"form-control",placeholder:"Текст при правильном ответе","aria-label":"Текст при правильном ответе",maxlength:"255","onUpdate:modelValue":o[9]||(o[9]=n=>t.questionForm.success_message=n),"aria-describedby":"quiz-question-success_message"},`
                    `,512),[[_,t.questionForm.success_message]])]),e("div",v7,[e("div",$7,[c(e("input",{class:"form-check-input","onUpdate:modelValue":o[10]||(o[10]=n=>t.need_media_for_success=n),type:"checkbox",id:"need_media_for_success"},null,512),[[k,t.need_media_for_success]]),y7])]),t.need_media_for_success?(l(),i("div",k7,[F7,g(N,{type:t.questionForm.success_media_content_type,"onUpdate:type":o[11]||(o[11]=n=>t.questionForm.success_media_content_type=n),value:t.questionForm.success_media_content,"onUpdate:value":o[12]||(o[12]=n=>t.questionForm.success_media_content=n)},null,8,["type","value"]),C7,e("button",{type:"button",onClick:o[13]||(o[13]=(...n)=>t.chooseSuccessMediaContent&&t.chooseSuccessMediaContent(...n)),class:"btn btn-outline-info rounded-lg"},"Выбрать медиа-файл ")])):r("",!0),e("div",w7,[e("div",S7,[e("label",j7,[g(a,null,{content:f(()=>[z7]),default:f(()=>[q7]),_:1}),m(" Текст при выборе неправильного ответа "),P7,t.questionForm.failure_message?(l(),i("small",V7," Длина текста "+u(t.questionForm.failure_message.length)+"/255",1)):r("",!0)]),g(R,{param:"failure_message",onCallback:t.attachTo},null,8,["onCallback"])]),c(e("textarea",{class:"form-control",placeholder:"Текст при неправильном ответе","aria-label":"Текст при неправильном ответе",maxlength:"255","onUpdate:modelValue":o[14]||(o[14]=n=>t.questionForm.failure_message=n),"aria-describedby":"quiz-question-failure-message"},`
                    `,512),[[_,t.questionForm.failure_message]])]),e("div",O7,[e("div",U7,[c(e("input",{class:"form-check-input","onUpdate:modelValue":o[15]||(o[15]=n=>t.need_media_for_failed=n),type:"checkbox",id:"need_media_for_failed"},null,512),[[k,t.need_media_for_failed]]),A7])]),t.need_media_for_failed?(l(),i("div",I7,[Q7,g(N,{type:t.questionForm.failure_media_content_type,"onUpdate:type":o[16]||(o[16]=n=>t.questionForm.failure_media_content_type=n),value:t.questionForm.failure_media_content,"onUpdate:value":o[17]||(o[17]=n=>t.questionForm.failure_media_content=n)},null,8,["type","value"]),T7,e("button",{type:"button",onClick:o[18]||(o[18]=(...n)=>t.chooseFailureMediaContent&&t.chooseFailureMediaContent(...n)),class:"btn btn-outline-info rounded-lg"},"Выбрать медиа-файл ")])):r("",!0)]),e("div",B7,[e("div",R7,[e("button",{onClick:o[19]||(o[19]=(...n)=>t.addNewAnswer&&t.addNewAnswer(...n)),type:"button",class:"btn btn-outline-success rounded-5"}," Добавить ответы ")]),e("div",M7,[t.questionForm.answers.length>0?(l(),i("table",D7,[E7,e("tbody",null,[(l(!0),i(v,null,y(t.questionForm.answers,(n,d)=>(l(),i("tr",{class:p({"border-info":n.deleted_at==null,"border-danger":n.deleted_at!=null})},[e("th",L7,u(n.id||"Новый"),1),e("td",null,[e("div",K7,[c(e("input",{type:"text","onUpdate:modelValue":h=>t.questionForm.answers[d].text=h,class:"form-control",id:"answer-text-"+d,placeholder:"Текст ответа"},null,8,N7),[[_,t.questionForm.answers[d].text]]),e("label",{for:"answer-text-"+d},"Текст ответа",8,J7)])]),e("td",null,[e("div",Y7,[c(e("input",{type:"text","onUpdate:modelValue":h=>t.questionForm.answers[d].points=h,class:"form-control",id:"answer-points-"+d,placeholder:"Текст ответа"},null,8,H7),[[_,t.questionForm.answers[d].points]]),e("label",{for:"answer-points-"+d},"Баллы",8,G7)])]),e("td",null,[e("p",{class:"cursor-pointer",onClick:h=>t.chooseMediaContent(d)},u(n.media_content||"Не указано"),9,W7)]),e("td",null,u(n.content_type||"Не указано"),1),e("td",null,[e("div",X7,[c(e("input",{class:"form-check-input","onUpdate:modelValue":h=>t.questionForm.answers[d].is_right_answer=h,type:"checkbox",id:"answer-is_right_answer-"+d},null,8,Z7),[[k,t.questionForm.answers[d].is_right_answer]]),e("label",{class:"form-check-label",for:"answer-is_right_answer-"+d}," Правильный ответ ",8,x7)])]),e("td",null,[e("div",e9,[t9,e("ul",s9,[n.id==null?(l(),i("li",o9,[e("a",{class:"dropdown-item",onClick:h=>t.removeAnswerFromArray(d),href:"javascript:void(0)"},"Удалить",8,l9)])):r("",!0),n.deleted_at==null&&n.id!=null?(l(),i("li",i9,[e("a",{class:"dropdown-item",onClick:h=>t.removeAnswer(n.id),href:"javascript:void(0)"},"Удалить",8,n9)])):r("",!0)])])])],2))),256))])])):(l(),i("p",a9,"На текущий момент нет ни одного созданного ответа"))])]),e("div",d9,[e("div",r9,[e("button",c9,[t.questionForm.id==null?(l(),i("span",u9,"Сохранить вопрос")):(l(),i("span",m9,"Обновить вопрос"))])])])],32),e("div",h9,[e("div",_9,[e("div",p9,[t.selectedQuestionIndex!=null?(l(),i("div",b9,[g(P,{"need-video":!0,"need-video-note":!0,"need-audio":!0,"need-photo":!0,selected:[t.questionForm.answers[t.selectedQuestionIndex||0].media_content||""],onSelect:t.selectMediaForAnswer},null,8,["selected","onSelect"])])):r("",!0),f9])])]),e("div",g9,[e("div",v9,[e("div",$9,[e("div",y9,[g(P,{"need-video":!0,"need-video-note":!0,"need-audio":!0,"need-photo":!0,selected:[t.questionForm.success_media_content],onSelect:t.selectMediaForSuccess},null,8,["selected","onSelect"])]),k9])])]),e("div",F9,[e("div",C9,[e("div",w9,[e("div",S9,[g(P,{"need-video":!0,"need-video-note":!0,"need-audio":!0,"need-photo":!0,selected:[t.questionForm.failure_media_content],onSelect:t.selectMediaForFailure},null,8,["selected","onSelect"])]),j9])])]),e("div",q9,[e("div",z9,[e("div",P9,[e("div",V9,[g(P,{"need-video":!0,"need-video-note":!0,"need-audio":!0,"need-photo":!0,selected:[t.questionForm.media_content],onSelect:t.selectMedia},null,8,["selected","onSelect"])]),O9])])])],64)}}}),I9={class:"row"},Q9={class:"col-12"},T9={key:0,class:"table"},B9=e("th",{scope:"col"},"Число ответов",-1),R9=e("th",{scope:"col"},"Действие",-1),M9={scope:"row"},D9=["onClick"],E9={key:0,class:"fa-solid fa-chevron-down text-success"},L9={key:1,class:"fa-solid fa-xmark text-danger"},K9={key:0,class:"fa-solid fa-chevron-down text-success"},N9={key:1,class:"fa-solid fa-xmark text-danger"},J9={key:0,class:"dropdown"},Y9=e("button",{class:"btn btn-outline-secondary",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-solid fa-ellipsis"})],-1),H9={class:"dropdown-menu"},G9={key:0},W9=["onClick"],X9={key:1},Z9={class:"col-12"},x9={props:["bot","quizId"],data(){return{direction:"desc",order:"updated_at",show:!0,is_group:!1,loading:!0,questions:[],search:null,paginate_object:null}},computed:{...w(["getQuizQuestions","getQuizQuestionsPaginateObject"])},mounted(){this.loadQuizQuestions()},methods:{nextQuizQuestion(s){this.loadQuizQuestions(s)},selectQuizQuestion(s){this.$emit("select",s),this.$notify("Вопрос успешно выбран")},removeQuizQuestion(s){this.loading=!0,this.$store.dispatch("removeQuizQuestion",{quizQuestionId:s}).then(t=>{this.loading=!1,this.loadQuizQuestions(0),this.$notify("Вопрос успешно удален")}).catch(()=>{this.loading=!1,this.$notify("Вопрос удаления сервиса")})},loadAndOrder(s){this.order=s,this.direction=this.direction==="desc"?"asc":"desc",this.loadQuizQuestions(0)},loadQuizQuestions(s=0){this.loading=!0,this.$store.dispatch("loadQuizQuestions",{dataObject:{quiz_id:this.quizId,bot_id:this.bot.id||null,search:this.search,order:this.order,direction:this.direction},page:s,size:100}).then(t=>{this.loading=!1,this.questions=this.getQuizQuestions,this.paginate_object=this.getQuizQuestionsPaginateObject}).catch(()=>{this.loading=!1})}}},eS=Object.assign(x9,{__name:"QuizQuestionTable",setup(s){return(t,o)=>(l(),i("div",I9,[e("div",Q9,[t.questions.length>0?(l(),i("table",T9,[e("thead",null,[e("tr",null,[e("th",{scope:"col",class:"cursor-pointer",onClick:o[0]||(o[0]=a=>t.loadAndOrder("id"))},"#"),e("th",{scope:"col",class:"cursor-pointer",onClick:o[1]||(o[1]=a=>t.loadAndOrder("text"))},"Текст вопроса"),B9,e("th",{scope:"col",class:"cursor-pointer",onClick:o[2]||(o[2]=a=>t.loadAndOrder("round"))},"Раунд"),e("th",{scope:"col",class:"cursor-pointer",onClick:o[3]||(o[3]=a=>t.loadAndOrder("media_content"))},"Контент"),e("th",{scope:"col",class:"cursor-pointer",onClick:o[4]||(o[4]=a=>t.loadAndOrder("content_type"))},"Тип контента"),e("th",{scope:"col",class:"cursor-pointer",onClick:o[5]||(o[5]=a=>t.loadAndOrder("is_multiply"))},"Множественный"),e("th",{scope:"col",class:"cursor-pointer",onClick:o[6]||(o[6]=a=>t.loadAndOrder("is_open"))},"Открытый"),e("th",{scope:"col",class:"cursor-pointer",onClick:o[7]||(o[7]=a=>t.loadAndOrder("updated_at"))},"Дата изменения"),R9])]),e("tbody",null,[(l(!0),i(v,null,y(t.questions,(a,n)=>(l(),i("tr",{class:p({"border-info":a.deleted_at==null,"border-danger":a.deleted_at!=null})},[e("th",M9,u(a.id),1),e("td",{onClick:d=>t.selectQuizQuestion(a)},u(a.text||"Не указано"),9,D9),e("td",null,u((a.answers||[]).length),1),e("td",null,u(a.round||"Не указано"),1),e("td",null,u(a.media_content||"Не указано"),1),e("td",null,u(a.content_type||"Не указано"),1),e("td",null,[a.is_multiply?(l(),i("i",E9)):(l(),i("i",L9))]),e("td",null,[a.is_open?(l(),i("i",K9)):(l(),i("i",N9))]),e("td",null,u(t.$filters.current(a.updated_at)),1),e("td",null,[a.id?(l(),i("div",J9,[Y9,e("ul",H9,[a.deleted_at==null?(l(),i("li",G9,[e("a",{class:"dropdown-item",onClick:d=>t.removeQuizQuestion(a.id),href:"javascript:void(0)"},"Удалить",8,W9)])):r("",!0)])])):r("",!0)])],2))),256))])])):(l(),i("p",X9,"На текущий момент нет ни одного созданного вопроса"))]),e("div",Z9,[t.paginate_object?(l(),$(j,{key:0,onPagination_page:t.nextQuizQuestion,pagination:t.paginate_object},null,8,["onPagination_page","pagination"])):r("",!0)])]))}}),tS={class:"row py-3"},sS={class:"col-12"},oS={class:"row"},lS={class:"col-12 mb-3"},iS={class:"form-label",id:"command-title"},nS=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),aS=e("div",null," Название команды ",-1),dS=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),rS={class:"col-12 mb-3"},cS={class:"form-label",id:"event-on_after_appointment"},uS=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),mS=e("div",null," Текст описания команды ",-1),hS=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),_S={key:0,class:"text-gray-400 ml-3",style:{"font-size":"10px"}},pS=e("div",{class:"col-12 mb-3"},[e("button",{type:"button",class:"btn btn-outline-info rounded-5","data-bs-toggle":"modal","data-bs-target":"#select-players"}," Подобрать участников команды ")],-1),bS={key:0,class:"col-12 mb-3"},fS=e("h4",null,"Пользователи в команде",-1),gS={class:"list-group list-group-numbered"},vS={class:"list-group-item d-flex justify-content-between align-items-start"},$S={class:"ms-2 me-auto"},yS={class:"fw-bold"},kS={class:"dropdown"},FS=e("button",{class:"btn btn-outline-secondary",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-solid fa-ellipsis"})],-1),CS={class:"dropdown-menu"},wS=["onClick"],SS={class:"row"},jS={class:"col-12"},qS={type:"submit",class:"btn btn-outline-success w-100 p-3"},zS={key:0},PS={key:1},VS={class:"modal fade",id:"select-players",tabindex:"-1","aria-labelledby":"select-players-label","aria-hidden":"true"},OS={class:"modal-dialog modal-fullscreen"},US={class:"modal-content"},AS=e("div",{class:"modal-header"},[e("h1",{class:"modal-title fs-5",id:"select-players-label"},"Подбор участников команды"),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),IS={class:"modal-body"},QS=e("div",{class:"modal-footer"},[e("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Закрыть")],-1),TS={props:["quizId","bot","command"],data(){return{step:0,load:!1,commandForm:{id:null,title:null,description:null,players:[]}}},watch:{commandForm:{handler(s){this.need_reset=!0},deep:!0}},mounted(){this.command&&this.$nextTick(()=>{this.commandForm={id:this.command.id||null,title:this.command.title||null,description:this.command.description||null,players:this.command.players||[]}})},methods:{removePlayerFromCommand(s){},selectBotUser(s){if(this.commandForm.players.findIndex(o=>o.id==s.id)>=0){this.$notify("Такой пользователь уже есть в списке");return}this.$notify("Пользователь успешно добавлен"),this.commandForm.players.push(s)},clearCommandForm(){this.commandForm={id:null,title:null,description:null,players:[]}},submitForm(){let s=new FormData;Object.keys(this.commandForm).forEach(t=>{const o=this.commandForm[t]||"";typeof o=="object"?s.append(t,JSON.stringify(o)):s.append(t,o)}),s.append("bot_id",this.bot.id),s.append("quiz_id",this.quizId),this.$store.dispatch("storeQuizCommand",{quizCommandForm:s}).then(t=>{this.$emit("callback",t.data),this.$notify("Команда успешно создана"),this.clearCommandForm()}).catch(t=>{this.$notify("Ошибка создания команды")})}}},BS=Object.assign(TS,{__name:"QuizCommandForm",setup(s){return(t,o)=>{const a=q("Popper");return l(),i(v,null,[e("div",tS,[e("div",sS,[e("button",{onClick:o[0]||(o[0]=(...n)=>t.clearCommandForm&&t.clearCommandForm(...n)),class:"btn btn-primary"},"Новая команда")])]),e("form",{onSubmit:o[3]||(o[3]=S((...n)=>t.submitForm&&t.submitForm(...n),["prevent"]))},[e("div",oS,[e("div",lS,[e("label",iS,[g(a,null,{content:f(()=>[aS]),default:f(()=>[nS]),_:1}),m(" Название команды "),dS]),c(e("input",{type:"text",class:"form-control",placeholder:"Название команды","aria-label":"Название команды",maxlength:"255","onUpdate:modelValue":o[1]||(o[1]=n=>t.commandForm.title=n),"aria-describedby":"command-title",required:""},null,512),[[_,t.commandForm.title]])]),e("div",rS,[e("label",cS,[g(a,null,{content:f(()=>[mS]),default:f(()=>[uS]),_:1}),m(" Описание команды "),hS,t.commandForm.description?(l(),i("small",_S," Длина текста "+u(t.commandForm.description.length)+"/255",1)):r("",!0)]),c(e("textarea",{type:"text",class:"form-control",placeholder:"Текст описания","aria-label":"Текст описания","onUpdate:modelValue":o[2]||(o[2]=n=>t.commandForm.description=n),maxlength:"255","aria-describedby":"command-text",required:""},`
                    `,512),[[_,t.commandForm.description]])]),pS,t.commandForm.players.length>0?(l(),i("div",bS,[fS,e("ol",gS,[(l(!0),i(v,null,y(t.commandForm.players,n=>(l(),i("li",vS,[e("div",$S,[e("div",yS,"#"+u(n.id),1),m(" "+u(n.fio_from_telegram||n.telegram_chat_id),1)]),e("div",kS,[FS,e("ul",CS,[e("li",null,[e("a",{class:"dropdown-item",onClick:d=>t.removePlayerFromCommand(n.id),href:"javascript:void(0)"},"Удалить",8,wS)])])])]))),256))])])):r("",!0)]),e("div",SS,[e("div",jS,[e("button",qS,[t.commandForm.id==null?(l(),i("span",zS,"Сохранить команду")):(l(),i("span",PS,"Обновить команду"))])])])],32),e("div",VS,[e("div",OS,[e("div",US,[AS,e("div",IS,[g(D,{simple:!0,onSelect:t.selectBotUser},null,8,["onSelect"])]),QS])])])],64)}}}),RS={class:"row"},MS={class:"col-12"},DS={key:0,class:"table"},ES=e("th",{scope:"col"},"Число участников",-1),LS=e("th",{scope:"col"},"Действие",-1),KS={scope:"row"},NS=["onClick"],JS={key:0,class:"dropdown"},YS=e("button",{class:"btn btn-outline-secondary",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-solid fa-ellipsis"})],-1),HS={class:"dropdown-menu"},GS={key:0},WS=["onClick"],XS={key:1},ZS={class:"col-12"},xS={props:["bot","quizId"],data(){return{direction:"desc",order:"updated_at",show:!0,is_group:!1,loading:!0,commands:[],search:null,paginate_object:null}},computed:{...w(["getQuizCommands","getQuizCommandsPaginateObject"])},mounted(){this.loadQuizCommands()},methods:{nextQuizCommand(s){this.loadQuizCommands(s)},selectQuizCommand(s){this.$emit("select",s),this.$notify("Вопрос успешно выбран")},removeQuizCommand(s){this.loading=!0,this.$store.dispatch("removeQuizCommand",{quizCommandId:s}).then(t=>{this.loading=!1,this.loadQuizCommands(0),this.$notify("Вопрос успешно удален")}).catch(()=>{this.loading=!1,this.$notify("Вопрос удаления сервиса")})},loadAndOrder(s){this.order=s,this.direction=this.direction==="desc"?"asc":"desc",this.loadQuizCommands(0)},loadQuizCommands(s=0){this.loading=!0,this.$store.dispatch("loadQuizCommands",{dataObject:{quiz_id:this.quizId,bot_id:this.bot.id||null,search:this.search,order:this.order,direction:this.direction},page:s,size:100}).then(t=>{this.loading=!1,this.commands=this.getQuizCommands,this.paginate_object=this.getQuizCommandsPaginateObject}).catch(()=>{this.loading=!1})}}},ej=Object.assign(xS,{__name:"QuizCommandTable",setup(s){return(t,o)=>(l(),i("div",RS,[e("div",MS,[t.commands.length>0?(l(),i("table",DS,[e("thead",null,[e("tr",null,[e("th",{scope:"col",class:"cursor-pointer",onClick:o[0]||(o[0]=a=>t.loadAndOrder("id"))},"#"),e("th",{scope:"col",class:"cursor-pointer",onClick:o[1]||(o[1]=a=>t.loadAndOrder("title"))},"Название"),ES,e("th",{scope:"col",class:"cursor-pointer",onClick:o[2]||(o[2]=a=>t.loadAndOrder("description"))},"Описание"),LS])]),e("tbody",null,[(l(!0),i(v,null,y(t.commands,(a,n)=>(l(),i("tr",{class:p({"border-info":a.deleted_at==null,"border-danger":a.deleted_at!=null})},[e("th",KS,u(a.id),1),e("td",{onClick:d=>t.selectQuizCommand(a)},u(a.title||"Не указано"),9,NS),e("td",null,u((a.players||[]).length),1),e("td",null,u(a.description||"Не указано"),1),e("td",null,[a.id?(l(),i("div",JS,[YS,e("ul",HS,[a.deleted_at==null?(l(),i("li",GS,[e("a",{class:"dropdown-item",onClick:d=>t.removeQuizCommand(a.id),href:"javascript:void(0)"},"Удалить",8,WS)])):r("",!0)])])):r("",!0)])],2))),256))])])):(l(),i("p",XS,"На текущий момент нет ни одной созданной команды"))]),e("div",ZS,[t.paginate_object?(l(),$(j,{key:0,onPagination_page:t.nextQuizCommand,pagination:t.paginate_object},null,8,["onPagination_page","pagination"])):r("",!0)])]))}}),tj={class:"row"},sj={class:"col-12"},oj={key:0,class:"table"},lj=e("th",{scope:"col"},"Название квиза",-1),ij=e("th",{scope:"col"},"Название команды",-1),nj=e("th",{scope:"col"},"Число участников",-1),aj=e("th",{scope:"col"},"Результат",-1),dj=e("th",{scope:"col"},"Действие",-1),rj={scope:"row"},cj=["onClick"],uj={key:0},mj=e("td",null,"-",-1),hj={key:0,class:"dropdown"},_j=e("button",{class:"btn btn-outline-secondary",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-solid fa-ellipsis"})],-1),pj={class:"dropdown-menu"},bj={key:0},fj=["onClick"],gj={key:1},vj={class:"col-12"},$j={props:["bot","quizId"],data(){return{direction:"desc",order:"updated_at",show:!0,is_group:!1,loading:!0,results:[],search:null,paginate_object:null}},computed:{...w(["getQuizResults","getQuizResultsPaginateObject"])},mounted(){this.loadQuizResults()},methods:{nextQuizResult(s){this.loadQuizResults(s)},selectQuizResult(s){this.$emit("select",s),this.$notify("Вопрос успешно выбран")},removeQuizResult(s){this.loading=!0,this.$store.dispatch("removeQuizResult",{quizResultId:s}).then(t=>{this.loading=!1,this.loadQuizResults(0),this.$notify("Вопрос успешно удален")}).catch(()=>{this.loading=!1,this.$notify("Вопрос удаления сервиса")})},loadAndOrder(s){this.order=s,this.direction=this.direction==="desc"?"asc":"desc",this.loadQuizResults(0)},loadQuizResults(s=0){this.loading=!0,this.$store.dispatch("loadQuizResults",{dataObject:{quiz_id:this.quizId,bot_id:this.bot.id||null,search:this.search,order:this.order,direction:this.direction},page:s,size:100}).then(t=>{this.loading=!1,this.results=this.getQuizResults,this.paginate_object=this.getQuizResultsPaginateObject}).catch(()=>{this.loading=!1})}}},yj=Object.assign($j,{__name:"QuizResultTable",setup(s){return(t,o)=>(l(),i("div",tj,[e("div",sj,[t.results.length>0?(l(),i("table",oj,[e("thead",null,[e("tr",null,[e("th",{scope:"col",class:"cursor-pointer",onClick:o[0]||(o[0]=a=>t.loadAndOrder("id"))},"#"),lj,ij,nj,e("th",{scope:"col",class:"cursor-pointer",onClick:o[1]||(o[1]=a=>t.loadAndOrder("points"))},"Баллы"),e("th",{scope:"col",class:"cursor-pointer",onClick:o[2]||(o[2]=a=>t.loadAndOrder("times"))},"Время"),aj,dj])]),e("tbody",null,[(l(!0),i(v,null,y(t.results,(a,n)=>(l(),i("tr",{class:p({"border-info":a.deleted_at==null,"border-danger":a.deleted_at!=null})},[e("th",rj,u(a.id),1),e("td",{onClick:d=>t.selectQuizResult(a)},u(a.quiz.title||"Не указано"),9,cj),e("td",null,[a.command?(l(),i("span",uj,u(a.command.title||"Не указано"),1)):r("",!0)]),e("td",null,u((a.command.players||[]).length),1),e("td",null,u(a.points||"Не указано"),1),e("td",null,u(a.times||"Не указано"),1),mj,e("td",null,[a.id?(l(),i("div",hj,[_j,e("ul",pj,[a.deleted_at==null?(l(),i("li",bj,[e("a",{class:"dropdown-item",onClick:d=>t.removeQuizResult(a.id),href:"javascript:void(0)"},"Удалить",8,fj)])):r("",!0)])])):r("",!0)])],2))),256))])])):(l(),i("p",gj,"На текущий момент нет ни одного созданного вопроса"))]),e("div",vj,[t.paginate_object?(l(),$(j,{key:0,onPagination_page:t.nextQuizResult,pagination:t.paginate_object},null,8,["onPagination_page","pagination"])):r("",!0)])]))}}),kj={key:0,class:"py-2"},Fj={class:"row"},Cj={class:"col-12"},wj={key:1,class:"py-2"},Sj={class:"row"},jj={class:"col-12"},qj={key:2,class:"py-2"},zj={class:"row"},Pj={class:"col-12"},Vj={class:"nav nav-tabs justify-content-center"},Oj={key:0,class:"row py-3"},Uj={class:"col-12"},Aj={key:1,class:"row py-3"},Ij={class:"col-12"},Qj={class:"col-12 py-3"},Tj=e("h4",null,"Доступные вопросы",-1),Bj={key:2,class:"row"},Rj={class:"col-12"},Mj={class:"col-12 py-3"},Dj=e("h4",null,"Команды участники квиза",-1),Ej={key:3,class:"row"},Lj={class:"col-12 py-3"},Kj=e("h4",null,"Статистика",-1),Nj={key:4,class:"row"},Jj=e("div",{class:"col-12"},null,-1),Yj=e("div",{class:"col-12 py-3"},[e("h4",null,"Отзывы к событию")],-1),Hj=[Jj,Yj],Gj={props:["bot"],data(){return{part:0,tab:0,loadTable:!1,loadQuizCommand:!1,loadQuizQuestion:!1,loadQuizQuestionTable:!1,loadQuizCommandTable:!1,loadQuizResult:!1,loadForm:!1,selectedQuiz:null,selectedQuizQuestion:null,selectedQuizCommand:null,selectedQuizResult:null}},mounted(){},methods:{callbackCommandForm(){this.loadQuizCommandTable=!0,this.$nextTick(()=>{this.loadQuizCommandTable=!1})},callbackQuestionForm(){this.loadQuizQuestionTable=!0,this.$nextTick(()=>{this.loadQuizQuestionTable=!1})},callbackForm(){this.loadTable=!0,this.part=0,this.$nextTick(()=>{this.loadTable=!1})},createQuiz(){this.part=2},selectQuizResult(s){this.loadQuizResult=!0,this.$nextTick(()=>{this.loadQuizResult=!1,this.selectedQuizResult=s})},selectQuizCommand(s){this.loadQuizCommand=!0,this.$nextTick(()=>{this.loadQuizCommand=!1,this.selectedQuizCommand=s})},selectQuizQuestion(s){this.loadQuizQuestion=!0,this.$nextTick(()=>{this.loadQuizQuestion=!1,this.selectedQuizQuestion=s})},selectQuiz(s){this.loadForm=!0,this.$nextTick(()=>{this.loadForm=!1,this.selectedQuiz=s,this.part=1,this.tab=0})}}},Wj=Object.assign(Gj,{__name:"Quizzes",setup(s){return(t,o)=>(l(),i(v,null,[t.part===0?(l(),i("div",kj,[e("div",Fj,[e("div",Cj,[e("button",{type:"button",onClick:o[0]||(o[0]=(...a)=>t.createQuiz&&t.createQuiz(...a)),class:"btn btn-primary"}," Создать новый квиз ")])]),t.loadTable?r("",!0):(l(),$(S6,{key:0,onCreate:t.createQuiz,onSelect:t.selectQuiz,bot:s.bot},null,8,["onCreate","onSelect","bot"]))])):r("",!0),t.part===2?(l(),i("div",wj,[e("div",Sj,[e("div",jj,[e("button",{type:"button",onClick:o[1]||(o[1]=a=>t.part=0),class:"btn btn-outline-primary"}," Назад ")])]),t.loadForm?r("",!0):(l(),$(x,{key:0,onCallback:t.callbackForm,bot:s.bot},null,8,["onCallback","bot"]))])):r("",!0),t.part===1?(l(),i("div",qj,[e("div",zj,[e("div",Pj,[e("button",{type:"button",onClick:o[2]||(o[2]=a=>t.part=0),class:"btn btn-outline-primary"}," Назад ")])]),e("ul",Vj,[e("li",{class:"nav-item",onClick:o[3]||(o[3]=a=>t.tab=0)},[e("a",{class:p(["nav-link",{active:t.tab===0}]),"aria-current":"page",href:"javascript:void(0)"},"Информация о квизе",2)]),e("li",{class:"nav-item",onClick:o[4]||(o[4]=a=>t.tab=1)},[e("a",{class:p(["nav-link",{active:t.tab===1}]),href:"javascript:void(0)"},"Вопросы квиза",2)]),e("li",{class:"nav-item",onClick:o[5]||(o[5]=a=>t.tab=2)},[e("a",{class:p(["nav-link",{active:t.tab===2}]),href:"javascript:void(0)"},"Команды на квизе",2)]),e("li",{class:"nav-item",onClick:o[6]||(o[6]=a=>t.tab=3)},[e("a",{class:p(["nav-link",{active:t.tab===3}]),href:"javascript:void(0)"},"Командная статистика",2)])]),t.tab===0?(l(),i("div",Oj,[e("div",Uj,[t.loadForm?r("",!0):(l(),$(x,{key:0,onCallback:t.callbackForm,quiz:t.selectedQuiz,bot:s.bot},null,8,["onCallback","quiz","bot"]))])])):r("",!0),t.tab===1?(l(),i("div",Aj,[e("div",Ij,[t.loadQuizQuestion?r("",!0):(l(),$(A9,{key:0,question:t.selectedQuizQuestion,"quiz-id":t.selectedQuiz.id,onCallback:t.callbackQuestionForm,bot:s.bot},null,8,["question","quiz-id","onCallback","bot"]))]),e("div",Qj,[Tj,t.loadQuizQuestionTable?r("",!0):(l(),$(eS,{key:0,"quiz-id":t.selectedQuiz.id,onSelect:t.selectQuizQuestion,bot:s.bot},null,8,["quiz-id","onSelect","bot"]))])])):r("",!0),t.tab===2?(l(),i("div",Bj,[e("div",Rj,[t.loadQuizCommand?r("",!0):(l(),$(BS,{key:0,command:t.selectedQuizCommand,"quiz-id":t.selectedQuiz.id,onCallback:t.callbackCommandForm,bot:s.bot},null,8,["command","quiz-id","onCallback","bot"]))]),e("div",Mj,[Dj,t.loadQuizCommandTable?r("",!0):(l(),$(ej,{key:0,"quiz-id":t.selectedQuiz.id,onSelect:t.selectQuizCommand,bot:s.bot},null,8,["quiz-id","onSelect","bot"]))])])):r("",!0),t.tab===3?(l(),i("div",Ej,[e("div",Lj,[Kj,g(yj,{"quiz-id":t.selectedQuiz.id,onSelect:t.selectQuizResult,bot:s.bot},null,8,["quiz-id","onSelect","bot"])])])):r("",!0),t.tab===4?(l(),i("div",Nj,Hj)):r("",!0)])):r("",!0)],64))}}),Xj={class:"row"},Zj={class:"col-12 mb-3 d-flex align-items-center"},xj={class:"dropdown mr-2"},eq={class:"btn btn-info dropdown-toggle",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},tq={key:0},sq={key:1},oq={class:"dropdown-menu"},lq=["onClick"],iq={class:"dropdown-item",href:"#"},nq=e("p",{class:"mb-0"}," - тип пункта меню",-1),aq={class:"col-12 col-md-12 mb-3"},dq={class:"form-label",id:"service-title"},rq=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),cq=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),uq={class:"col-12 mb-3"},mq={class:"form-label",id:"service-description"},hq=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),_q=e("div",null," Краткая информация о команде ",-1),pq=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),bq={key:0,class:"text-gray-400 ml-3",style:{"font-size":"10px"}},fq={class:"col-12 mb-3"},gq={class:"form-label",id:"service-input_message_content"},vq=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),$q=e("div",null," Текст, который будет в сообщении после выбора данного пункта меню ",-1),yq=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),kq={key:0,class:"text-gray-400 ml-3",style:{"font-size":"10px"}},Fq={class:"col-12 mb-3"},Cq={class:"form-check"},wq=e("label",{class:"form-check-label",for:"need_keyboard"}," Нужна клавиатура к тексту ",-1),Sq={key:0,class:"col-12 mb-3"},jq={class:"card"},qq={class:"card-body"},zq={class:"form-check"},Pq=e("label",{class:"form-check-label",for:"need_show_inline_template_selector"}," Выбрать клавиатуру из шаблона ",-1),Vq={class:"col-12 mb-3"},Oq={class:"form-check"},Uq=e("label",{class:"form-check-label",for:"need_custom_settings"}," Нужны дополнительные настройки ",-1),Aq={class:"col-12"},Iq={key:0,class:"card mb-2"},Qq={class:"card-header d-flex justify-content-between align-items-center"},Tq=e("h6",null,"Дополнительная конфигурация",-1),Bq={class:"card-body"},Rq={class:"row mb-2"},Mq={class:"col-5"},Dq={class:"form-label",id:"service-title"},Eq=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),Lq=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),Kq=["onUpdate:modelValue"],Nq={class:"col-5"},Jq={class:"form-label",id:"service-title"},Yq=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),Hq=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),Gq=["onUpdate:modelValue"],Wq={class:"col-2 d-flex flex-column justify-content-end align-items-center"},Xq=["onClick"],Zq={key:1,class:"row mb-2"},xq=e("div",{class:"col-12"},[e("div",{class:"alert alert-info",role:"alert"}," Вы еще не добавили ни одной дополнительной настройки ")],-1),ez=[xq],tz=e("div",{class:"row"},[e("div",{class:"col-12"},[e("button",{type:"submit",class:"btn btn-outline-primary w-100"},"Сохранить пункт меню ")])],-1),sz={props:["item"],data(){return{need_custom_settings:!1,need_keyboard:!1,need_show_inline_template_selector:!1,types:[{title:"Текст",value:0},{title:"Фото",value:1}],itemForm:{id:null,type:0,title:null,description:null,input_message_content:null,inline_keyboard_id:null,inline_keyboard:{menu:null},custom_settings:[]}}},computed:{preparedTypeTile(){return this.types.filter(s=>s.value==this.itemForm.type)[0]||null},uuid(){return Fe()}},watch:{itemForm:{handler(s){this.need_reset=!0},deep:!0}},mounted(){this.item&&this.$nextTick(()=>{console.log("menu",this.item.inline_keyboard),this.itemForm={id:this.item.id||uuid,type:this.item.type||0,title:this.item.title||null,description:this.item.description||null,input_message_content:this.item.input_message_content||null,need_keyboard:this.item.title||!1,inline_keyboard_id:this.item.inline_keyboard_id||null,inline_keyboard:this.item.inline_keyboard?this.item.inline_keyboard:{menu:null},custom_settings:this.item.custom_settings||[]},this.itemForm.inline_keyboard&&(this.need_keyboard=!0),this.itemForm.custom_settings&&(this.need_custom_settings=!0)})},methods:{submitForm(){this.$emit("callback",this.itemForm),this.itemForm={id:null,type:0,title:null,description:null,input_message_content:null,inline_keyboard_id:null,inline_keyboard:{menu:null},custom_settings:[]},this.need_keyboard=!1,this.need_custom_settings=!1,this.need_show_inline_template_selector=!1},addCustomSettings(){this.itemForm.custom_settings.push({key:null,value:null})},removeCustomSetting(s){this.itemForm.custom_settings.splice(s,1)},selectInlineKeyboard(s){console.log("selectInlineKeyboard",s),this.itemForm.inline_keyboard={id:null,menu:s,slug:null},this.need_show_inline_template_selector=!1}}},oz=Object.assign(sz,{__name:"InlineQueryItemForm",setup(s){return(t,o)=>{const a=q("Popper");return l(),i("form",{onSubmit:o[7]||(o[7]=S((...n)=>t.submitForm&&t.submitForm(...n),["prevent"])),class:"mb-2"},[e("div",Xj,[e("div",Zj,[e("div",xj,[e("button",eq,[t.itemForm.type?(l(),i("span",tq,u(t.preparedTypeTile.title),1)):(l(),i("span",sq,"Тип поля"))]),e("ul",oq,[(l(!0),i(v,null,y(t.types,n=>(l(),i("li",{onClick:d=>t.itemForm.type=n.value},[e("a",iq,u(n.title||"Не указан"),1)],8,lq))),256))])]),nq]),e("div",aq,[e("label",dq,[g(a,{content:"Заголовок"},{default:f(()=>[rq]),_:1}),m(" Заголовок "),cq]),c(e("input",{type:"text",class:"form-control",placeholder:"Заголовок","aria-label":"Заголовок","onUpdate:modelValue":o[0]||(o[0]=n=>t.itemForm.title=n),"aria-describedby":"title",required:""},null,512),[[_,t.itemForm.title]])]),e("div",uq,[e("label",mq,[g(a,null,{content:f(()=>[_q]),default:f(()=>[hq]),_:1}),m(" Описание команду "),pq,t.itemForm.description?(l(),i("small",bq," Длина текста "+u(t.itemForm.description.length)+" / 255",1)):r("",!0)]),c(e("textarea",{type:"text",class:"form-control",placeholder:"Описание команды","aria-label":"Описание команды",maxlength:"255","onUpdate:modelValue":o[1]||(o[1]=n=>t.itemForm.description=n),"aria-describedby":"service-description",required:""},`
                    `,512),[[_,t.itemForm.description]])]),e("div",fq,[e("label",gq,[g(a,null,{content:f(()=>[$q]),default:f(()=>[vq]),_:1}),m(" Текст после выбора "),yq,t.itemForm.input_message_content?(l(),i("small",kq," Длина текста "+u(t.itemForm.input_message_content.length)+" / 255",1)):r("",!0)]),c(e("textarea",{type:"text",class:"form-control",placeholder:"Текст поста","aria-label":"Текст поста",maxlength:"255","onUpdate:modelValue":o[2]||(o[2]=n=>t.itemForm.input_message_content=n),"aria-describedby":"service-input_message_content",required:""},`
                    `,512),[[_,t.itemForm.input_message_content]])]),e("div",Fq,[e("div",Cq,[c(e("input",{class:"form-check-input","onUpdate:modelValue":o[3]||(o[3]=n=>t.need_keyboard=n),type:"checkbox",id:"need_keyboard"},null,512),[[k,t.need_keyboard]]),wq])]),t.need_keyboard?(l(),i("div",Sq,[e("div",jq,[e("div",qq,[e("div",zq,[c(e("input",{class:"form-check-input","onUpdate:modelValue":o[4]||(o[4]=n=>t.need_show_inline_template_selector=n),type:"checkbox",id:"need_show_inline_template_selector"},null,512),[[k,t.need_show_inline_template_selector]]),Pq]),t.need_show_inline_template_selector?(l(),$(T,{key:0,class:"mb-2",type:"inline",onSelect:t.selectInlineKeyboard,"select-mode":!0},null,8,["onSelect"])):(l(),$(U,{key:1,type:"inline",onSave:t.selectInlineKeyboard,"edited-keyboard":t.itemForm.inline_keyboard.menu},null,8,["onSave","edited-keyboard"]))])])])):r("",!0),e("div",Vq,[e("div",Oq,[c(e("input",{class:"form-check-input","onUpdate:modelValue":o[5]||(o[5]=n=>t.need_custom_settings=n),type:"checkbox",id:"need_custom_settings"},null,512),[[k,t.need_custom_settings]]),Uq])]),e("div",Aq,[t.need_custom_settings?(l(),i("div",Iq,[e("div",Qq,[Tq,e("button",{type:"button",onClick:o[6]||(o[6]=(...n)=>t.addCustomSettings&&t.addCustomSettings(...n)),class:"btn btn-outline-primary"},"Добавить настройку ")]),e("div",Bq,[t.itemForm.custom_settings.length>0?(l(!0),i(v,{key:0},y(t.itemForm.custom_settings,(n,d)=>(l(),i("div",Rq,[e("div",Mq,[e("label",Dq,[g(a,{content:"Ключ"},{default:f(()=>[Eq]),_:1}),m(" Ключ "),Lq]),c(e("input",{type:"text",class:"form-control",placeholder:"Ключ","aria-label":"Ключ",min:"0","onUpdate:modelValue":h=>t.itemForm.custom_settings[d].key=h,"aria-describedby":"price",required:""},null,8,Kq),[[_,t.itemForm.custom_settings[d].key]])]),e("div",Nq,[e("label",Jq,[g(a,{content:"Значение"},{default:f(()=>[Yq]),_:1}),m(" Значение "),Hq]),c(e("input",{type:"text",class:"form-control",placeholder:"Значение","aria-label":"Значение",min:"0","onUpdate:modelValue":h=>t.itemForm.custom_settings[d].value=h,"aria-describedby":"price",required:""},null,8,Gq),[[_,t.itemForm.custom_settings[d].value]])]),e("div",Wq,[e("button",{onClick:h=>t.removeCustomSetting(d),class:"btn btn-outline-danger"},"Удалить ",8,Xq)])]))),256)):(l(),i("div",Zq,ez))])])):r("",!0)])]),tz],32)}}}),lz={class:"row"},iz={class:"col-12 mb-3"},nz={class:"form-label",id:"service-title"},az=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),dz=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),rz={class:"col-12 mb-3"},cz={class:"form-label",id:"service-description"},uz=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),mz=e("div",null," Краткая информация о команде ",-1),hz=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),_z={key:0,class:"text-gray-400 ml-3",style:{"font-size":"10px"}},pz={class:"col-12 mb-2"},bz={key:0},fz={class:"table-responsive"},gz={class:"table"},vz=e("thead",null,[e("tr",null,[e("th",{scope:"col"},"Название"),e("th",{scope:"col"},"Описание"),e("th",{scope:"col"},"Текст"),e("th",{scope:"col"},"Есть клавиатура"),e("th",{scope:"col"},"Есть доп настройки"),e("th",{scope:"col"},"Действие")])],-1),$z=["onClick"],yz=["onClick"],kz=["onClick"],Fz={key:0,class:"fa-solid fa-check text-success"},Cz={key:1,class:"fa-solid fa-xmark text-danger"},wz={key:0,class:"fa-solid fa-check text-success"},Sz={key:1,class:"fa-solid fa-xmark text-danger"},jz={class:"dropdown"},qz=e("button",{class:"btn btn-link",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-solid fa-bars"})],-1),zz={class:"dropdown-menu"},Pz=["onClick"],Vz={class:"row"},Oz={class:"col-12"},Uz={type:"submit",class:"btn btn-outline-success w-100 p-3"},Az={key:0},Iz={key:1},Qz={class:"modal fade",id:"inline-query-item-editor",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},Tz={class:"modal-dialog modal-lg"},Bz={class:"modal-content"},Rz={class:"modal-body"},Mz={props:["bot","inlineQuery"],data(){return{load:!1,selectedInlineQueryItem:null,inlineQueryModal:null,inlineQueryForm:{id:null,command:null,description:null,items:[]}}},watch:{inlineQueryForm:{handler(s){this.need_reset=!0},deep:!0}},mounted(){this.inlineQueryModal=new bootstrap.Modal(document.getElementById("inline-query-item-editor"),{}),this.inlineQuery&&this.$nextTick(()=>{this.inlineQueryForm={id:this.inlineQuery.id||null,command:this.inlineQuery.command||null,description:this.inlineQuery.description||null,items:this.inlineQuery.items||[]}})},methods:{removeInlineQueryItem(s){const t=this.inlineQueryForm.items[s];this.inlineQueryForm.items.splice(s,1),this.$store.dispatch("removeInlineQueryItem",{queryItemId:t.id}).then(o=>{this.$notify("Команда успешно удалена")}).catch(o=>{this.$notify("Ошибка удаления команды")})},openModal(){this.load=!0,this.$nextTick(()=>{this.selectedInlineQueryItem=null,this.load=!1,this.inlineQueryModal.show()})},addInlineQueryItem(s){let t=this.inlineQueryForm.items.findIndex(o=>o.id===s.id);t===-1?this.inlineQueryForm.items.push(s):this.inlineQueryForm.items[t]=s},selectInlineQueryItem(s){this.load=!0,this.$nextTick(()=>{this.selectedInlineQueryItem=s,this.load=!1,this.inlineQueryModal.show()})},submitForm(){let s=new FormData;Object.keys(this.inlineQueryForm).forEach(t=>{const o=this.inlineQueryForm[t]||"";typeof o=="object"?s.append(t,JSON.stringify(o)):s.append(t,o)}),s.append("bot_id",this.bot.id),this.$store.dispatch("storeInlineQuery",{inlineQueryForm:s}).then(t=>{this.inlineQueryForm={id:null,command:null,description:null,items:[]},this.$emit("callback",t.data),this.$notify("Команда успешно создана")}).catch(t=>{this.$notify("Ошибка создания команды"),this.$emit("callback",response.data)})}}},Dz=Object.assign(Mz,{__name:"InlineQueryForm",setup(s){return(t,o)=>{const a=q("Popper");return l(),i(v,null,[e("form",{onSubmit:o[3]||(o[3]=S((...n)=>t.submitForm&&t.submitForm(...n),["prevent"]))},[e("div",lz,[e("div",iz,[e("label",nz,[g(a,{content:"Название оказываемой услуги"},{default:f(()=>[az]),_:1}),m(" Название команды "),dz]),c(e("input",{type:"text",class:"form-control",placeholder:"Команда","aria-label":"Команда","onUpdate:modelValue":o[0]||(o[0]=n=>t.inlineQueryForm.command=n),maxlength:"255","aria-describedby":"service-title",required:""},null,512),[[_,t.inlineQueryForm.command]])]),e("div",rz,[e("label",cz,[g(a,null,{content:f(()=>[mz]),default:f(()=>[uz]),_:1}),m(" Описание команду "),hz,t.inlineQueryForm.description?(l(),i("small",_z," Длина текста "+u(t.inlineQueryForm.description.length)+" / 255",1)):r("",!0)]),c(e("textarea",{type:"text",class:"form-control",placeholder:"Описание команды","aria-label":"Описание команды",maxlength:"255","onUpdate:modelValue":o[1]||(o[1]=n=>t.inlineQueryForm.description=n),"aria-describedby":"service-description",required:""},`
                    `,512),[[_,t.inlineQueryForm.description]])]),e("div",pz,[e("button",{type:"button",class:"btn btn-outline-primary",onClick:o[2]||(o[2]=(...n)=>t.openModal&&t.openModal(...n))}," Добавление пункта меню ")]),t.inlineQueryForm.items.length>0?(l(),i("div",bz,[e("div",fz,[e("table",gz,[vz,e("tbody",null,[(l(!0),i(v,null,y(t.inlineQueryForm.items,(n,d)=>(l(),i("tr",null,[e("td",{onClick:h=>t.selectInlineQueryItem(n)},u(n.title||"-"),9,$z),e("td",{onClick:h=>t.selectInlineQueryItem(n)},u(n.description||"-"),9,yz),e("td",{onClick:h=>t.selectInlineQueryItem(n)},u(n.input_message_content||"-"),9,kz),e("td",null,[n.inline_keyboard?(l(),i("i",Fz)):(l(),i("i",Cz))]),e("td",null,[(n.custom_settings||[]).length>0?(l(),i("i",wz)):(l(),i("i",Sz))]),e("td",null,[e("div",jz,[qz,e("ul",zz,[e("li",null,[e("a",{class:"dropdown-item",onClick:h=>t.removeInlineQueryItem(d),href:"#"},"Удалить",8,Pz)])])])])]))),256))])])])])):r("",!0)]),e("div",Vz,[e("div",Oz,[e("button",Uz,[t.inlineQueryForm.id===null?(l(),i("span",Az,"Создать встроенное меню")):(l(),i("span",Iz,"Обновить встроенное меню"))])])])],32),e("div",Qz,[e("div",Tz,[e("div",Bz,[e("div",Rz,[t.load?r("",!0):(l(),$(oz,{key:0,item:t.selectedInlineQueryItem,onCallback:t.addInlineQueryItem},null,8,["item","onCallback"]))])])])])],64)}}}),Ez={class:"row"},Lz={class:"col-12"},Kz={key:0,class:"table"},Nz=e("th",{scope:"col",class:"cursor-pointer"},"Кол-во пунктов меню",-1),Jz=e("th",{scope:"col"},"Действие",-1),Yz={scope:"row"},Hz=["onClick"],Gz={key:0,class:"dropdown"},Wz=e("button",{class:"btn btn-outline-secondary",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-solid fa-ellipsis"})],-1),Xz={class:"dropdown-menu"},Zz={key:0},xz=["onClick"],eP={key:1},tP={class:"col-12"},sP={props:["bot"],data(){return{direction:"desc",order:"updated_at",show:!0,loading:!0,queries:[],search:null,paginate_object:null}},computed:{...w(["getInlineQueries","getInlineQueriesPaginateObject"])},mounted(){this.loadInlineQueries()},methods:{nextInlineQuery(s){this.loadInlineQueries(s)},selectInlineQuery(s){this.$emit("select",s),this.$notify("Встроенное меню успешно выбрано")},removeInlineQuery(s){this.loading=!0,this.$store.dispatch("removeInlineQuery",{queryId:s}).then(t=>{this.loading=!1,this.loadInlineQueries(0),this.$notify("Встроенное меню успешно удалено")}).catch(()=>{this.loading=!1,this.$notify("Ошибка удаления встроенного меню")})},loadAndOrder(s){this.order=s,this.direction=this.direction==="desc"?"asc":"desc",this.loadInlineQueries(0)},loadInlineQueries(s=0){this.loading=!0,this.$store.dispatch("loadInlineQueries",{dataObject:{bot_id:this.bot.id||null,search:this.search,order:this.order,direction:this.direction},page:s,size:100}).then(t=>{this.loading=!1,this.queries=this.getInlineQueries,this.paginate_object=this.getInlineQueriesPaginateObject}).catch(()=>{this.loading=!1})}}},oP=Object.assign(sP,{__name:"InlineQueryTable",setup(s){return(t,o)=>(l(),i("div",Ez,[e("div",Lz,[t.queries.length>0?(l(),i("table",Kz,[e("thead",null,[e("tr",null,[e("th",{scope:"col",class:"cursor-pointer",onClick:o[0]||(o[0]=a=>t.loadAndOrder("id"))},"#"),e("th",{scope:"col",class:"cursor-pointer",onClick:o[1]||(o[1]=a=>t.loadAndOrder("command"))},"Команда"),Nz,e("th",{scope:"col",class:"cursor-pointer",onClick:o[2]||(o[2]=a=>t.loadAndOrder("description"))},"Описание"),Jz])]),e("tbody",null,[(l(!0),i(v,null,y(t.queries,(a,n)=>(l(),i("tr",{class:p({"border-info":a.deleted_at==null,"border-danger":a.deleted_at!=null})},[e("th",Yz,u(a.id),1),e("td",{onClick:d=>t.selectInlineQuery(a)},u(a.command||"Не указано"),9,Hz),e("td",null,u(a.items.length),1),e("td",null,u(a.description||"Не указано"),1),e("td",null,[a.id?(l(),i("div",Gz,[Wz,e("ul",Xz,[a.deleted_at==null?(l(),i("li",Zz,[e("a",{class:"dropdown-item",onClick:d=>t.removeInlineQuery(a.id),href:"javascript:void(0)"},"Удалить",8,xz)])):r("",!0)])])):r("",!0)])],2))),256))])])):(l(),i("p",eP,"На текущий момент нет ни одной созданной команды"))]),e("div",tP,[t.paginate_object?(l(),$(j,{key:0,onPagination_page:t.nextInlineQuery,pagination:t.paginate_object},null,8,["onPagination_page","pagination"])):r("",!0)])]))}}),lP={class:"my-2"},iP={key:0,class:"row mb-2"},nP={class:"col-12"},aP={key:3,class:"spinner-border",role:"status"},dP=e("span",{class:"visually-hidden"},"Loading...",-1),rP=[dP],cP={props:["bot"],data(){return{load:!1,selectedInlineQuery:null}},mounted(){},methods:{selectInlineQuery(s){this.load=!0,this.$nextTick(()=>{this.selectedInlineQuery=s,this.load=!1})},reloadTable(){this.load=!0,this.$nextTick(()=>{this.load=!1})}}},uP=Object.assign(cP,{__name:"InlineQuery",setup(s){return(t,o)=>(l(),i("div",lP,[t.selectedInlineQuery!=null?(l(),i("div",iP,[e("div",nP,[e("button",{type:"button",onClick:o[0]||(o[0]=a=>t.selectInlineQuery(null)),class:"btn btn-primary"}," Добавить новое встроенное меню")])])):r("",!0),t.load?r("",!0):(l(),$(Dz,{key:1,bot:s.bot,onCallback:t.reloadTable,"inline-query":t.selectedInlineQuery},null,8,["bot","onCallback","inline-query"])),t.load?r("",!0):(l(),$(oP,{key:2,bot:s.bot,onSelect:t.selectInlineQuery},null,8,["bot","onSelect"])),t.load?(l(),i("div",aP,rP)):r("",!0)]))}}),mP={class:"row"},hP={class:"col-12 mb-3"},_P={class:"form-label",id:"quiz-title"},pP=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),bP=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),fP={class:"col-12 mb-3"},gP={class:"form-label",id:"quiz-description"},vP=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),$P=e("div",null," Краткая информация о назначении промокода ",-1),yP=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),kP={key:0,class:"text-gray-400 ml-3",style:{"font-size":"10px"}},FP={class:"col-12 mb-3"},CP={class:"form-check"},wP=e("label",{class:"form-check-label",for:"is_active"}," Доступен для активации ",-1),SP={class:"col-12 mb-3"},jP={class:"form-label",id:"promoCodeForm-max_activation_count"},qP=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),zP=e("div",null," Максимальное число активация кода ",-1),PP=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),VP={class:"col-12 mb-3"},OP={class:"form-check"},UP=e("label",{class:"form-check-label",for:"promoCodeForm-cashback_amount"}," Нужно начислить CashBack по промокоду ",-1),AP={key:0,class:"col-12 mb-3"},IP={class:"form-label",id:"quiz-time_limit"},QP=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),TP=e("div",null," Сколько % нужно ответить чтоб пройти ",-1),BP=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),RP={key:1,class:"col-12 mb-3"},MP={class:"form-check"},DP=e("label",{class:"form-check-label",for:"promoCodeForm-need_slots"}," Нужны слоты для активации ",-1),EP={key:2,class:"col-12 mb-3"},LP={class:"form-label",id:"promoCodeForm-slot_amount"},KP=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),NP=e("div",null," Укажите количество слотов, которые получит пользователь при активации (внимание, доступно только для администраторов) ",-1),JP=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),YP={key:0,class:"col-12 mb-3"},HP={class:"form-check"},GP=e("label",{class:"form-check-label",for:"promoCodeForm-need_attach_scripts"}," Нужно добавить скрипты ",-1),WP={key:1,class:"col-12 mb-3"},XP=["onClick"],ZP={class:"row"},xP={class:"col-12"},eV={type:"submit",class:"btn btn-outline-success w-100 p-3"},tV={key:0},sV={key:1},oV={props:["code","bot"],data(){return{step:0,load:!1,need_reset:!1,need_cashback:!1,need_slots:!1,need_attach_scripts:!1,promoCodeForm:{id:null,code:null,description:null,slot_amount:0,cashback_amount:0,max_activation_count:1,is_active:!1,scripts:[]}}},computed:{getSelf(){return window.profile}},watch:{promoCodeForm:{handler(s){this.need_reset=!0},deep:!0}},mounted(){this.code&&this.$nextTick(()=>{this.promoCodeForm={id:this.code.id||null,description:this.code.description||null,code:this.code.code||null,slot_amount:this.code.slot_amount||0,cashback_amount:this.code.cashback_amount||0,max_activation_count:this.code.max_activation_count||1,is_active:this.code.is_active||!1,scripts:this.code.scripts||[]},this.promoCodeForm.slot_amount>0&&(this.need_slots=!0),this.promoCodeForm.cashback_amount>0&&(this.need_slots=!0),this.promoCodeForm.scripts.length>0&&(this.need_attach_scripts=!0)})},methods:{removeSlug(s){this.promoCodeForm.scripts.splice(s,1)},selectSlugsCallback(s){this.promoCodeForm.scripts.findIndex(o=>o.id===s.id)===-1&&this.promoCodeForm.scripts.push(s)},submitForm(){let s=new FormData;Object.keys(this.promoCodeForm).forEach(t=>{const o=this.promoCodeForm[t]||"";typeof o=="object"?s.append(t,JSON.stringify(o)):s.append(t,o)}),s.append("bot_id",this.bot.id),this.$store.dispatch("storePromoCodes",{promoCodeForm:s}).then(t=>{this.promoCodeForm={id:null,code:null,description:null,slot_amount:0,cashback_amount:0,max_activation_count:1,scripts:[],is_active:!1},this.$emit("callback",t.data),this.$notify("Промокод успешно создан")}).catch(t=>{this.$notify("Ошибка создания промокода")})}}},ee=Object.assign(oV,{__name:"PromoCodesForm",setup(s){return(t,o)=>{const a=q("Popper");return l(),i("form",{onSubmit:o[9]||(o[9]=S((...n)=>t.submitForm&&t.submitForm(...n),["prevent"])),class:"py-3"},[e("div",mP,[e("div",hP,[e("label",_P,[g(a,{content:"Название вашего квиза"},{default:f(()=>[pP]),_:1}),m(" Промокод (вписать или сгенерировать) "),bP]),c(e("input",{type:"text",class:"form-control",placeholder:"Название","aria-label":"Название","onUpdate:modelValue":o[0]||(o[0]=n=>t.promoCodeForm.code=n),maxlength:"255","aria-describedby":"quiz-title",required:""},null,512),[[_,t.promoCodeForm.code]])]),e("div",fP,[e("label",gP,[g(a,null,{content:f(()=>[$P]),default:f(()=>[vP]),_:1}),m(" Назначение промокода "),yP,t.promoCodeForm.description?(l(),i("small",kP," Длина текста "+u(t.promoCodeForm.description.length)+"/255",1)):r("",!0)]),c(e("textarea",{class:"form-control",placeholder:"Описание промокода","aria-label":"Описание промокода",maxlength:"255","onUpdate:modelValue":o[1]||(o[1]=n=>t.promoCodeForm.description=n),"aria-describedby":"quiz-description",required:""},`
                    `,512),[[_,t.promoCodeForm.description]])]),e("div",FP,[e("div",CP,[c(e("input",{class:"form-check-input","onUpdate:modelValue":o[2]||(o[2]=n=>t.promoCodeForm.is_active=n),type:"checkbox",id:"is_active"},null,512),[[k,t.promoCodeForm.is_active]]),wP])]),e("div",SP,[e("label",jP,[g(a,null,{content:f(()=>[zP]),default:f(()=>[qP]),_:1}),m(" Количество активация кода "),PP]),c(e("input",{type:"number",class:"form-control",placeholder:"Число попыток","aria-label":"Число попыток",step:"1",min:"1","onUpdate:modelValue":o[3]||(o[3]=n=>t.promoCodeForm.max_activation_count=n),"aria-describedby":"promoCodeForm-max_activation_count",required:""},null,512),[[_,t.promoCodeForm.max_activation_count]])]),e("div",VP,[e("div",OP,[c(e("input",{class:"form-check-input","onUpdate:modelValue":o[4]||(o[4]=n=>t.need_cashback=n),type:"checkbox",id:"promoCodeForm-cashback_amount"},null,512),[[k,t.need_cashback]]),UP])]),t.need_cashback?(l(),i("div",AP,[e("label",IP,[g(a,null,{content:f(()=>[TP]),default:f(()=>[QP]),_:1}),m(" Сколько CashBack начислить по промокоду? "),BP]),c(e("input",{type:"number",class:"form-control",placeholder:"Процент для победы","aria-label":"Процент для победы",step:"1",min:"0","onUpdate:modelValue":o[5]||(o[5]=n=>t.promoCodeForm.cashback_amount=n),"aria-describedby":"promoCodeForm-cashback_amount",required:""},null,512),[[_,t.promoCodeForm.cashback_amount]])])):r("",!0),t.getSelf.is_admin?(l(),i("div",RP,[e("div",MP,[c(e("input",{class:"form-check-input","onUpdate:modelValue":o[6]||(o[6]=n=>t.need_slots=n),type:"checkbox",id:"promoCodeForm-need_slots"},null,512),[[k,t.need_slots]]),DP])])):r("",!0),t.need_slots?(l(),i("div",EP,[e("label",LP,[g(a,null,{content:f(()=>[NP]),default:f(()=>[KP]),_:1}),m(" Сколько нужно добавить слотов? "),JP]),c(e("input",{type:"number",class:"form-control",placeholder:"Количество слотов","aria-label":"Количество слотов",step:"1",min:"0","onUpdate:modelValue":o[7]||(o[7]=n=>t.promoCodeForm.slot_amount=n),"aria-describedby":"promoCodeForm-slot_amount",required:""},null,512),[[_,t.promoCodeForm.slot_amount]])])):r("",!0)]),t.getSelf.is_admin?(l(),i("div",YP,[e("div",HP,[c(e("input",{class:"form-check-input","onUpdate:modelValue":o[8]||(o[8]=n=>t.need_attach_scripts=n),type:"checkbox",id:"promoCodeForm-need_attach_scripts"},null,512),[[k,t.need_attach_scripts]]),GP])])):r("",!0),t.need_attach_scripts?(l(),i("div",WP,[e("p",null,[(l(!0),i(v,null,y(t.promoCodeForm.scripts,(n,d)=>(l(),i("span",{class:"badge bg-primary mr-2 mb-2 cursor-pointer",onClick:h=>t.removeSlug(d)},u(n.command||"-"),9,XP))),256))]),s.bot?(l(),$(Y,{key:0,"can-add":!0,bot:s.bot,"hide-add-modal":!0,onSelect:t.selectSlugsCallback},null,8,["bot","onSelect"])):r("",!0)])):r("",!0),e("div",ZP,[e("div",xP,[e("button",eV,[t.promoCodeForm.id==null?(l(),i("span",tV,"Создать промокод")):(l(),i("span",sV,"Обновить промокод"))])])])],32)}}}),lV={class:"row py-2"},iV={class:"col-12"},nV={class:"input-group mb-3"},aV={class:"col-12"},dV={key:0,class:"table"},rV=e("th",{scope:"col",class:"cursor-pointer"},"Число активаций",-1),cV=e("th",{scope:"col"},"Действие",-1),uV={scope:"row"},mV=["onClick"],hV={key:0},_V={key:0,class:"fa-solid fa-chevron-down text-success"},pV={key:1,class:"fa-solid fa-xmark text-danger"},bV={key:0,class:"dropdown"},fV=e("button",{class:"btn btn-outline-secondary",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-solid fa-ellipsis"})],-1),gV={class:"dropdown-menu"},vV={key:0},$V=["onClick"],yV={key:1},kV=e("div",{class:"alert alert-warning alert-dismissible fade show",role:"alert"},[e("strong",null,"Внимание!"),m(" Вы еще не добавили ни одного промокода! "),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"alert","aria-label":"Close"})],-1),FV={class:"position-relative p-5 text-center text-muted bg-body border border-dashed rounded-2"},CV={class:"d-flex justify-content-center mb-3"},wV={alt:"",width:"100",height:"100"},SV=e("h1",{class:"text-body-emphasis"},"Создание промокода",-1),jV=e("p",{class:"col-lg-8 mx-auto fs-5 text-muted"}," Промокод - это инструмент мотивации пользователей пользоваться вашим сервисом. Он позволяет клиентам получать некоторые бонусы за активацию кода, а вы в свою очередь будете видеть статистику активация прмокода. ",-1),qV={class:"d-inline-flex gap-2 mb-5"},zV=e("a",{href:"#",target:"_blank",class:"d-inline-flex align-items-center btn btn-outline-secondary btn-lg px-4 rounded-pill"}," Подробнее ",-1),PV={key:0,class:"col-12"},VV={props:["bot"],data(){return{direction:"desc",order:"updated_at",show:!0,loading:!0,codes:[],search:null,paginate_object:null}},computed:{...w(["getPromoCodes","getPromoCodesPaginateObject"]),getSelf(){return window.profile}},mounted(){this.loadPromoCodes()},methods:{removeQuiz(s){this.loading=!0,this.$store.dispatch("removePromoCodes",{promoCodeId:s}).then(t=>{this.loading=!1,this.loadPromoCodes(0),this.$notify("Промокод успешно удален")}).catch(()=>{this.loading=!1,this.$notify("Ошибка удаления промокода")})},createPromoCode(){this.$emit("create")},nextPromoCodes(s){this.loadPromoCodes(s)},selectEvent(s){this.$emit("select",s)},loadAndOrder(s){this.order=s,this.direction=this.direction==="desc"?"asc":"desc",this.loadPromoCodes(0)},loadPromoCodes(s=0){this.loading=!0,this.$store.dispatch("loadPromoCodes",{dataObject:{bot_id:this.bot.id||null,search:this.search,order:this.order,direction:this.direction},page:s,size:20}).then(t=>{this.loading=!1,this.codes=this.getPromoCodes,this.paginate_object=this.getPromoCodesPaginateObject}).catch(()=>{this.loading=!1})}}},OV=Object.assign(VV,{__name:"PromoCodesTable",setup(s){return(t,o)=>{const a=A("lazy");return l(),i("div",lV,[e("div",iV,[e("div",nV,[c(e("input",{type:"search",class:"form-control",placeholder:"Поиск кода","aria-label":"Поиск кода","onUpdate:modelValue":o[0]||(o[0]=n=>t.search=n),"aria-describedby":"promocode-search-and-filter"},null,512),[[_,t.search]]),e("button",{class:"btn btn-outline-secondary",onClick:o[1]||(o[1]=n=>t.loadPromoCodes(0)),type:"button",id:"promocode-search-and-filter"},"Найти ")])]),e("div",aV,[t.codes.length>0?(l(),i("table",dV,[e("thead",null,[e("tr",null,[e("th",{scope:"col",class:"cursor-pointer",onClick:o[2]||(o[2]=n=>t.loadAndOrder("id"))},"#"),e("th",{scope:"col",class:"cursor-pointer",onClick:o[3]||(o[3]=n=>t.loadAndOrder("code"))},"Код"),e("th",{scope:"col",class:"cursor-pointer",onClick:o[4]||(o[4]=n=>t.loadAndOrder("description"))},"Описание"),t.getSelf.is_admin?(l(),i("th",{key:0,scope:"col",class:"cursor-pointer",onClick:o[5]||(o[5]=n=>t.loadAndOrder("slot_amount"))},"Число слотов ")):r("",!0),e("th",{scope:"col",class:"cursor-pointer",onClick:o[6]||(o[6]=n=>t.loadAndOrder("cashback_amount"))},"Величина CashBack-а, руб "),e("th",{scope:"col",class:"cursor-pointer",onClick:o[7]||(o[7]=n=>t.loadAndOrder("max_activation_count"))},"Максимальное число активаций "),rV,e("th",{scope:"col",class:"cursor-pointer",onClick:o[8]||(o[8]=n=>t.loadAndOrder("is_active"))},"Активный"),cV])]),e("tbody",null,[(l(!0),i(v,null,y(t.codes,(n,d)=>(l(),i("tr",{class:p({"border-info":n.deleted_at==null,"border-danger":n.deleted_at!=null})},[e("th",uV,u(n.id),1),e("td",{onClick:h=>t.selectEvent(n)},u(n.code||"Не указано"),9,mV),e("td",null,u(n.description||"Не указано"),1),t.getSelf.is_admin?(l(),i("td",hV,u(n.slot_amount),1)):r("",!0),e("td",null,u(n.cashback_amount),1),e("td",null,u(n.max_activation_count),1),e("td",null,u(n.current_activation_count||0),1),e("td",null,[n.is_active?(l(),i("i",_V)):(l(),i("i",pV))]),e("td",null,[n.id?(l(),i("div",bV,[fV,e("ul",gV,[n.deleted_at==null?(l(),i("li",vV,[e("a",{class:"dropdown-item",onClick:h=>t.removeQuiz(n.id),href:"javascript:void(0)"},"Удалить",8,$V)])):r("",!0)])])):r("",!0)])],2))),256))])])):(l(),i("div",yV,[kV,e("div",FV,[e("div",CV,[c(e("img",wV,null,512),[[a,"../images/icon.png"]])]),SV,jV,e("div",qV,[e("button",{onClick:o[9]||(o[9]=(...n)=>t.createPromoCode&&t.createPromoCode(...n)),class:"d-inline-flex align-items-center btn btn-lg px-4 rounded-pill btn-primary",type:"button"}," Добавить "),zV])])]))]),t.codes.length>0?(l(),i("div",PV,[t.paginate_object?(l(),$(j,{key:0,onPagination_page:t.nextPromoCodes,pagination:t.paginate_object},null,8,["onPagination_page","pagination"])):r("",!0)])):r("",!0)])}}}),UV={key:0,class:"py-2"},AV={class:"row"},IV={class:"col-12"},QV={key:1,class:"py-2"},TV={class:"row"},BV={class:"col-12"},RV={key:2,class:"py-2"},MV={class:"row"},DV={class:"col-12"},EV={class:"nav nav-tabs justify-content-center"},LV={key:0,class:"row py-3"},KV={class:"col-12"},NV={key:1,class:"row py-3"},JV=e("div",{class:"col-12 py-3"},[e("h4",null,"Статистика")],-1),YV=[JV],HV={props:["bot"],data(){return{part:0,tab:0,selectedPromoCode:null,loadForm:!1,loadTable:!1}},methods:{callbackForm(){this.loadTable=!0,this.selectedPromoCode=null,this.part=0,this.$nextTick(()=>{this.loadTable=!1})},createPromoCode(){this.part=2},selectPromoCode(s){this.loadForm=!0,this.$nextTick(()=>{this.loadForm=!1,this.selectedPromoCode=s,this.part=1,this.tab=0})}}},GV=Object.assign(HV,{__name:"PromoCodes",setup(s){return(t,o)=>(l(),i(v,null,[t.part===0?(l(),i("div",UV,[e("div",AV,[e("div",IV,[e("button",{type:"button",onClick:o[0]||(o[0]=(...a)=>t.createPromoCode&&t.createPromoCode(...a)),class:"btn btn-primary"}," Создать новый промокод ")])]),t.loadTable?r("",!0):(l(),$(OV,{key:0,onCreate:t.createPromoCode,onSelect:t.selectPromoCode,bot:s.bot},null,8,["onCreate","onSelect","bot"]))])):r("",!0),t.part===2?(l(),i("div",QV,[e("div",TV,[e("div",BV,[e("button",{type:"button",onClick:o[1]||(o[1]=a=>t.part=0),class:"btn btn-outline-primary"}," Назад ")])]),t.loadForm?r("",!0):(l(),$(ee,{key:0,onCallback:t.callbackForm,bot:s.bot},null,8,["onCallback","bot"]))])):r("",!0),t.part===1?(l(),i("div",RV,[e("div",MV,[e("div",DV,[e("button",{type:"button",onClick:o[2]||(o[2]=a=>t.part=0),class:"btn btn-outline-primary"}," Назад ")])]),e("ul",EV,[e("li",{class:"nav-item",onClick:o[3]||(o[3]=a=>t.tab=0)},[e("a",{class:p(["nav-link",{active:t.tab===0}]),"aria-current":"page",href:"javascript:void(0)"},"Информация о Промокоде",2)]),e("li",{class:"nav-item",onClick:o[4]||(o[4]=a=>t.tab=1)},[e("a",{class:p(["nav-link",{active:t.tab===1}]),href:"javascript:void(0)"},"Статистика использования",2)])]),t.tab===0?(l(),i("div",LV,[e("div",KV,[t.loadForm?r("",!0):(l(),$(ee,{key:0,onCallback:t.callbackForm,code:t.selectedPromoCode,bot:s.bot},null,8,["onCallback","code","bot"]))])])):r("",!0),t.tab===1?(l(),i("div",NV,YV)):r("",!0)])):r("",!0)],64))}}),WV={props:["data"],data(){return{hasConnect:!1,bot:null,frontPadForm:{hook_url:null,channel:null,affiliate:null,point:null,token:null,statuses:[{value:null,key:"new",title:"Новый"}],bot_id:null,pays:[{value:null,key:"cash",title:"Наличные"},{value:null,key:"card",title:"Перевод на карту"}]}}},computed:{...w(["getCurrentBot"])},mounted(){this.bot=this.getCurrentBot,this.data?this.$nextTick(()=>{this.frontPadForm.hook_url=this.data.hook_url||null,this.frontPadForm.channel=this.data.channel||null,this.frontPadForm.affiliate=this.data.affiliate||null,this.frontPadForm.point=this.data.point||null,this.frontPadForm.token=this.data.token||null,this.frontPadForm.bot_id=this.data.bot_id||this.bot.id||null,this.data.pays!=null&&(this.frontPadForm.pays=this.data.pays),this.data.statuses!=null&&(this.frontPadForm.statuses=this.data.statuses)}):this.frontPadForm.bot_id=this.bot.id||null},methods:{submit(){let s=new FormData;Object.keys(this.frontPadForm).forEach(t=>{const o=this.frontPadForm[t]||"";typeof o=="object"?s.append(t,JSON.stringify(o)):s.append(t,o)}),this.$store.dispatch("saveFrontPad",{frontPadForm:s}).then(t=>{this.$notify("Данные CRM успешно сохранены")}).catch(t=>{})}}},XV={class:"col-md-6 col-12 mb-2"},ZV={class:"form-label",id:"token"},xV=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),eO=e("div",null,"Токен интеграции",-1),tO=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),sO={class:"col-md-6 col-12 mb-2"},oO={class:"form-label",id:"channel"},lO=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),iO=e("div",null,'Данные брать из справочника FrontPad "Каналы продаж". Создать канал. Telegram. Указать значение для API',-1),nO={class:"col-md-6 col-12 mb-2"},aO={class:"form-label",id:"affiliate"},dO=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),rO=e("div",null,"Филиал",-1),cO={class:"col-md-6 col-12 mb-2"},uO={class:"form-label",id:"point"},mO=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),hO=e("div",null,"Филиал",-1),_O={class:"col-12"},pO=e("div",{class:"alert alert-info",role:"alert"},' Данные брать из справочника FrontPad "Статусы". Указать значение для API ',-1),bO={key:0,class:"card mb-2 p-0"},fO=e("div",{class:"card-header"},[e("h6",null,"Статусы")],-1),gO={class:"card-body"},vO={class:"table"},$O=e("thead",null,[e("tr",null,[e("th",{scope:"col"},"Название"),e("th",{scope:"col"},"Ключ"),e("th",{scope:"col"},"Значение")])],-1),yO=["onUpdate:modelValue"],kO={class:"col-12"},FO=e("div",{class:"alert alert-info",role:"alert"},' Данные брать из справочника FrontPad "Варианты оплат". Указать значение для API ',-1),CO={key:0,class:"card mb-2 p-0"},wO=e("div",{class:"card-header"},[e("h6",null,"Типы оплаты")],-1),SO={class:"card-body"},jO={class:"table"},qO=e("thead",null,[e("tr",null,[e("th",{scope:"col"},"Название"),e("th",{scope:"col"},"Ключ"),e("th",{scope:"col"},"Значение")])],-1),zO=["onUpdate:modelValue"],PO=e("div",{class:"col-md-12 col-12"},[e("button",{type:"submit",class:"btn btn-outline-primary p-3 w-100"},[e("i",{class:"fa-solid fa-cloud-arrow-down mr-1"}),m(" Сохранить настройку ")])],-1);function VO(s,t,o,a,n,d){const h=q("Popper");return l(),i("form",{onSubmit:t[4]||(t[4]=S((...b)=>d.submit&&d.submit(...b),["prevent"])),class:"row"},[e("div",XV,[e("label",ZV,[g(h,null,{content:f(()=>[eO]),default:f(()=>[xV]),_:1}),m(" Токен интеграции "),tO]),c(e("input",{type:"text",class:"form-control",placeholder:"Токен","aria-label":"Токен","onUpdate:modelValue":t[0]||(t[0]=b=>n.frontPadForm.token=b),"aria-describedby":"token"},null,512),[[_,n.frontPadForm.token]])]),e("div",sO,[e("label",oO,[g(h,null,{content:f(()=>[iO]),default:f(()=>[lO]),_:1}),m(" Канал продаж ")]),c(e("input",{type:"text",class:"form-control",placeholder:"channel","aria-label":"channel","onUpdate:modelValue":t[1]||(t[1]=b=>n.frontPadForm.channel=b),"aria-describedby":"channel"},null,512),[[_,n.frontPadForm.channel]])]),e("div",nO,[e("label",aO,[g(h,null,{content:f(()=>[rO]),default:f(()=>[dO]),_:1}),m(" Филиал ")]),c(e("input",{type:"text",class:"form-control",placeholder:"Филиал","aria-label":"Филиал","onUpdate:modelValue":t[2]||(t[2]=b=>n.frontPadForm.affiliate=b),"aria-describedby":"Филиал"},null,512),[[_,n.frontPadForm.affiliate]])]),e("div",cO,[e("label",uO,[g(h,null,{content:f(()=>[hO]),default:f(()=>[mO]),_:1}),m(" Точка продаж ")]),c(e("input",{type:"text",class:"form-control",placeholder:"Точка продаж","aria-label":"Точка продаж","onUpdate:modelValue":t[3]||(t[3]=b=>n.frontPadForm.point=b),"aria-describedby":"Точка продаж"},null,512),[[_,n.frontPadForm.point]])]),e("div",_O,[pO,n.frontPadForm.statuses?(l(),i("div",bO,[fO,e("div",gO,[e("table",vO,[$O,e("tbody",null,[(l(!0),i(v,null,y(n.frontPadForm.statuses,(b,F)=>(l(),i("tr",null,[e("td",null,u(b.title||"-"),1),e("td",null,u(b.key||"-"),1),e("td",null,[c(e("input",{type:"text",class:"form-control",placeholder:"Статус","aria-label":"Статус","onUpdate:modelValue":C=>n.frontPadForm.statuses[F].value=C,"aria-describedby":"Статус"},null,8,yO),[[_,n.frontPadForm.statuses[F].value]])])]))),256))])])])])):r("",!0)]),e("div",kO,[FO,n.frontPadForm.pays?(l(),i("div",CO,[wO,e("div",SO,[e("table",jO,[qO,e("tbody",null,[(l(!0),i(v,null,y(n.frontPadForm.pays,(b,F)=>(l(),i("tr",null,[e("td",null,u(b.title||"-"),1),e("td",null,u(b.key||"-"),1),e("td",null,[c(e("input",{type:"text",class:"form-control",placeholder:"Статус","aria-label":"Статус","onUpdate:modelValue":C=>n.frontPadForm.pays[F].value=C,"aria-describedby":"Статус"},null,8,zO),[[_,n.frontPadForm.pays[F].value]])])]))),256))])])])])):r("",!0)]),PO],32)}const OO=I(WV,[["render",VO]]);const UO={class:"d-flex custom-dropdown justify-content-between align-items-center"},AO={class:"btn-group"},IO=e("i",{class:"fa-solid fa-info mr-2"},null,-1),QO=e("i",{class:"fa-solid fa-file mr-2"},null,-1),TO={key:0,class:"btn btn-primary",type:"button","data-bs-toggle":"offcanvas","data-bs-target":"#bot-section-menu","aria-controls":"staticBackdrop"},BO=e("i",{class:"fa-solid fa-screwdriver-wrench p-2 text-primary"},null,-1),RO=[BO],MO={key:0,class:"pb-5 mb-5"},DO={key:1,class:"pb-5 mb-5"},EO={key:2,class:"pb-5 mb-5"},LO={key:3,class:"pb-5 mb-5"},KO={key:4,class:"pb-5 mb-5"},NO={key:5,class:"pb-5 mb-5"},JO={key:6,class:"pb-5 mb-5"},YO={key:7,class:"pb-5 mb-5"},HO={key:8,class:"pb-5 pt-2 mb-5"},GO={key:9,class:"pb-5 mb-5"},WO={key:10,class:"pb-5 mb-5 pt-2"},XO={key:11,class:"pb-5 mb-5"},ZO={key:12,class:"pb-5 mb-5 pt-2"},xO={key:13,class:"pb-5 mb-5 pt-2"},eU={key:14,class:"pb-5 mb-5 pt-2"},tU={key:15,class:"row pb-5 mb-5"},sU={key:0,class:"col-12 col-md-12"},oU={key:16,class:"pb-5 mb-5"},lU={class:"offcanvas offcanvas-end","data-bs-scroll":"true","data-bs-backdrop":"false",tabindex:"-1",id:"bot-section-menu","aria-labelledby":"staticBackdropLabel"},iU=e("div",{class:"offcanvas-header"},[e("h5",{class:"offcanvas-title",id:"staticBackdropLabel"},"Меню управления ботом"),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"offcanvas","aria-label":"Close"})],-1),nU={class:"offcanvas-body"},aU={class:"list-group list-group-flush bot-section-menu-group"},dU=e("i",{class:"fa-regular fa-newspaper mr-2"},null,-1),rU=e("i",{class:"fa-regular fa-calendar-days mr-2"},null,-1),cU=e("i",{class:"fa-solid fa-q mr-2"},null,-1),uU=e("i",{class:"fa-solid fa-q mr-2"},null,-1),mU=e("i",{class:"fa-solid fa-clipboard-list mr-2"},null,-1),hU=e("i",{class:"fa-solid fa-code mr-2"},null,-1),_U=e("i",{class:"fa-solid fa-keyboard mr-2"},null,-1),pU=e("i",{class:"fa-solid fa-scroll mr-2"},null,-1),bU=e("i",{class:"fa-solid fa-comment-dots mr-2"},null,-1),fU=e("i",{class:"fa-solid fa-users mr-2"},null,-1),gU=e("i",{class:"fa-solid fa-list-check mr-2"},null,-1),vU=e("i",{class:"fa-solid fa-list-check mr-2"},null,-1),$U=e("i",{class:"fa-solid fa-list-check mr-2"},null,-1),yU=e("i",{class:"fa-brands fa-shopify mr-2"},null,-1),kU=e("i",{class:"fa-brands fa-shopify mr-2"},null,-1),FU={props:["bot"],data(){return{page:null,step:0,load:!1,loadPage:!1}},mounted(){this.setStep(localStorage.getItem("cashman_set_botform_step_index")||0)},methods:{botCallbackUpdate(s){this.$store.dispatch("updateCurrentBot",{bot:s}).then(()=>{}),this.$emit("callback")},hasRole(s){return window.hasRole(s)||!1},setStep(s){this.step=parseInt(s),localStorage.setItem("cashman_set_botform_step_index",s)},pageListCallback(s){this.loadPage=!0,this.page=s,this.$nextTick(()=>{this.loadPage=!1})},pageCallback(s){this.page=s,this.loadPageList=!0,this.$nextTick(()=>{this.loadPageList=!1})},loadCurrentCompany(s=null){this.$store.dispatch("updateCurrentCompany",{company:s}).then(()=>{this.company=this.getCurrentCompany})},companyListCallback(s){this.load=!0,this.loadCurrentCompany(s),this.$nextTick(()=>{this.load=!1})}}},vI=Object.assign(FU,{__name:"BotSection",setup(s){return(t,o)=>(l(),i(v,null,[e("div",UO,[e("div",AO,[e("button",{type:"button",class:p(["btn btn-primary text-primary",{"bg-primary text-white":t.step==0}]),onClick:o[0]||(o[0]=a=>t.setStep(0))},[IO,m("Информация о боте ")],2),e("button",{type:"button",class:p(["btn btn-primary text-primary",{"bg-primary text-white":t.step==4}]),onClick:o[1]||(o[1]=a=>t.setStep(4))},[QO,m("Страницы (кнопки бота) ")],2)]),t.hasRole("admin")?(l(),i("button",TO,RO)):r("",!0)]),t.step===14?(l(),i("div",MO,[t.load?r("",!0):(l(),$(Wj,{key:0,bot:s.bot},null,8,["bot"]))])):r("",!0),t.step===16?(l(),i("div",DO,[t.load?r("",!0):(l(),$(GV,{key:0,bot:s.bot},null,8,["bot"]))])):r("",!0),t.step===13?(l(),i("div",EO,[t.load?r("",!0):(l(),$(Iw,{key:0,bot:s.bot},null,8,["bot"]))])):r("",!0),t.step===0?(l(),i("div",LO,[t.load?r("",!0):(l(),$(ke,{key:0,onCallback:t.botCallbackUpdate,bot:s.bot},null,8,["onCallback","bot"]))])):r("",!0),t.step===15?(l(),i("div",KO,[t.load?r("",!0):(l(),$(uP,{key:0,bot:s.bot},null,8,["bot"]))])):r("",!0),t.step===7?(l(),i("div",NO,[t.load?r("",!0):(l(),$(p2,{key:0,data:s.bot.amo},null,8,["data"]))])):r("",!0),t.step===17?(l(),i("div",JO,[t.load?r("",!0):(l(),$(OO,{key:0,data:s.bot.frontPad},null,8,["data"]))])):r("",!0),t.step===12?(l(),i("div",YO,[t.load?r("",!0):(l(),$(P2,{key:0,data:s.bot.y_clients},null,8,["data"]))])):r("",!0),t.step===11?(l(),i("div",HO,[t.load?r("",!0):(l(),$(a0,{key:0}))])):r("",!0),t.step===8?(l(),i("div",GO,[t.load?r("",!0):(l(),$(Ky,{key:0}))])):r("",!0),t.step===10?(l(),i("div",WO,[t.load?r("",!0):(l(),$(zk,{key:0}))])):r("",!0),t.step===1?(l(),i("div",XO,[t.load?r("",!0):(l(),$(T,{key:0,"select-mode":!1}))])):r("",!0),t.step===6?(l(),i("div",ZO,[t.load?r("",!0):(l(),$(ae,{key:0}))])):r("",!0),t.step===2?(l(),i("div",xO,[t.load?r("",!0):(l(),$(Li,{key:0}))])):r("",!0),t.step===3?(l(),i("div",eU,[t.load?r("",!0):(l(),$(D,{key:0}))])):r("",!0),t.step===4?(l(),i("div",tU,[t.load?r("",!0):(l(),i("div",sU,[t.loadPage?r("",!0):(l(),$(w1,{key:0,page:t.page,onCallback:t.pageCallback},null,8,["page","onCallback"]))]))])):r("",!0),t.step===9?(l(),i("div",oU,[g(D2,{bot:s.bot},null,8,["bot"])])):r("",!0),e("div",lU,[iU,e("div",nU,[e("ul",aU,[e("li",null,[e("a",{class:"list-group-item list-group-item-action",href:"#bot-news",onClick:o[2]||(o[2]=a=>t.setStep(9))},[dU,m(" Рассылки")])]),e("li",null,[e("a",{class:"list-group-item list-group-item-action",href:"#bot-appointments",onClick:o[3]||(o[3]=a=>t.setStep(13))},[rU,m("Запись на событие (прием)")])]),e("li",null,[e("a",{class:"list-group-item list-group-item-action",href:"#bot-quizzes",onClick:o[4]||(o[4]=a=>t.setStep(14))},[cU,m("Квизы")])]),e("li",null,[e("a",{class:"list-group-item list-group-item-action",href:"#bot-promo-codes",onClick:o[5]||(o[5]=a=>t.setStep(16))},[uU,m("Промокоды")])]),e("li",null,[e("a",{class:"list-group-item list-group-item-action",href:"#bot-inline-queries",onClick:o[6]||(o[6]=a=>t.setStep(15))},[mU,m("Встраиваемые запросы")])]),e("li",null,[e("a",{class:"list-group-item list-group-item-action",href:"#bot-custom-fields",onClick:o[7]||(o[7]=a=>t.setStep(10))},[hU,m("Настраиваемые поля")])]),e("li",null,[e("a",{class:"list-group-item list-group-item-action",href:"#bot-menu-template",onClick:o[8]||(o[8]=a=>t.setStep(1))},[_U,m("Все клавиатуры в боте")])]),e("li",null,[e("a",{class:"list-group-item list-group-item-action",href:"#bot-slugs",onClick:o[9]||(o[9]=a=>t.setStep(2))},[pU,m("Все скрипты в боте")])]),e("li",null,[e("a",{class:"list-group-item list-group-item-action",href:"#bot-dialogs",onClick:o[10]||(o[10]=a=>t.setStep(6))},[bU,m("Все диалоги в боте")])]),e("li",null,[e("a",{class:"list-group-item list-group-item-action",href:"#bot-users",onClick:o[11]||(o[11]=a=>t.setStep(3))},[fU,m("Все пользователи в боте")])]),e("li",null,[e("a",{class:"list-group-item list-group-item-action",href:"#bot-amo",onClick:o[12]||(o[12]=a=>t.setStep(7))},[gU,m(" AMO CRM")])]),e("li",null,[e("a",{class:"list-group-item list-group-item-action",href:"#bot-front-pad",onClick:o[13]||(o[13]=a=>t.setStep(17))},[vU,m(" FrontPad")])]),e("li",null,[e("a",{class:"list-group-item list-group-item-action",href:"#bot-y-clients",onClick:o[14]||(o[14]=a=>t.setStep(12))},[$U,m(" YClients")])]),e("li",null,[e("a",{class:"list-group-item list-group-item-action",href:"#bot-shop",onClick:o[15]||(o[15]=a=>t.setStep(8))},[yU,m(" Магазин")])]),e("li",null,[e("a",{class:"list-group-item list-group-item-action",href:"#bot-media",onClick:o[16]||(o[16]=a=>t.setStep(11))},[kU,m(" Медиа файлы бота")])])])])])],64))}}),CU={key:0},wU={key:0,class:"row"},SU={class:"col-md-12"},jU=e("h4",null,"Боты в работе",-1),qU={class:"mb-0"},zU={class:"table mb-5"},PU=e("thead",null,[e("tr",null,[e("th",{scope:"col"},"#"),e("th",{scope:"col"},"Домен"),e("th",{scope:"col"},"Название"),e("th",{scope:"col"},"Шаблон"),e("th",{scope:"col"},"Дата изменения"),e("th",{scope:"col"},"Действие")])],-1),VU={scope:"row"},OU=["onClick"],UU=["onClick"],AU={key:0,class:"badge bg-primary"},IU={key:1},QU={class:"d-flex"},TU=["onClick"],BU=e("i",{class:"fa-regular fa-star"},null,-1),RU=[BU],MU=["onClick"],DU=e("i",{class:"fa-solid fa-chevron-down"},null,-1),EU=[DU],LU=["onClick"],KU=e("i",{class:"fa-solid fa-chevron-up"},null,-1),NU=[KU],JU=e("hr",null,null,-1),YU={class:"row"},HU={class:"col-md-12 d-flex flex-column"},GU={class:"d-flex"},WU={class:"dropdown mr-2"},XU=e("button",{class:"btn btn-outline-primary dropdown-toggle",type:"button",id:"dropdownMenuButton1","data-bs-toggle":"dropdown","aria-expanded":"false"}," Фильтры ",-1),ZU={class:"dropdown-menu","aria-labelledby":"dropdownMenuButton1"},xU=["onClick"],eA={class:"input-group mb-3"},tA={key:0,class:"mt-2"},sA={class:"badge bg-primary mr-1"},oA=["onClick"],lA=e("i",{class:"fa-solid fa-xmark"},null,-1),iA=[lA],nA={key:1,class:"row"},aA={class:"col-12"},dA=e("h4",null,"Все боты",-1),rA={class:"mb-0"},cA={class:"mb-0"},uA={key:2,class:"row"},mA={class:"col-12 mb-3"},hA={key:0,class:"col-12 mb-3"},_A={class:"table"},pA=e("th",{scope:"col"},"Действие",-1),bA={scope:"row"},fA=["onClick"],gA=["onClick"],vA={key:0,class:"badge bg-primary"},$A={key:1},yA={class:"d-flex"},kA=["onClick"],FA=e("i",{class:"fa-regular fa-star"},null,-1),CA=[FA],wA=["onClick"],SA=e("i",{class:"fa-regular fa-copy"},null,-1),jA=[SA],qA=["onClick"],zA=e("i",{class:"fa-solid fa-boxes-packing"},null,-1),PA=[zA],VA=["onClick"],OA=e("i",{class:"fa-solid fa-box-open"},null,-1),UA=[OA],AA=["onClick"],IA=e("i",{class:"fa-solid fa-trash-can text-white"},null,-1),QA=[IA],TA={class:"col-lg-4 col-12 mb-3"},BA={class:"card-body"},RA=["onClick"],MA={key:0,class:"badge bg-info"},DA={class:"card-footer d-flex"},EA=["onClick"],LA=e("i",{class:"fa-regular fa-star"},null,-1),KA=[LA],NA=["onClick"],JA=e("i",{class:"fa-regular fa-copy"},null,-1),YA=[JA],HA=["onClick"],GA=e("i",{class:"fa-solid fa-boxes-packing"},null,-1),WA=[GA],XA=["onClick"],ZA=e("i",{class:"fa-solid fa-box-open"},null,-1),xA=[ZA],eI=["onClick"],tI=e("i",{class:"fa-solid fa-trash-can text-white"},null,-1),sI=[tI],oI={class:"col-12"},lI={key:3,class:"row"},iI=e("div",{class:"col-12"},[e("div",{class:"alert alert-warning",role:"alert"}," У выбранной компании нет созданных ботов! ")],-1),nI=[iI],aI={props:["companyId","editor"],data(){return{displayType:1,direction:"desc",order:"updated_at",filters:[{name:"Активные",icon:"fa-brands fa-telegram",slug:"active"},{name:"Архивные",icon:"fa-solid fa-box-archive",slug:"archive"}],selectedFilters:[],show:!0,loading:!0,bots:[],favorites:[],search:null,bots_paginate_object:null}},watch:{displayType:function(s,t){localStorage.setItem("cashman_set_botlist_display_type",this.displayType)},selectedFilters:{handler:function(s){this.loadBots()},deep:!0}},computed:{...w(["getBots","getBotsPaginateObject","getCurrentCompany","getBotFavorites","inBotFav"]),filteredBots(){if(!this.bots)return[];if(this.selectedFilters.length===0&&this.search==null)return this.bots;if(this.selectedFilters.length===0&&this.search!=null)return this.bots.filter(t=>(t.bot_domain||"").trim().toLowerCase().indexOf(this.search.trim().toLowerCase())!==-1);let s=[];return this.selectedFilters.forEach(t=>{switch(t.slug){case"active":this.bots.filter(o=>o.deleted_at==null).forEach(o=>{s.push(o)});break;case"archive":this.bots.filter(o=>o.deleted_at!=null).forEach(o=>{s.push(o)});break}}),this.search==null?s:s.filter(t=>(t.bot_domain||"").trim().toLowerCase().indexOf(this.search.trim().toLowerCase())!==-1)}},mounted(){this.selectFilter("active"),this.displayType=parseInt(localStorage.getItem("cashman_set_botlist_display_type")||0)},methods:{hasRole(s){return window.hasRole(s)||!1},loadBotsByIds(){if(this.getBotFavorites.length==0){this.favorites=[];return}this.loading=!0,this.$store.dispatch("loadBotsByIds",{ids:this.getBotFavorites}).then(s=>{this.loading=!1,this.favorites=s}).catch(()=>{this.loading=!1})},prepareFavorites(){this.$store.dispatch("loadBotFavs").then(s=>{this.loadBotsByIds()})},moveOrderFavBot(s,t){this.$store.dispatch("swapBotInFav",{id:s,direction:t}).then(o=>{this.loadBotsByIds()})},addToFavorite(s){if(this.inBotFav(s)){this.$store.dispatch("removeFromBotFavorites",s).then(t=>{this.$notify("Указанный бот успешно удален из избранного"),this.loadBotsByIds()});return}this.$store.dispatch("addBotToFavorites",s).then(t=>{this.$notify("Указанный бот успешно добавлен в избранное"),this.loadBotsByIds()})},duplicate(s){if(!this.getCurrentCompany){this.$notify("У Вас не выбран клиент!");return}this.$store.dispatch("duplicateBot",{dataObject:{bot_id:s,company_id:this.getCurrentCompany.id}}).then(t=>{let o=this.bots_paginate_object.meta.current_page||0;this.loadBots(o),this.$notify("Указанный бот успешно продублирован")})},addToArchive(s){this.$store.dispatch("removeBot",{botId:s}).then(t=>{let o=this.bots_paginate_object.meta.current_page||0;this.$store.dispatch("resetCurrentBot"),this.loadBots(o),this.$notify("Указанный бот успешно перемещен в архив")})},forceDelete(s){this.$store.dispatch("forceDeleteBot",{botId:s}).then(t=>{let o=this.bots_paginate_object.meta.current_page||0;this.$store.dispatch("resetCurrentBot"),this.loadBots(o),this.$notify("Указанный бот успешно перемещен из архива")})},extractFromArchive(s){this.$store.dispatch("restoreBot",{botId:s}).then(t=>{let o=this.bots_paginate_object.meta.current_page||0;this.loadBots(o),this.$notify("Указанный бот успешно перемещен из архива")})},selectFilter(s){let t=this.filters.find(o=>o.slug===s);t&&this.selectedFilters.filter(o=>o.slug===s).length===0&&this.selectedFilters.push(t)},removeSelectedFilter(s){let t=this.selectedFilters.findIndex(o=>o.slug===s);this.selectedFilters.splice(t,1)},selectBot(s){this.$emit("callback",s),this.show=!1,this.$notify("Вы выбрали бота из списка! Все остальные действия будут производится для этого бота.")},nextBots(s){this.loadBots(s)},loadAndOrder(s){this.order=s,this.direction=this.direction==="desc"?"asc":"desc",this.loadBots(0)},loadBots(s=0){this.loading=!0,this.$store.dispatch("loadBots",{dataObject:{companyId:this.companyId||null,search:this.search,order:this.order,direction:this.direction,filters:this.selectedFilters.map(t=>t.slug)},page:s,size:20}).then(t=>{this.loading=!1,this.bots=this.getBots,this.bots_paginate_object=this.getBotsPaginateObject,this.prepareFavorites()}).catch(()=>{this.loading=!1})}}},$I=Object.assign(aI,{__name:"BotList",setup(s){return(t,o)=>t.show?(l(),i("div",CU,[t.favorites.length>0?(l(),i("div",wU,[e("div",SU,[jU,e("p",qU,"Количество ботов в работе "+u(t.favorites.length||0),1),e("table",zU,[PU,e("tbody",null,[(l(!0),i(v,null,y(t.favorites,(a,n)=>(l(),i("tr",{class:p({"border-info":a.deleted_at==null,"border-danger":a.deleted_at!=null})},[e("th",VU,u(a.id),1),e("td",{onClick:d=>t.selectBot(a)},[e("i",{class:p([{"text-danger":a.deleted_at!=null},"fa-solid fa-robot mr-2"])},null,2),m(" "+u(a.bot_domain||"Не указано"),1)],8,OU),e("td",{onClick:d=>t.selectBot(a)},u(a.title||"Не указано"),9,UU),e("td",null,[a.is_template?(l(),i("span",AU,u(a.template_description||"Не указано"),1)):(l(),i("span",IU,"Не является шаблоном"))]),e("td",null,u(t.$filters.current(a.updated_at)),1),e("td",null,[e("div",QU,[e("button",{class:p(["btn btn-outline-danger mr-2",{"btn-danger text-white":t.inBotFav(a.id)}]),type:"button",onClick:d=>t.addToFavorite(a.id),title:"Добавить в избранное"},RU,10,TU),t.favorites.length>1?(l(),i("button",{key:0,class:"btn btn-outline-primary mr-2",type:"button",onClick:d=>t.moveOrderFavBot(a.id,1),title:"Переместить вниз"},EU,8,MU)):r("",!0),t.favorites.length>1?(l(),i("button",{key:1,class:"btn btn-outline-primary mr-2",type:"button",onClick:d=>t.moveOrderFavBot(a.id,0),title:"Переместить вверх"},NU,8,LU)):r("",!0)])])],2))),256))])]),JU])])):r("",!0),e("div",YU,[e("div",HU,[e("div",GU,[e("div",WU,[XU,e("ul",ZU,[(l(!0),i(v,null,y(t.filters,a=>(l(),i("li",null,[e("a",{class:"dropdown-item",onClick:n=>t.selectFilter(a.slug),href:"#filter"},[e("i",{class:p([a.icon,"mr-2"])},null,2),m(" "+u(a.name||"Не указано"),1)],8,xU)]))),256))])]),e("div",eA,[c(e("input",{type:"search",class:"form-control",placeholder:"Поиск бота","aria-label":"Поиск бота","onUpdate:modelValue":o[0]||(o[0]=a=>t.search=a),onKeydown:o[1]||(o[1]=ye((...a)=>t.loadBots&&t.loadBots(...a),["enter"])),"aria-describedby":"button-addon2"},null,544),[[_,t.search]]),e("button",{class:"btn btn-outline-secondary",onClick:o[2]||(o[2]=(...a)=>t.loadBots&&t.loadBots(...a)),type:"button",id:"button-addon2"},"Найти ")])]),t.selectedFilters.length>0?(l(),i("p",tA,[(l(!0),i(v,null,y(t.selectedFilters,a=>(l(),i("span",sA,[m(u(a.name||"не указан")+" ",1),e("a",{onClick:n=>t.removeSelectedFilter(a.slug),class:"ml-1 text-white",href:"#filter"},iA,8,oA)]))),256))])):r("",!0)])]),t.bots_paginate_object?(l(),i("div",nA,[e("div",aA,[dA,e("p",rA,"Количество найденных ботов "+u(t.bots_paginate_object.meta.total||0),1),e("p",cA,"Количество результатов на странице "+u(t.bots.length||0),1),e("p",null,[m(" Тип отображения списка: "),e("span",{onClick:o[3]||(o[3]=a=>t.displayType=0),class:p([{"bg-primary":t.displayType===0,"bg-secondary":t.displayType!==0},"badge cursor-pointer mr-2"])},"Карточки",2),e("span",{class:p([{"bg-primary":t.displayType===1,"bg-secondary":t.displayType!==1},"badge cursor-pointer mr-2"]),onClick:o[4]||(o[4]=a=>t.displayType=1)},"Таблица",2)])])])):r("",!0),t.bots.length>0?(l(),i("div",uA,[e("div",mA,[s.editor?r("",!0):(l(),i("button",{key:0,type:"button",class:"btn btn-outline-info",onClick:o[5]||(o[5]=a=>t.selectBot(null))},"Создать нового бота "))]),t.displayType===1?(l(),i("div",hA,[e("table",_A,[e("thead",null,[e("tr",null,[e("th",{scope:"col",class:"cursor-pointer",onClick:o[6]||(o[6]=a=>t.loadAndOrder("id"))},"#"),e("th",{scope:"col",class:"cursor-pointer",onClick:o[7]||(o[7]=a=>t.loadAndOrder("bot_domain"))},"Домен"),e("th",{scope:"col",class:"cursor-pointer",onClick:o[8]||(o[8]=a=>t.loadAndOrder("title"))},"Название"),e("th",{scope:"col",class:"cursor-pointer",onClick:o[9]||(o[9]=a=>t.loadAndOrder("template_description"))},"Шаблон"),e("th",{scope:"col",class:"cursor-pointer",onClick:o[10]||(o[10]=a=>t.loadAndOrder("updated_at"))},"Дата изменения"),pA])]),e("tbody",null,[(l(!0),i(v,null,y(t.bots,(a,n)=>(l(),i("tr",{class:p({"border-info":a.deleted_at==null,"border-danger":a.deleted_at!=null})},[e("th",bA,u(a.id),1),e("td",{onClick:d=>t.selectBot(a)},[e("i",{class:p([{"text-danger":a.deleted_at!=null},"fa-solid fa-robot mr-2"])},null,2),m(" "+u(a.bot_domain||"Не указано"),1)],8,fA),e("td",{onClick:d=>t.selectBot(a)},u(a.title||"Не указано"),9,gA),e("td",null,[a.is_template?(l(),i("span",vA,u(a.template_description||"Не указано"),1)):(l(),i("span",$A,"Не является шаблоном"))]),e("td",null,u(t.$filters.current(a.updated_at)),1),e("td",null,[e("div",yA,[e("button",{class:p(["btn btn-outline-danger mr-2",{"btn-danger text-white":t.inBotFav(a.id)}]),type:"button",onClick:d=>t.addToFavorite(a.id),title:"Добавить в избранное"},CA,10,kA),e("button",{class:"btn btn-outline-info mr-2",type:"button",onClick:d=>t.duplicate(a.id),title:"Дублировать"},jA,8,wA),a.deleted_at==null&&t.hasRole("admin")?(l(),i("button",{key:0,class:"btn btn-outline-info",type:"button",onClick:d=>t.addToArchive(a.id),title:"В архив"},PA,8,qA)):r("",!0),a.deleted_at!=null&&t.hasRole("admin")?(l(),i("button",{key:1,class:"btn btn-outline-info mr-2",onClick:d=>t.extractFromArchive(a.id),title:"Из архива"},UA,8,VA)):r("",!0),a.deleted_at!=null&&t.hasRole("admin")?(l(),i("button",{key:2,class:"btn btn-danger mr-2",onClick:d=>t.forceDelete(a.id),title:"Удалить на совсем"},QA,8,AA)):r("",!0)])])],2))),256))])])])):r("",!0),t.displayType===0?(l(!0),i(v,{key:1},y(t.bots,(a,n)=>(l(),i("div",TA,[e("div",{class:p(["card w-100",{"border-info":a.deleted_at==null,"border-secondary":a.deleted_at!=null}])},[e("div",BA,[e("p",{class:"d-flex justify-content-between",onClick:d=>t.selectBot(a),style:{"word-wrap":"break-word"}},[e("span",null,[e("i",{class:p([{"text-danger":a.deleted_at!=null},"fa-solid fa-robot mr-2"])},null,2),m(" "+u(a.bot_domain||"Не указано"),1)]),a.is_template?(l(),i("span",MA,u(a.template_description||"Шаблон без названия"),1)):r("",!0)],8,RA)]),e("div",DA,[e("button",{class:p(["btn btn-outline-danger mr-2",{"btn-danger text-white":t.inBotFav(a.id)}]),type:"button",onClick:d=>t.addToFavorite(a.id),title:"Добавить в избранное"},KA,10,EA),e("button",{class:"btn btn-outline-info mr-2",type:"button",onClick:d=>t.duplicate(a.id),title:"Дублировать"},YA,8,NA),a.deleted_at==null&&t.hasRole("admin")?(l(),i("button",{key:0,class:"btn btn-outline-info",type:"button",onClick:d=>t.addToArchive(a.id),title:"В архив"},WA,8,HA)):r("",!0),a.deleted_at!=null&&t.hasRole("admin")?(l(),i("button",{key:1,class:"btn btn-outline-info mr-2",onClick:d=>t.extractFromArchive(a.id),title:"Из архива"},xA,8,XA)):r("",!0),a.deleted_at!=null&&t.hasRole("admin")?(l(),i("button",{key:2,class:"btn btn-danger mr-2",onClick:d=>t.forceDelete(a.id),title:"Удалить на совсем"},sI,8,eI)):r("",!0)])],2)]))),256)):r("",!0),e("div",oI,[t.bots_paginate_object?(l(),$(j,{key:0,onPagination_page:t.nextBots,pagination:t.bots_paginate_object},null,8,["onPagination_page","pagination"])):r("",!0)])])):(l(),i("div",lI,nI))])):r("",!0)}});export{$I as _,vI as a,w1 as b,ae as c};
