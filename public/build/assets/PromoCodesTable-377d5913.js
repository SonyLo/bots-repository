import{G as $,q as o,t as i,v as e,H as u,J as m,a7 as F,A as d,F as b,C as f,y as r,K as k,B as p,u as S,D as h,x as y,R as P,O as _,T as g,P as j,L as O}from"./index.es-f98e90e3.js";import{P as v}from"./Pagination-8d87cf85.js";import{K as w}from"./main-f646787a.js";import{_ as A}from"./GlobalSlugList-6909916a.js";const U={class:"row mt-2"},V={class:"input-group mb-3"},B={key:0,class:"row"},q={class:"col-12 col-md-12 mb-3"},z={class:"table"},I=e("th",{scope:"col"},"#",-1),T=e("th",{scope:"col"},"Ф.И.О. из телеграмма",-1),D=e("th",{scope:"col"},"Имя пользователя",-1),K=e("th",{scope:"col"},"Домен",-1),N=e("th",{scope:"col"},"Телефон",-1),E=e("th",{scope:"col"},"TG id",-1),L={key:0,scope:"col"},G={key:1,scope:"col"},M={key:2,scope:"col"},H={key:3,scope:"col"},J={key:4,scope:"col"},Q=["onClick"],R={scope:"row"},W=["href"],X={key:1},Y={key:0},Z=["onClick"],x=e("i",{class:"fa-solid fa-check text-success"},null,-1),ee=[x],te=["onClick"],se=e("i",{class:"fa-solid fa-xmark text-danger"},null,-1),oe=[se],ne={key:1},ie=["onClick"],ae=e("i",{class:"fa-solid fa-check text-success"},null,-1),le=[ae],de=["onClick"],re=e("i",{class:"fa-solid fa-xmark text-danger"},null,-1),ce=[re],ue={key:2},he=["onClick"],_e=e("i",{class:"fa-solid fa-check text-success"},null,-1),me=[_e],pe=["onClick"],be=e("i",{class:"fa-solid fa-xmark text-danger"},null,-1),ge=[be],fe={key:3},ke=["onClick"],$e=e("i",{class:"fa-solid fa-check text-success"},null,-1),ve=[$e],Ce=["onClick"],ye=e("i",{class:"fa-solid fa-xmark text-danger"},null,-1),we=[ye],Fe={key:4},Se=["onClick"],Pe=e("i",{class:"fa-solid fa-check text-success"},null,-1),je=[Pe],Oe=["onClick"],Ae=e("i",{class:"fa-solid fa-xmark text-danger"},null,-1),Ue=[Ae],Ve={class:"col-12"},Be={key:1,class:"row"},qe=e("div",{class:"col-12"},[e("div",{class:"alert alert-warning",role:"alert"}," У выбранного бота нет пользователей ")],-1),ze=[qe],Ie={props:["simple"],data(){return{bot:null,loading:!0,bot_users:[],search:null,bot_users_paginate_object:null}},computed:{...$(["getBotUsers","getBotUsersPaginateObject","getCurrentBot"])},mounted(){this.loadCurrentBot().then(()=>{this.loadUsers()})},methods:{selectUser(a){this.$emit("select",a)},loadCurrentBot(a=null){return this.$store.dispatch("updateCurrentBot",{bot:a}).then(()=>{this.bot=this.getCurrentBot})},changeUserStatus(a,t,s="is_admin"){this.bot_users[a][s]=t===1,this.$store.dispatch("changeUserStatus",{dataObject:{bot_user_id:this.bot_users[a].id,status:t,type:s}}).then(()=>{this.$notify({title:"Конструктор ботов",text:"Статус пользователя успешно изменен! Пользователь оповещен об изменении статуса!",type:"success"})}).catch(()=>{this.$notify({title:"Конструктор ботов",text:"Ошибка изменения статуса",type:"error"})})},nextUsers(a){this.loadUsers(a)},loadUsers(a=0){this.loading=!0,this.$store.dispatch("loadBotUsers",{dataObject:{botId:this.bot.id||null,search:this.search},size:100,page:a}).then(t=>{this.loading=!1,this.bot_users=this.getBotUsers,this.bot_users_paginate_object=this.getBotUsersPaginateObject}).catch(()=>{this.loading=!1})}}},zs=Object.assign(Ie,{__name:"BotUserList",setup(a){return(t,s)=>(o(),i(b,null,[e("div",U,[e("div",V,[u(e("input",{type:"search",class:"form-control",placeholder:"Поиск пользователя","aria-label":"Поиск пользователя",onKeydown:s[0]||(s[0]=F(l=>t.loadUsers(0),["enter"])),"onUpdate:modelValue":s[1]||(s[1]=l=>t.search=l)},null,544),[[m,t.search]]),e("button",{class:"btn btn-outline-secondary",onClick:s[2]||(s[2]=l=>t.loadUsers(0)),type:"button",id:"button-addon2"},"Найти ")])]),t.bot_users.length>0?(o(),i("div",B,[e("div",q,[e("table",z,[e("thead",null,[e("tr",null,[I,T,D,K,N,E,a.simple?d("",!0):(o(),i("th",L,"Админ")),a.simple?d("",!0):(o(),i("th",G,"VIP")),a.simple?d("",!0):(o(),i("th",M,"Доставщик")),a.simple?d("",!0):(o(),i("th",H,"Менеджер")),a.simple?d("",!0):(o(),i("th",J,"За работой"))])]),e("tbody",null,[(o(!0),i(b,null,f(t.bot_users,(l,n)=>(o(),i("tr",{onClick:c=>t.selectUser(l)},[e("th",R,r(l.id),1),e("td",null,r(l.fio_from_telegram||"Не указано"),1),e("td",null,r(l.name||"Не указано"),1),e("td",null,[l.username?(o(),i("a",{key:0,href:"https://t.me/"+l.username,target:"_blank"},"@"+r(l.username),9,W)):(o(),i("span",X,"Не указано"))]),e("td",null,r(l.phone||"Не указано"),1),e("td",null,r(l.telegram_chat_id||"Не указано"),1),a.simple?d("",!0):(o(),i("td",Y,[l.is_admin?(o(),i("span",{key:0,onClick:c=>t.changeUserStatus(n,0,"is_admin")},ee,8,Z)):(o(),i("span",{key:1,onClick:c=>t.changeUserStatus(n,1,"is_admin")},oe,8,te))])),a.simple?d("",!0):(o(),i("td",ne,[l.is_vip?(o(),i("span",{key:0,onClick:c=>t.changeUserStatus(n,0,"is_vip")},le,8,ie)):(o(),i("span",{key:1,onClick:c=>t.changeUserStatus(n,1,"is_vip")},ce,8,de))])),a.simple?d("",!0):(o(),i("td",ue,[l.is_deliveryman?(o(),i("span",{key:0,onClick:c=>t.changeUserStatus(n,0,"is_deliveryman")},me,8,he)):(o(),i("span",{key:1,onClick:c=>t.changeUserStatus(n,1,"is_deliveryman")},ge,8,pe))])),a.simple?d("",!0):(o(),i("td",fe,[l.is_manager?(o(),i("span",{key:0,onClick:c=>t.changeUserStatus(n,0,"is_manager")},ve,8,ke)):(o(),i("span",{key:1,onClick:c=>t.changeUserStatus(n,1,"is_manager")},we,8,Ce))])),a.simple?d("",!0):(o(),i("td",Fe,[l.is_work?(o(),i("span",{key:0,onClick:c=>t.changeUserStatus(n,0,"is_work")},je,8,Se)):(o(),i("span",{key:1,onClick:c=>t.changeUserStatus(n,1,"is_work")},Ue,8,Oe))]))],8,Q))),256))])])]),e("div",Ve,[t.bot_users_paginate_object?(o(),k(v,{key:0,onPagination_page:t.nextUsers,pagination:t.bot_users_paginate_object},null,8,["onPagination_page","pagination"])):d("",!0)])])):(o(),i("div",Be,ze))],64))}}),Te={class:"row"},De={class:"col-md-4"},Ke={class:"col-12"},Ne={key:0,class:"fa-solid fa-arrow-down-short-wide"},Ee={key:1,class:"fa-solid fa-arrow-up-wide-short"},Le={key:0,class:"fa-solid fa-arrow-down-short-wide"},Ge={key:1,class:"fa-solid fa-arrow-up-wide-short"},Me={key:0,class:"fa-solid fa-arrow-down-short-wide"},He={key:1,class:"fa-solid fa-arrow-up-wide-short"},Je={class:"col-md-4 mb-2"},Qe=["onClick"],Re={class:"card-body text-center"},We={class:"row"},Xe={class:"col-md-6"},Ye={class:"mb-0"},Ze=e("p",{class:"mb-0"},"Начало сеанса",-1),xe={class:"mb-0"},et=e("p",{class:"mb-0"},"Окончание сеанса",-1),tt={class:"mb-0"},st={class:"col-md-6"},ot={class:"mb-0"},nt={class:"mb-0"},it={class:"mb-0"},at=e("p",{class:"mb-0"},[e("strong",null,"Период")],-1),lt={class:"mb-0"},dt={class:"row"},rt={class:"col-12"},ct={props:["bot","eventId"],components:{VueDatePicker:w},data(){return{date:null,loading:!0,schedule:[],order:null,direction:null,months:["Январь","Февраль","Март","Апрель","Май","Июнь","Июль","Август","Сентябрь","октябрь","Ноябрь","Декабрь"],days:["Понедельник","Вторник","Среда","Четверг","Пятница","Суббота","Воскресенье"],paginate_object:null}},watch:{date:{handler:function(a){this.loadAppointmentSchedules()},deep:!0}},computed:{...$(["getAppointmentSchedules","getAppointmentSchedulesPaginateObject"])},mounted(){this.date=new Date,this.loadAppointmentSchedules()},methods:{selectTime(a){this.$emit("select",a)},loadAndOrder(a){this.order=a,this.direction=this.direction==="desc"?"asc":"desc",this.loadAppointmentSchedules(0)},nextAppointmentSchedule(a){this.loadAppointmentSchedules(a)},loadAppointmentSchedules(a=0){this.loading=!0,this.$store.dispatch("loadAppointmentSchedules",{dataObject:{date:this.date||null,event_id:this.eventId,bot_id:this.bot.id||null,order:this.order,direction:this.direction},page:a,size:20}).then(t=>{this.loading=!1,this.schedule=this.getAppointmentSchedules,this.paginate_object=this.getAppointmentSchedulesPaginateObject}).catch(()=>{this.loading=!1})}}},Is=Object.assign(ct,{__name:"AppointmentScheduleList",setup(a){return(t,s)=>(o(),i(b,null,[e("div",Te,[e("div",De,[p(S(w),{modelValue:t.date,"onUpdate:modelValue":s[0]||(s[0]=l=>t.date=l)},null,8,["modelValue"])]),e("div",Ke,[e("p",null,[h(" Тип сортировки: "),e("a",{class:"mx-2",onClick:s[1]||(s[1]=l=>t.loadAndOrder("day")),href:"javascript:void(0)"},[h("По дню недели "),t.order==="day"&&t.direction==="asc"?(o(),i("i",Ne)):d("",!0),t.order==="day"&&t.direction==="desc"?(o(),i("i",Ee)):d("",!0)]),e("a",{class:"mx-2",onClick:s[2]||(s[2]=l=>t.loadAndOrder("start_time")),href:"javascript:void(0)"},[h("По времени начала "),t.order==="start_time"&&t.direction==="asc"?(o(),i("i",Le)):d("",!0),t.order==="start_time"&&t.direction==="desc"?(o(),i("i",Ge)):d("",!0)]),e("a",{class:"mx-2",onClick:s[3]||(s[3]=l=>t.loadAndOrder("end_time")),href:"javascript:void(0)"},[h("По времени окончания "),t.order==="end_time"&&t.direction==="asc"?(o(),i("i",Me)):d("",!0),t.order==="end_time"&&t.direction==="desc"?(o(),i("i",He)):d("",!0)])])]),(o(!0),i(b,null,f(t.schedule,l=>(o(),i("div",Je,[e("div",{class:y(["card btn",{"btn-outline-secondary bg-secondary":l.appointment!=null,"btn-outline-success":l.appointment==null}]),onClick:n=>t.selectTime(l)},[e("div",Re,[e("div",We,[e("div",Xe,[e("p",Ye,[e("strong",null,r(t.days[l.day-1]),1)]),Ze,e("p",xe,[e("strong",null,r(l.start_time||"-"),1)]),et,e("p",tt,[e("strong",null,r(l.end_time||"-"),1)])]),e("div",st,[e("p",ot,[e("strong",null,r(l.year||"-"),1)]),e("p",nt,[e("strong",null,r(t.months[l.month||0]),1)]),e("p",it,[e("strong",null,r(l.day_number),1)]),at,e("p",lt,[e("strong",null,"c "+r(l.week_start||"-"),1),h(" по "),e("strong",null,r(l.week_end||"-"),1)])])])])],10,Qe)]))),256))]),e("div",dt,[e("div",rt,[t.paginate_object?(o(),k(v,{key:0,onPagination_page:t.nextAppointmentSchedule,pagination:t.paginate_object},null,8,["onPagination_page","pagination"])):d("",!0)])])],64))}});const ut={class:"row"},ht={class:"col-12 mb-3"},_t={class:"form-label",id:"quiz-title"},mt=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),pt=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),bt={class:"col-12 mb-3"},gt={class:"form-label",id:"quiz-description"},ft=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),kt=e("div",null," Краткая информация о назначении промокода ",-1),$t=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),vt={key:0,class:"text-gray-400 ml-3",style:{"font-size":"10px"}},Ct={class:"col-12 mb-3"},yt={class:"form-check"},wt=e("label",{class:"form-check-label",for:"is_active"}," Доступен для активации ",-1),Ft={class:"col-12 mb-3"},St={class:"form-label",id:"promoCodeForm-max_activation_count"},Pt=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),jt=e("div",null," Максимальное число активация кода ",-1),Ot=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),At={class:"col-12 mb-3"},Ut={class:"form-check"},Vt=e("label",{class:"form-check-label",for:"promoCodeForm-cashback_amount"}," Нужно начислить CashBack по промокоду ",-1),Bt={key:0,class:"col-12 mb-3"},qt={class:"form-label",id:"quiz-time_limit"},zt=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),It=e("div",null," Сколько % нужно ответить чтоб пройти ",-1),Tt=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),Dt={key:1,class:"col-12 mb-3"},Kt={class:"form-check"},Nt=e("label",{class:"form-check-label",for:"promoCodeForm-need_slots"}," Нужны слоты для активации ",-1),Et={key:2,class:"col-12 mb-3"},Lt={class:"form-label",id:"promoCodeForm-slot_amount"},Gt=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),Mt=e("div",null," Укажите количество слотов, которые получит пользователь при активации (внимание, доступно только для администраторов) ",-1),Ht=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),Jt={key:0,class:"col-12 mb-3"},Qt={class:"form-check"},Rt=e("label",{class:"form-check-label",for:"promoCodeForm-need_attach_scripts"}," Нужно добавить скрипты ",-1),Wt={key:1,class:"col-12 mb-3"},Xt=["onClick"],Yt={class:"row"},Zt={class:"col-12"},xt={type:"submit",class:"btn btn-outline-success w-100 p-3"},es={key:0},ts={key:1},ss={props:["code","bot"],data(){return{step:0,load:!1,need_reset:!1,need_cashback:!1,need_slots:!1,need_attach_scripts:!1,promoCodeForm:{id:null,code:null,description:null,slot_amount:0,cashback_amount:0,max_activation_count:1,is_active:!1,scripts:[]}}},computed:{getSelf(){return window.profile}},watch:{promoCodeForm:{handler(a){this.need_reset=!0},deep:!0}},mounted(){this.code&&this.$nextTick(()=>{this.promoCodeForm={id:this.code.id||null,description:this.code.description||null,code:this.code.code||null,slot_amount:this.code.slot_amount||0,cashback_amount:this.code.cashback_amount||0,max_activation_count:this.code.max_activation_count||1,is_active:this.code.is_active||!1,scripts:this.code.scripts||[]},this.promoCodeForm.slot_amount>0&&(this.need_slots=!0),this.promoCodeForm.cashback_amount>0&&(this.need_slots=!0),this.promoCodeForm.scripts.length>0&&(this.need_attach_scripts=!0)})},methods:{removeSlug(a){this.promoCodeForm.scripts.splice(a,1)},selectSlugsCallback(a){this.promoCodeForm.scripts.findIndex(s=>s.id===a.id)===-1&&this.promoCodeForm.scripts.push(a)},submitForm(){let a=new FormData;Object.keys(this.promoCodeForm).forEach(t=>{const s=this.promoCodeForm[t]||"";typeof s=="object"?a.append(t,JSON.stringify(s)):a.append(t,s)}),a.append("bot_id",this.bot.id),this.$store.dispatch("storePromoCodes",{promoCodeForm:a}).then(t=>{this.promoCodeForm={id:null,code:null,description:null,slot_amount:0,cashback_amount:0,max_activation_count:1,scripts:[],is_active:!1},this.$emit("callback",t.data),this.$notify("Промокод успешно создан")}).catch(t=>{this.$notify("Ошибка создания промокода")})}}},Ts=Object.assign(ss,{__name:"PromoCodesForm",setup(a){return(t,s)=>{const l=P("Popper");return o(),i("form",{onSubmit:s[9]||(s[9]=j((...n)=>t.submitForm&&t.submitForm(...n),["prevent"])),class:"py-3"},[e("div",ut,[e("div",ht,[e("label",_t,[p(l,{content:"Название вашего квиза"},{default:_(()=>[mt]),_:1}),h(" Промокод (вписать или сгенерировать) "),pt]),u(e("input",{type:"text",class:"form-control",placeholder:"Название","aria-label":"Название","onUpdate:modelValue":s[0]||(s[0]=n=>t.promoCodeForm.code=n),maxlength:"255","aria-describedby":"quiz-title",required:""},null,512),[[m,t.promoCodeForm.code]])]),e("div",bt,[e("label",gt,[p(l,null,{content:_(()=>[kt]),default:_(()=>[ft]),_:1}),h(" Назначение промокода "),$t,t.promoCodeForm.description?(o(),i("small",vt," Длина текста "+r(t.promoCodeForm.description.length)+"/255",1)):d("",!0)]),u(e("textarea",{class:"form-control",placeholder:"Описание промокода","aria-label":"Описание промокода",maxlength:"255","onUpdate:modelValue":s[1]||(s[1]=n=>t.promoCodeForm.description=n),"aria-describedby":"quiz-description",required:""},`
                    `,512),[[m,t.promoCodeForm.description]])]),e("div",Ct,[e("div",yt,[u(e("input",{class:"form-check-input","onUpdate:modelValue":s[2]||(s[2]=n=>t.promoCodeForm.is_active=n),type:"checkbox",id:"is_active"},null,512),[[g,t.promoCodeForm.is_active]]),wt])]),e("div",Ft,[e("label",St,[p(l,null,{content:_(()=>[jt]),default:_(()=>[Pt]),_:1}),h(" Количество активация кода "),Ot]),u(e("input",{type:"number",class:"form-control",placeholder:"Число попыток","aria-label":"Число попыток",step:"1",min:"1","onUpdate:modelValue":s[3]||(s[3]=n=>t.promoCodeForm.max_activation_count=n),"aria-describedby":"promoCodeForm-max_activation_count",required:""},null,512),[[m,t.promoCodeForm.max_activation_count]])]),e("div",At,[e("div",Ut,[u(e("input",{class:"form-check-input","onUpdate:modelValue":s[4]||(s[4]=n=>t.need_cashback=n),type:"checkbox",id:"promoCodeForm-cashback_amount"},null,512),[[g,t.need_cashback]]),Vt])]),t.need_cashback?(o(),i("div",Bt,[e("label",qt,[p(l,null,{content:_(()=>[It]),default:_(()=>[zt]),_:1}),h(" Сколько CashBack начислить по промокоду? "),Tt]),u(e("input",{type:"number",class:"form-control",placeholder:"Процент для победы","aria-label":"Процент для победы",step:"1",min:"0","onUpdate:modelValue":s[5]||(s[5]=n=>t.promoCodeForm.cashback_amount=n),"aria-describedby":"promoCodeForm-cashback_amount",required:""},null,512),[[m,t.promoCodeForm.cashback_amount]])])):d("",!0),t.getSelf.is_admin?(o(),i("div",Dt,[e("div",Kt,[u(e("input",{class:"form-check-input","onUpdate:modelValue":s[6]||(s[6]=n=>t.need_slots=n),type:"checkbox",id:"promoCodeForm-need_slots"},null,512),[[g,t.need_slots]]),Nt])])):d("",!0),t.need_slots?(o(),i("div",Et,[e("label",Lt,[p(l,null,{content:_(()=>[Mt]),default:_(()=>[Gt]),_:1}),h(" Сколько нужно добавить слотов? "),Ht]),u(e("input",{type:"number",class:"form-control",placeholder:"Количество слотов","aria-label":"Количество слотов",step:"1",min:"0","onUpdate:modelValue":s[7]||(s[7]=n=>t.promoCodeForm.slot_amount=n),"aria-describedby":"promoCodeForm-slot_amount",required:""},null,512),[[m,t.promoCodeForm.slot_amount]])])):d("",!0)]),t.getSelf.is_admin?(o(),i("div",Jt,[e("div",Qt,[u(e("input",{class:"form-check-input","onUpdate:modelValue":s[8]||(s[8]=n=>t.need_attach_scripts=n),type:"checkbox",id:"promoCodeForm-need_attach_scripts"},null,512),[[g,t.need_attach_scripts]]),Rt])])):d("",!0),t.need_attach_scripts?(o(),i("div",Wt,[e("p",null,[(o(!0),i(b,null,f(t.promoCodeForm.scripts,(n,c)=>(o(),i("span",{class:"badge bg-primary mr-2 mb-2 cursor-pointer",onClick:C=>t.removeSlug(c)},r(n.command||"-"),9,Xt))),256))]),a.bot?(o(),k(A,{key:0,"can-add":!0,bot:a.bot,"hide-add-modal":!0,onSelect:t.selectSlugsCallback},null,8,["bot","onSelect"])):d("",!0)])):d("",!0),e("div",Yt,[e("div",Zt,[e("button",xt,[t.promoCodeForm.id==null?(o(),i("span",es,"Создать промокод")):(o(),i("span",ts,"Обновить промокод"))])])])],32)}}}),os={class:"row py-2"},ns={class:"col-12"},is={class:"input-group mb-3"},as={class:"col-12"},ls={key:0,class:"table"},ds=e("th",{scope:"col",class:"cursor-pointer"},"Число активаций",-1),rs=e("th",{scope:"col"},"Действие",-1),cs={scope:"row"},us=["onClick"],hs={key:0},_s={key:0,class:"fa-solid fa-chevron-down text-success"},ms={key:1,class:"fa-solid fa-xmark text-danger"},ps={key:0,class:"dropdown"},bs=e("button",{class:"btn btn-outline-secondary",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-solid fa-ellipsis"})],-1),gs={class:"dropdown-menu"},fs={key:0},ks=["onClick"],$s={key:1},vs=e("div",{class:"alert alert-warning alert-dismissible fade show",role:"alert"},[e("strong",null,"Внимание!"),h(" Вы еще не добавили ни одного промокода! "),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"alert","aria-label":"Close"})],-1),Cs={class:"position-relative p-5 text-center text-muted bg-body border border-dashed rounded-2"},ys={class:"d-flex justify-content-center mb-3"},ws={alt:"",width:"100",height:"100"},Fs=e("h1",{class:"text-body-emphasis"},"Создание промокода",-1),Ss=e("p",{class:"col-lg-8 mx-auto fs-5 text-muted"}," Промокод - это инструмент мотивации пользователей пользоваться вашим сервисом. Он позволяет клиентам получать некоторые бонусы за активацию кода, а вы в свою очередь будете видеть статистику активация прмокода. ",-1),Ps={class:"d-inline-flex gap-2 mb-5"},js=e("a",{href:"#",target:"_blank",class:"d-inline-flex align-items-center btn btn-outline-secondary btn-lg px-4 rounded-pill"}," Подробнее ",-1),Os={key:0,class:"col-12"},As={props:["bot"],data(){return{direction:"desc",order:"updated_at",show:!0,loading:!0,codes:[],search:null,paginate_object:null}},computed:{...$(["getPromoCodes","getPromoCodesPaginateObject"]),getSelf(){return window.profile}},mounted(){this.loadPromoCodes()},methods:{removeQuiz(a){this.loading=!0,this.$store.dispatch("removePromoCodes",{promoCodeId:a}).then(t=>{this.loading=!1,this.loadPromoCodes(0),this.$notify("Промокод успешно удален")}).catch(()=>{this.loading=!1,this.$notify("Ошибка удаления промокода")})},createPromoCode(){this.$emit("create")},nextPromoCodes(a){this.loadPromoCodes(a)},selectEvent(a){this.$emit("select",a)},loadAndOrder(a){this.order=a,this.direction=this.direction==="desc"?"asc":"desc",this.loadPromoCodes(0)},loadPromoCodes(a=0){this.loading=!0,this.$store.dispatch("loadPromoCodes",{dataObject:{bot_id:this.bot.id||null,search:this.search,order:this.order,direction:this.direction},page:a,size:20}).then(t=>{this.loading=!1,this.codes=this.getPromoCodes,this.paginate_object=this.getPromoCodesPaginateObject}).catch(()=>{this.loading=!1})}}},Ds=Object.assign(As,{__name:"PromoCodesTable",setup(a){return(t,s)=>{const l=O("lazy");return o(),i("div",os,[e("div",ns,[e("div",is,[u(e("input",{type:"search",class:"form-control",placeholder:"Поиск кода","aria-label":"Поиск кода","onUpdate:modelValue":s[0]||(s[0]=n=>t.search=n),"aria-describedby":"promocode-search-and-filter"},null,512),[[m,t.search]]),e("button",{class:"btn btn-outline-secondary",onClick:s[1]||(s[1]=n=>t.loadPromoCodes(0)),type:"button",id:"promocode-search-and-filter"},"Найти ")])]),e("div",as,[t.codes.length>0?(o(),i("table",ls,[e("thead",null,[e("tr",null,[e("th",{scope:"col",class:"cursor-pointer",onClick:s[2]||(s[2]=n=>t.loadAndOrder("id"))},"#"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[3]||(s[3]=n=>t.loadAndOrder("code"))},"Код"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[4]||(s[4]=n=>t.loadAndOrder("description"))},"Описание"),t.getSelf.is_admin?(o(),i("th",{key:0,scope:"col",class:"cursor-pointer",onClick:s[5]||(s[5]=n=>t.loadAndOrder("slot_amount"))},"Число слотов ")):d("",!0),e("th",{scope:"col",class:"cursor-pointer",onClick:s[6]||(s[6]=n=>t.loadAndOrder("cashback_amount"))},"Величина CashBack-а, руб "),e("th",{scope:"col",class:"cursor-pointer",onClick:s[7]||(s[7]=n=>t.loadAndOrder("max_activation_count"))},"Максимальное число активаций "),ds,e("th",{scope:"col",class:"cursor-pointer",onClick:s[8]||(s[8]=n=>t.loadAndOrder("is_active"))},"Активный"),rs])]),e("tbody",null,[(o(!0),i(b,null,f(t.codes,(n,c)=>(o(),i("tr",{class:y({"border-info":n.deleted_at==null,"border-danger":n.deleted_at!=null})},[e("th",cs,r(n.id),1),e("td",{onClick:C=>t.selectEvent(n)},r(n.code||"Не указано"),9,us),e("td",null,r(n.description||"Не указано"),1),t.getSelf.is_admin?(o(),i("td",hs,r(n.slot_amount),1)):d("",!0),e("td",null,r(n.cashback_amount),1),e("td",null,r(n.max_activation_count),1),e("td",null,r(n.current_activation_count||0),1),e("td",null,[n.is_active?(o(),i("i",_s)):(o(),i("i",ms))]),e("td",null,[n.id?(o(),i("div",ps,[bs,e("ul",gs,[n.deleted_at==null?(o(),i("li",fs,[e("a",{class:"dropdown-item",onClick:C=>t.removeQuiz(n.id),href:"javascript:void(0)"},"Удалить",8,ks)])):d("",!0)])])):d("",!0)])],2))),256))])])):(o(),i("div",$s,[vs,e("div",Cs,[e("div",ys,[u(e("img",ws,null,512),[[l,"../images/icon.png"]])]),Fs,Ss,e("div",Ps,[e("button",{onClick:s[9]||(s[9]=(...n)=>t.createPromoCode&&t.createPromoCode(...n)),class:"d-inline-flex align-items-center btn btn-lg px-4 rounded-pill btn-primary",type:"button"}," Добавить "),js])])]))]),t.codes.length>0?(o(),i("div",Os,[t.paginate_object?(o(),k(v,{key:0,onPagination_page:t.nextPromoCodes,pagination:t.paginate_object},null,8,["onPagination_page","pagination"])):d("",!0)])):d("",!0)])}}});export{Ds as _,Ts as a,zs as b,Is as c};
