import{_ as B,a as Q,b as G,c as I,d as ue,e as me,f as he}from"./MailingTable-fd9221fd.js";import{R as q,q as l,t as n,v as e,B as g,O as b,D as m,H as c,J as _,F as v,C as $,y as u,A as r,S as k,P as S,G as w,x as f,K as y,L as A,z as ee,u as M,Y as T,a3 as z,M as _e,k as pe,g as K,o as be,a8 as fe,a4 as ge,a9 as ve,aa as H,a7 as ye}from"./index.es-b188fb53.js";import{_ as Y}from"./GlobalSlugList-3fc01c4f.js";import{T as te}from"./TelegramChannelHelper-a3ce9357.js";import{_ as V,V as se,B as J}from"./vue3-json-editor.esm.prod-22c6b7fc.js";import{P as j}from"./Pagination-0b2e35d4.js";import{_ as D,a as oe}from"./InlineInjectionsHelper.vue_vue_type_style_index_0_lang-8f930414.js";import{_ as $e}from"./BotForm-30f4ae96.js";import{_ as O}from"./_plugin-vue_export-helper-c27b6911.js";import{K as le}from"./main-1486aa08.js";import{v as ke}from"./v4-4a60fe23.js";const Fe={class:"row"},Ce={class:"col-12 mb-3"},we={class:"form-label",id:"service-title"},Se=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),je=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),qe={class:"col-12 mb-3"},ze={key:0},Ve=["onClick"],Pe={class:"form-label",id:"service-category"},Oe=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),Ue=e("div",null,"Категория услуги (используется для группировки) ",-1),Ae=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),Qe={class:"col-12 mb-3"},Ie={class:"form-label",id:"service-description"},Te=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),Be=e("div",null," Краткая информация об оказываемой услуге ",-1),Re=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),Me={key:0,class:"text-gray-400 ml-3",style:{"font-size":"10px"}},De={class:"col-12 col-md-6 mb-3"},Ee={class:"form-label",id:"service-title"},Le=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),Ke=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),Ne={class:"col-12 col-md-6 mb-3"},Je={class:"form-label",id:"service-title"},Ye=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),Ge=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),He={class:"col-12 mb-3"},We={class:"form-check"},Xe=e("label",{class:"form-check-label",for:"need_images"}," Необходимо добавить изображения к сервиус ",-1),Ze={key:0,class:"col-12 mb-3"},xe={class:"form-label",id:"service-images"},et=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),tt=e("div",null," Изображение, которое видит пользователь при выборе услуги ",-1),st=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),ot={class:"col-12 mb-3"},lt={class:"form-check"},nt=e("label",{class:"form-check-label",for:"need_prepayment"}," Необходима предоплата ",-1),it={class:"row"},at={class:"col-12"},dt={type:"submit",class:"btn btn-outline-success w-100 p-3"},rt={key:0},ct={key:1},ut={props:["eventId","bot","service"],data(){return{load:!1,need_reset:!1,need_images:!1,categories:[],serviceForm:{id:null,title:null,appointment_event_id:null,description:null,category:null,images:[],need_prepayment:!1,price:0,discount_price:0}}},watch:{serviceForm:{handler(o){this.need_reset=!0},deep:!0}},mounted(){this.loadAppointmentServiceCategories(),console.log("Service form",this.service),this.service&&this.$nextTick(()=>{this.serviceForm={id:this.service.id||null,appointment_event_id:this.service.appointment_event_id||null,title:this.service.title||null,category:this.service.category||null,description:this.service.description||null,images:this.service.images||[],need_prepayment:this.service.need_prepayment||!1,price:this.service.price||0,discount_price:this.service.discount_price||0}})},methods:{loadAppointmentServiceCategories(){this.$store.dispatch("loadAppointmentServiceCategories",{dataObject:{bot_id:this.bot.id||null,event_id:this.eventId||null}}).then(o=>{this.categories=o})},selectPhotos(o){this.serviceForm.images||(this.serviceForm.images=[]);let t=this.serviceForm.images.indexOf(o.file_id);t!==-1?this.serviceForm.images.splice(t,1):this.serviceForm.images.push(o.file_id)},resetForm(){},submitForm(){let o=new FormData;Object.keys(this.serviceForm).forEach(t=>{const s=this.serviceForm[t]||"";typeof s=="object"?o.append(t,JSON.stringify(s)):o.append(t,s)}),o.append("bot_id",this.bot.id),o.append("appointment_event_id",this.eventId),this.$store.dispatch(this.serviceForm.id===null?"addAppointmentService":"updateAppointmentService",{appointmentServiceForm:o}).then(t=>{this.$emit("callback",t.data),this.$notify("Услуги успешно создано")}).catch(t=>{this.$notify("Услуги создания события")})}}},mt=Object.assign(ut,{__name:"AppointmentServiceForm",setup(o){return(t,s)=>{const a=q("Popper");return l(),n("form",{onSubmit:s[7]||(s[7]=S((...i)=>t.submitForm&&t.submitForm(...i),["prevent"]))},[e("div",Fe,[e("div",Ce,[e("label",we,[g(a,{content:"Название оказываемой услуги"},{default:b(()=>[Se]),_:1}),m(" Название услуги "),je]),c(e("input",{type:"text",class:"form-control",placeholder:"Название","aria-label":"Название","onUpdate:modelValue":s[0]||(s[0]=i=>t.serviceForm.title=i),maxlength:"255","aria-describedby":"service-title",required:""},null,512),[[_,t.serviceForm.title]])]),e("div",qe,[t.categories?(l(),n("p",ze,[m(" Ранее созданные категории: "),(l(!0),n(v,null,$(t.categories,i=>(l(),n("span",{onClick:d=>t.serviceForm.category=i,class:"badge bg-primary mr-1 cursor-pointer"},u(i),9,Ve))),256))])):r("",!0),e("label",Pe,[g(a,null,{content:b(()=>[Ue]),default:b(()=>[Oe]),_:1}),m(" Категория услуги "),Ae]),c(e("input",{type:"text",class:"form-control",placeholder:"Категория услуги","aria-label":"Категория услуги","onUpdate:modelValue":s[1]||(s[1]=i=>t.serviceForm.category=i),maxlength:"255","aria-describedby":"service-category",required:""},null,512),[[_,t.serviceForm.category]])]),e("div",Qe,[e("label",Ie,[g(a,null,{content:b(()=>[Be]),default:b(()=>[Te]),_:1}),m(" Описание услуги "),Re,t.serviceForm.description?(l(),n("small",Me," Длина текста "+u(t.serviceForm.description.length)+" / 255",1)):r("",!0)]),c(e("textarea",{type:"text",class:"form-control",placeholder:"Описание услуги","aria-label":"Описание услуги",maxlength:"255","onUpdate:modelValue":s[2]||(s[2]=i=>t.serviceForm.description=i),"aria-describedby":"service-description",required:""},`
                    `,512),[[_,t.serviceForm.description]])]),e("div",De,[e("label",Ee,[g(a,{content:"Цена оказываемой услуги"},{default:b(()=>[Le]),_:1}),m(" Цена услуги, руб "),Ke]),c(e("input",{type:"number",class:"form-control",placeholder:"Цена","aria-label":"Цена",min:"0","onUpdate:modelValue":s[3]||(s[3]=i=>t.serviceForm.price=i),"aria-describedby":"price",required:""},null,512),[[_,t.serviceForm.price]])]),e("div",Ne,[e("label",Je,[g(a,{content:"Цена скидки на оказываемую услугу"},{default:b(()=>[Ye]),_:1}),m(" Цена скидки на услугу, руб "),Ge]),c(e("input",{type:"number",class:"form-control",placeholder:"Цена","aria-label":"Цена",min:"0","onUpdate:modelValue":s[4]||(s[4]=i=>t.serviceForm.discount_price=i),"aria-describedby":"price",required:""},null,512),[[_,t.serviceForm.discount_price]])]),e("div",He,[e("div",We,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[5]||(s[5]=i=>t.need_images=i),type:"checkbox",id:"need_images"},null,512),[[k,t.need_images]]),Xe])]),t.need_images?(l(),n("div",Ze,[e("label",xe,[g(a,null,{content:b(()=>[tt]),default:b(()=>[et]),_:1}),m(" Изображение к услуге "),st]),g(V,{"need-photo":!0,selected:t.serviceForm.images,onSelect:t.selectPhotos},null,8,["selected","onSelect"])])):r("",!0),e("div",ot,[e("div",lt,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[6]||(s[6]=i=>t.serviceForm.need_prepayment=i),type:"checkbox",id:"need_prepayment"},null,512),[[k,t.serviceForm.need_prepayment]]),nt])])]),e("div",it,[e("div",at,[e("button",dt,[t.serviceForm.id===null?(l(),n("span",rt,"Создать услугу")):(l(),n("span",ct,"Обновить услугу"))])])])],32)}}}),ht={props:["param"],data(){return{expressions:[{expression:"{{userName}}",description:"Имя пользователя"},{expression:"{{telegramChatId}}",description:"Идентификатор чата"},{expression:"{{referralLink}}",description:"Реферальная ссылка"},{expression:"{{referralQr}}",description:"Реферальный QR-код"}]}},methods:{expressionsSelect(o){this.$emit("callback",{param:this.param,text:o.expression})}}},_t={class:"dropdown"},pt=e("button",{class:"btn btn-link dropdown-toggle",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-brands fa-hire-a-helper"})],-1),bt={class:"dropdown-menu item-with-text cursor-pointer text-muted p-2"},ft=["onClick"];function gt(o,t,s,a,i,d){return l(),n("div",_t,[pt,e("div",bt,[e("li",null,[(l(!0),n(v,null,$(i.expressions,h=>(l(),n("a",{class:"dropdown-item",onClick:p=>d.expressionsSelect(h)},u(h.description||"-"),9,ft))),256))])])])}const vt=O(ht,[["render",gt]]),yt={key:0,class:"row"},$t={class:"col-12"},kt={class:"form-floating mb-3"},Ft=e("label",{for:"floatingInput"},"Быстрый поиск команды",-1),Ct={class:"col-12 mb-2"},wt={class:"form-check"},St={class:"form-check-label",for:"need_global"},jt={key:0},qt={key:1},zt={class:"form-check"},Vt=e("label",{class:"form-check-label",for:"need_show_deleted"}," Удаленные ",-1),Pt={key:0,class:"mb-3 col-12 col-sm-12"},Ot={class:"table"},Ut=e("thead",null,[e("tr",null,[e("th",{scope:"col"},"#"),e("th",{scope:"col"},"Команда"),e("th",{scope:"col"},"Пояснение")])],-1),At=["onClick"],Qt={key:2,class:"mb-3 col-md-12"},It=e("div",{class:"alert alert-danger",role:"alert"}," У Вас еще нет добавленных скриптов! ",-1),Tt=[It],Bt={props:["command","canSelect"],data(){return{bot:null,load:!1,need_global:!0,need_show_deleted:!0,slugs:[],ownSearch:null,paginate:[]}},watch:{ownSearch:function(o,t){this.loadSlugs()},need_global:function(o,t){this.loadSlugs()},need_show_deleted:function(o,t){this.loadSlugs()}},computed:{...w(["getCurrentBot","getSlugs","getSlugsPaginateObject"])},mounted(){this.loadCurrentBot().then(()=>{this.loadSlugs()})},methods:{nextSlugs(o){this.loadSlugs(o)},loadSlugs(o=0){return this.$store.dispatch("loadSlugs",{dataObject:{botId:this.bot.id,needGlobal:this.need_global,needDeleted:this.need_show_deleted,search:this.ownSearch},page:o}).then(t=>{this.slugs=this.getSlugs,this.paginate=this.getSlugsPaginateObject})},loadCurrentBot(o=null){return this.$store.dispatch("updateCurrentBot",{bot:o}).then(()=>{this.bot=this.getCurrentBot})},callbackSlugs(){this.loadSlugs()},selectSlug(o){this.$emit("select",o)}}},Rt=Object.assign(Bt,{__name:"BotSlugSimpleTableList",setup(o){return(t,s)=>t.bot?(l(),n("div",yt,[e("div",$t,[e("div",kt,[c(e("input",{type:"search","onUpdate:modelValue":s[0]||(s[0]=a=>t.ownSearch=a),class:"form-control",id:"floatingInput",placeholder:"name@example.com"},null,512),[[_,t.ownSearch]]),Ft])]),e("div",Ct,[e("div",wt,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[1]||(s[1]=a=>t.need_global=a),type:"checkbox",id:"need_global"},null,512),[[k,t.need_global]]),e("label",St,[t.need_global?(l(),n("span",jt,"Глобальные")):(l(),n("span",qt,"Локальные"))])]),e("div",zt,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[2]||(s[2]=a=>t.need_show_deleted=a),type:"checkbox",id:"need_show_deleted"},null,512),[[k,t.need_show_deleted]]),Vt])]),t.slugs?(l(),n("div",Pt,[e("table",Ot,[Ut,e("tbody",null,[(l(!0),n(v,null,$(t.slugs,(a,i)=>(l(),n("tr",{class:f({"border-info":a.deleted_at==null,"border-danger":a.deleted_at!=null})},[e("th",{scope:"row",class:f({"text-danger":a.deleted_at!=null})},u(a.id||"Нет идентификатора"),3),e("td",{onClick:d=>t.selectSlug(a),class:f({"text-danger":a.deleted_at!=null})},u(a.command||"Нет команды"),11,At),e("td",{class:f({"text-danger":a.deleted_at!=null})},u(a.comment||"Пояснение не указано"),3)],2))),256))])])])):r("",!0),t.paginate?(l(),y(j,{key:1,onPagination_page:t.nextSlugs,pagination:t.paginate},null,8,["onPagination_page","pagination"])):r("",!0),t.slugs.length===0?(l(),n("div",Qt,Tt)):r("",!0)])):r("",!0)}}),Mt={class:"form-floating mb-3"},Dt=e("label",{for:"floatingInput"},"Команда",-1),Et={class:"form-floating mb-3"},Lt=e("label",{for:"floatingInput"},"Мнемоническое имя",-1),Kt={class:"form-floating mb-3"},Nt=e("label",{for:"floatingInput"},"Описание скрипта",-1),Jt=e("h6",null," Параметры скрипта ",-1),Yt=e("div",{class:"alert alert-info",role:"alert"}," Данные параметры используются для настройки скриптов на стороне сервера ",-1),Gt={class:"dropdown"},Ht=e("button",{class:"btn btn-outline-info w-100 dropdown-toggle mb-2",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"}," Добавить ",-1),Wt={class:"dropdown-menu w-100"},Xt=["onClick"],Zt={class:"row"},xt={class:"col-12"},es=["onClick"],ts={key:0},ss=e("i",{class:"fa-solid fa-rotate mr-2"},null,-1),os={key:0,class:"row"},ls={class:"col-12"},ns={class:"table"},is=e("thead",null,[e("tr",null,[e("th",{scope:"col"},"Ключ"),e("th",{scope:"col"},"Значение")])],-1),as={colspan:"2"},ds={class:"w-100 d-flex align-items-center justify-content-between"},rs={class:"dropdown mr-2"},cs=e("button",{class:"btn btn-outline-primary",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-solid fa-bars"})],-1),us={class:"dropdown-menu"},ms=["onClick"],hs=e("i",{class:"fa-solid fa-trash-can"},null,-1),_s=["onClick"],ps=e("i",{class:"fa-solid fa-caret-left"},null,-1),bs=["onClick"],fs=e("i",{class:"fa-solid fa-caret-right"},null,-1),gs=["innerHTML"],vs={key:1,class:"mb-0 font-bold"},ys={class:"dropdown"},$s={class:"btn btn-outline-primary dropdown-toggle w-100 d-flex justify-content-between align-items-center",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},ks={class:"dropdown-menu"},Fs=["onClick"],Cs={style:{width:"300px"}},ws={class:"form-floating"},Ss=["onUpdate:modelValue","id"],js=["for"],qs={key:0,class:"form-floating"},zs=["id","onUpdate:modelValue"],Vs=["for"],Ps={key:1,class:"form-check"},Os=["onUpdate:modelValue","id"],Us=["for"],As={key:2,class:"form-floating"},Qs=["onUpdate:modelValue","id"],Is=["for"],Ts=["onClick"],Bs={key:0,class:"fa-solid fa-eye mr-2"},Rs={key:1,class:"fa-solid fa-eye-slash mr-2"},Ms={key:2},Ds={key:3},Es=["onClick"],Ls={key:0,class:"fa-solid fa-eye mr-2"},Ks={key:1,class:"fa-solid fa-eye-slash mr-2"},Ns={key:2},Js={key:3},Ys={key:5,class:"form-floating"},Gs=["onUpdate:modelValue","id"],Hs=["for"],Ws=["onClick"],Xs={key:0,class:"fa-solid fa-eye mr-2"},Zs={key:1,class:"fa-solid fa-eye-slash mr-2"},xs={key:2},eo={key:3},to={key:7,class:"form-check"},so=["onUpdate:modelValue","id"],oo=["for"],lo={key:8,class:"form-floating"},no=["id","onUpdate:modelValue"],io=["for"],ao=["onClick"],ro={key:0,class:"fa-solid fa-eye mr-2"},co={key:1,class:"fa-solid fa-eye-slash mr-2"},uo={key:2},mo={key:3},ho={colspan:"2"},_o={key:0,class:"form-floating mb-3"},po=["id","onUpdate:modelValue"],bo=["for"],fo={key:1,class:"form-floating"},go=e("label",{class:"form-label",id:"bot-domain"},"JSON-код",-1),vo={key:2,class:"form-floating"},yo=["onUpdate:modelValue","id"],$o=["for"],ko={key:3,class:"form-floating"},Fo=["onUpdate:modelValue","id"],Co=["for"],wo={key:1,class:"row"},So=e("div",{class:"col-12"},[e("p",null,"Параметры скрипта еще не добавлены")],-1),jo=[So],qo={class:"btn btn-primary text-white w-100 mt-2 p-3"},zo={key:0},Vo={key:1},Po={props:["item"],components:{Vue3JsonEditor:se},data(){return{filters:[],simple:!0,configTypes:[{title:"Текстовый или числовой параметр",type:"text"},{title:"Большое текстовое поле",type:"large-text"},{title:"Канал обратной связи",type:"channel"},{title:"Логический оператор",type:"boolean"},{title:"Ссылка на изображение",type:"image"},{title:"Цвет",type:"color"},{title:"Geo",type:"geo"},{title:"Номер телефона",type:"phone"},{title:"ID скрипта",type:"script"},{title:"ID страницы",type:"page"},{title:"JSON",type:"json"}],bot:null,photos:[],slugForm:{bot_id:null,id:null,command:null,comment:null,slug:null,parent_id:null,config:[],is_global:!0}}},computed:{...w(["getCurrentBot"]),filteredConfigs(){return this.filters.length==0?this.slugForm.config:this.slugForm.config.filter(o=>this.filters.indexOf(o.type)>=0)}},mounted(){this.loadCurrentBot(),this.item&&(this.slugForm.id=this.item.id||null,this.slugForm.command=this.item.command,this.slugForm.comment=this.item.comment,this.slugForm.bot_id=this.item.bot_id,this.slugForm.slug=this.item.slug,this.slugForm.parent_id=this.item.parent_id||null,this.slugForm.config=this.item.config||[],this.slugForm.is_global=this.item.is_global||!1)},methods:{loadSlugParentParams(){this.$store.dispatch("loadSlugParams",{parentSlugId:this.slugForm.parent_id}).then(o=>{let t=o.config,s=0;t.forEach(a=>{this.slugForm.config.findIndex(d=>d.key===a.key)===-1&&(s++,this.slugForm.config.unshift(a))}),this.$notify({title:"Конструктор команд",text:`Параметры успешно подгружены: Обновлено ${s} параметров`,type:"success"})})},toggleFilter(o){let t=this.filters.indexOf(o);t>=0?this.filters.splice(t,1):this.filters.push(o)},addTextTo(o,t={text:null}){this.slugForm.config[o].value=t.text},loadCurrentBot(o=null){return this.$store.dispatch("updateCurrentBot",{bot:o}).then(()=>{this.bot=this.getCurrentBot})},submit(){let o=new FormData;Object.keys(this.slugForm).forEach(t=>{const s=this.slugForm[t]||"";typeof s=="object"?o.append(t,JSON.stringify(s)):o.append(t,s)}),this.$store.dispatch(this.slugForm.id===null?"createSlug":"updateSlug",{slugForm:o}).then(t=>{this.$notify({title:"Конструктор команд",text:"Команда успешно обновлена",type:"success"}),this.slugForm.id===null&&(this.slugForm.id=null,this.slugForm.command=null,this.slugForm.comment=null,this.slugForm.bot_id=null,this.slugForm.slug=null,this.slugForm.config=[],this.slugForm.is_global=!0),this.$emit("callback")}).catch(t=>{})},onJsonChange(o,t){this.filteredConfigs[t].value=o},addConfig(o){this.slugForm.config.splice(0,0,{key:null,value:null,type:o||"text"})},move(o,t=0){let s=this.slugForm.config[o],a=this.slugForm.config.length||0,i=t===0?o-1>=0?o-1:a-1:o<a-1?o+1:0;this.slugForm.config[o]=this.slugForm.config[i],this.slugForm.config[i]=s},removeConfigItem(o){try{this.slugForm.config.splice(o,1)}catch{this.slugForm.config=[]}},selectSlug(o,t){this.filteredConfigs[t].value=o.id},selectPhoto(o,t){this.filteredConfigs[t].value=o.file_id}}},Oo=Object.assign(Po,{__name:"SlugTableForm",setup(o){return(t,s)=>{const a=A("mask");return l(),n("form",{onSubmit:s[4]||(s[4]=S((...i)=>t.submit&&t.submit(...i),["prevent"]))},[e("div",Mt,[c(e("input",{type:"text","onUpdate:modelValue":s[0]||(s[0]=i=>t.slugForm.command=i),class:"form-control",id:"floatingInput",placeholder:"name@example.com",required:""},null,512),[[_,t.slugForm.command]]),Dt]),e("div",Et,[c(e("input",{type:"text","onUpdate:modelValue":s[1]||(s[1]=i=>t.slugForm.slug=i),class:"form-control",id:"floatingInput",placeholder:"name@example.com",required:""},null,512),[[_,t.slugForm.slug]]),Lt]),e("div",Kt,[c(e("input",{type:"text","onUpdate:modelValue":s[2]||(s[2]=i=>t.slugForm.comment=i),class:"form-control",id:"floatingInput",placeholder:"name@example.com",required:""},null,512),[[_,t.slugForm.comment]]),Nt]),Jt,Yt,e("div",Gt,[Ht,e("ul",Wt,[(l(!0),n(v,null,$(t.configTypes,(i,d)=>(l(),n("li",null,[e("a",{class:"dropdown-item",onClick:h=>t.addConfig(i.type)},u(i.title||"Не установлен"),9,Xt)]))),256))])]),e("div",Zt,[e("div",xt,[e("p",null,[m("Фильтры: "),(l(!0),n(v,null,$(t.configTypes,(i,d)=>(l(),n("span",{class:f(["badge mb-1 bg-gray-100 cursor-pointer mr-1",{"bg-info":t.filters.indexOf(i.type)>=0}]),onClick:h=>t.toggleFilter(i.type)},u(i.type),11,es))),256))]),t.slugForm.parent_id?(l(),n("p",ts,"Вы можете подгрузить отсутствующие параметры конфигурации")):r("",!0),t.slugForm.parent_id?(l(),n("button",{key:1,type:"button",onClick:s[3]||(s[3]=(...i)=>t.loadSlugParentParams&&t.loadSlugParentParams(...i)),class:"btn btn-outline-info"},[ss,m("Загрузить ")])):r("",!0)])]),t.filteredConfigs.length>0?(l(),n("div",os,[e("div",ls,[e("table",ns,[is,e("tbody",null,[(l(!0),n(v,null,$(t.filteredConfigs,(i,d)=>(l(),n(v,null,[e("tr",{class:f({"table-light":d%2===0})},[e("td",as,[e("div",ds,[e("div",rs,[cs,e("ul",us,[e("li",null,[e("a",{class:"dropdown-item",onClick:h=>t.removeConfigItem(d),href:"javascript:void(0)"},[hs,m(" Удалить")],8,ms)]),e("li",null,[e("a",{class:"dropdown-item",onClick:h=>t.move(d,0),href:"javascript:void(0)"},[ps,m(" Вверх")],8,_s)]),e("li",null,[e("a",{class:"dropdown-item",onClick:h=>t.move(d,1),href:"javascript:void(0)"},[fs,m(" Вниз")],8,bs)])])]),t.filteredConfigs[d].description?(l(),n("p",{key:0,class:"mb-0 font-italic font-bold",innerHTML:t.filteredConfigs[d].description},null,8,gs)):(l(),n("p",vs,"без описания")),e("div",ys,[e("button",$s,u(t.filteredConfigs[d].type),1),e("ul",ks,[(l(!0),n(v,null,$(t.configTypes,h=>(l(),n("li",null,[e("a",{class:"dropdown-item",onClick:p=>t.filteredConfigs[d].type=h.type},u(h.title||i.type),9,Fs)]))),256))])])])])],2),e("tr",{class:f({"table-light":d%2===0})},[e("td",Cs,[e("div",ws,[c(e("input",{type:"text",class:"form-control","onUpdate:modelValue":h=>t.filteredConfigs[d].key=h,id:"field-input-key-"+d,placeholder:"name@example.com"},null,8,Ss),[[_,t.filteredConfigs[d].key]]),e("label",{for:"field-input-key-"+d},"Ключ",8,js)])]),e("td",null,[t.filteredConfigs[d].type==="text"||t.filteredConfigs[d].type==="channel"?(l(),n("div",qs,[c(e("input",{type:"text",class:"form-control",id:"field-input-"+d,"onUpdate:modelValue":h=>t.filteredConfigs[d].value=h,placeholder:"name@example.com"},null,8,zs),[[_,t.filteredConfigs[d].value]]),e("label",{for:"field-input-"+d},"Значение",8,Vs)])):r("",!0),t.filteredConfigs[d].type==="boolean"?(l(),n("div",Ps,[c(e("input",{class:"form-check-input","onUpdate:modelValue":h=>t.filteredConfigs[d].value=h,type:"checkbox",value:"false",id:"filtered-config-"+d+"-checkbox"},null,8,Os),[[k,t.filteredConfigs[d].value]]),e("label",{class:"form-check-label",for:"filtered-config-"+d+"-checkbox"},u(t.filteredConfigs[d].value?"Истина":"Ложь"),9,Us)])):r("",!0),t.filteredConfigs[d].type==="geo"?(l(),n("div",As,[c(e("input",{class:"form-control",placeholder:"##.######,##.######","onUpdate:modelValue":h=>t.filteredConfigs[d].value=h,type:"text",id:"filtered-config-"+d+"-geo"},null,8,Qs),[[a,"##.######,##.######"],[_,t.filteredConfigs[d].value]]),e("label",{for:"filtered-config-"+d+"-geo"},"Значение",8,Is)])):r("",!0),t.filteredConfigs[d].type==="script"?(l(),n("button",{key:3,type:"button",class:"btn btn-outline-light text-primary w-100 py-3",onClick:h=>i.content_show=!i.content_show},[i.content_show?(l(),n("i",Rs)):(l(),n("i",Bs)),i.content_show?(l(),n("span",Ds,"Скрыть выбор скриптов")):(l(),n("span",Ms,"Показать выбор скриптов"))],8,Ts)):r("",!0),t.filteredConfigs[d].type==="page"?(l(),n("button",{key:4,type:"button",class:"btn btn-outline-light text-primary w-100 py-3",onClick:h=>i.content_show=!i.content_show},[i.content_show?(l(),n("i",Ks)):(l(),n("i",Ls)),i.content_show?(l(),n("span",Js,"Скрыть выбор страницы")):(l(),n("span",Ns,"Показать выбор страницы"))],8,Es)):r("",!0),t.filteredConfigs[d].type==="phone"?(l(),n("div",Ys,[c(e("input",{class:"form-control",placeholder:"+7(###)###-##-##","onUpdate:modelValue":h=>t.filteredConfigs[d].value=h,type:"text",id:"filtered-config-"+d+"-phone"},null,8,Gs),[[a,"+7(###)###-##-##"],[_,t.filteredConfigs[d].value]]),e("label",{for:"filtered-config-"+d+"-phone"},"Значение",8,Hs)])):r("",!0),t.filteredConfigs[d].type==="json"?(l(),n("button",{key:6,type:"button",class:"btn btn-outline-light text-primary w-100 py-3",onClick:h=>i.content_show=!i.content_show},[i.content_show?(l(),n("i",Zs)):(l(),n("i",Xs)),i.content_show?(l(),n("span",eo,"Скрыть редактор JSON")):(l(),n("span",xs,"Показать редактор JSON"))],8,Ws)):r("",!0),t.filteredConfigs[d].type==="color"?(l(),n("div",to,[c(e("input",{class:"form-control","onUpdate:modelValue":h=>t.filteredConfigs[d].value=h,type:"color",id:"filtered-config-"+d+"-color"},null,8,so),[[_,t.filteredConfigs[d].value]]),e("label",{for:"filtered-config-"+d+"-color"},[e("p",{style:ee({color:t.filteredConfigs[d].value})},"Цвет: "+u(t.filteredConfigs[d].value),5)],8,oo)])):r("",!0),t.filteredConfigs[d].type==="large-text"?(l(),n("div",lo,[c(e("textarea",{class:"form-control",id:"field-input-"+d,"onUpdate:modelValue":h=>t.filteredConfigs[d].value=h,placeholder:"name@example.com"},`
                            `,8,no),[[_,t.filteredConfigs[d].value]]),e("label",{for:"field-input-"+d},"Значение",8,io)])):r("",!0),t.filteredConfigs[d].type==="image"?(l(),n("button",{key:9,type:"button",class:"btn btn-outline-light text-primary w-100 py-3",onClick:h=>i.content_show=!i.content_show},[i.content_show?(l(),n("i",co)):(l(),n("i",ro)),i.content_show?(l(),n("span",mo,"Скрыть выбор изображений")):(l(),n("span",uo,"Показать выбор изображений"))],8,ao)):r("",!0)])],2),i.content_show?(l(),n("tr",{key:0,class:f({"table-light":d%2===0})},[e("td",ho,[t.filteredConfigs[d].type==="image"?(l(),n("div",_o,[c(e("input",{class:"form-control mb-2",id:"field-input-"+d,type:"text",disabled:"true","onUpdate:modelValue":h=>t.filteredConfigs[d].value=h,placeholder:"name@example.com"},null,8,po),[[_,t.filteredConfigs[d].value]]),e("label",{for:"field-input-"+d},"FileId ссылка на изображение",8,bo),g(V,{"need-video":!1,"need-photo":!0,selected:[t.filteredConfigs[d].value],onSelect:h=>t.selectPhoto(h,d)},null,8,["selected","onSelect"])])):r("",!0),t.filteredConfigs[d].type==="json"?(l(),n("div",fo,[go,g(M(se),{mode:"form",modelValue:t.filteredConfigs[d].value,"onUpdate:modelValue":h=>t.filteredConfigs[d].value=h,"show-btns":!1,expandedOnStart:!0,onJsonChange:h=>t.onJsonChange(h,d)},null,8,["modelValue","onUpdate:modelValue","onJsonChange"])])):r("",!0),t.filteredConfigs[d].type==="page"?(l(),n("div",vo,[c(e("input",{class:"form-control mb-2","onUpdate:modelValue":h=>t.filteredConfigs[d].value=h,type:"text",id:"filtered-config-"+d+"-script"},null,8,yo),[[_,t.filteredConfigs[d].value]]),e("label",{for:"filtered-config-"+d+"-script"},"Значение",8,$o),g(B,{onCallback:h=>t.selectSlug(h,d),editor:!1},null,8,["onCallback"])])):r("",!0),t.filteredConfigs[d].type==="script"?(l(),n("div",ko,[c(e("input",{class:"form-control mb-2","onUpdate:modelValue":h=>t.filteredConfigs[d].value=h,type:"text",id:"filtered-config-"+d+"-script"},null,8,Fo),[[_,t.filteredConfigs[d].value]]),e("label",{for:"filtered-config-"+d+"-script"},"Значение",8,Co),g(Rt,{onSelect:h=>t.selectSlug(h,d)},null,8,["onSelect"])])):r("",!0)])],2)):r("",!0)],64))),256))])])])])):(l(),n("div",wo,jo)),e("button",qo,[t.slugForm.id==null?(l(),n("span",zo," Сохранить команду ")):(l(),n("span",Vo," Обновить команду "))])],32)}}});const Uo={key:0,class:"row"},Ao={class:"col-12 mb-2"},Qo={key:0},Io=e("i",{class:"fa-solid fa-scroll"},null,-1),To={key:1},Bo=e("i",{class:"fa-regular fa-square-minus"},null,-1),Ro={key:0,class:"col-12"},Mo={class:"col-12"},Do={class:"form-floating mb-3"},Eo=e("label",{for:"floatingInput"},"Быстрый поиск команды",-1),Lo={class:"col-12 mb-2"},Ko={class:"form-check"},No={class:"form-check-label",for:"need_global"},Jo={key:0},Yo={key:1},Go={class:"form-check"},Ho=e("label",{class:"form-check-label",for:"need_show_deleted"}," Удаленные ",-1),Wo={key:1,class:"mb-3 col-12 col-sm-12"},Xo={class:"table"},Zo=e("thead",null,[e("tr",null,[e("th",{scope:"col"},"#"),e("th",{scope:"col"},"Команда"),e("th",{scope:"col"},"Пояснение"),e("th",{scope:"col"},"Глобальный"),e("th",{scope:"col"},"Действия")])],-1),xo=["onClick"],el={key:0},tl=e("i",{class:"fa-solid fa-check text-success"},null,-1),sl=[tl],ol={key:1},ll=e("i",{class:"fa-solid fa-xmark text-danger"},null,-1),nl=[ll],il={class:"dropdown"},al=e("button",{class:"btn btn-outline-secondary",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-solid fa-ellipsis"})],-1),dl={class:"dropdown-menu"},rl={key:0},cl=["onClick"],ul=e("i",{class:"fa-solid fa-arrow-left mr-1"},null,-1),ml={key:1},hl=["onClick"],_l=e("a",{class:"dropdown-item cursor-pointer","data-bs-toggle":"modal","data-bs-target":"#edit-table-slug"},[e("i",{class:"fa-regular fa-pen-to-square mr-1"}),m(" Редактировать")],-1),pl=[_l],bl=["onClick"],fl=e("i",{class:"fa-solid fa-clone mr-1"},null,-1),gl=["href"],vl=e("i",{class:"fa-regular fa-file-excel mr-1"},null,-1),yl={key:2},$l=["onClick"],kl=e("i",{class:"fa-regular fa-trash-can text-danger mr-1"},null,-1),Fl={key:3},Cl=["onClick"],wl=e("i",{class:"fa-regular fa-trash-can text-danger mr-1"},null,-1),Sl={key:3,class:"mb-3 col-md-12"},jl=e("div",{class:"alert alert-danger",role:"alert"}," У Вас еще нет добавленных скриптов! ",-1),ql=[jl],zl={class:"modal fade",id:"edit-table-slug",tabindex:"-1"},Vl={class:"modal-dialog modal-fullscreen"},Pl={key:0,class:"modal-content"},Ol={class:"modal-header"},Ul={class:"modal-title",id:"exampleModalLabel"},Al=e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),Ql={class:"modal-body"},Il={class:"row"},Tl={class:"col-12"},Bl=e("div",{class:"modal-footer"},[e("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Закрыть")],-1),Rl={props:["command","canSelect"],data(){return{bot:null,relocated_slug_id:null,need_global:!0,need_show_deleted:!0,show:!1,load:!1,slugs:[],paginate:[],selectedSlug:null,ownSearch:null,slugForm:{command:null,comment:null,slug:null}}},watch:{ownSearch:function(o,t){this.loadSlugs()},need_global:function(o,t){this.loadSlugs()},need_show_deleted:function(o,t){this.loadSlugs()}},computed:{...w(["getCurrentBot","getSlugs","getSlugsPaginateObject"])},mounted(){this.loadCurrentBot().then(()=>{this.loadSlugs(),this.command&&this.$nextTick(()=>{this.slugForm.command=this.command})})},methods:{nextSlugs(o){this.loadSlugs(o)},loadSlugs(o=0){return this.$store.dispatch("loadSlugs",{dataObject:{botId:this.bot.id,needGlobal:this.need_global,needDeleted:this.need_show_deleted,search:this.ownSearch},page:o}).then(t=>{this.slugs=this.getSlugs,this.paginate=this.getSlugsPaginateObject})},loadCurrentBot(o=null){return this.$store.dispatch("updateCurrentBot",{bot:o}).then(()=>{this.bot=this.getCurrentBot})},callbackSlugs(){this.loadSlugs()},selectSlug(o){this.load=!0,this.$nextTick(()=>{this.selectedSlug=o,this.load=!1}),this.$emit("select",o)},selectCard(){this.$emit("select",this.item)},slugFormCallback(){this.load=!0;const o=this.selectedSlug;this.loadSlugs().then(()=>{let t=this.slugs.find(s=>s.id===o.id);this.selectSlug(t||null)}),this.$emit("callback"),this.$nextTick(()=>{this.load=!1})},editSlug(){this.load=!0,this.$nextTick(()=>{this.load=!1})},duplicateSlug(o){this.load=!0,this.$store.dispatch("duplicateSlug",{dataObject:{slugId:o.id}}).then(t=>{this.$notify({title:"Конструктор команд",text:"Команда успешно продублирована",type:"success"}),this.$emit("callback"),this.$nextTick(()=>{this.load=!1})}).catch(t=>{this.$emit("callback"),this.$nextTick(()=>{this.load=!1})}),this.loadSlugs(),this.$emit("callback"),this.$nextTick(()=>{this.load=!1})},submitRelocateData(){this.$store.dispatch("relocateSlugActionData",{slug_sender_id:this.relocated_slug_id,slug_recipient_id:this.item.id,bot_id:this.bot.id}).then(o=>{this.$notify({title:"Конструктор команд",text:"Данные команды успешно перенесены",type:"success"})}).catch(o=>{this.$notify({title:"Конструктор команд",text:"Ошибка переноса данных",type:"error"})})},restoreSlug(o){this.load=!0,this.$store.dispatch("restoreSlug",{dataObject:{slugId:o.id}}).then(t=>{this.$notify({title:"Конструктор команд",text:"Команда успешно восстановлена",type:"success"}),this.loadSlugs(),this.$nextTick(()=>{this.load=!1})}).catch(t=>{this.$emit("callback"),this.$nextTick(()=>{this.load=!1})})},removeSlug(o){this.load=!0,this.$store.dispatch("removeSlug",{dataObject:{slugId:o.id}}).then(t=>{this.$notify({title:"Конструктор команд",text:"Команда успешно удалена",type:"success"}),this.loadSlugs()}).catch(t=>{this.$emit("callback"),this.$nextTick(()=>{this.load=!1})})}}},ne=Object.assign(Rl,{__name:"BotSlugTableList",setup(o){return(t,s)=>(l(),n(v,null,[t.bot?(l(),n("div",Uo,[e("div",Ao,[e("button",{type:"button",onClick:s[0]||(s[0]=a=>t.show=!t.show),class:"btn btn-outline-success p-3 w-100"},[t.show?(l(),n("span",To,[Bo,m(" Свернуть форму добавления")])):(l(),n("span",Qo,[Io,m(" Добавить глобальный скрипт")]))])]),t.show?(l(),n("div",Ro,[t.bot?(l(),y(Y,{key:0,"can-add":!0,bot:t.bot,onCallback:t.loadSlugs},null,8,["bot","onCallback"])):r("",!0)])):r("",!0),e("div",Mo,[e("div",Do,[c(e("input",{type:"search","onUpdate:modelValue":s[1]||(s[1]=a=>t.ownSearch=a),class:"form-control",id:"floatingInput",placeholder:"name@example.com"},null,512),[[_,t.ownSearch]]),Eo])]),e("div",Lo,[e("div",Ko,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[2]||(s[2]=a=>t.need_global=a),type:"checkbox",id:"need_global"},null,512),[[k,t.need_global]]),e("label",No,[t.need_global?(l(),n("span",Jo,"Глобальные")):(l(),n("span",Yo,"Локальные"))])]),e("div",Go,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[3]||(s[3]=a=>t.need_show_deleted=a),type:"checkbox",id:"need_show_deleted"},null,512),[[k,t.need_show_deleted]]),Ho])]),t.slugs&&t.bot?(l(),n("div",Wo,[e("table",Xo,[Zo,e("tbody",null,[(l(!0),n(v,null,$(t.slugs,(a,i)=>(l(),n("tr",{class:f({"border-info":a.deleted_at==null,"border-danger":a.deleted_at!=null})},[e("th",{scope:"row",class:f({"text-danger":a.deleted_at!=null})},u(a.id||"Нет идентификатора"),3),e("td",{onClick:d=>t.selectSlug(a),"data-bs-toggle":"modal","data-bs-target":"#edit-table-slug",class:f({"text-danger":a.deleted_at!=null})},u(a.command||"Нет команды"),11,xo),e("td",{class:f({"text-danger":a.deleted_at!=null})},u(a.comment||"Пояснение не указано"),3),e("td",null,[a.is_global?(l(),n("span",el,sl)):(l(),n("span",ol,nl))]),e("td",null,[e("div",il,[al,e("ul",dl,[o.canSelect?(l(),n("li",rl,[e("a",{onClick:d=>t.selectSlug(a),title:"Выбрать команду",class:"dropdown-item cursor-pointer"},[ul,m(" Выбрать команду ")],8,cl)])):r("",!0),o.canSelect?(l(),n("hr",ml)):r("",!0),e("li",{onClick:d=>t.selectSlug(a)},pl,8,hl),e("li",null,[e("a",{class:"dropdown-item cursor-pointer",onClick:d=>t.duplicateSlug(a)},[fl,m(" Дублировать")],8,bl)]),e("li",null,[e("a",{class:"dropdown-item cursor-pointer",target:"_blank",href:"/admin/slugs/action-data-export/"+a.id},[vl,m(" Скачать данные участников")],8,gl)]),a.deleted_at==null?(l(),n("li",yl,[e("a",{class:"dropdown-item cursor-pointer",onClick:d=>t.removeSlug(a)},[kl,m(" Удалить")],8,$l)])):r("",!0),a.deleted_at!=null?(l(),n("li",Fl,[e("a",{class:"dropdown-item cursor-pointer",onClick:d=>t.restoreSlug(a)},[wl,m(" Восстановить")],8,Cl)])):r("",!0)])])])],2))),256))])])])):r("",!0),t.paginate?(l(),y(j,{key:2,onPagination_page:t.nextSlugs,pagination:t.paginate},null,8,["onPagination_page","pagination"])):r("",!0),t.slugs.length===0?(l(),n("div",Sl,ql)):r("",!0)])):r("",!0),e("div",zl,[e("div",Vl,[t.selectedSlug&&!t.load?(l(),n("div",Pl,[e("div",Ol,[e("h5",Ul,[m("Редактирование команды #"),e("span",null,u(t.selectedSlug.id),1)]),Al]),e("div",Ql,[e("div",Il,[e("div",Tl,[g(Oo,{item:t.selectedSlug,onCallback:t.slugFormCallback},null,8,["item","onCallback"])])])]),Bl])):r("",!0)])])],64))}});const Ml={props:["param"],data(){return{expressions:[{expression:null,description:"Нет проверки"},{expression:"/([a-z0-9]+)/i",description:"Проверка набора из латинских букв и цифр"},{expression:"/([а-яё0-9]+)/iu",description:"Проверка на кириллицу и цифры"},{expression:"/(?P<digit>\\d+)/",description:"Проверка на число"},{expression:"/^([a-z0-9_-]+.)*[a-z0-9_-]+@[a-z0-9_-]+(.[a-z0-9_-]+)*.[a-z]{2,6}$/",description:"Проверка Email"},{expression:"/^((8|+7)[- ]?)?((?d{3})?[- ]?)?[d- ]{7,10}$/",description:"Проверка номера телефона: +7(982)000-00-00"},{expression:"/^(0[1-9]|[12][0-9]|3[01])[.](0[1-9]|1[012])[.](19|20)dd$/",description:"Проверка даты по формату DD.MM.YYYY"},{expression:"/^[0-9]{4}-(0[1-9]|1[012])-(0[1-9]|1[0-9]|2[0-9]|3[01])$/",description:"Проверка даты по формату YYYY-MM-DD"},{expression:"/^(https?://)?([da-z.-]+).([a-z.]{2,6})([/w .-]*)*/?$/",description:"Проверка доменного имени"}]}},methods:{expressionsSelect(o){this.$emit("callback",{param:this.param,text:o.expression})}}},Dl={class:"dropdown"},El=e("button",{class:"btn btn-link dropdown-toggle",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-regular fa-registered"})],-1),Ll={class:"dropdown-menu item-with-text cursor-pointer text-muted p-2"},Kl=["onClick"];function Nl(o,t,s,a,i,d){return l(),n("div",Dl,[El,e("div",Ll,[e("li",null,[(l(!0),n(v,null,$(i.expressions,h=>(l(),n("a",{class:"dropdown-item",onClick:p=>d.expressionsSelect(h)},u(h.description||"-"),9,Kl))),256))])])])}const Jl=O(Ml,[["render",Nl]]),Yl={key:0,class:"mb-2 d-flex justify-content-start flex-wrap"},Gl=e("p",null,"Связь цепочек: ",-1),Hl=["onClick"],Wl={key:0,class:"fa-solid fa-arrow-right font-12"},Xl={class:"form-floating mb-2"},Zl=["id"],xl=["for"],en={class:"form-check mb-2"},tn=e("label",{class:"form-check-label",for:"need-empty-dialog"}," Диалог без ожидания ответа ",-1),sn={key:1,class:"form-floating mb-2"},on=["id"],ln=["for"],nn={key:2,class:"form-floating mb-2"},an=["id"],dn=["for"],rn={key:3,class:"mb-2"},cn={class:"d-flex justify-content-between"},un=["for"],mn=["id"],hn={class:"mb-2"},_n={class:"d-flex justify-content-between"},pn=["for"],bn=["id"],fn={class:"mb-2"},gn={class:"form-check"},vn=e("label",{class:"form-check-label",for:"need-dialog-image"}," В диалоге нужно изображение ",-1),yn={class:"form-check"},$n=e("label",{class:"form-check-label",for:"need-dialog-menu-inline"}," В диалоге нужно меню тексту ",-1),kn={class:"form-check"},Fn=e("label",{class:"form-check-label",for:"need-dialog-menu-reply"}," В диалоге нужно нижнее меню ",-1),Cn={key:4,class:"card mb-2"},wn={class:"card-body"},Sn=e("h6",null,"Фотографии к диалогу",-1),jn={class:"photo-preview d-flex justify-content-start flex-wrap w-100"},qn={for:"location-photos",style:{"margin-right":"10px"},class:"photo-loader ml-2"},zn=e("span",null,"+",-1),Vn={class:"mb-2 img-preview",style:{"margin-right":"10px"}},Pn={class:"remove"},On=["onClick"],Un={class:"mb-2 img-preview",style:{"margin-right":"10px"}},An={class:"remove"},Qn=["onClick"],In={key:5,class:"card mb-2"},Tn=e("div",{class:"card-header"},[e("h6",null,"Кнопки к тексту вопроса")],-1),Bn={class:"card-body"},Rn={key:6,class:"card mb-2"},Mn=e("div",{class:"card-header"},[e("h6",null,"Кнопки в виде нижнего меню")],-1),Dn={class:"card-body"},En={class:"mb-2"},Ln=e("label",{class:"form-check-label",for:"need-empty-dialog"}," Сохранить в переменную ",-1),Kn=e("option",{selected:""},"Не выбрано",-1),Nn=["value"],Jn={class:"form-check mb-2"},Yn=e("label",{class:"form-check-label",for:"need-chains"}," Нужны многоуровневые диалоги ",-1),Gn={key:7,class:"mb-2"},Hn={key:0,class:"table"},Wn=e("thead",null,[e("tr",null,[e("th",{scope:"col"},"#"),e("th",{scope:"col"},"Ответ"),e("th",{scope:"col"},"Паттерн"),e("th",{scope:"col"},"Следующий диалог"),e("th",{scope:"col",class:"text-center"},"Действие")])],-1),Xn={scope:"row"},Zn={class:"form-floating"},xn=["onUpdate:modelValue"],ei=e("label",{for:"floatingInput"},"Точный текст ответа",-1),ti={class:"input-group"},si={class:"form-floating"},oi=["onUpdate:modelValue"],li=e("label",{for:"floatingInput"},"Шаблон предполагаемого текста",-1),ni={class:"dropdown d-flex"},ii=e("button",{class:"btn btn-outline-secondary w-100",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-solid fa-up-right-and-down-left-from-center"})],-1),ai={class:"dropdown-menu"},di=["onClick"],ri=["onClick"],ci={class:"input-group"},ui={class:"form-floating"},mi=["onUpdate:modelValue"],hi=e("label",{for:"floatingInput"},"Выберите диалог или введите его номер",-1),_i={class:"dropdown d-flex"},pi=e("button",{class:"btn btn-outline-secondary w-100","data-bs-auto-close":"outside",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-solid fa-up-right-and-down-left-from-center"})],-1),bi={class:"dropdown-menu p-2",style:{width:"400px","max-height":"300px","overflow-y":"auto"}},fi={class:"list-group"},gi=["onClick"],vi=["onClick"],yi={class:"px-3 pt-2"},$i={class:"dropdown d-flex justify-content-center align-items-center"},ki=e("button",{class:"btn btn-link",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-solid fa-bars"})],-1),Fi={class:"dropdown-menu"},Ci=["onClick"],wi={key:1,class:"alert alert-primary mt-2",role:"alert"},Si={class:"form-check mb-2"},ji=e("label",{class:"form-check-label",for:"need-set-flags"}," Установить флаги в соответствующее значение ",-1),qi={key:8,class:"mb-2"},zi=e("p",null,"Выбрать флаги",-1),Vi=["onClick"],Pi={key:9,class:"mb-2"},Oi={key:0,class:"row"},Ui=e("div",{class:"col-12"},[e("p",null,"Доступные для связывания диалоги:")],-1),Ai={class:"col-md-12 mb-1"},Qi={type:"button",class:"btn btn-outline-primary w-100 d-flex justify-content-between align-items-center",style:{"text-align":"left"}},Ii=["onClick"],Ti={key:0,class:"fa-solid fa-link mr-2 text-success"},Bi={key:1,class:"row"},Ri=e("div",{class:"col-12"},[e("div",{class:"alert alert-danger",role:"alert"}," Диалогов для связывания нет ")],-1),Mi=[Ri],Di=e("hr",null,null,-1),Ei={class:"mb-2"},Li={type:"submit",class:"btn btn-outline-success p-3 w-100"},Ki={key:0},Ni={key:1},Ji={props:["item","bot"],data(){return{patterns:[{title:"Номер телефона РФ",value:"/^\\s?(\\+\\s?7|8)([- ()]*\\d){10}$/"},{title:"Дата в формате ДД/ММ/ГГГГ",value:"/(\\d{2})\\/(\\d{2})\\/(\\d{4})$/"},{title:"Время в формате ЧЧ:ММ[:СС]",value:"#^[01]?[0-9]|2[0-3]):[0-5][0-9](:[0-5][0-9])?$#"}],loading:!0,dialog_commands:[],dialog_commands_paginate_object:null,need_images:!1,need_inline_keyboard:!1,need_reply_keyboard:!1,need_chains:!1,need_set_flags:!1,flags_variants:[{title:"Является VIP",key:"is_vip",value:null},{title:"Является Админом",key:"is_admin",value:null},{title:"За работой",key:"is_work",value:null},{title:"Является менеджером",key:"is_manager",value:null}],store_variants:[{title:"Имя",key:"name"},{title:"Почта",key:"email"},{title:"Возраст",key:"age"},{title:"Город",key:"city"},{title:"Страна",key:"country"},{title:"Адрес",key:"address"},{title:"Телефон",key:"phone"},{title:"День рождение",key:"birthday"}],commandForm:{id:null,slug:null,pre_text:null,post_text:null,error_text:null,bot_id:null,input_pattern:null,inline_keyboard_id:null,reply_keyboard_id:null,images:null,next_bot_dialog_command_id:null,bot_dialog_group_id:null,is_empty:!1,result_flags:[],store_to:null,result_channel:null,inline_keyboard:null,reply_keyboard:null,answers:[]},photos:[]}},watch:{need_inline_keyboard:function(o,t){this.need_inline_keyboard||(this.commandForm.inline_keyboard_id=null,this.commandForm.inline_keyboard=null)},need_reply_keyboard:function(o,t){this.need_reply_keyboard||(this.commandForm.reply_keyboard_id=null,this.commandForm.reply_keyboard=null)},need_set_flags:function(o,t){this.need_set_flags||(this.commandForm.result_flags=[])},need_images:function(o,t){this.need_images||(this.commandForm.images=null)}},computed:{...w(["getDialogCommands","getDialogCommandsPaginateObject"]),filteredCommands(){return this.dialog_commands?this.dialog_commands.filter(o=>o.id!=this.commandForm.id):[]}},mounted(){this.item&&this.$nextTick(()=>{this.commandForm={id:this.item.id||null,slug:this.item.slug||null,pre_text:this.item.pre_text||null,post_text:this.item.post_text||null,error_text:this.item.error_text||null,is_empty:this.item.is_empty||!1,input_pattern:this.item.input_pattern||null,inline_keyboard_id:this.item.inline_keyboard_id||null,reply_keyboard_id:this.item.reply_keyboard_id||null,images:this.item.images||[],next_bot_dialog_command_id:this.item.next_bot_dialog_command_id||null,bot_dialog_group_id:this.item.bot_dialog_group_id||null,result_channel:this.item.result_channel||null,inline_keyboard:this.item.inline_keyboard||null,reply_keyboard:this.item.reply_keyboard||null,result_flags:this.item.result_flags||[],store_to:this.item.store_to||null,answers:this.item.answers||[]},this.bot&&(this.commandForm.bot_id=this.bot.id||null),this.commandForm.inline_keyboard_id!=null&&(this.need_inline_keyboard=!0),this.commandForm.reply_keyboard_id!=null&&(this.need_reply_keyboard=!0),this.commandForm.images.length>0&&(this.need_images=!0),this.commandForm.result_flags.length>0&&(this.need_set_flags=!0),this.commandForm.answers.length>0&&(this.need_chains=!0)}),this.bot&&this.$nextTick(()=>{this.commandForm.bot_id=this.bot.id}),this.item&&(this.dialog_commands=this.getDialogCommands,this.dialog_commands_paginate_object=this.getDialogCommandsPaginateObject)},methods:{addAnswer(){this.commandForm.answers.push({id:null,bot_dialog_command_id:null,answer:null,pattern:null,next_bot_dialog_command_id:null})},nextDialogs(o){this.loadDialogs(o)},removeDialogAnswer(o,t){if(o.id==null){this.commandForm.answers.splice(t,1);return}this.commandForm.answers.splice(t,1),this.loading=!0,this.$store.dispatch("removeDialogAnswer",{dataObject:{dialogAnswerId:o.id}}).then(s=>{this.loading=!1,this.loadDialogs()}).catch(()=>{this.loading=!1})},loadDialogs(o=0){this.loading=!0,this.$store.dispatch("loadDialogCommands",{dataObject:{botId:this.bot.id||null,search:this.search},page:o}).then(t=>{this.loading=!1,this.dialog_commands=this.getDialogCommands,this.dialog_commands_paginate_object=this.getDialogCommandsPaginateObject}).catch(()=>{this.loading=!1})},doCommandLink(o){this.loading=!0,this.commandForm.next_bot_dialog_command_id=o},submit(){this.loading=!0;let o=new FormData;if(Object.keys(this.commandForm).forEach(t=>{const s=this.commandForm[t]||"";typeof s=="object"?o.append(t,JSON.stringify(s)):o.append(t,s)}),this.photos){for(let t=0;t<this.photos.length;t++)o.append("files[]",this.photos[t]);o.delete("photos")}this.$store.dispatch(this.commandForm.id?"updateDialogCommand":"createDialogCommand",{dialogCommandForm:o}).then(t=>{this.loading=!1,this.$notify({title:"Конструктор ботов",text:"Успешная обработка диалоговой команды",type:"success"}),this.commandForm.id==null&&(this.commandForm={id:null,slug:null,pre_text:null,post_text:null,error_text:null,input_pattern:null,inline_keyboard_id:null,images:null,next_bot_dialog_command_id:null,bot_dialog_group_id:null,result_channel:null,inline_keyboard:null,is_empty:!1,result_flags:[],answers:[],store_to:null},this.photos=[]),this.$emit("callback")}).catch(t=>{this.loading=!1})},getPhoto(o){return{imageUrl:URL.createObjectURL(o)}},removePhoto(o,t){this[o].splice(t,1)},onChangePhotos(o){const t=o.target.files;for(let s=0;s<t.length;s++)this.photos.push(t[s])},saveInlineKeyboard(o){this.commandForm.inline_keyboard=o},saveReplyKeyboard(o){this.commandForm.reply_keyboard=o},addTextTo(o={param:null,text:null}){this.commandForm[o.param]=o.text},selectElementById(o){this.$emit("select-element",o)},selectFlag(o){(!this.commandForm.result_flags||!Array.isArray(this.commandForm.result_flags))&&(this.commandForm.result_flags=[]);let t=this.commandForm.result_flags.indexOf(o.key);t===-1?this.commandForm.result_flags.push(o.key):this.commandForm.result_flags.splice(t,1)}}},Yi=Object.assign(Ji,{__name:"BotDialogCommandForm",setup(o){return(t,s)=>{const a=A("lazy");return l(),n("form",{onSubmit:s[15]||(s[15]=S((...i)=>t.submit&&t.submit(...i),["prevent"]))},[t.commandForm.next_bot_dialog_command_id?(l(),n("div",Yl,[Gl,(l(!0),n(v,null,$(o.item.chain,(i,d)=>(l(),n("div",null,[e("span",{class:f(["badge cursor-pointer",{"bg-success":t.commandForm.id==i,"bg-primary":t.commandForm.id!=i}]),onClick:h=>t.selectElementById(i)},u(i),11,Hl),d<o.item.chain.length-1?(l(),n("i",Wl)):r("",!0)]))),256))])):r("",!0),e("div",Xl,[c(e("textarea",{class:"form-control",id:"commandForm-pre-text-"+t.commandForm.id,placeholder:"Начни с малого...","onUpdate:modelValue":s[0]||(s[0]=i=>t.commandForm.pre_text=i),required:""},`
            `,8,Zl),[[_,t.commandForm.pre_text]]),e("label",{for:"commandForm-pre-text-"+t.commandForm.id},"Текст диалога",8,xl)]),e("div",en,[c(e("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":s[1]||(s[1]=i=>t.commandForm.is_empty=i),id:"need-empty-dialog",checked:""},null,512),[[k,t.commandForm.is_empty]]),tn]),t.commandForm.is_empty?r("",!0):(l(),n("div",sn,[c(e("textarea",{class:"form-control",id:"commandForm-post-text-"+t.commandForm.id,placeholder:"Начни с малого...","onUpdate:modelValue":s[2]||(s[2]=i=>t.commandForm.post_text=i)},`
            `,8,on),[[_,t.commandForm.post_text]]),e("label",{for:"commandForm-post-text-"+t.commandForm.id},"Текст после успешного завершения диалога",8,ln)])),t.commandForm.is_empty?r("",!0):(l(),n("div",nn,[c(e("textarea",{type:"text",class:"form-control",id:"commandForm-error-text-"+t.commandForm.id,placeholder:"Начни с малого...","onUpdate:modelValue":s[3]||(s[3]=i=>t.commandForm.error_text=i)},`
            `,8,an),[[_,t.commandForm.error_text]]),e("label",{for:"commandForm-error-text-"+t.commandForm.id},"Текст на случай ошибки корректности данных",8,dn)])),t.commandForm.is_empty?r("",!0):(l(),n("div",rn,[e("div",cn,[e("label",{class:"form-label",for:"commandForm-result-channel-"+t.commandForm.id},"Регулярное выражение для валидации данных ",8,un),g(Jl,{param:"input_pattern",onCallback:t.addTextTo},null,8,["onCallback"])]),c(e("input",{type:"text",class:"form-control",placeholder:"Регулярное выражение","aria-label":"Регулярное выражение","onUpdate:modelValue":s[4]||(s[4]=i=>t.commandForm.input_pattern=i),maxlength:"255",id:"commandForm-input-pattern-"+t.commandForm.id,"aria-describedby":"commandForm-input-pattern"},null,8,mn),[[_,t.commandForm.input_pattern]])])),e("div",hn,[e("div",_n,[e("label",{class:"form-label",for:"commandForm-result-channel-"+t.commandForm.id},"Канал для отправки данных ",8,pn),o.bot?(l(),y(te,{key:0,token:o.bot.bot_token,param:"result_channel",onCallback:t.addTextTo},null,8,["token","onCallback"])):r("",!0)]),c(e("input",{type:"number",class:"form-control",placeholder:"id канала","aria-label":"id канала","onUpdate:modelValue":s[5]||(s[5]=i=>t.commandForm.result_channel=i),id:"commandForm-result-channel-"+t.commandForm.id,"aria-describedby":"bot-order-channel"},null,8,bn),[[_,t.commandForm.result_channel]])]),e("div",fn,[e("div",gn,[c(e("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":s[6]||(s[6]=i=>t.need_images=i),id:"need-dialog-image",checked:""},null,512),[[k,t.need_images]]),vn]),e("div",yn,[c(e("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":s[7]||(s[7]=i=>t.need_inline_keyboard=i),id:"need-dialog-menu-inline",checked:""},null,512),[[k,t.need_inline_keyboard]]),$n]),e("div",kn,[c(e("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":s[8]||(s[8]=i=>t.need_reply_keyboard=i),id:"need-dialog-menu-reply",checked:""},null,512),[[k,t.need_reply_keyboard]]),Fn])]),t.need_images?(l(),n("div",Cn,[e("div",wn,[Sn,e("div",jn,[e("label",qn,[zn,e("input",{type:"file",id:"location-photos",multiple:"",accept:"image/*",onChange:s[9]||(s[9]=(...i)=>t.onChangePhotos&&t.onChangePhotos(...i)),style:{display:"none"}},null,32)]),t.photos.length>0?(l(!0),n(v,{key:0},$(t.photos,(i,d)=>(l(),n("div",Vn,[c(e("img",null,null,512),[[a,t.getPhoto(i).imageUrl]]),e("div",Pn,[e("a",{onClick:h=>t.removePhoto("photos",d)},"Удалить",8,On)])]))),256)):r("",!0),t.commandForm.images&&o.bot?(l(!0),n(v,{key:1},$(t.commandForm.images,(i,d)=>(l(),n("div",Un,[c(e("img",null,null,512),[[a,"/images-by-bot-id/"+o.bot.id+"/"+i]]),e("div",An,[e("a",{onClick:h=>t.removePhoto("images",d)},"Удалить",8,Qn)])]))),256)):r("",!0)])])])):r("",!0),t.need_inline_keyboard?(l(),n("div",In,[Tn,e("div",Bn,[g(Q,{type:"inline",onSave:t.saveInlineKeyboard,"edited-keyboard":t.commandForm.inline_keyboard},null,8,["onSave","edited-keyboard"])])])):r("",!0),t.need_reply_keyboard?(l(),n("div",Rn,[Mn,e("div",Dn,[g(Q,{type:"reply",onSave:t.saveReplyKeyboard,"edited-keyboard":t.commandForm.reply_keyboard},null,8,["onSave","edited-keyboard"])])])):r("",!0),e("div",En,[Ln,c(e("select",{class:"form-control","onUpdate:modelValue":s[10]||(s[10]=i=>t.commandForm.store_to=i)},[Kn,(l(!0),n(v,null,$(t.store_variants,i=>(l(),n("option",{value:i.key},u(i.title||"Не указано"),9,Nn))),256))],512),[[T,t.commandForm.store_to]])]),e("div",Jn,[c(e("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":s[11]||(s[11]=i=>t.need_chains=i),id:"need-chains",checked:""},null,512),[[k,t.need_chains]]),Yn]),t.need_chains?(l(),n("div",Gn,[e("button",{type:"button",class:"btn btn-outline-primary",onClick:s[12]||(s[12]=(...i)=>t.addAnswer&&t.addAnswer(...i))},"Добавить вариант ответа"),t.commandForm.answers.length>0?(l(),n("table",Hn,[Wn,e("tbody",null,[(l(!0),n(v,null,$(t.commandForm.answers,(i,d)=>(l(),n("tr",null,[e("th",Xn,u(d+1),1),e("td",null,[e("div",Zn,[c(e("input",{type:"text","onUpdate:modelValue":h=>t.commandForm.answers[d].answer=h,class:"form-control",id:"floatingInput",placeholder:"name@example.com"},null,8,xn),[[_,t.commandForm.answers[d].answer]]),ei])]),e("td",null,[e("div",ti,[e("div",si,[c(e("input",{type:"text","onUpdate:modelValue":h=>t.commandForm.answers[d].pattern=h,class:"form-control",id:"floatingInput",placeholder:"name@example.com"},null,8,oi),[[_,t.commandForm.answers[d].pattern]]),li]),e("div",ni,[ii,e("ul",ai,[e("li",null,[e("a",{class:"dropdown-item",onClick:h=>t.commandForm.answers[d].pattern=null,href:"javascript:void(0)"},"Не выбран",8,di)]),e("li",null,[(l(!0),n(v,null,$(t.patterns,h=>(l(),n("a",{class:"dropdown-item",onClick:p=>t.commandForm.answers[d].pattern=h.value,href:"javascript:void(0)"},u(h.title||"-"),9,ri))),256))])])])])]),e("td",null,[e("div",ci,[e("div",ui,[c(e("input",{type:"text",class:"form-control","onUpdate:modelValue":h=>t.commandForm.answers[d].next_bot_dialog_command_id=h,id:"floatingInput",placeholder:"name@example.com",required:""},null,8,mi),[[_,t.commandForm.answers[d].next_bot_dialog_command_id]]),hi]),e("div",_i,[pi,e("div",bi,[e("ul",fi,[e("li",{class:"list-group-item cursor-pointer font-12",onClick:h=>t.commandForm.answers[d].next_bot_dialog_command_id=null},"Не выбран ",8,gi),(l(!0),n(v,null,$(t.getDialogCommands,h=>(l(),n("li",{class:"list-group-item cursor-pointer font-12",style:{"line-height":"100%","text-align":"left"},onClick:p=>t.commandForm.answers[d].next_bot_dialog_command_id=h.id}," #"+u(h.id||"-")+" "+u(h.pre_text||"-"),9,vi))),256))]),e("div",yi,[t.dialog_commands_paginate_object?(l(),y(j,{key:0,onPagination_page:t.nextDialogs,pagination:t.dialog_commands_paginate_object},null,8,["onPagination_page","pagination"])):r("",!0)])])])])]),e("td",null,[e("div",$i,[ki,e("ul",Fi,[e("li",null,[e("a",{class:"dropdown-item",onClick:h=>t.removeDialogAnswer(i,d),href:"javascript:void(0)"},"Удалить",8,Ci)])])])])]))),256))])])):(l(),n("div",wi," Добавьте один или несколько вариантов ответов "))])):r("",!0),e("div",Si,[c(e("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":s[13]||(s[13]=i=>t.need_set_flags=i),id:"need-set-flags",checked:""},null,512),[[k,t.need_set_flags]]),ji]),t.need_set_flags?(l(),n("div",qi,[zi,(l(!0),n(v,null,$(t.flags_variants,i=>(l(),n("span",{class:f(["badge text-info mr-2",{"bg-info text-white":t.commandForm.result_flags.indexOf(i.key)!=-1}]),onClick:d=>t.selectFlag(i)},u(i.title),11,Vi))),256))])):r("",!0),t.commandForm.id?(l(),n("div",Pi,[t.filteredCommands.length>0?(l(),n("div",Oi,[Ui,(l(!0),n(v,null,$(t.filteredCommands,(i,d)=>(l(),n("div",Ai,[e("button",Qi,[e("span",{onClick:h=>t.doCommandLink(i.id)},[t.commandForm.next_bot_dialog_command_id==i.id?(l(),n("i",Ti)):r("",!0),m(" #"+u(i.id)+" "+u(i.pre_text||"Без текста"),1)],8,Ii),t.commandForm.next_bot_dialog_command_id==i.id?(l(),n("i",{key:0,class:"fa-solid fa-unlink text-danger",onClick:s[14]||(s[14]=h=>t.doCommandLink(null))})):r("",!0)])]))),256)),t.dialog_commands_paginate_object?(l(),y(j,{key:0,onPagination_page:t.nextDialogs,pagination:t.dialog_commands_paginate_object},null,8,["onPagination_page","pagination"])):r("",!0)])):(l(),n("div",Bi,Mi))])):r("",!0),Di,e("div",Ei,[e("button",Li,[t.commandForm.id?(l(),n("span",Ki,"Обновить диалог")):(l(),n("span",Ni,"Добавить диалог"))])])],32)}}});const Gi={class:"row"},Hi={class:"col-md-2 col-12"},Wi=e("i",{class:"fa-regular fa-comment-dots",style:{"margin-right":"10px"}},null,-1),Xi={class:"col-md-10 col-12"},Zi={class:"input-group mb-3"},xi={key:0,class:"row"},ea={class:"col-md-12"},ta={class:"table"},sa=e("thead",null,[e("tr",null,[e("th",{class:"text-center",scope:"col"},"#"),e("th",{class:"text-center",scope:"col"},"Текст диалога"),e("th",{class:"text-center",scope:"col"},"Есть ответы"),e("th",{class:"text-center",scope:"col"},"Цепочки"),e("th",{class:"text-center",scope:"col"},"Текст успеха"),e("th",{class:"text-center",scope:"col"},"Текст ошибки"),e("th",{class:"text-center",scope:"col"},"Канал результата"),e("th",{class:"text-center",scope:"col"},"Флаги"),e("th",{class:"text-center",scope:"col"},"Сохранить в"),e("th",{class:"text-center",scope:"col"},"Есть изображения"),e("th",{class:"text-center",scope:"col"},"Есть паттерны"),e("th",{class:"text-center",scope:"col"},"Пустой"),e("th",{class:"text-center",scope:"col"},"Есть кнопки"),e("th",{class:"text-center",scope:"col"},"Есть меню"),e("th",{class:"text-center",scope:"col"},"Команды")])],-1),oa={scope:"row"},la={class:"text-center"},na=["onClick"],ia={class:"text-center"},aa={key:0},da={key:1},ra=e("i",{class:"fa-solid fa-xmark text-danger"},null,-1),ca=[ra],ua={class:"text-center"},ma={key:0,class:"badge bg-primary"},ha={key:1},_a=e("i",{class:"fa-solid fa-xmark text-danger"},null,-1),pa=[_a],ba={class:"text-center"},fa={key:0},ga={key:1},va=e("i",{class:"fa-solid fa-xmark text-danger"},null,-1),ya=[va],$a={class:"text-center"},ka={key:0},Fa={key:1},Ca=e("i",{class:"fa-solid fa-xmark text-danger"},null,-1),wa=[Ca],Sa={class:"text-center"},ja={key:0},qa={key:1},za=e("i",{class:"fa-solid fa-xmark text-danger"},null,-1),Va=[za],Pa={class:"text-center"},Oa={key:0},Ua={class:"badge bg-primary"},Aa={key:1},Qa=e("i",{class:"fa-solid fa-xmark text-danger"},null,-1),Ia=[Qa],Ta={class:"text-center"},Ba={key:0},Ra={key:1},Ma=e("i",{class:"fa-solid fa-xmark text-danger"},null,-1),Da=[Ma],Ea={class:"text-center"},La={key:0,class:"fa-solid fa-check text-success"},Ka={key:1,class:"fa-solid fa-xmark text-danger"},Na={class:"text-center"},Ja={key:0},Ya={key:1},Ga=e("i",{class:"fa-solid fa-xmark text-danger"},null,-1),Ha=[Ga],Wa={class:"text-center"},Xa={key:0,class:"fa-solid fa-check text-success"},Za={key:1,class:"fa-solid fa-xmark text-danger"},xa={class:"text-center"},ed={key:0,class:"fa-solid fa-check text-success"},td={key:1,class:"fa-solid fa-xmark text-danger"},sd={class:"text-center"},od={key:0,class:"fa-solid fa-check text-success"},ld={key:1,class:"fa-solid fa-xmark text-danger"},nd={class:"text-center"},id={class:"dropdown"},ad=["disabled"],dd=e("i",{class:"fa-solid fa-ellipsis"},null,-1),rd=[dd],cd={class:"dropdown-menu"},ud=["onClick"],md=e("i",{class:"fa-solid fa-arrow-left mr-1"},null,-1),hd=e("hr",null,null,-1),_d=["onClick"],pd=e("i",{class:"fa-solid fa-clone mr-1"},null,-1),bd=["onClick"],fd=e("i",{class:"fa-solid fa-trash-can mr-1"},null,-1),gd={key:1,class:"row"},vd=e("div",{class:"col-12"},[e("div",{class:"alert alert-danger",role:"alert"}," Не найдено ни одного диалога! ")],-1),yd=[vd],$d={class:"modal fade",id:"dialog-command-modal-editor",tabindex:"-1"},kd={class:"modal-dialog modal-fullscreen"},Fd={class:"modal-content"},Cd=e("div",{class:"modal-header"},[e("h1",{class:"modal-title fs-5",id:"staticBackdropLabel"}," Создание диалогового сообщения "),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),wd={class:"modal-body"},Sd=e("div",{class:"modal-footer"},[e("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Закрыть")],-1),jd={data(){return{bot:null,selected:null,loading:!0,dialog_commands:[],search:null,dialog_commands_paginate_object:null}},computed:{...w(["getDialogCommands","getCurrentBot","getDialogCommandsPaginateObject"])},mounted(){this.loadCurrentBot().then(()=>{this.loadDialogs()})},methods:{openEditor(o){this.loading=!0,this.$nextTick(()=>{this.selected=o,this.loading=!1})},removeCommand(o){this.loading=!0,this.$store.dispatch("removeDialogCommand",{dataObject:{dialogCommandId:o}}).then(t=>{this.loading=!1,this.$notify({title:"Конструктор ботов",text:"Диалоговая команда успешно удалена!",type:"success"}),this.loadDialogs(),this.$emit("callback")}).catch(t=>{this.loading=!1})},duplicate(o){this.loading=!0,this.$store.dispatch("duplicateDialogCommand",{dataObject:{dialogCommandId:o}}).then(t=>{this.loading=!1,this.$notify({title:"Конструктор ботов",text:"Диалоговая команда успешно продублирована!",type:"success"}),this.loadDialogs(),this.$emit("callback")}).catch(t=>{this.loading=!1})},loadCurrentBot(o=null){return this.$store.dispatch("updateCurrentBot",{bot:o}).then(()=>{this.bot=this.getCurrentBot})},selectDialog(o){this.$emit("select-dialog",o),this.$notify("Вы выбрали диалог из списка!")},nextDialogs(o){this.loadDialogs(o)},selectElement(o){this.loading=!0,this.$nextTick(()=>{this.selected=this.dialog_commands.find(t=>t.id===o)||null,this.loading=!1})},loadDialogs(o=0){this.$store.dispatch("loadDialogCommands",{dataObject:{botId:this.bot.id||null,search:this.search},page:o}).then(t=>{const s=this.selected;this.dialog_commands=this.getDialogCommands,this.dialog_commands_paginate_object=this.getDialogCommandsPaginateObject,this.loading=!0,this.$nextTick(()=>{s&&(this.selected=this.dialog_commands.find(a=>a.id===s.id)||null),this.loading=!1})}).catch(()=>{this.loading=!1})}}},ie=Object.assign(jd,{__name:"BotDialogGroupList",setup(o){return(t,s)=>(l(),n(v,null,[e("div",Gi,[e("div",Hi,[e("button",{type:"button",onClick:s[0]||(s[0]=a=>t.openEditor(null)),"data-bs-toggle":"modal","data-bs-target":"#dialog-command-modal-editor",class:"btn btn-outline-success mb-2 w-100"},[Wi,m("Новый диалог ")])]),e("div",Xi,[e("div",Zi,[c(e("input",{type:"search",class:"form-control",placeholder:"Поиск диалога","aria-label":"Поиск диалога","onUpdate:modelValue":s[1]||(s[1]=a=>t.search=a),"aria-describedby":"button-addon2"},null,512),[[_,t.search]]),e("button",{class:"btn btn-outline-secondary",onClick:s[2]||(s[2]=a=>t.loadDialogs(0)),type:"button",id:"button-addon2"},"Найти ")])])]),t.dialog_commands.length>0?(l(),n("div",xi,[e("div",ea,[e("table",ta,[sa,e("tbody",null,[(l(!0),n(v,null,$(t.dialog_commands,(a,i)=>(l(),n("tr",null,[e("th",oa,u(a.id),1),e("td",la,[e("a",{"data-bs-toggle":"modal",onClick:d=>t.openEditor(a),"data-bs-target":"#dialog-command-modal-editor",href:"javascript:void(0)"},u(a.pre_text||"-"),9,na)]),e("td",ia,[(a.answers||[]).length>0?(l(),n("p",aa,u(a.answers.length),1)):(l(),n("p",da,ca))]),e("td",ua,[a.next_bot_dialog_command_id?(l(),n("span",ma,"#"+u(a.next_bot_dialog_command_id||"-")+" ("+u(a.chain.length||0)+")",1)):(l(),n("span",ha,pa))]),e("td",ba,[a.post_text?(l(),n("p",fa,u(a.post_text),1)):(l(),n("p",ga,ya))]),e("td",$a,[a.error_text?(l(),n("p",ka,u(a.error_text),1)):(l(),n("p",Fa,wa))]),e("td",Sa,[a.result_channel?(l(),n("p",ja,u(a.result_channel),1)):(l(),n("p",qa,Va))]),e("td",Pa,[a.result_flags.length>0?(l(),n("p",Oa,[(l(!0),n(v,null,$(a.result_flags,d=>(l(),n("span",Ua,u(d||"-"),1))),256))])):(l(),n("p",Aa,Ia))]),e("td",Ta,[a.store_to?(l(),n("p",Ba,u(a.store_to),1)):(l(),n("p",Ra,Da))]),e("td",Ea,[a.images.length>0?(l(),n("i",La)):(l(),n("i",Ka))]),e("td",Na,[a.input_pattern?(l(),n("p",Ja,u(a.input_pattern),1)):(l(),n("p",Ya,Ha))]),e("td",Wa,[a.is_empty?(l(),n("i",Xa)):(l(),n("i",Za))]),e("td",xa,[a.inline_keyboard_id!=null?(l(),n("i",ed)):(l(),n("i",td))]),e("td",sd,[a.reply_keyboard_id!=null?(l(),n("i",od)):(l(),n("i",ld))]),e("td",nd,[e("div",id,[e("button",{disabled:t.loading,class:"btn btn-outline-secondary",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},rd,8,ad),e("ul",cd,[e("li",null,[e("a",{onClick:d=>t.selectDialog(a),title:"Выбрать диалог",class:"dropdown-item cursor-pointer"},[md,m(" Выбрать диалог ")],8,ud)]),hd,e("li",null,[e("a",{title:"Дублирование команды",onClick:d=>t.duplicate(a.id),class:"dropdown-item cursor-pointer"},[pd,m(" Дублирование диалога ")],8,_d)]),e("li",null,[e("a",{onClick:d=>t.removeCommand(a.id),title:"Удаление команды",class:"dropdown-item cursor-pointer"},[fd,m(" Удаление диалога ")],8,bd)])])])])]))),256))])]),t.dialog_commands_paginate_object?(l(),y(j,{key:0,onPagination_page:t.nextDialogs,pagination:t.dialog_commands_paginate_object},null,8,["onPagination_page","pagination"])):r("",!0)])])):(l(),n("div",gd,yd)),e("div",$d,[e("div",kd,[e("div",Fd,[Cd,e("div",wd,[t.bot&&!t.loading?(l(),y(Yi,{key:0,item:t.selected,onCallback:t.loadDialogs,onSelectElement:t.selectElement,bot:t.bot},null,8,["item","onCallback","onSelectElement","bot"])):r("",!0)]),Sd])])])],64))}}),qd=e("div",{class:"alert alert-success",role:"alert"},' Проверка правил идет по методу "И" - все правила должны выполняться для перехода на данную страницу, иначе будет вызвана страница из блока "иначе". Действия для "иначе" добавлять не обязательно. ',-1),zd=e("h6",null,"Блок условий",-1),Vd={key:0,class:"py-2"},Pd={class:"form-label",id:"bot-domain"},Od=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),Ud=e("div",null,"Напишите текст, который будет отображен пользователю вместе с основным контентом в случае если условие будет выполнено ",-1),Ad={class:"dropdown mb-2"},Qd=e("button",{class:"btn btn-outline-info dropdown-toggle w-100",type:"button",id:"dropdownMenuButton1","data-bs-toggle":"dropdown","aria-expanded":"false"}," Добавить условие ",-1),Id={class:"dropdown-menu","aria-labelledby":"dropdownMenuButton1"},Td=["onClick"],Bd={key:1},Rd={key:2,class:"list-group"},Md={key:0,class:"list-group-item d-flex justify-content-between align-items-center"},Dd={class:"form-check"},Ed={class:"form-check-label",for:"bot-user-is-vip"},Ld={key:0},Kd={key:1},Nd=e("i",{class:"fa-solid fa-trash-can"},null,-1),Jd=[Nd],Yd={key:1,class:"list-group-item d-flex justify-content-between align-items-center"},Gd={class:"form-check"},Hd={class:"form-check-label",for:"bot-user-is-admin"},Wd={key:0},Xd={key:1},Zd=e("i",{class:"fa-solid fa-trash-can"},null,-1),xd=[Zd],er={key:2,class:"list-group-item d-flex justify-content-between align-items-center"},tr={class:"form-check"},sr={class:"form-check-label",for:"bot-user-is-deliveryman"},or={key:0},lr={key:1},nr=e("i",{class:"fa-solid fa-trash-can"},null,-1),ir=[nr],ar={key:3,class:"list-group-item d-flex justify-content-between align-items-center"},dr={class:"form-check"},rr={class:"form-check-label",for:"bot-user-is-work"},cr={key:0},ur={key:1},mr=e("i",{class:"fa-solid fa-trash-can"},null,-1),hr=[mr],_r={key:4,class:"list-group-item d-flex justify-content-between align-items-center"},pr={class:"form-check"},br={class:"form-check-label",for:"bot-user-in-location"},fr={key:0},gr={key:1},vr=e("i",{class:"fa-solid fa-trash-can"},null,-1),yr=[vr],$r={key:5,class:"list-group-item d-flex justify-content-between align-items-center"},kr=e("label",{class:"form-label",id:"bot-domain"}," Возраст от ",-1),Fr=e("i",{class:"fa-solid fa-trash-can"},null,-1),Cr=[Fr],wr={key:6,class:"list-group-item d-flex justify-content-between align-items-center"},Sr=e("label",{class:"form-label",id:"bot-domain"}," Только для города ",-1),jr=e("i",{class:"fa-solid fa-trash-can"},null,-1),qr=[jr],zr={key:7,class:"list-group-item d-flex justify-content-between align-items-center"},Vr={class:"form-check"},Pr={class:"form-check-label",for:"bot-user-sex"},Or={key:0},Ur={key:1},Ar=e("i",{class:"fa-solid fa-trash-can"},null,-1),Qr=[Ar],Ir={key:8,class:"list-group-item"},Tr={class:"mb-3"},Br={class:"d-flex justify-content-between align-items-center"},Rr={class:"form-label d-flex w-100 align-items-center",id:"bot-order-channel"},Mr=["onClick"],Dr=e("i",{class:"fa-solid fa-trash-can"},null,-1),Er=[Dr],Lr=["onUpdate:modelValue"],Kr={key:3,class:"mt-5"},Nr={key:4,class:"d-flex justify-content-between"},Jr={key:6,class:"py-2"},Yr={class:"form-label",id:"bot-domain"},Gr=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),Hr=e("div",null,'Напишите текст, который будет отображен пользователю вместе с основным контентом в случае если условие не будет выполнено и будет вызван блок "иначе" ',-1),Wr={props:["bot","rulesForm"],data(){return{rules:[{id:1,title:"Является администратором",rules_block:"bot_user",rule:{is_admin:!0}},{id:2,title:"Является VIP-пользователем",rules_block:"bot_user",rule:{is_vip:!0}},{id:3,title:"Находится в заведении",rules_block:"bot_user",rule:{user_in_location:!0}},{id:4,title:"За работой",rules_block:"bot_user",rule:{is_work:!0}},{id:5,title:"Возраст от ...",rules_block:"bot_user",rule:{age:18}},{id:6,title:"Находится в городе ...",rules_block:"bot_user",rule:{city:"Краснодар"}},{id:7,title:"Пол",rules_block:"bot_user",rule:{sex:!0}},{id:8,title:"Состоит в канале",rules_block:"channels",rule:{channel:1}},{id:9,title:"Является Менеджером",rules_block:"bot_user",rule:{is_manager:!0}}]}},computed:{rulesForCustomFields(){let o=this.rules.filter(t=>t.key!=null);return console.log("filtered rules",o),o}},mounted(){},methods:{hasRuleKey(o){return this.rulesForm.rules_if==null?!1:(console.log("key=>",o||"-"),Object.keys(this.rulesForm.rules_if.bot_user).find(t=>t===o)!=null)},modifyChannel(o){this.rulesForm.rules_if.channels[o.param]=o.text},removeChannelFromRule(o){this.rulesForm.rules_if.channels.splice(o,1)},removeRule(o){delete this.rulesForm.rules_if.bot_user[o]},addRules(o){this.rulesForm.rules_if||(this.rulesForm.rules_if={bot_user:{},channels:[]}),o.rules_block==="bot_user"&&(this.rulesForm.rules_if.bot_user={...this.rulesForm.rules_if.bot_user,...o.rule}),o.rules_block==="channels"&&this.rulesForm.rules_if.channels.push(o.rule.channel)},loadCurrentBotFields(){return this.$store.dispatch("loadCurrentBotFields",{bot_id:this.bot.id}).then(o=>{(o.data||[]).forEach(s=>{s.is_active&&(this.rules.push({id:this.rules.length+1,title:s.label,key:s.key,type:s.type,rules_block:"bot_user",rule:{}}),s.type===0&&(this.rules[this.rules.length-1].rule[s.key]=""),s.type===1&&(this.rules[this.rules.length-1].rule[s.key]=0),s.type===2&&(this.rules[this.rules.length-1].rule[s.key]=!0))}),console.log("new rules=>",this.rules)})},attachPageToRule(o){o.id!=this.rulesForm.id?this.rulesForm.rules_else_page_id=o.id:this.$notify({title:"Конструктор страниц",text:"Вы не можете связать данную страницу с собой",type:"error"})}}},Xr=Object.assign(Wr,{__name:"PageRules",setup(o){return(t,s)=>{const a=q("Popper");return l(),n(v,null,[qd,zd,o.rulesForm.rules_if?(l(),n("div",Vd,[e("label",Pd,[g(a,null,{content:b(()=>[Ud]),default:b(()=>[Od]),_:1}),m(" Сообщение при успешном прохождении условий (не обязательно) ")]),c(e("textarea",{type:"text",class:"form-control",placeholder:"Текст сообщения","aria-label":"Текст сообщения","onUpdate:modelValue":s[0]||(s[0]=i=>o.rulesForm.rules_if_message=i),maxlength:"255","aria-describedby":"rules-else-message"},`
            `,512),[[_,o.rulesForm.rules_if_message]])])):r("",!0),e("div",Ad,[Qd,e("ul",Id,[(l(!0),n(v,null,$(t.rules,i=>(l(),n("li",null,[e("a",{onClick:d=>t.addRules(i),class:"dropdown-item",href:"javascript:void(0)"},u(i.title||"Не указан"),9,Td)]))),256))])]),o.rulesForm.rules_if?(l(),n("h6",Bd,"Выбранные условия")):r("",!0),o.rulesForm.rules_if?(l(),n("ul",Rd,[t.hasRuleKey("is_vip")?(l(),n("li",Md,[e("div",Dd,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[1]||(s[1]=i=>o.rulesForm.rules_if.bot_user.is_vip=i),type:"checkbox",id:"bot-user-is-vip"},null,512),[[k,o.rulesForm.rules_if.bot_user.is_vip]]),e("label",Ed,[o.rulesForm.rules_if.bot_user.is_vip?(l(),n("span",Ld,"Является VIP-пользователем")):(l(),n("span",Kd,"Не является VIP-пользователем"))])]),e("button",{type:"button",class:"btn btn-outline-info",onClick:s[2]||(s[2]=i=>t.removeRule("is_vip"))},Jd)])):r("",!0),t.hasRuleKey("is_admin")?(l(),n("li",Yd,[e("div",Gd,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[3]||(s[3]=i=>o.rulesForm.rules_if.bot_user.is_admin=i),type:"checkbox",id:"bot-user-is-admin"},null,512),[[k,o.rulesForm.rules_if.bot_user.is_admin]]),e("label",Hd,[o.rulesForm.rules_if.bot_user.is_admin?(l(),n("span",Wd,"Является администратором")):(l(),n("span",Xd,"Не является администратором"))])]),e("button",{type:"button",class:"btn btn-outline-info",onClick:s[4]||(s[4]=i=>t.removeRule("is_admin"))},xd)])):r("",!0),t.hasRuleKey("is_deliveryman")?(l(),n("li",er,[e("div",tr,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[5]||(s[5]=i=>o.rulesForm.rules_if.bot_user.is_deliveryman=i),type:"checkbox",id:"bot-user-is-deliveryman"},null,512),[[k,o.rulesForm.rules_if.bot_user.is_deliveryman]]),e("label",sr,[o.rulesForm.rules_if.bot_user.is_deliveryman?(l(),n("span",or,"Является доставщиком")):(l(),n("span",lr,"Не является доставщиком"))])]),e("button",{type:"button",class:"btn btn-outline-info",onClick:s[6]||(s[6]=i=>t.removeRule("is_deliveryman"))},ir)])):r("",!0),t.hasRuleKey("is_work")?(l(),n("li",ar,[e("div",dr,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[7]||(s[7]=i=>o.rulesForm.rules_if.bot_user.is_work=i),type:"checkbox",id:"bot-user-is-work"},null,512),[[k,o.rulesForm.rules_if.bot_user.is_work]]),e("label",rr,[o.rulesForm.rules_if.bot_user.is_work?(l(),n("span",cr,"За работой")):(l(),n("span",ur,"Не работает"))])]),e("button",{type:"button",class:"btn btn-outline-info",onClick:s[8]||(s[8]=i=>t.removeRule("is_work"))},hr)])):r("",!0),t.hasRuleKey("user_in_location")?(l(),n("li",_r,[e("div",pr,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[9]||(s[9]=i=>o.rulesForm.rules_if.bot_user.user_in_location=i),type:"checkbox",id:"bot-user-in-location"},null,512),[[k,o.rulesForm.rules_if.bot_user.user_in_location]]),e("label",br,[o.rulesForm.rules_if.bot_user.user_in_location?(l(),n("span",fr,"Находится в заведении")):(l(),n("span",gr,"Не находится в заведении"))])]),e("button",{type:"button",class:"btn btn-outline-info",onClick:s[10]||(s[10]=i=>t.removeRule("user_in_location"))},yr)])):r("",!0),t.hasRuleKey("age")?(l(),n("li",$r,[e("div",null,[kr,c(e("input",{type:"text",class:"form-control",placeholder:"Возраст от","aria-label":"Возраст от","onUpdate:modelValue":s[11]||(s[11]=i=>o.rulesForm.rules_if.bot_user.age=i),maxlength:"255","aria-describedby":"bot-user-age"},null,512),[[_,o.rulesForm.rules_if.bot_user.age]])]),e("button",{type:"button",class:"btn btn-outline-info",onClick:s[12]||(s[12]=i=>t.removeRule("age"))},Cr)])):r("",!0),t.hasRuleKey("city")?(l(),n("li",wr,[e("div",null,[Sr,c(e("input",{type:"text",class:"form-control",placeholder:"Город","aria-label":"Город","onUpdate:modelValue":s[13]||(s[13]=i=>o.rulesForm.rules_if.bot_user.city=i),maxlength:"255","aria-describedby":"bot-user-city"},null,512),[[_,o.rulesForm.rules_if.bot_user.city]])]),e("button",{type:"button",class:"btn btn-outline-info",onClick:s[14]||(s[14]=i=>t.removeRule("city"))},qr)])):r("",!0),t.hasRuleKey("sex")?(l(),n("li",zr,[e("div",Vr,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[15]||(s[15]=i=>o.rulesForm.rules_if.bot_user.sex=i),type:"checkbox",id:"bot-user-sex"},null,512),[[k,o.rulesForm.rules_if.bot_user.sex]]),e("label",Pr,[o.rulesForm.rules_if.bot_user.sex?(l(),n("span",Or,"Только для мужчин")):(l(),n("span",Ur,"Только для женщин"))])]),e("button",{type:"button",class:"btn btn-outline-info",onClick:s[16]||(s[16]=i=>t.removeRule("sex"))},Qr)])):r("",!0),o.rulesForm.rules_if.channels.length>0?(l(),n("li",Ir,[m("Проверка нахождения в канале \\ группе: "),(l(!0),n(v,null,$(o.rulesForm.rules_if.channels,(i,d)=>(l(),n("div",Tr,[e("div",Br,[e("label",Rr,[g(te,{token:o.bot.bot_token,param:`${d}`,onCallback:t.modifyChannel},null,8,["token","param","onCallback"]),m(" Канал для проверки ")]),e("button",{type:"button",class:"btn btn-link text-danger",onClick:h=>t.removeChannelFromRule(d)},Er,8,Mr)]),c(e("input",{type:"text",class:"form-control",placeholder:"id канала","aria-label":"id канала","onUpdate:modelValue":h=>o.rulesForm.rules_if.channels[d]=h,maxlength:"255","aria-describedby":"bot-order-channel"},null,8,Lr),[[_,o.rulesForm.rules_if.channels[d]]])]))),256))])):r("",!0)])):r("",!0),o.rulesForm.rules_if?(l(),n("h6",Kr,"Иначе")):r("",!0),o.rulesForm.rules_else_page_id?(l(),n("p",Nr,[m("Вы выбрали страницу #"+u(o.rulesForm.rules_else_page_id)+' в качестве условия "иначе" ',1),e("a",{href:"javascript:void(0)",onClick:s[17]||(s[17]=i=>o.rulesForm.rules_else_page_id=null)},"Очистить")])):r("",!0),o.rulesForm.rules_if?(l(),y(B,{key:5,current:o.rulesForm.id,onCallback:t.attachPageToRule,editor:!1},null,8,["current","onCallback"])):r("",!0),o.rulesForm.rules_if?(l(),n("div",Jr,[e("label",Yr,[g(a,null,{content:b(()=>[Hr]),default:b(()=>[Gr]),_:1}),m(" Сообщение в случае невыполнения условий (не обязательно) ")]),c(e("textarea",{type:"text",class:"form-control",placeholder:"Текст сообщения","aria-label":"Текст сообщения","onUpdate:modelValue":s[18]||(s[18]=i=>o.rulesForm.rules_else_message=i),maxlength:"255","aria-describedby":"rules-else-message"},`
            `,512),[[_,o.rulesForm.rules_else_message]])])):r("",!0)],64)}}}),Zr={class:"page-container"},xr={class:"page-content"},ec={class:"row"},tc={class:"col"},sc={class:"row"},oc={class:"col"},lc={class:"row"},nc={class:"col"},ic={class:"row"},ac={class:"col-12"},dc=["innerHTML"],rc={key:0,class:"row"},cc={class:"col-12"},uc={key:1,class:"row mt-2"},mc=e("p",{class:"mb-0"},[e("strong",null,"Нижнее меню")],-1),hc={class:"col-12"},_c={props:["page"]},pc=Object.assign(_c,{__name:"PagePreview",setup(o){return(t,s)=>{const a=A("lazy");return l(),n("div",Zr,[e("div",xr,[e("div",ec,[o.page.images?(l(!0),n(v,{key:0},$(o.page.images,(i,d)=>(l(),n("div",tc,[c(e("img",null,null,512),[[a,"/images-by-bot-id/"+o.page.bot_id+"/"+i]])]))),256)):r("",!0)]),e("div",sc,[o.page.videos?(l(!0),n(v,{key:0},$(o.page.videos,(i,d)=>(l(),n("div",oc,[g(J,{content:i,type:"video"},null,8,["content"])]))),256)):r("",!0)]),e("div",lc,[o.page.audios?(l(!0),n(v,{key:0},$(o.page.audios,(i,d)=>(l(),n("div",nc,[g(J,{content:i,type:"audio"},null,8,["content"])]))),256)):r("",!0)]),e("div",ic,[e("div",ac,[e("p",{innerHTML:o.page.content},null,8,dc)])])]),o.page.inlineKeyboard?(l(),n("div",rc,[e("div",cc,[o.page.inlineKeyboard.deleted_at?r("",!0):(l(),y(G,{key:0,simple:!0,"select-mode":!0,keyboard:o.page.inlineKeyboard},null,8,["keyboard"]))])])):r("",!0),o.page.replyKeyboard?(l(),n("div",uc,[mc,e("div",hc,[o.page.replyKeyboard.deleted_at?r("",!0):(l(),y(G,{key:0,simple:!0,"select-mode":!0,keyboard:o.page.replyKeyboard},null,8,["keyboard"]))])])):r("",!0)])}}});const bc={key:0,class:"row pt-3"},fc={class:"col-12"},gc={class:"alert alert-info",role:"alert"},vc=e("strong",null,"Внимание!",-1),yc={style:{"font-size":"16px"}},$c={key:0,class:"row"},kc={class:"col-12 mb-2"},Fc=e("h6",null,"На странице выбраны следующие разделы",-1),Cc={class:"mini-pics justify-content-start d-inline-flex text-primary"},wc=e("i",{class:"fa-regular fa-images"},null,-1),Sc=[wc],jc=e("i",{class:"fa-regular fa-note-sticky"},null,-1),qc=[jc],zc=e("i",{class:"fa-solid fa-photo-film"},null,-1),Vc=[zc],Pc=e("i",{class:"fa-regular fa-file-audio"},null,-1),Oc=[Pc],Uc=e("i",{class:"fa-regular fa-file-word"},null,-1),Ac=[Uc],Qc=e("i",{class:"fa-solid fa-link"},null,-1),Ic=[Qc],Tc=e("i",{class:"fa-solid fa-scroll"},null,-1),Bc=[Tc],Rc=e("i",{class:"fa-regular fa-comment-dots"},null,-1),Mc=[Rc],Dc=e("i",{class:"fa-solid fa-scale-balanced"},null,-1),Ec=[Dc],Lc=e("i",{class:"fa-regular fa-keyboard"},null,-1),Kc=[Lc],Nc=e("i",{class:"fa-solid fa-ellipsis"},null,-1),Jc=[Nc],Yc={class:"row"},Gc={class:"col-md-8 col-12 mb-2"},Hc={class:"form-label",id:"bot-domain"},Wc=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),Xc=e("div",null,[m(" Команда должна начинаться с символа . и *"),e("br"),m(" Например: .*Меню"),e("br")],-1),Zc=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),xc={class:"col-md-4 col-12 mb-2 d-flex justify-content-end align-items-end"},eu={class:"btn-group",style:{background:"white"},role:"group","aria-label":"Basic example"},tu={key:0,type:"submit",title:"Сохранить страницу",id:"save-page-btn",class:"btn btn-primary min-menu-btn"},su=e("i",{class:"fa-regular fa-floppy-disk"},null,-1),ou=[su],lu=e("i",{class:"fa-solid fa-xmark text-danger"},null,-1),nu=[lu],iu=e("button",{type:"button",title:"Список страниц","data-bs-toggle":"offcanvas","data-bs-target":"#offcanvas",class:"btn btn-outline-primary text-primary min-menu-btn"},[e("i",{class:"fa-solid fa-list-ol"})],-1),au={class:"row"},du={class:"col-12 mb-2"},ru={class:"form-label d-flex justify-content-between align-items-center mb-0",id:"bot-domain"},cu=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),uu=e("div",null,[m(" Текстовый редактор. Данный текст будет в таком"),e("br"),m(" же виде отображен в посте в телеграм. ")],-1),mu=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),hu={class:"form-floating"},_u={for:"floatingTextarea2"},pu={key:0},bu={class:"col-12 mb-2"},fu={class:"nav nav-tabs justify-content-center"},gu=e("i",{class:"fa-regular fa-keyboard"},null,-1),vu=e("span",null,"Нижнее меню",-1),yu=[gu,vu],$u=e("i",{class:"fa-solid fa-ellipsis"},null,-1),ku=e("span",null,"Меню под текстом",-1),Fu=[$u,ku],Cu=e("i",{class:"fa-regular fa-images"},null,-1),wu=e("span",null,"Изображения",-1),Su=[Cu,wu],ju=e("i",{class:"fa-solid fa-photo-film"},null,-1),qu=e("span",null,"Видео",-1),zu=[ju,qu],Vu=e("i",{class:"fa-regular fa-note-sticky"},null,-1),Pu=e("span",null,"Стикеры",-1),Ou=[Vu,Pu],Uu=e("i",{class:"fa-regular fa-file-audio"},null,-1),Au=e("span",null,"Аудио",-1),Qu=[Uu,Au],Iu=e("i",{class:"fa-regular fa-file-word"},null,-1),Tu=e("span",null,"Документы",-1),Bu=[Iu,Tu],Ru=e("i",{class:"fa-solid fa-link"},null,-1),Mu=e("span",null,"Другая страница",-1),Du=[Ru,Mu],Eu=e("i",{class:"fa-solid fa-scroll"},null,-1),Lu=e("span",null,"Скрипт",-1),Ku=[Eu,Lu],Nu=e("i",{class:"fa-regular fa-comment-dots"},null,-1),Ju=e("span",null,"Начало диалога",-1),Yu=[Nu,Ju],Gu=e("i",{class:"fa-solid fa-scale-balanced"},null,-1),Hu=e("span",null,"Правила",-1),Wu=[Gu,Hu],Xu={key:0,class:"col-12 mb-2"},Zu={class:"form-check"},xu=e("label",{class:"form-check-label",for:"need-reply-menu"}," Нижнее меню страницы ",-1),em={key:1,class:"col-12 mb-2"},tm={class:"card"},sm={class:"card-header d-flex justify-between align-items-center"},om=e("h6",null,"Конструктор нижнего меню",-1),lm={key:0},nm={key:1},im={class:"card-body"},am={class:"row"},dm={class:"col-12 mb-2"},rm={class:"form-label",id:"bot-domain"},cm=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),um=e("div",null," Заголовок для нижнего меню ",-1),mm={key:2,class:"col-12 mb-2"},hm={class:"position-relative p-5 text-center text-muted bg-body border border-dashed rounded-2"},_m={class:"d-flex justify-content-center mb-3"},pm={alt:"",width:"100",height:"100"},bm=e("h1",{class:"text-body-emphasis"},"Нижнее меню",-1),fm=e("p",{class:"col-lg-8 mx-auto fs-5 text-muted"}," Создание и настройка нижнего меню страницы бота. Добавление и редактирование функций кнопок бота на странице. Данное меню отображается пользователю всегда. ",-1),gm={class:"d-inline-flex gap-2 mb-5"},vm=["disabled"],ym=e("a",{href:"https://telegra.ph/Nizhnee-menyu-bota-01-03",target:"_blank",class:"d-inline-flex align-items-center btn btn-outline-secondary btn-lg px-4 rounded-pill"}," Подробнее ",-1),$m={key:0,class:"col-12 mb-2"},km={class:"form-check"},Fm=e("label",{class:"form-check-label",for:"need-inline-menu"}," Меню под текстом страницы ",-1),Cm={key:1,class:"col-12 mb-2"},wm={class:"card"},Sm={class:"card-header d-flex justify-between align-items-center"},jm=e("h6",null,"Конструктор меню в сообщении",-1),qm={key:0},zm={key:1},Vm={class:"card-body"},Pm={key:2,class:"col-12 mb-2"},Om={class:"position-relative p-5 text-center text-muted bg-body border border-dashed rounded-2"},Um={class:"d-flex justify-content-center mb-3"},Am={alt:"",width:"100",height:"100"},Qm=e("h1",{class:"text-body-emphasis"},"Меню под текстом",-1),Im=e("p",{class:"col-lg-8 mx-auto fs-5 text-muted"}," В отличии от нижнего меню, которое отображается всегда, меню под текстом показывается под контентом только в момент отображения этого контента. ",-1),Tm={class:"d-inline-flex gap-2 mb-5"},Bm=["disabled"],Rm=e("a",{href:"https://telegra.ph/Menyu-k-tekstu-01-03",target:"_blank",class:"d-inline-flex align-items-center btn btn-outline-secondary btn-lg px-4 rounded-pill"}," Подробнее ",-1),Mm={key:0,class:"col-12 mb-2"},Dm={class:"form-check"},Em=e("label",{class:"form-check-label",for:"need-page-images"}," Изображения на странице (максимум 10) ",-1),Lm={key:1,class:"col-12 mb-2"},Km={class:"card mb-3"},Nm=e("div",{class:"card-header"},[e("h6",null,"Загрузите изображения с файловой системы")],-1),Jm={class:"card-body d-flex justify-content-start"},Ym={for:"photos",style:{"margin-right":"10px"},class:"photo-loader ml-2"},Gm={class:"row"},Hm={key:0,class:"col-12 d-flex flex-wrap"},Wm={class:"mb-2 img-preview",style:{"margin-right":"10px"}},Xm={class:"remove"},Zm=["onClick"],xm={key:1},eh={key:2,class:"col-12 d-flex flex-wrap"},th={class:"mb-2 img-preview",style:{"margin-right":"10px"}},sh={class:"remove"},oh=["onClick"],lh={key:2,class:"col-12 mb-2"},nh={class:"position-relative p-5 text-center text-muted bg-body border border-dashed rounded-2"},ih={class:"d-flex justify-content-center mb-3"},ah={alt:"",width:"100",height:"100"},dh=e("h1",{class:"text-body-emphasis"},"Изображения",-1),rh=e("p",{class:"col-lg-8 mx-auto fs-5 text-muted"},[m(" Вы можете добавить к одной странице от "),e("b",null,"1"),m(" до "),e("b",null,"10"),m(" изображений. Изображения (от 2х) будут собраны в группу и показаны под текстовым содержимым страницы. Если изображение одно, то текст будет отображен под ним. ")],-1),ch={class:"d-inline-flex gap-2 mb-5"},uh=["disabled"],mh=e("a",{href:"https://telegra.ph/Dobavlenie-izobrazhenij-01-03",target:"_blank",class:"d-inline-flex align-items-center btn btn-outline-secondary btn-lg px-4 rounded-pill"}," Подробнее ",-1),hh={key:0,class:"col-12 mb-2"},_h={class:"form-check"},ph=e("label",{class:"form-check-label",for:"need-page-video"}," Видео к странице ",-1),bh={key:1,class:"col-12 mb-2"},fh={key:2,class:"col-12 mb-2"},gh={class:"position-relative p-5 text-center text-muted bg-body border border-dashed rounded-2"},vh={class:"d-flex justify-content-center mb-3"},yh={alt:"",width:"100",height:"100"},$h=e("h1",{class:"text-body-emphasis"},"Видео",-1),kh=e("p",{class:"col-lg-8 mx-auto fs-5 text-muted"},[m(" Вы можете добавить к одной странице от "),e("b",null,"1"),m(" до "),e("b",null,"10"),m(" видео. Ролики (от 2х) будут собраны в группу и показаны под текстовым содержимым страницы. ")],-1),Fh={class:"d-inline-flex gap-2 mb-5"},Ch=["disabled"],wh=e("a",{href:"https://telegra.ph/Dobavlenie-video-na-stranicu-01-03",target:"_blank",class:"d-inline-flex align-items-center btn btn-outline-secondary btn-lg px-4 rounded-pill"}," Подробнее ",-1),Sh={key:0,class:"col-12 mb-2"},jh={class:"form-check"},qh=e("label",{class:"form-check-label",for:"need-page-sticker"}," Стикер к странице ",-1),zh={key:1,class:"col-12 mb-2"},Vh={key:2,class:"col-12 mb-2"},Ph={class:"position-relative p-5 text-center text-muted bg-body border border-dashed rounded-2"},Oh={class:"d-flex justify-content-center mb-3"},Uh={alt:"",width:"100",height:"100"},Ah=e("h1",{class:"text-body-emphasis"},"Стикеры",-1),Qh=e("p",{class:"col-lg-8 mx-auto fs-5 text-muted"}," Вы можете переслать любой стикер в бота (от лица администратора) и затем этот стикер использовать для взаимодействия с пользователем. ",-1),Ih={class:"d-inline-flex gap-2 mb-5"},Th=["disabled"],Bh=e("a",{href:"https://telegra.ph/Dobavlenie-stikera-na-stranicu-01-03",target:"_blank",class:"d-inline-flex align-items-center btn btn-outline-secondary btn-lg px-4 rounded-pill"}," Подробнее ",-1),Rh={key:0,class:"col-12 mb-2"},Mh={class:"form-check"},Dh=e("label",{class:"form-check-label",for:"need-page-audio"}," Звук к странице ",-1),Eh={key:1,class:"col-12 mb-2"},Lh={key:2,class:"col-12 mb-2"},Kh={class:"position-relative p-5 text-center text-muted bg-body border border-dashed rounded-2"},Nh={class:"d-flex justify-content-center mb-3"},Jh={alt:"",width:"100",height:"100"},Yh=e("h1",{class:"text-body-emphasis"},"Аудио",-1),Gh=e("p",{class:"col-lg-8 mx-auto fs-5 text-muted"},[m(" Вы можете добавить к одной странице от "),e("b",null,"1"),m(" до "),e("b",null,"10"),m(" аудио. Музыка (от 2х) будет собрана в группу и показана под текстовым содержимым страницы. Если вы хотите использовать "),e("b",{class:"text-danger"},"голосовое"),m(", то можно использовать максимум "),e("b",{class:"text-danger"},"одну запись"),m(". Или же, вы можете конвертировать её в mp3 и залить как музыкальный файл в бота. ")],-1),Hh={class:"d-inline-flex gap-2 mb-5"},Wh=["disabled"],Xh=e("a",{href:"https://telegra.ph/Dobavlenie-audio-na-stranicu-01-03",target:"_blank",class:"d-inline-flex align-items-center btn btn-outline-secondary btn-lg px-4 rounded-pill"}," Подробнее ",-1),Zh={key:0,class:"col-12 mb-2"},xh={class:"form-check"},e_=e("label",{class:"form-check-label",for:"need-page-document"}," Документ \\ презентацию к странице \\ картинку в оригинале ",-1),t_={key:1,class:"col-12 mb-2"},s_={key:2,class:"col-12 mb-2"},o_={class:"position-relative p-5 text-center text-muted bg-body border border-dashed rounded-2"},l_={class:"d-flex justify-content-center mb-3"},n_={alt:"",width:"100",height:"100"},i_=e("h1",{class:"text-body-emphasis"},"Документы",-1),a_=e("p",{class:"col-lg-8 mx-auto fs-5 text-muted"},[m(" Вы можете добавить к одной странице от "),e("b",null,"1"),m(" до "),e("b",null,"10"),m(" документов. Документы (от 2х) будут собраны в группу и показана под текстовым содержимым страницы. В качестве файлов вы можете использовать текстовые документы, презентации, файлы-pdf, изображения в оригинальном размере. ")],-1),d_={class:"d-inline-flex gap-2 mb-5"},r_=["disabled"],c_=e("a",{href:"https://telegra.ph/Dobavlenie-dokumenta-01-03",target:"_blank",class:"d-inline-flex align-items-center btn btn-outline-secondary btn-lg px-4 rounded-pill"}," Подробнее ",-1),u_={class:"col-12 mb-2"},m_={class:"position-relative p-5 text-center text-muted bg-body border border-dashed rounded-2"},h_={class:"d-flex justify-content-center mb-3"},__={alt:"",width:"100",height:"100"},p_=e("h1",{class:"text-body-emphasis"},"Связь со страницей",-1),b_=e("p",{class:"col-lg-8 mx-auto fs-5 text-muted"}," Вы можете привязать вызов другой страницы непосредственно после вызова текущей. Это позволит выводить контент по цепочке для пользователя. ",-1),f_={key:0,class:"my-3 text-success font-bold"},g_={class:"d-inline-flex gap-2 mb-5"},v_={key:1,"data-bs-toggle":"modal","data-bs-target":"#page-list-modal",class:"d-inline-flex align-items-center btn btn-lg px-4 rounded-pill btn-primary",type:"button"},y_=e("a",{href:"https://telegra.ph/Svyazyvanie-so-stranicej-01-03",target:"_blank",class:"d-inline-flex align-items-center btn btn-outline-secondary btn-lg px-4 rounded-pill"}," Подробнее ",-1),$_=e("h6",{class:"mb-3"},"Конструктор цепочек",-1),k_={class:"d-flex justify-content-center align-items-center flex-wrap"},F_=e("span",{class:"px-2"},"Текущая страница",-1),C_=e("i",{class:"fa-solid fa-arrow-right"},null,-1),w_={class:"d-flex justify-content-center align-items-center px-3 py-2"},S_=["onClick"],j_={class:"position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger"},q_={key:0,class:"fa-solid fa-arrow-right ml-2"},z_={key:0,class:"fa-solid fa-arrow-right"},V_=e("button",{type:"button","data-bs-toggle":"modal","data-bs-target":"#page-list-modal",class:"btn btn-outline-secondary position-relative rounded-5 ml-5"},[e("i",{class:"fa-solid fa-plus"})],-1),P_={key:0,class:"col-12 mb-2"},O_=e("div",{class:"alert alert-info",role:"alert"}," Если в вашем боте нет каких-то предустановленных скриптов вы можете найти их в глобальном магазине скриптов ",-1),U_={class:"form-check"},A_=e("label",{class:"form-check-label",for:"need-show-global-slug-list"}," Добавить скрипты из глобального магазина? ",-1),Q_={key:1,class:"col-12 mb-2"},I_={class:"form-check"},T_=e("label",{class:"form-check-label",for:"need-slug-attach"}," Привязать скрипт ",-1),B_={key:2,class:"col-12 mb-2"},R_={key:0,class:"alert alert-success d-flex justify-content-between align-items-center",role:"alert"},M_={key:3,class:"col-12 mb-2"},D_={class:"position-relative p-5 text-center text-muted bg-body border border-dashed rounded-2"},E_={class:"d-flex justify-content-center mb-3"},L_={alt:"",width:"100",height:"100"},K_=e("h1",{class:"text-body-emphasis"},"Скрипты",-1),N_=e("p",{class:"col-lg-8 mx-auto fs-5 text-muted"}," Скрипты содержат основной функционал системы. Вы можете к каждой странице привязать один скрипт, который будет вызван после вывода основного содержимого страницы. ",-1),J_={class:"d-inline-flex gap-2 mb-5"},Y_=["disabled"],G_=e("a",{href:"https://telegra.ph/Svyazyvanie-so-skriptom-01-03",target:"_blank",class:"d-inline-flex align-items-center btn btn-outline-secondary btn-lg px-4 rounded-pill"}," Подробнее ",-1),H_={key:0,class:"col-12 mb-2"},W_={class:"form-check"},X_=e("label",{class:"form-check-label",for:"need-dialog-attach"}," Привязать начало диалога ",-1),Z_={key:1,class:"col-12 mb-2"},x_={key:0},ep={key:2,class:"col-12 mb-2"},tp={class:"position-relative p-5 text-center text-muted bg-body border border-dashed rounded-2"},sp={class:"d-flex justify-content-center mb-3"},op={alt:"",width:"100",height:"100"},lp=e("h1",{class:"text-body-emphasis"},"Диалоги",-1),np=e("p",{class:"col-lg-8 mx-auto fs-5 text-muted"}," Диалоги страницы - это инструмент запроса данных от пользователя. Вы можете привязать начало диалога к странице, а сам диалог будет вызван по цепочке. ",-1),ip={class:"d-inline-flex gap-2 mb-5"},ap=["disabled"],dp=e("a",{href:"https://telegra.ph/Dobavlenie-dialoga-01-03",target:"_blank",class:"d-inline-flex align-items-center btn btn-outline-secondary btn-lg px-4 rounded-pill"}," Подробнее ",-1),rp={key:0,class:"col-12 mb-2"},cp={class:"form-check"},up=e("label",{class:"form-check-label",for:"need-rules"}," Нужны правила загрузки страницы ",-1),mp={key:1,class:"col-12 mb-2"},hp={key:2,class:"col-12 mb-2"},_p={class:"position-relative p-5 text-center text-muted bg-body border border-dashed rounded-2"},pp={class:"d-flex justify-content-center mb-3"},bp={alt:"",width:"100",height:"100"},fp=e("h1",{class:"text-body-emphasis"},"Правила отображения страницы",-1),gp=e("p",{class:"col-lg-8 mx-auto fs-5 text-muted"}," Вы можете создать правила, согласно которым будет отображена та или иная страница. Вы можете перенаправить пользователя с одной страницы на другую, в случае если ваше условие не выполнено. ",-1),vp={class:"d-inline-flex gap-2 mb-5"},yp=["disabled"],$p=e("a",{href:"https://telegra.ph/Pravila-na-stranice-01-03",target:"_blank",class:"d-inline-flex align-items-center btn btn-outline-secondary btn-lg px-4 rounded-pill"}," Подробнее ",-1),kp=e("div",{class:"row"},[e("div",{class:"col-12"},[e("div",{class:"alert alert-info",role:"alert"},[e("h6",null,"Страница поддерживает комбинации клавиш:"),e("ul",{class:"mb-0 mr-0 p-0"},[e("li",null,[e("strong",null,"Ctrl+S"),m(" - открыть\\закрыть окно сохранения")]),e("li",null,[e("strong",null,"Ctrl+D"),m(" - просмотр страницы (для сохраненных страниц)")]),e("li",null,[e("strong",null,"Ctrl+пробел"),m(" - открыть\\закрыть список страниц")]),e("li",null,[e("strong",null,"Ctrl+backspace"),m(" - очистить страницу\\новая страница")]),e("li",null,[e("strong",null,"Ctrl+стрелка вправо"),m(" - переключение между вкладка вперед")]),e("li",null,[e("strong",null,"Ctrl+стрелка влево"),m(" - переключение между вкладка назад")])])])])],-1),Fp={class:"modal fade",id:"save-modal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},Cp={class:"modal-dialog"},wp={class:"modal-content"},Sp=e("div",{class:"modal-header"},[e("h5",{class:"modal-title",id:"exampleModalLabel"},"Сохранение страницы"),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),jp={class:"modal-body"},qp={key:0,class:"row"},zp={class:"col-12 mb-2"},Vp={class:"d-flex justify-between"},Pp=["href"],Op={class:"col-12 mb-2"},Up=e("h6",null,"На странице выбраны следующие разделы",-1),Ap={class:"mini-pics text-primary"},Qp=e("i",{class:"fa-regular fa-images"},null,-1),Ip=[Qp],Tp=e("i",{class:"fa-regular fa-note-sticky"},null,-1),Bp=[Tp],Rp=e("i",{class:"fa-solid fa-photo-film"},null,-1),Mp=[Rp],Dp=e("i",{class:"fa-regular fa-file-audio"},null,-1),Ep=[Dp],Lp=e("i",{class:"fa-regular fa-file-word"},null,-1),Kp=[Lp],Np=e("i",{class:"fa-solid fa-link"},null,-1),Jp=[Np],Yp=e("i",{class:"fa-solid fa-scroll"},null,-1),Gp=[Yp],Hp=e("i",{class:"fa-regular fa-comment-dots"},null,-1),Wp=[Hp],Xp=e("i",{class:"fa-solid fa-scale-balanced"},null,-1),Zp=[Xp],xp=e("i",{class:"fa-regular fa-keyboard"},null,-1),eb=[xp],tb=e("i",{class:"fa-solid fa-ellipsis"},null,-1),sb=[tb],ob={key:0,class:"col-12 mb-2"},lb={class:"form-check"},nb=e("label",{class:"form-check-label",for:"need-show-qr-and-link"}," Показать ссылку на страницу и QR-код ",-1),ib={key:1,class:"col-12 mb-2"},ab={class:"d-flex justify-content-center"},db={style:{width:"200px",height:"200px"}},rb={class:"col-12 mb-2"},cb={class:"form-label",id:"bot-domain"},ub=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),mb=e("div",null,"Напишите для себя пояснение для чего нужна данная страница. Это поможет другим менеджерам лучше понять Вас. ",-1),hb=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),_b={class:"col-12"},pb={class:"form-check"},bb=e("label",{class:"form-check-label",for:"is-external"}," Внешнее управление страницей ",-1),fb={key:0,class:"alert alert-danger",role:"alert"},gb={key:0,class:"mb-0"},vb=e("strong",null,'"Информация о боте"',-1),yb=e("strong",null,"Другие настройки",-1),$b=e("strong",null,'"Ссылка на внешний сервис обработки данных"',-1),kb={class:"col-12"},Fb={class:"form-check"},Cb=e("label",{class:"form-check-label",for:"need_log_user_action"}," Логгировать действия пользователя в канал при переходе ",-1),wb={class:"col-12"},Sb={class:"form-check"},jb=e("label",{class:"form-check-label",for:"need-stay-after-save"}," Остаться на текущей странице после сохранения ",-1),qb=e("div",{class:"col-12"},[e("button",{type:"submit",id:"submit-page",class:"btn btn-success w-100 p-3"},"Сохранить ")],-1),zb=e("div",{class:"modal-footer"},[e("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Не сохранять")],-1),Vb={class:"modal fade",id:"page-list-modal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},Pb={class:"modal-dialog"},Ob={class:"modal-content"},Ub={class:"modal-body"},Ab={class:"modal fade",id:"page-preview-modal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},Qb={class:"modal-dialog"},Ib={class:"modal-content"},Tb={class:"modal-body"},Bb={key:1},Rb={class:"offcanvas offcanvas-end w-25",tabindex:"-1",id:"offcanvas","data-bs-keyboard":"true","data-bs-scroll":"true","data-bs-backdrop":"true"},Mb=e("div",{class:"offcanvas-header"},[e("h6",{class:"offcanvas-title d-none d-sm-block",id:"offcanvas"},"Ваши страницы (кнопки)"),e("button",{type:"button",class:"btn-close text-reset","data-bs-dismiss":"offcanvas","aria-label":"Close"})],-1),Db={class:"offcanvas-body"},Eb={class:"row"},Lb={class:"col-12"},Kb={data(){return{tab:0,links:[],saveModal:null,pageModal:null,pagePreviewModal:null,page:null,need_show_qr_and_link:!1,need_stay_after_save:!0,need_show_global_slug_list:!1,need_clean:!1,load:!1,photos:[],showReplyTemplateSelector:!1,showInlineTemplateSelector:!1,loaded_page_list:!0,load_slug_simple_list:!0,showMenu:!1,need_page_sticker:!1,need_page_audios:!1,need_page_documents:!1,need_page_video:!1,need_page_images:!1,need_inline_menu:!1,need_reply_menu:!1,need_attach_page:!1,need_attach_dialog:!1,need_attach_slug:!1,need_rules:!1,bot:null,pageForm:{id:null,content:"",command:null,slug:null,comment:null,videos:[],images:[],audios:[],documents:[],sticker:null,reply_keyboard_title:null,reply_keyboard:null,reply_keyboard_settings:null,inline_keyboard:null,is_external:!1,need_log_user_action:!1,next_page_id:null,next_bot_dialog_command_id:null,next_bot_menu_slug_id:null,rules_if:null,rules_else_page_id:null,rules_if_message:null,rules_else_message:null}}},watch:{need_page_images:function(o,t){this.need_page_images||(this.photos=[],this.pageForm.images=[])},need_page_audios:function(o,t){this.need_page_audios||(this.pageForm.audios=[])},need_page_documents:function(o,t){this.need_page_documents||(this.pageForm.documents=[])},need_page_sticker:function(o,t){this.need_page_sticker||(this.pageForm.sticker=null)},need_page_video:function(o,t){this.need_page_video||(this.pageForm.videos=[])},need_inline_menu:function(o,t){this.need_inline_menu||(this.pageForm.inline_keyboard=null,this.pageForm.inline_keyboard_id=null)},need_rules:function(o,t){this.need_rules||(this.pageForm.rules_if=null,this.pageForm.rules_else_page_id=null,this.pageForm.rules_if_message=null,this.pageForm.rules_else_message=null)},need_reply_menu:function(o,t){this.need_reply_menu||(this.pageForm.reply_keyboard=null,this.pageForm.reply_keyboard_id=null)},need_attach_page:function(o,t){this.need_attach_page||(this.pageForm.next_page_id=null)},need_attach_dialog:function(o,t){this.need_attach_dialog||(this.pageForm.next_bot_dialog_command_id=null)},need_attach_slug:function(o,t){this.need_attach_slug||(this.pageForm.next_bot_menu_slug_id=null)},pageForm:{handler:function(o){this.pageForm.reply_keyboard!=null&&(this.need_reply_menu=!0),this.pageForm.inline_keyboard!=null&&(this.need_inline_menu=!0),this.pageForm.images.length>0&&(this.need_page_images=!0),this.pageForm.next_bot_dialog_command_id!=null&&(this.need_attach_dialog=!0),this.pageForm.next_bot_menu_slug_id!=null&&(this.need_attach_slug=!0),this.pageForm.next_page_id!=null&&(this.need_attach_page=!0),this.pageForm.rules_if!=null&&(this.need_rules=!0),this.pageForm.videos.length>0&&(this.need_page_video=!0),this.pageForm.audios.length>0&&(this.need_page_audios=!0),this.pageForm.documents.length>0&&(this.need_page_documents=!0),this.pageForm.sticker&&(this.need_page_sticker=!0),this.need_clean=!0},deep:!0}},computed:{...w(["getCurrentBot"]),qr(){return"https://api.qrserver.com/v1/create-qr-code/?size=450x450&qzone=2&data="+this.link},selectedLinkIds(){let o=this.links.map(t=>t.id);return this.page==null?o:this.page.id!=null?[this.page.id,...o]:o},hasParts(){return this.need_page_sticker||this.need_page_audios||this.need_page_documents||this.need_page_video||this.need_page_images||this.need_inline_menu||this.need_reply_menu||this.need_attach_page||this.need_attach_dialog||this.need_attach_slug||this.need_rules},pageLink(){if(!this.pageForm.id)return"Ссылка недоступна";let o="";for(let t=0;t<10-(""+this.pageForm.id).length;t++)o+="0";return o+=this.pageForm.id,"https://t.me/"+this.getCurrentBot.bot_domain+"?start="+btoa("004"+o)}},mounted(){this.page?this.preparePageForm(this.page):this.clearForm(),this.loadCurrentBot().then(()=>{this.saveModal=new bootstrap.Modal(document.getElementById("save-modal"),{})}),this.pageModal=new bootstrap.Offcanvas(document.getElementById("offcanvas"),{scroll:!0}),this.pagePreviewModal=new bootstrap.Modal(document.getElementById("page-preview-modal"),{}),window.addEventListener("keydown",o=>{if(o.ctrlKey&&o.keyCode==8&&(o.preventDefault(),this.clearForm()),o.ctrlKey&&o.code=="KeyD"&&(o.preventDefault(),this.pagePreviewModal.toggle()),o.ctrlKey&&o.keyCode==32&&(o.preventDefault(),this.pageModal.toggle()),o.ctrlKey&&o.code=="KeyS"){o.preventDefault();const t=document.querySelector("#save-page-btn");t?t.click():this.$notify({title:"Конструктор страниц",text:"Вы еще не начали создавать страницу!",type:"warning"})}o.ctrlKey&&o.keyCode==39&&(o.preventDefault(),this.tab===10?this.tab=0:this.tab++),o.ctrlKey&&o.keyCode==37&&(o.preventDefault(),this.tab===0?this.tab=10:this.tab--)})},methods:{chainCollapseTest(o){return this.page==null?this.links.filter(t=>t.id==o.id).length>1:[this.page,...this.links].filter(t=>t.id==o.id).length>1},loadPageChains(){return this.$store.dispatch("loadPageChains",{dataObject:{start_page_id:this.page.id}}).then(o=>{this.links=o.data})},removeLink(o){this.links.splice(o,1)},loadSlugs(){this.load_slug_simple_list=!1,this.need_show_global_slug_list=!1,this.$nextTick(()=>{this.load_slug_simple_list=!0})},preparePageForm(o){this.links=[],this.page=o,this.photos=[],this.$nextTick(()=>{this.pageForm={id:o.id,slug_id:o.slug?o.slug.id:null,content:o.content,command:o.slug?o.slug.command:null,slug:o.slug?o.slug.slug:null,comment:o.slug?o.slug.comment:null,images:o.images||[],sticker:o.sticker||null,reply_keyboard_title:o.reply_keyboard_title||null,reply_keyboard_id:o.reply_keyboard_id||null,inline_keyboard_id:o.inline_keyboard_id||null,reply_keyboard:o.replyKeyboard||null,inline_keyboard:o.inlineKeyboard||null,next_page_id:o.next_page_id||null,next_bot_dialog_command_id:o.next_bot_dialog_command_id||null,next_bot_menu_slug_id:o.next_bot_menu_slug_id||null,is_external:o.is_external||!1,need_log_user_action:o.need_log_user_action||!1,rules_if:o.rules_if||null,rules_else_page_id:o.rules_else_page_id||null,audios:o.audios||[],documents:o.documents||[],videos:o.videos||[],rules_if_message:o.rules_if_message||null,rules_else_message:o.rules_else_message||null},this.pageForm.id!=null&&this.pageForm.next_page_id!=null&&this.loadPageChains()})},copyToClipBoard(o){navigator.clipboard.writeText(o).then(()=>{this.$notify({title:"Копирование",text:"Ссылка скопирована в буфер"})}).catch(t=>{this.$notify({title:"Копирование",text:"Ошибка копирования",type:"error"})})},associateDialog(o){this.pageForm.next_bot_dialog_command_id=o.id},associateSlug(o){this.pageForm.next_bot_menu_slug_id=o.id},loadCurrentBot(o=null){return this.$store.dispatch("updateCurrentBot",{bot:o}).then(()=>{this.bot=this.getCurrentBot})},clearLinks(){this.links=[],this.pageForm.next_page_id=null},attachPage(o){this.links.length==0&&(o.id!=this.pageForm.id?(this.$notify({title:"Конструктор страниц",text:"Вы успешно связали страницы!",type:"success"}),this.pageForm.next_page_id=o.id):this.$notify({title:"Конструктор страниц",text:"Вы не можете связать данную страницу с собой",type:"error"})),(this.page==null?this.links.findIndex(s=>s.id===o.id)!=-1:this.links.findIndex(s=>s.id===o.id)!=-1||o.id===this.page.id)||this.links.push(o)},injectContent(o){this.pageForm.content?this.pageForm.content+=o.text:this.pageForm.content=o.text},clearForm(){this.photos=[],this.pageForm={id:null,content:null,command:null,slug:null,comment:null,sticker:null,images:[],reply_keyboard:null,inline_keyboard:null,is_external:!1,need_log_user_action:!1,videos:[],audios:[],documents:[],reply_keyboard_title:null,reply_keyboard_id:null,inline_keyboard_id:null,next_page_id:null,next_menu_slug:null,next_bot_dialog_command_id:null,next_bot_menu_slug_id:null,rules_if_message:null,rules_else_message:null},this.photos=[],this.showReplyTemplateSelector=!1,this.showInlineTemplateSelector=!1,this.need_page_images=!1,this.need_page_video=!1,this.need_inline_menu=!1,this.need_reply_menu=!1,this.need_attach_page=!1,this.need_attach_dialog=!1,this.need_attach_slug=!1,this.need_rules=!1,this.need_page_audios=!1,this.need_page_documents=!1,this.need_page_sticker=!1,this.links=[],this.$nextTick(()=>{this.need_clean=!1})},openSaveModal(){(this.pageForm.comment||"").length===0&&(this.pageForm.comment=this.pageForm.command),this.saveModal.show()},submitPage(){let o=new FormData;if(Object.keys(this.pageForm).forEach(t=>{const s=this.pageForm[t]||"";typeof s=="object"?o.append(t,JSON.stringify(s)):o.append(t,s)}),this.bot&&o.append("bot_id",this.bot.id),this.photos.length>0)for(let t=0;t<this.photos.length;t++)o.append("photos[]",this.photos[t]);this.$store.dispatch(this.pageForm.id==null?"createPage":"updatePage",{pageForm:o}).then(t=>{this.pageForm.id==null&&this.preparePageForm(t.data),this.links.length>0&&this.$store.dispatch("storePageChains",{dataObject:{start_page_id:t.data.id,links:this.links.map(s=>s.id)}}),this.need_stay_after_save||(this.load=!0,this.$nextTick(()=>{this.load=!1,this.clearForm()})),this.loaded_page_list=!1,this.$nextTick(()=>{this.loaded_page_list=!0}),this.saveModal.hide(),this.$emit("callback",t.data),this.$notify({title:"Конструктор ботов",text:this.pageForm.id==null?"Страница успешно создана!":"Страница успешно обновлена!",type:"success"}),this.$store.dispatch("loadPages",{dataObject:{botId:this.bot.id,needNewFirst:!0},page:localStorage.getItem(`cashman_pagelist_${this.bot.id}_page_index`)||0})}).catch(t=>{})},saveInlineKeyboard(o){this.pageForm.inline_keyboard=o},selectReplyKeyboard(o){this.pageForm.reply_keyboard=o,this.showReplyTemplateSelector=!1},selectInlineKeyboard(o){this.pageForm.inline_keyboard=o,this.showInlineTemplateSelector=!1},saveReplyKeyboard(o){this.pageForm.reply_keyboard=o},saveReplyKeyboardSettings(o){this.pageForm.reply_keyboard_settings=o},getPhoto(o){return{imageUrl:URL.createObjectURL(o)}},removePhoto(o){this.photos.splice(o,1)},removeImage(o){this.pageForm.images.splice(o,1)},onChangePhotos(o){const t=o.target.files;for(let s=0;s<t.length;s++)this.photos.push(t[s])},onChange(o){this.pageForm.content=o},selectPhoto(o){this.pageForm.images||(this.pageForm.images=[]);let t=this.pageForm.images.indexOf(o.file_id);t!==-1?this.pageForm.images.splice(t,1):this.pageForm.images.push(o.file_id)},selectSticker(o){this.pageForm.sticker=o.file_id},selectVideo(o){this.pageForm.videos||(this.pageForm.videos=[]);let t=this.pageForm.videos.indexOf(o.file_id);t!==-1?this.pageForm.videos.splice(t,1):this.pageForm.videos.push(o.file_id)},selectAudio(o){this.pageForm.audios||(this.pageForm.audios=[]);let t=this.pageForm.audios.indexOf(o.file_id);if(o.type==="voice"){if(t!==-1){this.pageForm.audios.splice(t,1);return}this.pageForm.audios=[o.file_id];return}t!==-1?this.pageForm.audios.splice(t,1):this.pageForm.audios.push(o.file_id)},selectDocument(o){this.pageForm.documents||(this.pageForm.documents=[]);let t=this.pageForm.documents.indexOf(o.file_id);t!==-1?this.pageForm.documents.splice(t,1):this.pageForm.documents.push(o.file_id)},pageListCallback(o){this.$notify("Вы выбрали страницу из списка! Все остальные действия будут производится для этой страницы"),this.load=!0,this.preparePageForm(o),this.$nextTick(()=>{this.load=!1})}}},Nb=Object.assign(Kb,{__name:"Page",setup(o){return(t,s)=>{const a=q("Popper"),i=A("lazy");return l(),n(v,null,[t.pageForm.id?(l(),n("div",bc,[e("div",fc,[e("div",gc,[vc,m(" Вы в режиме редактирования страницы (кнопки) "),e("strong",yc,u(t.page.slug?t.page.slug.command:"Без названия"),1),m(", если хотите создать новую нажмите "),e("a",{href:"javascript:void(0)",class:"btn btn-primary ml-2",onClick:s[0]||(s[0]=(...d)=>t.clearForm&&t.clearForm(...d))},"Создать новую страницу")])])])):r("",!0),t.bot?(l(),n("form",{key:1,id:"page-construct",class:"py-3",onSubmit:s[43]||(s[43]=S((...d)=>t.openSaveModal&&t.openSaveModal(...d),["prevent"]))},[t.hasParts?(l(),n("div",$c,[e("div",kc,[Fc,e("ul",Cc,[e("li",{class:f(["mr-1",{active:t.need_page_images}]),title:"Изображения"},Sc,2),e("li",{class:f(["mr-1",{active:t.need_page_sticker}]),title:"Стикеры"},qc,2),e("li",{class:f(["mr-1",{active:t.need_page_video}]),title:"Видео"},Vc,2),e("li",{class:f(["mr-1",{active:t.need_page_audios}]),title:"Аудио"},Oc,2),e("li",{class:f(["mr-1",{active:t.need_page_documents}]),title:"Документы"},Ac,2),e("li",{class:f(["mr-1",{active:t.need_attach_page}]),title:"Страницы"},Ic,2),e("li",{class:f(["mr-1",{active:t.need_attach_slug}]),title:"Скрипты"},Bc,2),e("li",{class:f(["mr-1",{active:t.need_attach_dialog}]),title:"Диалоги"},Mc,2),e("li",{class:f(["mr-1",{active:t.need_rules}]),title:"Правила"},Ec,2),e("li",{class:f(["mr-1",{active:t.need_reply_menu}]),title:"Нижнее меню"},Kc,2),e("li",{title:"Текстовое меню",class:f({active:t.need_inline_menu})},Jc,2)])])])):r("",!0),e("div",Yc,[e("div",Gc,[e("label",Hc,[g(a,null,{content:b(()=>[Xc]),default:b(()=>[Wc]),_:1}),m(" Команда "),Zc]),c(e("input",{type:"text",class:"form-control",placeholder:"Команда","aria-label":"Команда","onUpdate:modelValue":s[1]||(s[1]=d=>t.pageForm.command=d),maxlength:"255","aria-describedby":"bot-domain",required:""},null,512),[[_,t.pageForm.command]])]),e("div",xc,[e("div",eu,[t.pageForm.id||t.need_clean?(l(),n("button",tu,ou)):r("",!0),t.pageForm.id||t.need_clean?(l(),n("button",{key:1,type:"button",onClick:s[2]||(s[2]=(...d)=>t.clearForm&&t.clearForm(...d)),title:"Очистить \\ Новая страница",class:"btn btn-outline-primary min-menu-btn"},nu)):r("",!0),iu])])]),c(e("div",au,[e("div",du,[e("label",ru,[e("div",null,[g(a,null,{content:b(()=>[uu]),default:b(()=>[cu]),_:1}),m(" Текстовое содержимое страницы "),mu]),g(vt,{param:"content",onCallback:t.injectContent},null,8,["onCallback"])]),e("div",hu,[c(e("textarea",{class:"form-control","onUpdate:modelValue":s[3]||(s[3]=d=>t.pageForm.content=d),maxlength:"4096",placeholder:"Введите текст",id:"floatingTextarea2",style:{"min-height":"150px"}},null,512),[[_,t.pageForm.content]]),e("label",_u,[m("Содержимое страницы "),t.pageForm.content?(l(),n("span",pu,u(t.pageForm.content.length)+"/4096 ",1)):r("",!0)])])]),e("div",bu,[e("ul",fu,[e("li",{class:"nav-item",onClick:s[4]||(s[4]=d=>t.tab=0)},[e("a",{class:f([{active:t.tab===0,"primary-mark":t.need_reply_menu},"nav-link d-flex flex-column justify-content-center align-items-center font-12"]),href:"javascript:void(0)"},yu,2)]),e("li",{class:"nav-item",onClick:s[5]||(s[5]=d=>t.tab=1)},[e("a",{class:f([{active:t.tab===1,"primary-mark":t.need_inline_menu},"nav-link d-flex flex-column justify-content-center align-items-center font-12"]),href:"javascript:void(0)"},Fu,2)]),e("li",{class:"nav-item",onClick:s[6]||(s[6]=d=>t.tab=2)},[e("a",{class:f([{active:t.tab===2,"primary-mark":t.need_page_images},"nav-link d-flex flex-column justify-content-center align-items-center font-12"]),href:"javascript:void(0)"},Su,2)]),e("li",{class:"nav-item",onClick:s[7]||(s[7]=d=>t.tab=3)},[e("a",{class:f([{active:t.tab===3,"primary-mark":t.need_page_video},"nav-link d-flex flex-column justify-content-center align-items-center font-12"]),href:"javascript:void(0)"},zu,2)]),e("li",{class:"nav-item",onClick:s[8]||(s[8]=d=>t.tab=4)},[e("a",{class:f([{active:t.tab===4,"primary-mark":t.need_page_sticker},"nav-link d-flex flex-column justify-content-center align-items-center font-12"]),href:"javascript:void(0)"},Ou,2)]),e("li",{class:"nav-item",onClick:s[9]||(s[9]=d=>t.tab=5)},[e("a",{class:f([{active:t.tab===5,"primary-mark":t.need_page_audios},"nav-link d-flex flex-column justify-content-center align-items-center font-12"]),href:"javascript:void(0)"},Qu,2)]),e("li",{class:"nav-item",onClick:s[10]||(s[10]=d=>t.tab=6)},[e("a",{class:f([{active:t.tab===6,"primary-mark":t.need_page_documents},"nav-link d-flex flex-column justify-content-center align-items-center font-12"]),href:"javascript:void(0)"},Bu,2)]),e("li",{class:"nav-item",onClick:s[11]||(s[11]=d=>t.tab=7)},[e("a",{class:f([{active:t.tab===7,"primary-mark":t.need_attach_page},"nav-link d-flex flex-column justify-content-center align-items-center font-12"]),href:"javascript:void(0)"},Du,2)]),e("li",{class:"nav-item",onClick:s[12]||(s[12]=d=>t.tab=8)},[e("a",{class:f([{active:t.tab===8,"primary-mark":t.need_attach_slug},"nav-link d-flex flex-column justify-content-center align-items-center font-12"]),href:"javascript:void(0)"},Ku,2)]),e("li",{class:"nav-item",onClick:s[13]||(s[13]=d=>t.tab=9)},[e("a",{class:f([{active:t.tab===9,"primary-mark":t.need_attach_dialog},"nav-link d-flex flex-column justify-content-center align-items-center font-12"]),href:"javascript:void(0)"},Yu,2)]),e("li",{class:"nav-item",onClick:s[14]||(s[14]=d=>t.tab=10)},[e("a",{class:f([{active:t.tab===10,"primary-mark":t.need_rules},"nav-link d-flex flex-column justify-content-center align-items-center font-12"]),href:"javascript:void(0)"},Wu,2)])])]),c(e("div",null,[t.need_reply_menu?(l(),n("div",Xu,[e("div",Zu,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[15]||(s[15]=d=>t.need_reply_menu=d),type:"checkbox",id:"need-reply-menu"},null,512),[[k,t.need_reply_menu]]),xu])])):r("",!0),t.need_reply_menu?(l(),n("div",em,[e("div",tm,[e("div",sm,[om,e("button",{class:f(["btn",{"btn-outline-primary":!t.showReplyTemplateSelector,"btn-primary":t.showReplyTemplateSelector}]),type:"button",onClick:s[16]||(s[16]=d=>t.showReplyTemplateSelector=!t.showReplyTemplateSelector)},[t.showReplyTemplateSelector?(l(),n("span",nm," Скрыть шаблоны меню")):(l(),n("span",lm," Открыть шаблоны меню"))],2)]),e("div",im,[e("div",am,[e("div",dm,[e("label",rm,[g(a,null,{content:b(()=>[um]),default:b(()=>[cm]),_:1}),m(" Заголовок ")]),c(e("input",{type:"text",class:"form-control",placeholder:"Заголовок меню","aria-label":"Заголовок меню","onUpdate:modelValue":s[17]||(s[17]=d=>t.pageForm.reply_keyboard_title=d),maxlength:"255","aria-describedby":"bot-domain"},null,512),[[_,t.pageForm.reply_keyboard_title]])])]),t.showReplyTemplateSelector?(l(),y(I,{key:0,class:"mb-2",type:"reply",onSelect:t.selectReplyKeyboard,"select-mode":!0},null,8,["onSelect"])):(l(),y(Q,{key:1,type:"reply",onSave:t.saveReplyKeyboard,onSaveSettings:t.saveReplyKeyboardSettings,"edited-keyboard":t.pageForm.reply_keyboard},null,8,["onSave","onSaveSettings","edited-keyboard"]))])])])):(l(),n("div",mm,[e("div",hm,[e("div",_m,[c(e("img",pm,null,512),[[i,"../images/icon.png"]])]),bm,fm,e("div",gm,[e("button",{disabled:t.need_reply_menu,onClick:s[18]||(s[18]=d=>t.need_reply_menu=!0),class:f([{"btn-primary":!t.need_reply_menu,"btn-outline-secondary":t.need_reply_menu},"d-inline-flex align-items-center btn btn-lg px-4 rounded-pill"]),type:"button"}," Добавить ",10,vm),ym])])]))],512),[[z,t.tab===0]]),c(e("div",null,[t.need_inline_menu?(l(),n("div",$m,[e("div",km,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[19]||(s[19]=d=>t.need_inline_menu=d),type:"checkbox",id:"need-inline-menu"},null,512),[[k,t.need_inline_menu]]),Fm])])):r("",!0),t.need_inline_menu?(l(),n("div",Cm,[e("div",wm,[e("div",Sm,[jm,e("button",{class:f(["btn",{"btn-outline-primary":!t.showInlineTemplateSelector,"btn-primary":t.showInlineTemplateSelector}]),type:"button",onClick:s[20]||(s[20]=d=>t.showInlineTemplateSelector=!t.showInlineTemplateSelector)},[t.showInlineTemplateSelector?(l(),n("span",zm," Скрыть шаблоны меню")):(l(),n("span",qm," Открыть шаблоны меню"))],2)]),e("div",Vm,[t.showInlineTemplateSelector?(l(),y(I,{key:0,class:"mb-2",type:"inline",onSelect:t.selectInlineKeyboard,"select-mode":!0},null,8,["onSelect"])):(l(),y(Q,{key:1,type:"inline",onSave:t.saveInlineKeyboard,"edited-keyboard":t.pageForm.inline_keyboard},null,8,["onSave","edited-keyboard"]))])])])):(l(),n("div",Pm,[e("div",Om,[e("div",Um,[c(e("img",Am,null,512),[[i,"../images/icon.png"]])]),Qm,Im,e("div",Tm,[e("button",{disabled:t.need_inline_menu,onClick:s[21]||(s[21]=d=>t.need_inline_menu=!0),class:f([{"btn-primary":!t.need_inline_menu,"btn-outline-secondary":t.need_inline_menu},"d-inline-flex align-items-center btn btn-lg px-4 rounded-pill"]),type:"button"}," Добавить ",10,Bm),Rm])])]))],512),[[z,t.tab===1]]),c(e("div",null,[t.need_page_images?(l(),n("div",Mm,[e("div",Dm,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[22]||(s[22]=d=>t.need_page_images=d),type:"checkbox",id:"need-page-images"},null,512),[[k,t.need_page_images]]),Em])])):r("",!0),t.need_page_images?(l(),n("div",Lm,[e("div",Km,[Nm,e("div",Jm,[e("label",Ym,[m(" + "),e("input",{type:"file",id:"photos",multiple:"",accept:"image/*",onChange:s[23]||(s[23]=(...d)=>t.onChangePhotos&&t.onChangePhotos(...d)),style:{display:"none"}},null,32)]),e("div",Gm,[t.photos.length>0?(l(),n("div",Hm,[(l(!0),n(v,null,$(t.photos,(d,h)=>(l(),n("div",Wm,[c(e("img",null,null,512),[[i,t.getPhoto(d).imageUrl]]),e("div",Xm,[e("a",{onClick:p=>t.removePhoto(h)},"Удалить",8,Zm)])]))),256))])):r("",!0),t.pageForm.images.length>0?(l(),n("h6",xm,"Ранее загруженные фотографии")):r("",!0),t.pageForm.images.length>0?(l(),n("div",eh,[(l(!0),n(v,null,$(t.pageForm.images,(d,h)=>(l(),n("div",th,[c(e("img",null,null,512),[[i,"/images-by-bot-id/"+t.bot.id+"/"+d]]),e("div",sh,[e("a",{onClick:p=>t.removeImage(h)},"Удалить",8,oh)])]))),256))])):r("",!0)])])])])):(l(),n("div",lh,[e("div",nh,[e("div",ih,[c(e("img",ah,null,512),[[i,"../images/icon.png"]])]),dh,rh,e("div",ch,[e("button",{disabled:t.need_page_images,onClick:s[24]||(s[24]=d=>t.need_page_images=!0),class:f([{"btn-primary":!t.need_page_images,"btn-outline-secondary":t.need_page_images},"d-inline-flex align-items-center btn btn-lg px-4 rounded-pill"]),type:"button"}," Добавить ",10,uh),mh])])]))],512),[[z,t.tab===2]]),c(e("div",null,[t.need_page_video?(l(),n("div",hh,[e("div",_h,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[25]||(s[25]=d=>t.need_page_video=d),type:"checkbox",id:"need-page-video"},null,512),[[k,t.need_page_video]]),ph])])):r("",!0),t.need_page_video?(l(),n("div",bh,[g(V,{"need-video":!0,"need-video-note":!0,selected:t.pageForm.videos,onSelect:t.selectVideo},null,8,["selected","onSelect"])])):(l(),n("div",fh,[e("div",gh,[e("div",vh,[c(e("img",yh,null,512),[[i,"../images/icon.png"]])]),$h,kh,e("div",Fh,[e("button",{disabled:t.need_page_video,onClick:s[26]||(s[26]=d=>t.need_page_video=!0),class:f([{"btn-primary":!t.need_page_video,"btn-outline-secondary":t.need_page_video},"d-inline-flex align-items-center btn btn-lg px-4 rounded-pill"]),type:"button"}," Добавить ",10,Ch),wh])])]))],512),[[z,t.tab===3]]),c(e("div",null,[t.need_page_sticker?(l(),n("div",Sh,[e("div",jh,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[27]||(s[27]=d=>t.need_page_sticker=d),type:"checkbox",id:"need-page-sticker"},null,512),[[k,t.need_page_sticker]]),qh])])):r("",!0),t.need_page_sticker?(l(),n("div",zh,[g(V,{"need-sticker":!0,selected:[t.pageForm.sticker],onSelect:t.selectSticker},null,8,["selected","onSelect"])])):(l(),n("div",Vh,[e("div",Ph,[e("div",Oh,[c(e("img",Uh,null,512),[[i,"../images/icon.png"]])]),Ah,Qh,e("div",Ih,[e("button",{disabled:t.need_page_sticker,onClick:s[28]||(s[28]=d=>t.need_page_sticker=!0),class:f([{"btn-primary":!t.need_page_sticker,"btn-outline-secondary":t.need_page_sticker},"d-inline-flex align-items-center btn btn-lg px-4 rounded-pill"]),type:"button"}," Добавить ",10,Th),Bh])])]))],512),[[z,t.tab===4]]),c(e("div",null,[t.need_page_audios?(l(),n("div",Rh,[e("div",Mh,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[29]||(s[29]=d=>t.need_page_audios=d),type:"checkbox",id:"need-page-audio"},null,512),[[k,t.need_page_audios]]),Dh])])):r("",!0),t.need_page_audios?(l(),n("div",Eh,[g(V,{"need-audio":!0,selected:t.pageForm.audios,onSelect:t.selectAudio},null,8,["selected","onSelect"])])):(l(),n("div",Lh,[e("div",Kh,[e("div",Nh,[c(e("img",Jh,null,512),[[i,"../images/icon.png"]])]),Yh,Gh,e("div",Hh,[e("button",{disabled:t.need_page_audios,onClick:s[30]||(s[30]=d=>t.need_page_audios=!0),class:f([{"btn-primary":!t.need_page_audios,"btn-outline-secondary":t.need_page_audios},"d-inline-flex align-items-center btn btn-lg px-4 rounded-pill"]),type:"button"}," Добавить ",10,Wh),Xh])])]))],512),[[z,t.tab===5]]),c(e("div",null,[t.need_page_documents?(l(),n("div",Zh,[e("div",xh,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[31]||(s[31]=d=>t.need_page_documents=d),type:"checkbox",id:"need-page-document"},null,512),[[k,t.need_page_documents]]),e_])])):r("",!0),t.need_page_documents?(l(),n("div",t_,[g(V,{"need-document":!0,selected:t.pageForm.documents,onSelect:t.selectDocument},null,8,["selected","onSelect"])])):(l(),n("div",s_,[e("div",o_,[e("div",l_,[c(e("img",n_,null,512),[[i,"../images/icon.png"]])]),i_,a_,e("div",d_,[e("button",{disabled:t.need_page_documents,onClick:s[32]||(s[32]=d=>t.need_page_documents=!0),class:f([{"btn-primary":!t.need_page_documents,"btn-outline-secondary":t.need_page_documents},"d-inline-flex align-items-center btn btn-lg px-4 rounded-pill"]),type:"button"}," Добавить ",10,r_),c_])])]))],512),[[z,t.tab===6]]),c(e("div",null,[e("div",u_,[e("div",m_,[e("div",h_,[c(e("img",__,null,512),[[i,"../images/icon.png"]])]),p_,b_,t.pageForm.next_page_id?(l(),n("p",f_,"Связано со страницей #"+u(t.pageForm.next_page_id),1)):r("",!0),e("div",g_,[t.pageForm.next_page_id?(l(),n("button",{key:0,class:"d-inline-flex align-items-center btn btn-lg px-4 rounded-pill btn-danger",type:"button",onClick:s[33]||(s[33]=(...d)=>t.clearLinks&&t.clearLinks(...d))},"Очистить ")):(l(),n("button",v_," Связать ")),y_]),$_,e("div",k_,[F_,C_,(l(!0),n(v,null,$(t.links,(d,h)=>(l(),n("div",w_,[e("button",{type:"button",onClick:p=>t.removeLink(h),class:f([{"btn-danger":t.chainCollapseTest(d)},"btn btn-primary position-relative rounded-5"])},[m(u(d.slug.command||"-")+" ",1),e("span",j_," #"+u(d.id),1)],10,S_),h<t.links.length-1?(l(),n("i",q_)):r("",!0)]))),256)),t.links.length>0?(l(),n("i",z_)):r("",!0),V_])])])],512),[[z,t.tab===7]]),c(e("div",null,[t.need_attach_slug?(l(),n("div",P_,[O_,e("div",U_,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[34]||(s[34]=d=>t.need_show_global_slug_list=d),type:"checkbox",id:"need-show-global-slug-list"},null,512),[[k,t.need_show_global_slug_list]]),A_]),t.bot&&t.need_show_global_slug_list?(l(),y(Y,{key:0,"can-add":!0,bot:t.bot,onCallback:t.loadSlugs},null,8,["bot","onCallback"])):r("",!0)])):r("",!0),t.need_attach_slug?(l(),n("div",Q_,[e("div",I_,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[35]||(s[35]=d=>t.need_attach_slug=d),type:"checkbox",id:"need-slug-attach"},null,512),[[k,t.need_attach_slug]]),T_])])):r("",!0),t.need_attach_slug?(l(),n("div",B_,[t.pageForm.next_bot_menu_slug_id?(l(),n("div",R_,[m(" Связано со скриптом #"+u(t.pageForm.next_bot_menu_slug_id)+" ",1),e("a",{class:"btn btn-link text-danger",onClick:s[36]||(s[36]=d=>t.pageForm.next_bot_menu_slug_id=null)},"Очистить")])):r("",!0),t.bot&&t.load_slug_simple_list?(l(),y(ne,{key:1,global:!0,selected:[t.pageForm.next_bot_menu_slug_id],onCallback:t.associateSlug,bot:t.bot},null,8,["selected","onCallback","bot"])):r("",!0)])):(l(),n("div",M_,[e("div",D_,[e("div",E_,[c(e("img",L_,null,512),[[i,"../images/icon.png"]])]),K_,N_,e("div",J_,[e("button",{disabled:t.need_attach_slug,onClick:s[37]||(s[37]=d=>t.need_attach_slug=!0),class:f([{"btn-primary":!t.need_attach_slug,"btn-outline-secondary":t.need_attach_slug},"d-inline-flex align-items-center btn btn-lg px-4 rounded-pill"]),type:"button"}," Добавить ",10,Y_),G_])])]))],512),[[z,t.tab===8]]),c(e("div",null,[t.need_attach_dialog?(l(),n("div",H_,[e("div",W_,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[38]||(s[38]=d=>t.need_attach_dialog=d),type:"checkbox",id:"need-dialog-attach"},null,512),[[k,t.need_attach_dialog]]),X_])])):r("",!0),t.need_attach_dialog?(l(),n("div",Z_,[t.pageForm.next_bot_dialog_command_id?(l(),n("p",x_,[m("Связано с диалогом #"+u(t.pageForm.next_bot_dialog_command_id)+" ",1),e("a",{class:"btn btn-link",onClick:s[39]||(s[39]=d=>t.pageForm.next_bot_dialog_command_id=null)},"Очистить")])):r("",!0),t.bot?(l(),y(ie,{key:1,onSelectDialog:t.associateDialog,bot:t.bot},null,8,["onSelectDialog","bot"])):r("",!0)])):(l(),n("div",ep,[e("div",tp,[e("div",sp,[c(e("img",op,null,512),[[i,"../images/icon.png"]])]),lp,np,e("div",ip,[e("button",{disabled:t.need_attach_dialog,onClick:s[40]||(s[40]=d=>t.need_attach_dialog=!0),class:f([{"btn-primary":!t.need_attach_dialog,"btn-outline-secondary":t.need_attach_dialog},"d-inline-flex align-items-center btn btn-lg px-4 rounded-pill"]),type:"button"}," Добавить ",10,ap),dp])])]))],512),[[z,t.tab===9]]),c(e("div",null,[t.need_rules?(l(),n("div",rp,[e("div",cp,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[41]||(s[41]=d=>t.need_rules=d),type:"checkbox",id:"need-rules"},null,512),[[k,t.need_rules]]),up])])):r("",!0),t.need_rules?(l(),n("div",mp,[g(Xr,{bot:t.bot,"rules-form":t.pageForm},null,8,["bot","rules-form"])])):(l(),n("div",hp,[e("div",_p,[e("div",pp,[c(e("img",bp,null,512),[[i,"../images/icon.png"]])]),fp,gp,e("div",vp,[e("button",{disabled:t.need_rules,onClick:s[42]||(s[42]=d=>t.need_rules=!0),class:f([{"btn-primary":!t.need_rules,"btn-outline-secondary":t.need_rules},"d-inline-flex align-items-center btn btn-lg px-4 rounded-pill"]),type:"button"}," Добавить ",10,yp),$p])])]))],512),[[z,t.tab===10]])],512),[[z,!t.pageForm.is_external]])],32)):r("",!0),kp,e("div",Fp,[e("div",Cp,[e("div",wp,[Sp,e("div",jp,[t.bot?(l(),n("div",qp,[e("div",zp,[e("h6",Vp,[e("span",null,[m("Вы создаете страницу для "),e("a",{href:"https://t.me/"+t.bot.bot_domain,target:"_blank"},u(t.bot.bot_domain),9,Pp)])])])])):r("",!0),e("form",{onSubmit:s[50]||(s[50]=S((...d)=>t.submitPage&&t.submitPage(...d),["prevent"])),class:"row"},[e("div",Op,[Up,e("ul",Ap,[e("li",{class:f({active:t.need_page_images})},Ip,2),e("li",{class:f({active:t.need_page_sticker})},Bp,2),e("li",{class:f({active:t.need_page_video})},Mp,2),e("li",{class:f({active:t.need_page_audios})},Ep,2),e("li",{class:f({active:t.need_page_documents})},Kp,2),e("li",{class:f({active:t.need_attach_page})},Jp,2),e("li",{class:f({active:t.need_attach_slug})},Gp,2),e("li",{class:f({active:t.need_attach_dialog})},Wp,2),e("li",{class:f({active:t.need_rules})},Zp,2),e("li",{class:f({active:t.need_reply_menu})},eb,2),e("li",{class:f({active:t.need_inline_menu})},sb,2)])]),t.pageForm.id?(l(),n("div",ob,[e("div",lb,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[44]||(s[44]=d=>t.need_show_qr_and_link=d),type:"checkbox",id:"need-show-qr-and-link"},null,512),[[k,t.need_show_qr_and_link]]),nb])])):r("",!0),t.pageForm.id&&t.need_show_qr_and_link?(l(),n("div",ib,[e("p",null,[m("Ссылка на текущую страницу: "),e("span",{class:"bg-secondary font-bold cursor-pointer",onClick:s[45]||(s[45]=d=>t.copyToClipBoard(t.pageLink))},u(t.pageLink),1)]),e("div",ab,[c(e("img",db,null,512),[[i,t.qr]])])])):r("",!0),e("div",rb,[e("label",cb,[g(a,null,{content:b(()=>[mb]),default:b(()=>[ub]),_:1}),m(" Описание страницы "),hb]),c(e("textarea",{type:"text",class:"form-control",placeholder:"Описание страницы","aria-label":"Описание страницы","onUpdate:modelValue":s[46]||(s[46]=d=>t.pageForm.comment=d),maxlength:"255","aria-describedby":"bot-domain",required:""},`
            `,512),[[_,t.pageForm.comment]])]),e("div",_b,[e("div",pb,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[47]||(s[47]=d=>t.pageForm.is_external=d),type:"checkbox",id:"is-external"},null,512),[[k,t.pageForm.is_external]]),bb]),t.pageForm.is_external?(l(),n("div",fb,[m(" Обработка ссылок передана на внешний адрес, указанный в настройках бота! Все запросы по данной кнопке будут отправлены на указанный URL-адрес: "),e("strong",null,u(t.bot.callback_link||"не указано")+".",1),t.bot.callback_link?r("",!0):(l(),n("p",gb,[m("Внешня ссылка не установлена! Перейдите в раздел "),vb,m(", затем "),yb,m(" и установите ссылку для внешнего управления в поле "),$b,m("!")]))])):r("",!0)]),e("div",kb,[e("div",Fb,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[48]||(s[48]=d=>t.pageForm.need_log_user_action=d),type:"checkbox",id:"need_log_user_action"},null,512),[[k,t.pageForm.need_log_user_action]]),Cb])]),e("div",wb,[e("div",Sb,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[49]||(s[49]=d=>t.need_stay_after_save=d),type:"checkbox",id:"need-stay-after-save"},null,512),[[k,t.need_stay_after_save]]),jb])]),qb],32)]),zb])])]),e("div",Vb,[e("div",Pb,[e("div",Ob,[e("div",Ub,[g(B,{current:t.pageForm.id,selected:t.selectedLinkIds,onCallback:t.attachPage,editor:!1},null,8,["current","selected","onCallback"])])])])]),e("div",Ab,[e("div",Qb,[e("div",Ib,[e("div",Tb,[t.page?(l(),y(pc,{key:0,page:t.page},null,8,["page"])):(l(),n("p",Bb,"Сперва сохраните страницу"))])])])]),m("- "),e("div",Rb,[Mb,e("div",Db,[e("div",Eb,[e("div",Lb,[t.loaded_page_list?(l(),y(B,{key:0,editor:!0,current:t.page,onCallback:t.pageListCallback},null,8,["current","onCallback"])):r("",!0)])])])])],64)}}}),Jb={props:["bot","item"],data(){return{sectionForm:{section:null},categoryForm:{label:null},tab:0,types:[{title:"Готовый продукт",value:1},{title:"Товар на вес",value:2},{title:"Конструктор товара",value:3}],productCategories:[],sections:["Общие характеристики","Дополнительная информация"],photos:[],categories:[],removed_options:[],productForm:{article:null,vk_product_id:null,frontpad_article:null,iiko_article:null,title:null,description:null,images:[],type:1,old_price:null,current_price:null,variants:[],in_stop_list_at:null,bot_id:null,options:[],reviews:[],categories:[]}}},computed:{...w(["getProductCategories"]),filteredCategories(){return this.productCategories.length===0?this.categories:this.categories.filter(o=>this.productCategories.indexOf(o.value)===-1)}},mounted(){this.loadProductCategories(),this.item&&this.$nextTick(()=>{this.productForm={id:this.item.id||null,article:this.item.article||null,vk_product_id:this.item.vk_product_id||null,frontpad_article:this.item.frontpad_article||null,iiko_article:this.item.iiko_article||null,title:this.item.title||null,description:this.item.description||null,images:this.item.images||null,type:this.item.type||1,old_price:this.item.old_price||null,current_price:this.item.current_price||null,variants:this.item.variants||null,in_stop_list_at:this.item.in_stop_list_at||null,bot_id:this.item.bot_id||null,options:this.item.options||null,reviews:this.item.reviews||null},this.options=[],this.item.categories.forEach(o=>{this.productCategories.push(o.id)})})},methods:{prepareCategoryName(o){let t=this.categories.find(s=>s.value===o);return console.log(t),t?t.label:o},addCategory(){const o=this.categoryForm.label;this.productCategories.push(o),this.categoryForm.label=null},selectCategory(o){this.productCategories.push(o.value)},submit(){let o=new FormData;if(Object.keys(this.productForm).forEach(t=>{const s=this.productForm[t]||"";typeof s=="object"?o.append(t,JSON.stringify(s)):o.append(t,s)}),this.bot&&o.append("bot_id",this.bot.id),this.photos.length>0)for(let t=0;t<this.photos.length;t++)o.append("photos[]",this.photos[t]);this.removed_options.length>0&&o.append("removed_options",JSON.stringify(this.removed_options)),this.productCategories.length>0&&o.append("categories",JSON.stringify(this.productCategories)),this.$store.dispatch("saveProduct",{productForm:o}).then(t=>{this.load=!0,this.$notify({title:"Конструктор ботов",text:"Продукт успешно сохранен!",type:"success"}),this.clearForm(),this.$emit("refresh")}).catch(t=>{})},onChangePhotos(o){const t=o.target.files;for(let s=0;s<t.length;s++)this.photos.push(t[s])},loadProductCategories(){this.$store.dispatch("loadProductCategories",{dataObject:{bot_id:this.bot.id}}).then(()=>{this.getProductCategories.forEach(t=>{this.categories.push({value:t.id,label:t.title})})})},getPhoto(o){return{imageUrl:URL.createObjectURL(o)}},removeSection(o){this.sections.splice(o,1)},addSection(){this.sections.push(this.sectionForm.section),this.sectionForm.section=null},addOption(){this.productForm.options||(this.productForm.options=[]),this.productForm.options.push({id:null,key:null,value:null,title:null,section:null})},addVariant(){this.productForm.variants||(this.productForm.variants=[]),this.productForm.variants.push({key:null,value:null})},removeProductCategory(o){this.productCategories.splice(o,1)},removeVariant(o){this.productForm.variants.splice(o,1)},removeOption(o){this.productForm.options[o].id&&this.removed_options.push(this.productForm.options[o].id),this.productForm.options.splice(o,1)},removeImage(o){this.productForm.images.splice(o,1)},removePhoto(o){this.photos.splice(o,1)},clearForm(){const o={article:null,vk_product_id:null,title:null,description:null,images:[],type:1,old_price:null,current_price:null,variants:[],in_stop_list_at:null,bot_id:null,options:[],reviews:[],categories:[]};this.photos=[],this.removed_options=[],this.productCategories=[],this.productForm=o}}},Yb={class:"nav nav-tabs"},Gb={class:"nav-item"},Hb={class:"nav-item"},Wb={class:"nav-item"},Xb={key:0},Zb={class:"col-md-8 d-flex align-items-center"},xb={class:"form-check"},ef=e("label",{class:"form-check-label",for:"in-stop-list"}," Товар находится в стоп-листе ",-1),tf={class:"col-md-4 d-flex justify-content-end"},sf={class:"col-md-12 mb-3"},of=["onClick"],lf={class:"dropdown"},nf=e("button",{type:"button",class:"btn btn-outline-info w-100","data-bs-toggle":"dropdown","data-bs-display":"static","aria-expanded":"false"},[e("p",{class:"mb-0"},"Выберите категорию")],-1),af={class:"dropdown-menu w-100",style:{"overflow-y":"scroll",height:"300px"}},df={class:"p-3"},rf=e("label",{for:"exampleDropdownFormEmail1",class:"form-label"},"Новая категория",-1),cf={class:"p-3"},uf=e("li",null,[e("hr",{class:"dropdown-divider"})],-1),mf=["onClick"],hf={class:"col-md-6"},_f={class:"form-floating mb-3"},pf=e("label",{for:"article"},"Артикул товара",-1),bf={class:"col-md-6"},ff={class:"form-floating mb-3"},gf=e("label",{for:"article"},"Артикул товара FrontPad",-1),vf={class:"col-md-6"},yf={class:"form-floating mb-3"},$f=e("label",{for:"article"},"Артикул товара в IIKO",-1),kf={class:"col-md-6"},Ff={class:"form-floating mb-3"},Cf=e("label",{for:"vk-product-id"},"Идентификатор товара VK",-1),wf={class:"col-md-6"},Sf={class:"form-floating mb-3"},jf=e("label",{for:"title"},"Названи товара",-1),qf={class:"col-md-6"},zf={class:"form-floating mb-3"},Vf=["value"],Pf=e("label",{for:"type"},"Тип товара",-1),Of={class:"col-md-12"},Uf={class:"form-floating mb-3"},Af=e("label",{for:"description"},"Описание товара",-1),Qf={class:"col-md-6"},If={class:"form-floating mb-3"},Tf=e("label",{for:"current-price"},"Актуальная цена",-1),Bf={class:"col-md-6"},Rf={class:"form-floating mb-3"},Mf=e("label",{for:"old-price"},"Старая цена",-1),Df={class:"col-md-12 mb-3"},Ef={class:"card"},Lf={class:"card-header"},Kf={key:0},Nf={class:"card-body"},Jf={class:"row"},Yf={class:"col-12 mb-3"},Gf={class:"col-md-6 mb-3"},Hf={class:"card w-100"},Wf={class:"card-body"},Xf={class:"form-floating mb-3"},Zf=["onUpdate:modelValue","id"],xf=["for"],e1={class:"form-floating mb-3"},t1=["onUpdate:modelValue","id"],s1=["for"],o1={class:"card-footer"},l1=["onClick"],n1=e("i",{class:"fa-solid fa-trash-can"},null,-1),i1=[n1],a1={class:"col-md-12 mb-3"},d1={class:"card"},r1=e("div",{class:"card-header"},[e("h6",null,"Характеристики товара")],-1),c1={class:"card-body"},u1={class:"row mb-3"},m1={class:"col-12"},h1=e("button",{class:"btn btn-outline-info",type:"submit",id:"button-addon2"},"Добавить секцию ",-1),_1={class:"badge bg-info mr-1"},p1=["onClick"],b1=e("i",{class:"fa-solid fa-xmark"},null,-1),f1=[b1],g1={class:"row"},v1={class:"col-md-4 mb-3"},y1={class:"card w-100"},$1={class:"card-body"},k1={class:"form-floating mb-3"},F1=["onUpdate:modelValue","id"],C1=["for"],w1={class:"form-floating mb-3"},S1=["onUpdate:modelValue","id"],j1=["for"],q1={class:"form-floating mb-3"},z1=["onUpdate:modelValue","id"],V1=e("option",{value:null},"Без секции",-1),P1=["value"],O1=["for"],U1={class:"card-footer"},A1=["onClick"],Q1=e("i",{class:"fa-solid fa-trash-can"},null,-1),I1=[Q1],T1={class:"row"},B1={class:"col-12"},R1={class:"col-md-12 mb-3"},M1=e("h6",null,"Фотографии товара",-1),D1={class:"photo-preview d-flex justify-content-start flex-wrap w-100"},E1={for:"location-photos",style:{"margin-right":"10px"},class:"photo-loader ml-2"},L1=e("span",null,"+",-1),K1={class:"mb-2 img-preview",style:{"margin-right":"10px"}},N1={class:"remove"},J1=["onClick"],Y1={class:"mb-2 img-preview",style:{"margin-right":"10px"}},G1={class:"remove"},H1=["onClick"],W1=e("div",{class:"col-12"},[e("button",{type:"submit",class:"btn btn-outline-primary w-100 p-3"},"Сохранить ")],-1),X1={key:1};function Z1(o,t,s,a,i,d){const h=A("lazy");return l(),n(v,null,[e("ul",Yb,[e("li",Gb,[e("a",{class:f(["nav-link",{active:i.tab===0}]),onClick:t[0]||(t[0]=p=>i.tab=0),"aria-current":"page",href:"#product-form-info"},"Информация о товаре",2)]),e("li",Hb,[e("a",{class:f(["nav-link",{active:i.tab===1}]),onClick:t[1]||(t[1]=p=>i.tab=1),href:"#product-reviews"},"Комментарии",2)]),e("li",Wb,[e("a",{class:f(["nav-link",{active:i.tab===2}]),onClick:t[2]||(t[2]=p=>i.tab=2),href:"#product-reviews"},"Заказы",2)])]),i.tab===0?(l(),n("div",Xb,[e("form",{onSubmit:t[21]||(t[21]=S((...p)=>d.submit&&d.submit(...p),["prevent"])),class:"row"},[e("div",Zb,[e("div",xb,[c(e("input",{class:"form-check-input","onUpdate:modelValue":t[3]||(t[3]=p=>i.productForm.in_stop_list_at=p),type:"checkbox",value:"false",id:"in-stop-list"},null,512),[[k,i.productForm.in_stop_list_at]]),ef])]),e("div",tf,[e("a",{href:"#",class:"btn btn-link",onClick:t[4]||(t[4]=(...p)=>d.clearForm&&d.clearForm(...p))},"Новый товар")]),e("div",sf,[(l(!0),n(v,null,$(i.productCategories,(p,F)=>(l(),n("span",{class:"badge bg-info mr-1 mb-1 cursor-pointer",onClick:C=>d.removeProductCategory(F)},u(d.prepareCategoryName(p)),9,of))),256)),e("div",lf,[nf,e("ul",af,[e("div",df,[rf,c(e("input",{type:"text",class:"form-control","onUpdate:modelValue":t[5]||(t[5]=p=>i.categoryForm.label=p),id:"exampleDropdownFormEmail1",placeholder:"Название категории"},null,512),[[_,i.categoryForm.label]])]),e("div",cf,[e("button",{class:"btn btn-primary w-100",type:"button",onClick:t[6]||(t[6]=(...p)=>d.addCategory&&d.addCategory(...p))},"Добавить категорию ")]),uf,(l(!0),n(v,null,$(d.filteredCategories,p=>(l(),n("li",null,[e("button",{class:"dropdown-item",type:"button",onClick:F=>d.selectCategory(p)},u(p.label),9,mf)]))),256))])])]),e("div",hf,[e("div",_f,[c(e("input",{type:"text","onUpdate:modelValue":t[7]||(t[7]=p=>i.productForm.article=p),class:"form-control",id:"article",placeholder:"name@example.com"},null,512),[[_,i.productForm.article]]),pf])]),e("div",bf,[e("div",ff,[c(e("input",{type:"text","onUpdate:modelValue":t[8]||(t[8]=p=>i.productForm.frontpad_article=p),class:"form-control",id:"article",placeholder:"name@example.com"},null,512),[[_,i.productForm.frontpad_article]]),gf])]),e("div",vf,[e("div",yf,[c(e("input",{type:"text","onUpdate:modelValue":t[9]||(t[9]=p=>i.productForm.iiko_article=p),class:"form-control",id:"article",placeholder:"name@example.com"},null,512),[[_,i.productForm.iiko_article]]),$f])]),e("div",kf,[e("div",Ff,[c(e("input",{type:"text","onUpdate:modelValue":t[10]||(t[10]=p=>i.productForm.vk_product_id=p),disabled:!0,class:"form-control",id:"vk-product-id",placeholder:"name@example.com"},null,512),[[_,i.productForm.vk_product_id]]),Cf])]),e("div",wf,[e("div",Sf,[c(e("input",{type:"text","onUpdate:modelValue":t[11]||(t[11]=p=>i.productForm.title=p),class:"form-control",id:"title",placeholder:"name@example.com"},null,512),[[_,i.productForm.title]]),jf])]),e("div",qf,[e("div",zf,[c(e("select",{class:"form-select","onUpdate:modelValue":t[12]||(t[12]=p=>i.productForm.type=p),id:"type","aria-label":"Floating label select example"},[(l(!0),n(v,null,$(i.types,(p,F)=>(l(),n("option",{value:p.value},u(p.title),9,Vf))),256))],512),[[T,i.productForm.type]]),Pf])]),e("div",Of,[e("div",Uf,[c(e("textarea",{class:"form-control","onUpdate:modelValue":t[13]||(t[13]=p=>i.productForm.description=p),placeholder:"Leave a comment here",id:"description"},null,512),[[_,i.productForm.description]]),Af])]),e("div",Qf,[e("div",If,[c(e("input",{type:"number","onUpdate:modelValue":t[14]||(t[14]=p=>i.productForm.current_price=p),class:"form-control",id:"current-price",placeholder:"name@example.com"},null,512),[[_,i.productForm.current_price]]),Tf])]),e("div",Bf,[e("div",Rf,[c(e("input",{type:"number","onUpdate:modelValue":t[15]||(t[15]=p=>i.productForm.old_price=p),class:"form-control",id:"old-price",placeholder:"name@example.com"},null,512),[[_,i.productForm.old_price]]),Mf])]),e("div",Df,[e("div",Ef,[e("div",Lf,[e("h6",null,[m("Варианты товара "),i.productForm.variants?(l(),n("span",Kf,"("+u(i.productForm.variants.length)+")",1)):r("",!0)])]),e("div",Nf,[e("div",Jf,[e("div",Yf,[e("button",{type:"button",class:"btn btn-outline-info w-100",onClick:t[16]||(t[16]=(...p)=>d.addVariant&&d.addVariant(...p))},"Добавить вариант ")]),(l(!0),n(v,null,$(i.productForm.variants,(p,F)=>(l(),n("div",Gf,[e("div",Hf,[e("div",Wf,[e("div",Xf,[c(e("input",{type:"text","onUpdate:modelValue":C=>i.productForm.variants[F].key=C,class:"form-control",id:"variant-key-"+F,placeholder:"name@example.com",required:""},null,8,Zf),[[_,i.productForm.variants[F].key]]),e("label",{for:"variant-key-"+F},"Ключ",8,xf)]),e("div",e1,[c(e("input",{type:"text","onUpdate:modelValue":C=>i.productForm.variants[F].value=C,class:"form-control",id:"variant-value-"+F,placeholder:"name@example.com",required:""},null,8,t1),[[_,i.productForm.variants[F].value]]),e("label",{for:"variant-value-"+F},"Значение",8,s1)])]),e("div",o1,[e("button",{type:"button",class:"btn btn-outline-danger",onClick:C=>d.removeVariant(F)},i1,8,l1)])])]))),256))])])])]),e("div",a1,[e("div",d1,[r1,e("div",c1,[e("div",u1,[e("div",m1,[e("form",{onSubmit:t[18]||(t[18]=S((...p)=>d.addSection&&d.addSection(...p),["prevent"])),class:"input-group mb-3"},[c(e("input",{type:"text","onUpdate:modelValue":t[17]||(t[17]=p=>i.sectionForm.section=p),class:"form-control border-info",placeholder:"Название секции","aria-label":"Recipient's username","aria-describedby":"button-addon2",required:""},null,512),[[_,i.sectionForm.section]]),h1],32),(l(!0),n(v,null,$(i.sections,(p,F)=>(l(),n("span",_1,[m(u(p)+" ",1),e("strong",{onClick:C=>d.removeSection(F)},f1,8,p1)]))),256))])]),e("div",g1,[(l(!0),n(v,null,$(i.productForm.options,(p,F)=>(l(),n("div",v1,[e("div",y1,[e("div",$1,[e("div",k1,[c(e("input",{type:"text","onUpdate:modelValue":C=>i.productForm.options[F].title=C,class:"form-control",id:"option-title-"+F,placeholder:"name@example.com"},null,8,F1),[[_,i.productForm.options[F].title]]),e("label",{for:"option-title-"+F},"Название характеристики",8,C1)]),e("div",w1,[c(e("input",{type:"text","onUpdate:modelValue":C=>i.productForm.options[F].value=C,class:"form-control",id:"option-value-"+F,placeholder:"name@example.com"},null,8,S1),[[_,i.productForm.options[F].value]]),e("label",{for:"option-value-"+F},"Значение характеристики",8,j1)]),e("div",q1,[c(e("select",{class:"form-select","onUpdate:modelValue":C=>i.productForm.options[F].section=C,id:"option-section-"+F,"aria-label":"Floating label select example"},[V1,(l(!0),n(v,null,$(i.sections,C=>(l(),n("option",{value:C},u(C),9,P1))),256))],8,z1),[[T,i.productForm.options[F].section]]),e("label",{for:"option-section-"+F},"Секция товара",8,O1)])]),e("div",U1,[e("button",{type:"button",class:"btn btn-outline-danger",onClick:C=>d.removeOption(F)},I1,8,A1)])])]))),256))]),e("div",T1,[e("div",B1,[e("button",{type:"button",class:"btn btn-outline-info w-100",onClick:t[19]||(t[19]=(...p)=>d.addOption&&d.addOption(...p))},"Добавить характеристику ")])])])])]),e("div",R1,[M1,e("div",D1,[e("label",E1,[L1,e("input",{type:"file",id:"location-photos",multiple:"",accept:"image/*",onChange:t[20]||(t[20]=(...p)=>d.onChangePhotos&&d.onChangePhotos(...p)),style:{display:"none"}},null,32)]),i.productForm.images?(l(!0),n(v,{key:0},$(i.productForm.images,(p,F)=>(l(),n("div",K1,[c(e("img",null,null,512),[[h,p]]),e("div",N1,[e("a",{onClick:C=>d.removeImage(F)},"Удалить",8,J1)])]))),256)):r("",!0),i.photos.length>0?(l(!0),n(v,{key:1},$(i.photos,(p,F)=>(l(),n("div",Y1,[c(e("img",null,null,512),[[h,d.getPhoto(p).imageUrl]]),e("div",G1,[e("a",{onClick:C=>d.removePhoto(F)},"Удалить",8,H1)])]))),256)):r("",!0)])]),W1],32)])):r("",!0),i.tab===1?(l(),n("div",X1," Отзывы ")):r("",!0)],64)}const x1=O(Jb,[["render",Z1]]),eg={props:["item"],data(){return{bot:null}},methods:{preparedImgUrl(o){return o.toLocaleLowerCase().startsWith("https://")||o.toLocaleLowerCase().startsWith("http://")?o:"/images-by-bot-id/"+this.bot.id+"/"+o},removeProduct(){this.$store.dispatch("removeProduct",this.item.id).then(o=>{this.$notify({title:"Конструктор ботов",text:"Продукт успешно удален!",type:"success"})}).catch(o=>{})},duplicateProduct(){this.$store.dispatch("duplicateProduct",this.item.id).then(o=>{this.$notify({title:"Конструктор ботов",text:"Продукт успешно продублирован!",type:"success"})}).catch(o=>{})}},mounted(){this.bot=this.getCurrentBot},computed:{...w(["getCurrentBot"])}},tg={key:0,class:"card"},sg={class:"card-header"},og={class:"card-body"},lg=["id"],ng={class:"carousel-inner"},ig=["src"],ag=["data-bs-target"],dg=e("span",{class:"carousel-control-prev-icon","aria-hidden":"true"},null,-1),rg=e("span",{class:"visually-hidden"},"Previous",-1),cg=[dg,rg],ug=["data-bs-target"],mg=e("span",{class:"carousel-control-next-icon","aria-hidden":"true"},null,-1),hg=e("span",{class:"visually-hidden"},"Next",-1),_g=[mg,hg],pg={class:"card-footer d-flex justify-content-between"},bg=e("i",{class:"fa-regular fa-copy"},null,-1),fg=[bg],gg=e("i",{class:"fa-solid fa-trash-can"},null,-1),vg=[gg];function yg(o,t,s,a,i,d){return i.bot?(l(),n("div",tg,[e("div",sg,[e("p",null,"#"+u(s.item.id),1)]),e("div",og,[e("p",null,u(s.item.title),1),e("div",{id:"image-slider-"+s.item.id,class:"carousel slide","data-bs-ride":"carousel"},[e("div",ng,[(l(!0),n(v,null,$(s.item.images,(h,p)=>(l(),n("div",{class:f(["carousel-item",{active:p===0}]),style:{height:"300px"}},[e("img",{src:d.preparedImgUrl(h),class:"d-block w-100 object-fit-cover",alt:"..."},null,8,ig)],2))),256))]),e("button",{class:"carousel-control-prev",type:"button","data-bs-target":"#image-slider-"+s.item.id,"data-bs-slide":"prev"},cg,8,ag),e("button",{class:"carousel-control-next",type:"button","data-bs-target":"#image-slider-"+s.item.id,"data-bs-slide":"next"},_g,8,ug)],8,lg)]),e("div",pg,[e("button",{title:"Дублировать товар",onClick:t[0]||(t[0]=(...h)=>d.duplicateProduct&&d.duplicateProduct(...h)),class:"btn btn-outline-info mr-1"},fg),e("button",{title:"Удалить товар",onClick:t[1]||(t[1]=(...h)=>d.removeProduct&&d.removeProduct(...h)),class:"btn btn-outline-danger"},vg)])])):r("",!0)}const $g=O(eg,[["render",yg]]),kg=e("button",{class:"btn btn-outline-info",type:"submit",id:"button-addon2"}," Найти ",-1),Fg={key:0},Cg={class:"row"},wg={class:"col-4 mb-2"},Sg={props:["bot"],data(){return{search:null,products:[],paginate:null}},computed:{...w(["getProducts","getProductsPaginateObject"]),filteredProducts(){return this.search?this.products.filter(o=>o.title.toLowerCase().trim().indexOf(this.search.toLowerCase().trim())>=0):this.products}},mounted(){this.loadProducts()},methods:{selectProduct(o){this.$emit("select",o)},nextProducts(o){this.loadProducts(o)},loadProducts(o=0){return this.$store.dispatch("loadProducts",{dataObject:{bot_id:this.bot.id,search:this.search},page:o}).then(()=>{this.products=this.getProducts,this.paginate=this.getProductsPaginateObject})}}},jg=Object.assign(Sg,{__name:"ProductList",setup(o){return(t,s)=>(l(),n(v,null,[e("form",{class:"input-group mb-3",onSubmit:s[1]||(s[1]=S(a=>t.loadProducts(0),["prevent"]))},[c(e("input",{type:"text",class:"form-control border-info",placeholder:"Поиск товара","aria-label":"Поиск товара","onUpdate:modelValue":s[0]||(s[0]=a=>t.search=a),"aria-describedby":"button-addon2",required:""},null,512),[[_,t.search]]),kg],32),e("p",null,[m("Всего товаров: "),t.paginate?(l(),n("span",Fg,u(t.paginate.meta.total||0),1)):r("",!0)]),e("div",Cg,[(l(!0),n(v,null,$(t.filteredProducts,(a,i)=>(l(),n("div",wg,[g($g,{onClick:d=>t.selectProduct(a),item:a},null,8,["onClick","item"])]))),256))]),t.paginate?(l(),y(j,{key:0,onPagination_page:t.nextProducts,pagination:t.paginate},null,8,["onPagination_page","pagination"])):r("",!0)],64))}}),qg={class:"card mb-2"},zg=e("div",{class:"card-header"},[e("h6",null,"Управление магазином")],-1),Vg={class:"card-body"},Pg={class:"row"},Og={class:"col-12"},Ug={class:"form-label d-flex justify-content-between mt-2",id:"bot-level-3"},Ag=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),Qg=e("div",null,"Ссылка на страницу ВК с товарами для вашего магазина в боте ",-1),Ig=e("a",{href:"https://vk.com/groups?w=groups_create",target:"_blank"},"Создать",-1),Tg=["disabled"],Bg=e("i",{class:"fa-regular fa-floppy-disk mr-2"},null,-1),Rg={class:"row mb-3"},Mg={class:"col-md-3"},Dg=["href"],Eg=_e('<div class="col-md-3"><button class="btn btn-outline-info w-100">Экспорт в XLS</button></div><div class="col-md-3"><button class="btn btn-outline-info w-100">Импорт из XLS</button></div><div class="col-md-3"><button class="btn btn-outline-danger w-100">Удалить товары</button></div>',3),Lg=e("div",{class:"row"},[e("div",{class:"col-md-3"},[e("button",{class:"btn btn-outline-info w-100"},"Экспортировать заказы")])],-1),Kg={class:"card"},Ng=e("div",{class:"card-header"},[e("h6",null,"Работа с товаром")],-1),Jg={class:"card-body"},Yg={class:"card mt-2"},Gg={class:"card-body"},Hg={data(){return{load:!1,tab:0,url:null,link:null,bot:null,selectedProduct:null,botForm:{vk_shop_link:null}}},computed:{...w(["getCurrentBot"])},mounted(){this.bot=this.getCurrentBot,this.botForm.vk_shop_link=this.bot.vk_shop_link||null,this.updateProducts()},methods:{updateShopLink(){this.load=!0,this.botForm.bot_id=this.bot.id,this.$store.dispatch("updateShopLink",{botForm:this.botForm}).then(o=>{this.load=!1,this.updateProducts(),this.$notify({title:"Менеджер магазина",text:"Ссылка на источник в ВК обновлена"})}).catch(()=>{this.load=!1})},refresh(){this.load=!0,this.selectedProduct=null,this.$nextTick(()=>{this.load=!1})},selectProduct(o){this.load=!0,this.$nextTick(()=>{this.selectedProduct=o,this.load=!1})},updateProducts(){this.load=!0,this.$store.dispatch("updateProductsFromVk",{dataObject:{bot_domain:this.getCurrentBot.bot_domain}}).then(o=>{this.link=o.data.url,this.load=!1,this.url=null}).catch(()=>{this.load=!1})}}},Wg=Object.assign(Hg,{__name:"Shop",setup(o){return(t,s)=>{const a=q("Popper");return l(),n(v,null,[e("div",qg,[zg,e("div",Vg,[e("div",Pg,[e("div",Og,[e("form",{onSubmit:s[1]||(s[1]=S((...i)=>t.updateShopLink&&t.updateShopLink(...i),["prevent"])),class:"mb-2"},[e("label",Ug,[e("div",null,[g(a,null,{content:b(()=>[Qg]),default:b(()=>[Ag]),_:1}),m(" ВК-группа ")]),Ig]),c(e("input",{type:"url",class:"form-control",placeholder:"Ссылка на группу ВК","aria-label":"ссылка на группу ВК","onUpdate:modelValue":s[0]||(s[0]=i=>t.botForm.vk_shop_link=i),"aria-describedby":"vk_shop_link"},null,512),[[_,t.botForm.vk_shop_link]]),e("button",{disabled:t.load,class:"btn btn-outline-primary mt-2 mb-2 w-100"},[Bg,m(" Сохранить ")],8,Tg)],32)])]),e("div",Rg,[e("div",Mg,[e("a",{target:"_blank",href:t.link,class:"btn btn-primary w-100"}," Обновить товар ",8,Dg)]),Eg]),Lg])]),e("div",Kg,[Ng,e("div",Jg,[t.bot&&!t.load?(l(),y(x1,{key:0,bot:t.bot,item:t.selectedProduct,onRefresh:t.refresh},null,8,["bot","item","onRefresh"])):r("",!0)])]),e("div",Yg,[e("div",Gg,[t.bot&&!t.load?(l(),y(jg,{key:0,bot:t.bot,onSelect:t.selectProduct},null,8,["bot","onSelect"])):r("",!0)])])],64)}}}),Xg={props:["data"],data(){return{hasConnect:!1,bot:null,amoForm:{client_id:null,client_secret:null,auth_code:null,redirect_uri:null,subdomain:null,bot_id:null}}},computed:{...w(["getCurrentBot"])},mounted(){this.bot=this.getCurrentBot,this.data?this.$nextTick(()=>{this.amoForm.client_id=this.data.client_id||null,this.amoForm.client_secret=this.data.client_secret||null,this.amoForm.auth_code=this.data.auth_code||null,this.amoForm.redirect_uri=this.data.redirect_uri||null,this.amoForm.subdomain=this.data.subdomain||null,this.amoForm.bot_id=this.data.bot_id||this.bot.id||null}):this.amoForm.bot_id=this.bot.id||null},methods:{submitAmo(){let o=new FormData;Object.keys(this.amoForm).forEach(t=>{const s=this.amoForm[t]||"";typeof s=="object"?o.append(t,JSON.stringify(s)):o.append(t,s)}),this.$store.dispatch("saveAmoCRM",{amoForm:o}).then(t=>{this.$notify("Данные CRM успешно сохранены")}).catch(t=>{})}}},Zg=e("div",{class:"col-12"},[e("p",null,[e("a",{target:"_blank",href:"https://www.amocrm.ru/developers/content/oauth/step-by-step"},"Документация для разработчика "),m(" по шагам")])],-1),xg={class:"col-md-6 col-12 mb-2"},ev={class:"form-label",id:"client_id"},tv=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),sv=e("div",null,"ID интеграции",-1),ov=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),lv={class:"col-md-6 col-12 mb-2"},nv={class:"form-label",id:"client_secret"},iv=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),av=e("div",null,"Секрет интеграции",-1),dv=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),rv={class:"col-md-6 mb-2"},cv={class:"form-label",id:"auth_code"},uv=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),mv=e("div",null,"Полученный код авторизации",-1),hv=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),_v={class:"col-md-6 col-12 mb-2"},pv={class:"form-label",id:"subdomain2"},bv=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),fv=e("div",null,"Ваш поддомен в системе AMO CRM",-1),gv=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),vv=e("div",{class:"col-md-12 col-12"},[e("button",{type:"submit",class:"btn btn-outline-primary p-3 w-100"},[e("i",{class:"fa-solid fa-cloud-arrow-down mr-1"}),m(" Сохранить настройку AMO ")])],-1);function yv(o,t,s,a,i,d){const h=q("Popper");return l(),n("form",{onSubmit:t[4]||(t[4]=S((...p)=>d.submitAmo&&d.submitAmo(...p),["prevent"])),class:"row"},[Zg,e("div",xg,[e("label",ev,[g(h,null,{content:b(()=>[sv]),default:b(()=>[tv]),_:1}),m(" client_id "),ov]),c(e("input",{type:"text",class:"form-control",placeholder:"client_id","aria-label":"client_id","onUpdate:modelValue":t[0]||(t[0]=p=>i.amoForm.client_id=p),"aria-describedby":"client_id"},null,512),[[_,i.amoForm.client_id]])]),e("div",lv,[e("label",nv,[g(h,null,{content:b(()=>[av]),default:b(()=>[iv]),_:1}),m(" client_secret "),dv]),c(e("input",{type:"text",class:"form-control",placeholder:"client_secret","aria-label":"client_secret","onUpdate:modelValue":t[1]||(t[1]=p=>i.amoForm.client_secret=p),"aria-describedby":"client_secret"},null,512),[[_,i.amoForm.client_secret]])]),e("div",rv,[e("label",cv,[g(h,null,{content:b(()=>[mv]),default:b(()=>[uv]),_:1}),m(" auth_code "),hv]),c(e("textarea",{class:"form-control",placeholder:"auth_code","aria-label":"auth_code","onUpdate:modelValue":t[2]||(t[2]=p=>i.amoForm.auth_code=p),"aria-describedby":"auth_code"},`
                                    `,512),[[_,i.amoForm.auth_code]])]),e("div",_v,[e("label",pv,[g(h,null,{content:b(()=>[fv]),default:b(()=>[bv]),_:1}),m(" subdomain "),gv]),c(e("input",{type:"text",class:"form-control",placeholder:"subdomain","aria-label":"subdomain","onUpdate:modelValue":t[3]||(t[3]=p=>i.amoForm.subdomain=p),"aria-describedby":"subdomain"},null,512),[[_,i.amoForm.subdomain]])]),vv],32)}const $v=O(Xg,[["render",yv]]),kv={props:["data"],data(){return{load:!1,bot:null,yClientsForm:{login:null,password:null,partner_token:null,company:null}}},computed:{...w(["getCurrentBot"])},mounted(){this.bot=this.getCurrentBot,this.data&&this.$nextTick(()=>{this.yClientsForm.login=this.data.login||null,this.yClientsForm.password=this.data.password||null,this.yClientsForm.partner_token=this.data.partner_token||null,this.yClientsForm.company=this.data.company||null})},methods:{submitYClients(){let o=new FormData;Object.keys(this.yClientsForm).forEach(t=>{const s=this.yClientsForm[t]||"";typeof s=="object"?o.append(t,JSON.stringify(s)):o.append(t,s)}),o.append("bot_id",this.bot.id),this.$store.dispatch("saveYClients",{yClientsForm:o}).then(t=>{this.$notify({title:"Работа с YClients",text:"Данные YClients успешно сохранены",type:"success"})}).catch(t=>{this.$notify({title:"Работа с YClients",text:"Ошибка сохранения данных",type:"error"})})}}},Fv=e("h6",null,"Настройка YClients",-1),Cv={class:"row"},wv={class:"col-md-12"},Sv={class:"mb-2"},jv=e("label",{class:"form-label d-flex justify-content-between mt-2",for:"login"},[m(" Логин "),e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно")],-1),qv={class:"mb-2"},zv=e("label",{class:"form-label d-flex justify-content-between mt-2",for:"password"},[m(" Пароль "),e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно")],-1),Vv={class:"mb-2"},Pv=e("label",{class:"form-label d-flex justify-content-between mt-2",for:"partner_token"},[m(" Партнерский тоукен "),e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно")],-1),Ov={class:"mb-2"},Uv=e("label",{class:"form-label d-flex justify-content-between mt-2",for:"partner_token"},[m(" ID компании, в которую записывать клиентов "),e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно")],-1),Av=e("button",{class:"btn btn-success w-100 r mb-3 text-uppercase font-900"}," Сохранить ",-1);function Qv(o,t,s,a,i,d){return l(),n(v,null,[Fv,e("form",{onSubmit:t[4]||(t[4]=S((...h)=>d.submitYClients&&d.submitYClients(...h),["prevent"]))},[e("div",Cv,[e("div",wv,[e("div",Sv,[jv,c(e("input",{type:"text",id:"login",class:"form-control",placeholder:"Ваш логин","aria-label":"Ваш логин","onUpdate:modelValue":t[0]||(t[0]=h=>i.yClientsForm.login=h),"aria-describedby":"Ваш логин",required:""},null,512),[[_,i.yClientsForm.login]])]),e("div",qv,[zv,c(e("input",{type:"text",id:"password",class:"form-control",placeholder:"Ваш пароль","aria-label":"Ваш пароль","onUpdate:modelValue":t[1]||(t[1]=h=>i.yClientsForm.password=h),"aria-describedby":"Ваш пароль",required:""},null,512),[[_,i.yClientsForm.password]])]),e("div",Vv,[Pv,c(e("input",{type:"text",id:"partner_token",class:"form-control",placeholder:"Ваш партнерский тоукен","aria-label":"Ваш партнерский тоукен","onUpdate:modelValue":t[2]||(t[2]=h=>i.yClientsForm.partner_token=h),"aria-describedby":"Ваш партнерский тоукен",required:""},null,512),[[_,i.yClientsForm.partner_token]])]),e("div",Ov,[Uv,c(e("input",{type:"number",id:"throttle",class:"form-control",placeholder:"ID компании","aria-label":"ID компании","onUpdate:modelValue":t[3]||(t[3]=h=>i.yClientsForm.company=h),"aria-describedby":"ID компании",required:""},null,512),[[_,i.yClientsForm.company]])])])]),Av],32)],64)}const Iv=O(kv,[["render",Qv]]),Tv={class:"py-2"},Bv={class:"nav nav-tabs"},Rv={class:"nav-item"},Mv={class:"nav-item"},Dv={key:0,class:"row"},Ev={class:"col-12 py-2"},Lv={key:1,class:"row"},Kv={class:"col-12 py-2"},Nv={class:"col-12"},Jv={props:["bot"],data(){return{tab:1,load:!1,loadMailingTable:!1}},mounted(){},methods:{callbackPersonalMail(){this.loadMailingTable=!0,this.$nextTick(()=>{this.loadMailingTable=!1})}}},Yv=Object.assign(Jv,{__name:"Mail",setup(o){return(t,s)=>(l(),n("div",Tv,[e("ul",Bv,[e("li",Rv,[e("a",{class:f(["nav-link",{active:t.tab===0}]),onClick:s[0]||(s[0]=a=>t.tab=0),"aria-current":"page",href:"#"},"Рассылка в канал",2)]),e("li",Mv,[e("a",{class:f(["nav-link",{active:t.tab===1}]),onClick:s[1]||(s[1]=a=>t.tab=1),href:"#"},"Рассылка в бота",2)])]),t.tab===0?(l(),n("div",Dv,[e("div",Ev,[g(ue)])])):r("",!0),t.tab===1?(l(),n("div",Lv,[e("div",Kv,[g(me,{onCallback:t.callbackPersonalMail},null,8,["onCallback"])]),e("div",Nv,[t.loadMailingTable?r("",!0):(l(),y(he,{key:0,bot:o.bot},null,8,["bot"]))])])):r("",!0)]))}}),Gv={data(){return{load:!1,bot:null,fieldTypes:[{title:"Текст",value:0},{title:"Число",value:1},{title:"Логический",value:2},{title:"Дата и время",value:3}],fieldForm:{fields:[]}}},computed:{...w(["getCurrentBot"])},mounted(){this.loadCurrentBot().then(()=>{this.bot=this.getCurrentBot,this.$nextTick(()=>{this.fieldForm.fields=this.bot.field_settings||[]}),this.loadCurrentBotFields()})},methods:{loadCurrentBotFields(){return this.$store.dispatch("loadCurrentBotFields",{bot_id:this.bot.id}).then(o=>{this.fieldForm.fields=o.data||[]})},loadCurrentBot(o=null){return this.$store.dispatch("updateCurrentBot",{bot:o}).then(()=>{this.bot=this.getCurrentBot})},removeField(o){this.fieldForm.fields.splice(o,1)},submit(){let o=new FormData;Object.keys(this.fieldForm).forEach(t=>{const s=this.fieldForm[t]||"";typeof s=="object"?o.append(t,JSON.stringify(s)):o.append(t,s)}),o.append("bot_id",this.bot.id),this.$store.dispatch("storeBotFields",{dataObject:o}).then(t=>{this.$notify({title:"Конструктор ботов",text:"Поля успешно обновлены",type:"success"}),this.fieldForm.fields=[],this.fieldForm.fields=t.data}).catch(t=>{this.$notify({title:"Конструктор ботов",text:"Ошибка обновления полей",type:"error"})})},addField(){if(this.fieldForm.fields||(this.fieldForm.fields=[]),this.fieldForm.fields.length>0&&this.fieldForm.fields.findIndex(t=>t.key==null)!==-1){this.$notify({title:"Настраиваемые поля",text:"У вас есть пустые ключевые поля!",type:"error"});return}this.fieldForm.fields.push({key:null,type:0,label:null,description:null,required:!1,validate_pattern:null})}}},Hv={class:"mb-2"},Wv={class:"d-flex justify-content-between"},Xv=e("h6",null,"Настройка полей пользователя бота",-1),Zv=e("i",{class:"fa-solid fa-plus mr-2"},null,-1),xv=e("p",null,[e("em",null,"Данные поля будут добавлены пользователю бота и будут автоматически учитываться в условиях страниц, скриптах (в формах заполнения данных), диалогах. Ключи должны быть уникальные для каждого бота. Если ключ дублируется, то будет использовано более позднее его значение. Если поле добавлено и сохранено, то удалить его уже нельзя, только скрыть. "),m(". "),e("br"),e("span",{class:"text-danger"},"*"),m(" - обязательное поле ")],-1),ey={class:"table"},ty=e("thead",null,[e("tr",null,[e("th",{scope:"col"},"#"),e("th",{scope:"col"},[m("Ключ"),e("span",{class:"text-danger"},"*")]),e("th",{scope:"col"},[m("Подпись поля"),e("span",{class:"text-danger"},"*")]),e("th",{scope:"col"},[m("Тип поля"),e("span",{class:"text-danger"},"*")]),e("th",{scope:"col"},"Паттерн"),e("th",{scope:"col"},"Обязательный"),e("th",{scope:"col"},[m("Вопрос для анкеты"),e("span",{class:"text-danger"},"*")]),e("th",{scope:"col"})])],-1),sy={scope:"row"},oy={scope:"col"},ly=["onUpdate:modelValue"],ny={scope:"col"},iy=["onUpdate:modelValue"],ay={scope:"col"},dy=["onUpdate:modelValue"],ry=["value"],cy={scope:"col"},uy=["disabled","onUpdate:modelValue"],my={scope:"col"},hy={class:"form-check"},_y=["onUpdate:modelValue","id"],py=["for"],by={key:0},fy={key:1},gy={scope:"col"},vy=["onUpdate:modelValue"],yy={scope:"col"},$y=["onClick"],ky=e("i",{class:"fa-regular fa-trash-can"},null,-1),Fy=[ky],Cy={key:1,class:"form-check mt-2"},wy=["onUpdate:modelValue","id"],Sy=["for"],jy={key:0},qy=e("i",{class:"fa-solid fa-eye text-success"},null,-1),zy=[qy],Vy={key:1},Py=e("i",{class:"fa-solid fa-eye-slash text-danger"},null,-1),Oy=[Py],Uy=e("button",{type:"submit",class:"btn btn-success w-100 p-3"}," Сохранить поля ",-1);function Ay(o,t,s,a,i,d){return l(),n("div",Hv,[e("div",Wv,[Xv,e("button",{type:"button",onClick:t[0]||(t[0]=h=>d.addField()),class:"btn mb-2 rounded-sm btn-outline-info"},[Zv,m(" Добавить параметр ")])]),xv,e("form",{onSubmit:t[1]||(t[1]=S((...h)=>d.submit&&d.submit(...h),["prevent"]))},[e("table",ey,[ty,e("tbody",null,[(l(!0),n(v,null,$(i.fieldForm.fields,(h,p)=>(l(),n("tr",null,[e("th",sy,u(p+1),1),e("th",oy,[c(e("input",{type:"text",class:"form-control mb-2 w-100",placeholder:"Ключ","aria-label":"Ключ",maxlength:"255","onUpdate:modelValue":F=>i.fieldForm.fields[p].key=F,required:""},null,8,ly),[[_,i.fieldForm.fields[p].key]])]),e("th",ny,[c(e("input",{type:"text",class:"form-control mb-2 w-100",placeholder:"Подпись поля","aria-label":"Название поля",maxlength:"255","onUpdate:modelValue":F=>i.fieldForm.fields[p].label=F,required:""},null,8,iy),[[_,i.fieldForm.fields[p].label]])]),e("th",ay,[c(e("select",{class:"form-select","onUpdate:modelValue":F=>i.fieldForm.fields[p].type=F},[(l(!0),n(v,null,$(i.fieldTypes,F=>(l(),n("option",{value:F.value},u(F.title||"Не указан"),9,ry))),256))],8,dy),[[T,i.fieldForm.fields[p].type]])]),e("th",cy,[c(e("input",{type:"text",class:"form-control mb-2 w-100",placeholder:"Паттерн","aria-label":"Паттерн",maxlength:"255",disabled:i.fieldForm.fields[p].type===2,"onUpdate:modelValue":F=>i.fieldForm.fields[p].validate_pattern=F},null,8,uy),[[_,i.fieldForm.fields[p].validate_pattern]])]),e("th",my,[e("div",hy,[c(e("input",{class:"form-check-input","onUpdate:modelValue":F=>i.fieldForm.fields[p].required=F,type:"checkbox",value:"",id:"field-required"+p},null,8,_y),[[k,i.fieldForm.fields[p].required]]),e("label",{class:"form-check-label",for:"field-required"+p},[i.fieldForm.fields[p].required?(l(),n("span",by,"Да")):r("",!0),i.fieldForm.fields[p].required?r("",!0):(l(),n("span",fy,"Нет"))],8,py)])]),e("th",gy,[c(e("input",{type:"text",class:"form-control mb-2 w-100",placeholder:"Описание вопроса","aria-label":"Описание вопроса",maxlength:"255","onUpdate:modelValue":F=>i.fieldForm.fields[p].description=F,required:""},null,8,vy),[[_,i.fieldForm.fields[p].description]])]),e("th",yy,[i.fieldForm.fields[p].id?(l(),n("div",Cy,[c(e("input",{class:"form-check-input d-none","onUpdate:modelValue":F=>i.fieldForm.fields[p].is_active=F,type:"checkbox",value:"",id:"field-is_active-"+p},null,8,wy),[[k,i.fieldForm.fields[p].is_active]]),e("label",{class:"form-check-label",for:"field-is_active-"+p},[i.fieldForm.fields[p].is_active?(l(),n("span",jy,zy)):r("",!0),i.fieldForm.fields[p].is_active?r("",!0):(l(),n("span",Vy,Oy))],8,Sy)])):(l(),n("button",{key:0,type:"button",onClick:F=>d.removeField(p),class:"btn btn-link text-danger"},Fy,8,$y))])]))),256))])]),Uy],32)])}const Qy=O(Gv,[["render",Ay]]),Iy={class:"row"},Ty={class:"input-group mb-3"},By={key:0,class:"row"},Ry={class:"col-12 col-md-12 mb-3"},My={class:"table"},Dy=e("thead",null,[e("tr",null,[e("th",{scope:"col"},"#"),e("th",{scope:"col"},"Тип"),e("th",{scope:"col"},"Подпись"),e("th",{scope:"col"},"File Id"),e("th",{scope:"col"},"Действия")])],-1),Ey={scope:"row"},Ly={class:"badge bg-info rounded-pill"},Ky={style:{"word-break":"break-all"}},Ny={style:{"word-break":"break-all"}},Jy={style:{"min-width":"200px"}},Yy=["onClick"],Gy=e("i",{class:"fa-solid fa-eye"},null,-1),Hy=[Gy],Wy=["onClick"],Xy=e("i",{class:"fa-brands fa-telegram"},null,-1),Zy=[Xy],xy=["onClick"],e$=e("i",{class:"fa-solid fa-trash"},null,-1),t$=[e$],s$={class:"col-12"},o$={key:1,class:"row"},l$=e("div",{class:"col-12"},[e("div",{class:"alert alert-warning",role:"alert"}," У выбранного бота нет медиа-файлов ")],-1),n$=[l$],i$={class:"modal fade",id:"preview-modal",tabindex:"-1","aria-labelledby":"preview-modal-label","aria-hidden":"true"},a$={class:"modal-dialog"},d$={class:"modal-content"},r$={class:"modal-body"},c$={key:0,class:"d-flex justify-content-center align-items-center"},u$=e("div",{class:"modal-footer"},[e("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Закрыть")],-1),m$={data(){return{bot:null,previewContent:null,loading:!0,media:[],search:null,media_paginate_object:null}},computed:{...w(["getMedia","getMediaPaginateObject","getCurrentBot"])},mounted(){this.loadCurrentBot().then(()=>{this.loadMedia()})},methods:{selectMedia(o){this.$emit("select",o)},loadCurrentBot(o=null){return this.$store.dispatch("updateCurrentBot",{bot:o}).then(()=>{this.bot=this.getCurrentBot})},nextMedia(o){this.loadMedia(o)},remove(o){this.$store.dispatch("removeMedia",{dataObject:{mediaId:o}}).then(t=>{this.loadMedia(),this.$notify({title:"Удаление медиа-контента",text:"Медиа контент удален"})}).catch(()=>{})},showPreview(o){this.previewContent=null,this.$nextTick(()=>{this.previewContent=o,new bootstrap.Modal("#preview-modal",{}).show()})},showPreviewInTg(o){this.$store.dispatch("showMediaPreview",{dataObject:{mediaId:o}}).then(t=>{this.$notify({title:"Превью медиа-контента",text:"Отправлено в бота"})}).catch(()=>{})},loadMedia(o=0){this.loading=!0,this.$store.dispatch("loadMedia",{dataObject:{bot_id:this.bot.id||null,search:this.search,needVideo:!0,needVideoNote:!0,needPhoto:!0,needAudio:!0,needDocument:!0,needSticker:!0},page:o}).then(t=>{this.loading=!1,this.media=this.getMedia,this.media_paginate_object=this.getMediaPaginateObject}).catch(()=>{this.loading=!1})}}},h$=Object.assign(m$,{__name:"BotMediaTable",setup(o){return(t,s)=>(l(),n(v,null,[e("div",Iy,[e("div",Ty,[c(e("input",{type:"search",class:"form-control",placeholder:"Поиск файла","aria-label":"Поиск файла","onUpdate:modelValue":s[0]||(s[0]=a=>t.search=a)},null,512),[[_,t.search]]),e("button",{class:"btn btn-outline-secondary",onClick:s[1]||(s[1]=a=>t.loadMedia(0)),type:"button",id:"button-addon2"},"Найти ")])]),t.media.length>0?(l(),n("div",By,[e("div",Ry,[e("table",My,[Dy,e("tbody",null,[(l(!0),n(v,null,$(t.media,(a,i)=>(l(),n("tr",null,[e("th",Ey,u(a.id),1),e("td",null,[e("span",Ly,u(a.type),1)]),e("td",null,[e("p",Ky,u(a.caption??"Без подписи"),1)]),e("td",null,[e("p",Ny,u(a.file_id),1)]),e("td",null,[e("div",Jy,[e("a",{href:"javascript:void(0)",class:"btn btn-info mr-2",onClick:d=>t.showPreview(a)},Hy,8,Yy),e("a",{href:"javascript:void(0)",class:"btn btn-info mr-2",onClick:d=>t.showPreviewInTg(a.id)},Zy,8,Wy),e("a",{href:"javascript:void(0)",class:"btn btn-outline-danger text-danger",onClick:d=>t.remove(a.id)},t$,8,xy)])])]))),256))])])]),e("div",s$,[t.media_paginate_object?(l(),y(j,{key:0,onPagination_page:t.nextMedia,pagination:t.media_paginate_object},null,8,["onPagination_page","pagination"])):r("",!0)])])):(l(),n("div",o$,n$)),e("div",i$,[e("div",a$,[e("div",d$,[e("div",r$,[t.previewContent!=null?(l(),n("div",c$,[g(J,{type:t.previewContent.type,content:t.previewContent.file_id},null,8,["type","content"])])):r("",!0)]),u$])])])],64))}}),_$={class:"row py-3"},p$={class:"col-12"},b$={class:"row"},f$={class:"col-12"},g$={key:0},v$={key:1},y$={key:0,class:"col-12 mb-3"},$$={class:"col-12 mb-3"},k$={key:0},F$={key:1},C$={key:1,class:"col-12 mb-3"},w$={class:"row py-3"},S$=e("div",{class:"col-12"},[e("p",{class:"mb-0"},"Выбор статуса")],-1),j$={class:"col-md-3"},q$=["onClick"],z$={class:"row"},V$={class:"col-12 mb-3"},P$={class:"form-label",id:"service-title"},O$=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),U$=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),A$={class:"col-12 mb-3"},Q$={class:"form-label",id:"service-title"},I$=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),T$=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),B$={class:"col-12 mb-3"},R$={class:"form-label",id:"appointment-info"},M$=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),D$=e("div",null," Краткая информация от клиента ",-1),E$=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),L$={key:0,class:"text-gray-400 ml-3",style:{"font-size":"10px"}},K$={class:"row"},N$={class:"col-12"},J$={type:"submit",class:"btn btn-outline-success w-100 p-3"},Y$={key:0},G$={key:1},H$={props:["eventId","bot","appointment"],data(){return{step:0,load:!1,selected_schedule_time:null,selected_bot_user:null,need_load_users:!1,need_schedule_time:!1,statuses:[{value:0,title:"Новая запись"},{value:1,title:"Подтверждение записи"},{value:2,title:"Прохождение по записи"},{value:3,title:"Отмена записи"}],days:["понедельник","вторник","среду","четверг","пятницу","субботу","воскресенье"],appointmentForm:{id:null,appointment_event_id:null,appointment_schedule_id:null,bot_user_id:null,status:0,name:null,phone:null,info:null}}},mounted(){this.appointment&&this.$nextTick(()=>{this.appointmentForm={id:this.appointment.id||null,appointment_event_id:this.appointment.appointment_event_id||null,appointment_schedule_id:this.appointment.appointment_schedule_id||null,bot_user_id:this.appointment.bot_user_id||null,status:this.appointment.status||0,name:this.appointment.name||null,phone:this.appointment.phone||null,info:this.appointment.info||null},this.selected_schedule_time=this.appointment.schedule||null,this.selected_bot_user=this.appointment.botUser||null})},methods:{selectScheduleTime(o){if(o.appointment){this.$notify("Данное время уже занято!");return}this.selected_schedule_time=o,this.need_schedule_time=!1},selectBotUser(o){this.selected_bot_user=o,this.need_load_users=!1},clearAppointmentForm(){this.appointmentForm={id:null,appointment_event_id:null,appointment_schedule_id:null,bot_user_id:null,status:0},this.selected_schedule_time=null,this.selected_bot_user=null},submitForm(){this.appointmentForm.bot_user_id=this.selected_bot_user.id,this.appointmentForm.appointment_schedule_id=this.selected_schedule_time.id,this.appointmentForm.appointment_event_id=this.eventId;let o=new FormData;Object.keys(this.appointmentForm).forEach(t=>{const s=this.appointmentForm[t]||"";typeof s=="object"?o.append(t,JSON.stringify(s)):o.append(t,s)}),o.append("bot_id",this.bot.id),this.$store.dispatch("storeAppointment",{dataObject:{appointmentForm:o}}).then(t=>{this.clearAppointmentForm(),this.$emit("callback"),this.$notify("Запись успешно создана")}).catch(t=>{this.$notify("Ошибка создания записи")})}}},W$=Object.assign(H$,{__name:"AppointmentForm",setup(o){return(t,s)=>{const a=q("Popper"),i=A("mask");return l(),n(v,null,[e("div",_$,[e("div",p$,[e("button",{onClick:s[0]||(s[0]=(...d)=>t.clearAppointmentForm&&t.clearAppointmentForm(...d)),class:"btn btn-primary"},"Новая заявка ")])]),e("form",{onSubmit:s[6]||(s[6]=S((...d)=>t.submitForm&&t.submitForm(...d),["prevent"]))},[e("div",b$,[e("div",f$,[e("a",{href:"javascript:void(0)",class:"btn btn-link",onClick:s[1]||(s[1]=d=>t.need_load_users=!t.need_load_users)},[t.selected_bot_user==null?(l(),n("span",g$,"Выберите пользователя")):r("",!0),t.selected_bot_user?(l(),n("span",v$," Пользователь "+u(t.selected_bot_user.name||t.selected_bot_user.fio_from_telegram||t.selected_bot_user.telegram_chat_id||"-"),1)):r("",!0)])]),t.need_load_users?(l(),n("div",y$,[g(D,{simple:!0,onSelect:t.selectBotUser},null,8,["onSelect"])])):r("",!0),e("div",$$,[e("a",{href:"javascript:void(0)",class:"btn btn-link",onClick:s[2]||(s[2]=d=>t.need_schedule_time=!t.need_schedule_time)},[t.selected_schedule_time==null?(l(),n("span",k$,"Выберите время в расписании")):r("",!0),t.selected_schedule_time?(l(),n("span",F$," Запись на "+u(t.days[t.selected_schedule_time.day-1]||"-")+" с "+u(t.selected_schedule_time.start_time||"-")+" до "+u(t.selected_schedule_time.end_time||"-"),1)):r("",!0)])]),t.need_schedule_time?(l(),n("div",C$,[g(oe,{"event-id":o.eventId,bot:o.bot,onSelect:t.selectScheduleTime},null,8,["event-id","bot","onSelect"])])):r("",!0)]),e("div",w$,[S$,(l(!0),n(v,null,$(t.statuses,d=>(l(),n("div",j$,[e("button",{type:"button",class:f([{"btn-success text-white":t.appointmentForm.status==d.value},"btn btn-outline-success w-100"]),onClick:h=>t.appointmentForm.status=d.value},u(d.title||"не указано"),11,q$)]))),256))]),e("div",z$,[e("div",V$,[e("label",P$,[g(a,{content:"ФИО человека, который посетит запись"},{default:b(()=>[O$]),_:1}),m(" Ф.И.О. посетителя "),U$]),c(e("input",{type:"text",class:"form-control",placeholder:"Иванов Иван Иванович","aria-label":"ФИО","onUpdate:modelValue":s[3]||(s[3]=d=>t.appointmentForm.name=d),maxlength:"255","aria-describedby":"appointment-name",required:""},null,512),[[_,t.appointmentForm.name]])]),e("div",A$,[e("label",Q$,[g(a,{content:"Номер телефона человека, который посетит запись"},{default:b(()=>[I$]),_:1}),m(" Телефонный номер "),T$]),c(e("input",{type:"text",class:"form-control",placeholder:"+7(000)000-00-00","aria-label":"номер телефона","onUpdate:modelValue":s[4]||(s[4]=d=>t.appointmentForm.phone=d),maxlength:"255","aria-describedby":"appointment-phone",required:""},null,512),[[i,"+7(###)###-##-##"],[_,t.appointmentForm.phone]])]),e("div",B$,[e("label",R$,[g(a,null,{content:b(()=>[D$]),default:b(()=>[M$]),_:1}),m(" Описание услуги "),E$,t.appointmentForm.info?(l(),n("small",L$," Длина текста "+u(t.appointmentForm.info.length)+" / 255",1)):r("",!0)]),c(e("textarea",{type:"text",class:"form-control",placeholder:"Информация от клиента","aria-label":"Информация от клиента",maxlength:"255","onUpdate:modelValue":s[5]||(s[5]=d=>t.appointmentForm.info=d),"aria-describedby":"appointment-info",required:""},`
                    `,512),[[_,t.appointmentForm.info]])])]),e("div",K$,[e("div",N$,[e("button",J$,[t.appointmentForm.id==null?(l(),n("span",Y$,"Записаться")):(l(),n("span",G$,"Обновить запись"))])])])],32)],64)}}}),X$={class:"row"},Z$={class:"col-12"},x$={key:0,class:"table"},e2=e("th",{scope:"col"},"Действие",-1),t2=["onClick"],s2={scope:"row"},o2={key:0},l2={key:0,class:"dropdown"},n2=e("button",{class:"btn btn-outline-secondary",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-solid fa-ellipsis"})],-1),i2={class:"dropdown-menu"},a2={key:0},d2=["onClick"],r2={key:1},c2={class:"col-12"},u2={props:["bot","eventId"],data(){return{direction:"desc",order:"updated_at",show:!0,is_group:!1,loading:!0,services:[],search:null,statuses:["Новая запись","Подтверждение записи","Прохождение по записи","Отмена записи"],days:["понедельник","вторник","среду","четверг","пятницу","субботу","воскресенье"],paginate_object:null}},computed:{...w(["getAppointments","getAppointmentsPaginateObject"])},mounted(){this.loadAppointments()},methods:{nextAppointments(o){this.loadAppointments(o)},selectAppointment(o){this.$emit("select",o)},loadAndOrder(o){this.order=o,this.direction=this.direction==="desc"?"asc":"desc",this.loadAppointments(0)},removeAppointment(o){this.loading=!0,this.$store.dispatch("removeAppointment",{dataObject:{appointmentId:o}}).then(t=>{this.loading=!1,this.loadAppointments(0),this.$notify("Запись успешно удалена")}).catch(()=>{this.loading=!1,this.$notify("Ошибка удаления записи")})},loadAppointments(o=0){this.loading=!0,this.$store.dispatch("loadAppointments",{dataObject:{event_id:this.eventId,bot_id:this.bot.id||null,search:this.search,order:this.order,direction:this.direction},page:o,size:100}).then(t=>{this.loading=!1,this.services=this.getAppointments,this.paginate_object=this.getAppointmentsPaginateObject}).catch(()=>{this.loading=!1})}}},m2=Object.assign(u2,{__name:"AppointmentsTable",setup(o){return(t,s)=>(l(),n("div",X$,[e("div",Z$,[t.services.length>0?(l(),n("table",x$,[e("thead",null,[e("tr",null,[e("th",{scope:"col",class:"cursor-pointer",onClick:s[0]||(s[0]=a=>t.loadAndOrder("id"))},"#"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[1]||(s[1]=a=>t.loadAndOrder("bot_user_id"))},"Пользователь"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[2]||(s[2]=a=>t.loadAndOrder("appointment_schedule_id"))},"Дата записи "),e("th",{scope:"col",class:"cursor-pointer",onClick:s[3]||(s[3]=a=>t.loadAndOrder("status"))},"Статус"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[4]||(s[4]=a=>t.loadAndOrder("name"))},"Посетитель"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[5]||(s[5]=a=>t.loadAndOrder("phone"))},"Телефон посетителя"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[6]||(s[6]=a=>t.loadAndOrder("info"))},"Доп.инф"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[7]||(s[7]=a=>t.loadAndOrder("updated_at"))},"Дата изменения"),e2])]),e("tbody",null,[(l(!0),n(v,null,$(t.services,(a,i)=>(l(),n("tr",{onClick:d=>t.selectAppointment(a),class:f({"border-info":a.deleted_at==null,"border-danger":a.deleted_at!=null})},[e("th",s2,u(a.id),1),e("td",null,u(a.botUser.fio_from_telegram||a.botUser.telegram_chat_id||"Не указано"),1),e("td",null,[a.schedule?(l(),n("p",o2," Запись на "+u(t.days[a.schedule.day-1]||"Не указано")+" с "+u(a.schedule.start_time||"Не указано")+" до "+u(a.schedule.end_time||"Не указано"),1)):r("",!0)]),e("td",null,u(t.statuses[a.status]),1),e("td",null,u(t.$filters.current(a.updated_at)),1),e("td",null,u(a.name||"не указано"),1),e("td",null,u(a.phone||"не указано"),1),e("td",null,u(a.info||"не указано"),1),e("td",null,[a.id?(l(),n("div",l2,[n2,e("ul",i2,[a.deleted_at==null?(l(),n("li",a2,[e("a",{class:"dropdown-item",onClick:d=>t.removeAppointment(a.id),href:"javascript:void(0)"},"Удалить",8,d2)])):r("",!0)])])):r("",!0)])],10,t2))),256))])])):(l(),n("p",r2,"На текущий момент нет ни одного созданного сервиса"))]),e("div",c2,[t.paginate_object?(l(),y(j,{key:0,onPagination_page:t.nextAppointments,pagination:t.paginate_object},null,8,["onPagination_page","pagination"])):r("",!0)])]))}}),h2={class:"row py-2"},_2={class:"col-12"},p2={class:"input-group mb-3"},b2={class:"col-12"},f2={key:0,class:"table"},g2=e("th",{scope:"col"},"Действие",-1),v2={scope:"row"},y2=["onClick"],$2={key:0,class:"fa-solid fa-chevron-down text-success"},k2={key:1,class:"fa-solid fa-xmark text-danger"},F2={key:0,class:"dropdown"},C2=e("button",{class:"btn btn-outline-secondary",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-solid fa-ellipsis"})],-1),w2={class:"dropdown-menu"},S2={key:0},j2=["onClick"],q2={key:1},z2=["onClick"],V2={key:1},P2={class:"col-12"},O2={props:["bot"],data(){return{direction:"desc",order:"updated_at",show:!0,is_group:!1,loading:!0,events:[],search:null,paginate_object:null}},computed:{...w(["getAppointmentEvents","getAppointmentEventsPaginateObject"])},mounted(){this.loadAppointmentEvents()},methods:{duplicateAppointmentEvent(o){this.loading=!0,this.$store.dispatch("duplicateAppointmentEvent",{dataObject:{appointmentEventId:o,bot_id:this.bot.id}}).then(t=>{this.loading=!1,this.loadAppointmentEvents(0),this.$notify("Событие успешно продублировано")}).catch(()=>{this.loading=!1,this.$notify("Ошибка дублирования события")})},removeAppointmentEvent(o){this.loading=!0,this.$store.dispatch("removeAppointmentEvent",{dataObject:{appointmentEventId:o}}).then(t=>{this.loading=!1,this.loadAppointmentEvents(0),this.$notify("Событие успешно удалено")}).catch(()=>{this.loading=!1,this.$notify("Ошибка удаления события")})},nextAppointmentEvents(o){this.loadAppointmentEvents(o)},selectEvent(o){this.$emit("select",o)},loadAndOrder(o){this.order=o,this.direction=this.direction==="desc"?"asc":"desc",this.loadAppointmentEvents(0)},loadAppointmentEvents(o=0){this.loading=!0,this.$store.dispatch("loadAppointmentEvents",{dataObject:{bot_id:this.bot.id||null,search:this.search,is_group:this.is_group,order:this.order,direction:this.direction},page:o,size:20}).then(t=>{this.loading=!1,this.events=this.getAppointmentEvents,this.paginate_object=this.getAppointmentEventsPaginateObject}).catch(()=>{this.loading=!1})}}},U2=Object.assign(O2,{__name:"AppointmentEventTable",setup(o){return(t,s)=>(l(),n("div",h2,[e("div",_2,[e("div",p2,[c(e("input",{type:"search",class:"form-control",placeholder:"Поиск события","aria-label":"Поиск события","onUpdate:modelValue":s[0]||(s[0]=a=>t.search=a),"aria-describedby":"appointment-search-event"},null,512),[[_,t.search]]),e("button",{class:"btn btn-outline-secondary",onClick:s[1]||(s[1]=a=>t.loadAppointmentEvents(0)),type:"button",id:"appointment-search-event"},"Найти ")])]),e("div",b2,[t.events.length>0?(l(),n("table",f2,[e("thead",null,[e("tr",null,[e("th",{scope:"col",class:"cursor-pointer",onClick:s[2]||(s[2]=a=>t.loadAndOrder("id"))},"#"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[3]||(s[3]=a=>t.loadAndOrder("title"))},"Название"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[4]||(s[4]=a=>t.loadAndOrder("subtitle"))},"Подзаголовок"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[5]||(s[5]=a=>t.loadAndOrder("address"))},"Адрес"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[6]||(s[6]=a=>t.loadAndOrder("description"))},"Описание"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[7]||(s[7]=a=>t.loadAndOrder("is_group"))},"Групповое"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[8]||(s[8]=a=>t.loadAndOrder("updated_at"))},"Дата изменения"),g2])]),e("tbody",null,[(l(!0),n(v,null,$(t.events,(a,i)=>(l(),n("tr",{class:f({"border-info":a.deleted_at==null,"border-danger":a.deleted_at!=null})},[e("th",v2,u(a.id),1),e("td",{onClick:d=>t.selectEvent(a)},u(a.title||"Не указано"),9,y2),e("td",null,u(a.subtitle||"Не указано"),1),e("td",null,u(a.address||"Не указано"),1),e("td",null,u(a.description||"Не указано"),1),e("td",null,[a.is_group?(l(),n("i",$2)):(l(),n("i",k2))]),e("td",null,u(t.$filters.current(a.updated_at)),1),e("td",null,[a.id?(l(),n("div",F2,[C2,e("ul",w2,[a.deleted_at==null?(l(),n("li",S2,[e("a",{class:"dropdown-item",onClick:d=>t.removeAppointmentEvent(a.id),href:"javascript:void(0)"},"Удалить",8,j2)])):r("",!0),a.deleted_at==null?(l(),n("li",q2,[e("a",{class:"dropdown-item",onClick:d=>t.duplicateAppointmentEvent(a.id),href:"javascript:void(0)"},"Дублировать",8,z2)])):r("",!0)])])):r("",!0)])],2))),256))])])):(l(),n("p",V2,"На текущий момент нет событий в вашем списке"))]),e("div",P2,[t.paginate_object?(l(),y(j,{key:0,onPagination_page:t.nextAppointmentEvents,pagination:t.paginate_object},null,8,["onPagination_page","pagination"])):r("",!0)])]))}}),A2={class:"row"},Q2={class:"col-12"},I2={key:0,class:"table"},T2=e("th",{scope:"col"},"Действие",-1),B2={scope:"row"},R2=["onClick"],M2={key:0,class:"fa-solid fa-chevron-down text-success"},D2={key:1,class:"fa-solid fa-xmark text-danger"},E2={key:0,class:"dropdown"},L2=e("button",{class:"btn btn-outline-secondary",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-solid fa-ellipsis"})],-1),K2={class:"dropdown-menu"},N2={key:0},J2=["onClick"],Y2={key:1},G2={class:"col-12"},H2={props:["bot","eventId"],data(){return{direction:"desc",order:"updated_at",show:!0,is_group:!1,loading:!0,services:[],search:null,paginate_object:null}},computed:{...w(["getAppointmentServices","getAppointmentServicesPaginateObject"])},mounted(){this.loadAppointmentServices()},methods:{nextAppointmentService(o){this.loadAppointmentServices(o)},selectService(o){this.$emit("select",o)},removeAppointmentService(o){this.loading=!0,this.$store.dispatch("removeAppointmentService",{dataObject:{appointmentServiceId:o}}).then(t=>{this.loading=!1,this.loadAppointmentServices(0),this.$notify("Сервис успешно удален")}).catch(()=>{this.loading=!1,this.$notify("Ошибка удаления сервиса")})},loadAndOrder(o){this.order=o,this.direction=this.direction==="desc"?"asc":"desc",this.loadAppointmentServices(0)},loadAppointmentServices(o=0){this.loading=!0,this.$store.dispatch("loadAppointmentServices",{dataObject:{event_id:this.eventId,bot_id:this.bot.id||null,search:this.search,order:this.order,direction:this.direction},page:o,size:100}).then(t=>{this.loading=!1,this.services=this.getAppointmentServices,this.paginate_object=this.getAppointmentServicesPaginateObject}).catch(()=>{this.loading=!1})}}},W2=Object.assign(H2,{__name:"AppointmentServicesTable",setup(o){return(t,s)=>(l(),n("div",A2,[e("div",Q2,[t.services.length>0?(l(),n("table",I2,[e("thead",null,[e("tr",null,[e("th",{scope:"col",class:"cursor-pointer",onClick:s[0]||(s[0]=a=>t.loadAndOrder("id"))},"#"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[1]||(s[1]=a=>t.loadAndOrder("title"))},"Название"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[2]||(s[2]=a=>t.loadAndOrder("subtitle"))},"Подзаголовок"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[3]||(s[3]=a=>t.loadAndOrder("description"))},"Описание"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[4]||(s[4]=a=>t.loadAndOrder("is_group"))},"Групповое"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[5]||(s[5]=a=>t.loadAndOrder("updated_at"))},"Дата изменения"),T2])]),e("tbody",null,[(l(!0),n(v,null,$(t.services,(a,i)=>(l(),n("tr",{class:f({"border-info":a.deleted_at==null,"border-danger":a.deleted_at!=null})},[e("th",B2,u(a.id),1),e("td",{onClick:d=>t.selectService(a)},u(a.title||"Не указано"),9,R2),e("td",null,u(a.subtitle||"Не указано"),1),e("td",null,u(a.description||"Не указано"),1),e("td",null,[a.is_group?(l(),n("i",M2)):(l(),n("i",D2))]),e("td",null,u(t.$filters.current(a.updated_at)),1),e("td",null,[a.id?(l(),n("div",E2,[L2,e("ul",K2,[a.deleted_at==null?(l(),n("li",N2,[e("a",{class:"dropdown-item",onClick:d=>t.removeAppointmentService(a.id),href:"javascript:void(0)"},"Удалить",8,J2)])):r("",!0)])])):r("",!0)])],2))),256))])])):(l(),n("p",Y2,"На текущий момент нет ни одного созданого сервиса"))]),e("div",G2,[t.paginate_object?(l(),y(j,{key:0,onPagination_page:t.nextAppointmentService,pagination:t.paginate_object},null,8,["onPagination_page","pagination"])):r("",!0)])]))}}),X2={class:"row"},Z2={class:"col-12 mb-3"},x2={class:"form-label",id:"event-title"},ek=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),tk=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),sk={class:"col-12 mb-3"},ok={class:"form-label",id:"event-subtitle"},lk=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),nk=e("div",null,"Подзаголовок события или доп. инфа под названием события ",-1),ik=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),ak={class:"col-12 mb-3"},dk={class:"form-check"},rk=e("label",{class:"form-check-label",for:"need_add_address"}," Нужно указать адрес и координат мероприятия ",-1),ck={key:0,class:"col-12 mb-3"},uk={class:"form-label",id:"event-address"},mk=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),hk=e("div",null,"Адрес, указывающий точное место проведения события \\ мероприятия ",-1),_k={key:1,class:"col-12 mb-3"},pk={class:"form-label",id:"event-coords"},bk=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),fk=e("div",null,"Координаты мероприятия ",-1),gk={class:"col-12 mb-3"},vk={class:"form-label",id:"event-description"},yk=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),$k=e("div",null," Краткая информация о происходящем мероприятии ",-1),kk=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),Fk={key:0,class:"text-gray-400 ml-3",style:{"font-size":"10px"}},Ck={class:"col-12 mb-3"},wk={class:"form-label",id:"event-on_start_appointment"},Sk=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),jk=e("div",null," Текст, который будет отображен клиенту, когда тот записался ",-1),qk=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),zk={key:0,class:"text-gray-400 ml-3",style:{"font-size":"10px"}},Vk={class:"col-12 mb-3"},Pk={class:"form-label",id:"event-on_cancel_appointment"},Ok=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),Uk=e("div",null," Текст, который будет отображен клиенту, когда тот отменил запись ",-1),Ak=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),Qk={key:0,class:"text-gray-400 ml-3",style:{"font-size":"10px"}},Ik={class:"col-12 mb-3"},Tk={class:"form-label",id:"event-on_after_appointment"},Bk=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),Rk=e("div",null," Текст, который будет отображен клиенту, когда тот прошел событие успешно ",-1),Mk=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),Dk={key:0,class:"text-gray-400 ml-3",style:{"font-size":"10px"}},Ek={class:"col-12 mb-3"},Lk={class:"form-label",id:"event-on_repeat_appointment"},Kk=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),Nk=e("div",null," Текст, который будет отображен клиенту, когда тот записывается 2й и более раз ",-1),Jk=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),Yk={key:0,class:"text-gray-400 ml-3",style:{"font-size":"10px"}},Gk={class:"col-12 mb-3"},Hk={class:"form-check"},Wk=e("label",{class:"form-check-label",for:"need_media"}," Нужно изображение к событию ",-1),Xk={key:2,class:"col-12 mb-3"},Zk={class:"form-label",id:"event-images"},xk=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),e0=e("div",null," Изображение, которое видит пользователь при выборе события ",-1),t0=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),s0={class:"col-12 mb-3"},o0={class:"form-check"},l0=e("label",{class:"form-check-label",for:"is-group"}," Является групповым мероприятием ",-1),n0={key:3,class:"col-md-6 col-12 mb-3"},i0={class:"form-label",id:"event-min_people"},a0=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),d0=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),r0={key:4,class:"col-md-6 col-12 mb-3"},c0={class:"form-label",id:"event-max_people"},u0=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),m0=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),h0={class:"row"},_0={class:"col-12"},p0={type:"submit",class:"btn btn-outline-success w-100 p-3"},b0={key:0},f0={key:1},g0={props:["event","bot"],data(){return{step:0,load:!1,need_reset:!1,need_services:!1,need_add_address:!1,need_media:!1,eventForm:{id:null,title:null,subtitle:null,description:null,address:null,coords:null,images:[],services:[],times:[],is_group:!1,max_people:0,min_people:0,on_start_appointment:null,on_cancel_appointment:null,on_after_appointment:null,on_repeat_appointment:null}}},watch:{eventForm:{handler(o){this.need_reset=!0},deep:!0}},mounted(){this.event&&this.$nextTick(()=>{this.eventForm={id:this.event.id||null,title:this.event.title||null,subtitle:this.event.subtitle||null,description:this.event.description||null,images:this.event.images||[],is_group:this.event.is_group||!1,address:this.event.address||null,coords:this.event.coords||null,max_people:this.event.max_people||0,min_people:this.event.min_people||0,on_start_appointment:this.event.on_start_appointment||null,on_cancel_appointment:this.event.on_cancel_appointment||null,on_after_appointment:this.event.on_after_appointment||null,on_repeat_appointment:this.event.on_repeat_appointment||null}})},methods:{selectPhotos(o){this.eventForm.images||(this.eventForm.images=[]);let t=this.eventForm.images.indexOf(o.file_id);t!==-1?this.eventForm.images.splice(t,1):this.eventForm.images.push(o.file_id)},resetForm(){},submitForm(){let o=new FormData;Object.keys(this.eventForm).forEach(t=>{const s=this.eventForm[t]||"";typeof s=="object"?o.append(t,JSON.stringify(s)):o.append(t,s)}),o.append("bot_id",this.bot.id),this.$store.dispatch(this.eventForm.id===null?"addAppointmentEvent":"updateAppointmentEvent",{appointmentEventForm:o}).then(t=>{this.$emit("callback",t.data),this.$nextTick(()=>{this.eventForm={id:null,title:null,subtitle:null,description:null,address:null,coords:null,images:[],services:[],times:[],is_group:!1,max_people:0,min_people:0,on_start_appointment:null,on_cancel_appointment:null,on_after_appointment:null,on_repeat_appointment:null}}),this.$notify("Событие успешно создано")}).catch(t=>{this.$notify("Ошибка создания события")})}}},W=Object.assign(g0,{__name:"AppointmentEventForm",setup(o){return(t,s)=>{const a=q("Popper"),i=A("mask");return l(),n("form",{onSubmit:s[14]||(s[14]=S((...d)=>t.submitForm&&t.submitForm(...d),["prevent"]))},[e("div",X2,[e("div",Z2,[e("label",x2,[g(a,{content:"Название вашего события (или специалиста), на которое планируется осуществить запись"},{default:b(()=>[ek]),_:1}),m(" Название события "),tk]),c(e("input",{type:"text",class:"form-control",placeholder:"Название","aria-label":"Название","onUpdate:modelValue":s[0]||(s[0]=d=>t.eventForm.title=d),maxlength:"255","aria-describedby":"event-title",required:""},null,512),[[_,t.eventForm.title]])]),e("div",sk,[e("label",ok,[g(a,null,{content:b(()=>[nk]),default:b(()=>[lk]),_:1}),m(" Подзаголовок события "),ik]),c(e("input",{type:"text",class:"form-control",placeholder:"Подзаголовок","aria-label":"Подзаголовок","onUpdate:modelValue":s[1]||(s[1]=d=>t.eventForm.subtitle=d),maxlength:"255","aria-describedby":"event-subtitle",required:""},null,512),[[_,t.eventForm.subtitle]])]),e("div",ak,[e("div",dk,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[2]||(s[2]=d=>t.need_add_address=d),type:"checkbox",id:"need_add_address"},null,512),[[k,t.need_add_address]]),rk])]),t.need_add_address?(l(),n("div",ck,[e("label",uk,[g(a,null,{content:b(()=>[hk]),default:b(()=>[mk]),_:1}),m(" Адрес события \\ мероприятия ")]),c(e("input",{type:"text",class:"form-control",placeholder:"Адрес события","aria-label":"Адрес события","onUpdate:modelValue":s[3]||(s[3]=d=>t.eventForm.address=d),maxlength:"255","aria-describedby":"event-address",required:""},null,512),[[_,t.eventForm.address]])])):r("",!0),t.need_add_address?(l(),n("div",_k,[e("label",pk,[g(a,null,{content:b(()=>[fk]),default:b(()=>[bk]),_:1}),m(" Координаты мероприятия: широта, долгота ")]),c(e("input",{type:"text",class:"form-control",placeholder:"00.0000,00.0000","aria-label":"Координаты события","onUpdate:modelValue":s[4]||(s[4]=d=>t.eventForm.coords=d),maxlength:"255","aria-describedby":"event-coords",required:""},null,512),[[_,t.eventForm.coords],[i,"##.####,##.####"]])])):r("",!0),e("div",gk,[e("label",vk,[g(a,null,{content:b(()=>[$k]),default:b(()=>[yk]),_:1}),m(" Описание события "),kk,t.eventForm.description?(l(),n("small",Fk," Длина текста "+u(t.eventForm.description.length)+"/255",1)):r("",!0)]),c(e("textarea",{type:"text",class:"form-control",placeholder:"Описание мероприятия","aria-label":"Описание мероприятия",maxlength:"255","onUpdate:modelValue":s[5]||(s[5]=d=>t.eventForm.description=d),"aria-describedby":"event-description",required:""},`
                    `,512),[[_,t.eventForm.description]])]),e("div",Ck,[e("label",wk,[g(a,null,{content:b(()=>[jk]),default:b(()=>[Sk]),_:1}),m(" Текст при записи на событие "),qk,t.eventForm.on_start_appointment?(l(),n("small",zk," Длина текста "+u(t.eventForm.on_start_appointment.length)+"/255",1)):r("",!0)]),c(e("textarea",{type:"text",class:"form-control",placeholder:"Текст при записи на событие","aria-label":"Текст при записи на событие","onUpdate:modelValue":s[6]||(s[6]=d=>t.eventForm.on_start_appointment=d),maxlength:"255","aria-describedby":"event-on_start_appointment",required:""},`
                    `,512),[[_,t.eventForm.on_start_appointment]])]),e("div",Vk,[e("label",Pk,[g(a,null,{content:b(()=>[Uk]),default:b(()=>[Ok]),_:1}),m(" Текст при отмене записи на событие "),Ak,t.eventForm.on_cancel_appointment?(l(),n("small",Qk," Длина текста "+u(t.eventForm.on_cancel_appointment.length)+"/255",1)):r("",!0)]),c(e("textarea",{type:"text",class:"form-control",placeholder:"Текст при отмене записи на событие","aria-label":"Текст при отмене записи на событие","onUpdate:modelValue":s[7]||(s[7]=d=>t.eventForm.on_cancel_appointment=d),maxlength:"255","aria-describedby":"event-on_cancel_appointment",required:""},`
                    `,512),[[_,t.eventForm.on_cancel_appointment]])]),e("div",Ik,[e("label",Tk,[g(a,null,{content:b(()=>[Rk]),default:b(()=>[Bk]),_:1}),m(" Текст после прохождения события "),Mk,t.eventForm.on_after_appointment?(l(),n("small",Dk," Длина текста "+u(t.eventForm.on_after_appointment.length)+"/255",1)):r("",!0)]),c(e("textarea",{type:"text",class:"form-control",placeholder:"Текст после прохождения события","aria-label":"Текст после прохождения события","onUpdate:modelValue":s[8]||(s[8]=d=>t.eventForm.on_after_appointment=d),maxlength:"255","aria-describedby":"event-on_after_appointment",required:""},`
                    `,512),[[_,t.eventForm.on_after_appointment]])]),e("div",Ek,[e("label",Lk,[g(a,null,{content:b(()=>[Nk]),default:b(()=>[Kk]),_:1}),m(" Текст при повторной записи на событие "),Jk,t.eventForm.on_repeat_appointment?(l(),n("small",Yk," Длина текста "+u(t.eventForm.on_repeat_appointment.length)+"/255",1)):r("",!0)]),c(e("textarea",{type:"text",class:"form-control",placeholder:" Текст при повторной записи на событие","aria-label":" Текст при повторной записи на событие","onUpdate:modelValue":s[9]||(s[9]=d=>t.eventForm.on_repeat_appointment=d),maxlength:"255","aria-describedby":"event-on_repeat_appointment",required:""},`
                    `,512),[[_,t.eventForm.on_repeat_appointment]])]),e("div",Gk,[e("div",Hk,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[10]||(s[10]=d=>t.need_media=d),type:"checkbox",id:"need_media"},null,512),[[k,t.need_media]]),Wk])]),t.need_media?(l(),n("div",Xk,[e("label",Zk,[g(a,null,{content:b(()=>[e0]),default:b(()=>[xk]),_:1}),m(" Изображение к событию "),t0]),g(V,{"need-photo":!0,selected:t.eventForm.images,onSelect:t.selectPhotos},null,8,["selected","onSelect"])])):r("",!0),e("div",s0,[e("div",o0,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[11]||(s[11]=d=>t.eventForm.is_group=d),type:"checkbox",id:"is-group"},null,512),[[k,t.eventForm.is_group]]),l0])]),t.eventForm.is_group?(l(),n("div",n0,[e("label",i0,[g(a,{content:"Минимально необходимое число людей, для начала 1 мероприятия"},{default:b(()=>[a0]),_:1}),m(" Минимальное число посетителей в группе "),d0]),c(e("input",{type:"number",class:"form-control",placeholder:"Минимальное число посетителей","aria-label":"Название","onUpdate:modelValue":s[12]||(s[12]=d=>t.eventForm.min_people=d),"aria-describedby":"event-min_people",required:""},null,512),[[_,t.eventForm.min_people]])])):r("",!0),t.eventForm.is_group?(l(),n("div",r0,[e("label",c0,[g(a,{content:"Количество людей, которые могут посетить мероприятие за 1 сеанс"},{default:b(()=>[u0]),_:1}),m(" Максимальное число посетителей в группе "),m0]),c(e("input",{type:"number",class:"form-control",placeholder:"Максимальное число посетителей","aria-label":"Название","onUpdate:modelValue":s[13]||(s[13]=d=>t.eventForm.max_people=d),"aria-describedby":"event-max_people",required:""},null,512),[[_,t.eventForm.max_people]])])):r("",!0)]),e("div",h0,[e("div",_0,[e("button",p0,[t.eventForm.id==null?(l(),n("span",b0,"Создать событие")):(l(),n("span",f0,"Обновить событие"))])])])],32)}}}),v0={class:"row pt-3"},y0={class:"col-md-4"},$0={class:"form-floating mb-3"},k0=e("label",{for:"config-step"},"Шаг, минуты",-1),F0={class:"col-md-4"},C0={class:"form-floating mb-3"},w0=e("label",{for:"config-start-time"},"Начало, часы",-1),S0={class:"col-md-4"},j0={class:"form-floating mb-3"},q0=["min"],z0=e("label",{for:"config-end-time"},"Конец, часы",-1),V0=e("hr",null,null,-1),P0={key:0,class:"row"},O0={class:"col-12 d-flex justify-content-end pb-3"},U0={class:"row"},A0={class:"col-md-4 text-center"},Q0={key:0,class:"fa-solid fa-arrow-down-short-wide"},I0={key:1,class:"fa-solid fa-arrow-up-wide-short"},T0={class:"col-md-4 text-center"},B0={key:0,class:"fa-solid fa-arrow-down-short-wide"},R0={key:1,class:"fa-solid fa-arrow-up-wide-short"},M0={class:"col-md-4 text-center"},D0={key:0,class:"fa-solid fa-arrow-down-short-wide"},E0={key:1,class:"fa-solid fa-arrow-up-wide-short"},L0={class:"col-md-4"},K0={class:"form-floating"},N0=["onUpdate:modelValue","id"],J0=["for"],Y0={class:"col-md-4"},G0={class:"form-floating"},H0=["onUpdate:modelValue","id"],W0=["for"],X0={class:"col-md-4"},Z0={class:"form-floating"},x0=["onUpdate:modelValue","id"],e3=["for"],t3={class:"row mt-3"},s3={class:"col-12"},o3={class:"row"},l3={class:"col-12"},n3={class:"col-12"},i3={class:"text-center"},a3={class:"row d-flex justify-content-center"},d3={class:"col-md-4"},r3={class:"table"},c3=e("th",{scope:"col"},"#",-1),u3={scope:"col"},m3={scope:"row"},h3=["onClick"],_3={key:0,class:"fa-solid fa-check"},p3={key:1,class:"fa-solid fa-xmark"},b3={components:{VueDatePicker:le},props:["eventId","bot"],data(){return{date:null,load:!1,step:30,start:8,end:18,order:null,direction:null,paginate_object:null,years:[2024,2025],months:["Январь","Февраль","Март","Апрель","Май","Июнь","Июль","Август","Сентябрь","октябрь","Ноябрь","Декабрь"],days:["Понедельник","Вторник","Среда","Четверг","Пятница","Суббота","Воскресенье"],schedule:[],added_schedule:[]}},watch:{date:{handler:function(o){this.loadAppointmentSchedules()},deep:!0}},computed:{...w(["getAppointmentSchedules","getAppointmentSchedulesPaginateObject"]),currentWeek(){return new Date().getWeek()},currentMonthWeek(){return new Date().getMonthWeek()},currentMonth(){return new Date().getMonth()},currentYear(){return new Date().getFullYear()},times(){let o=this.step,t=[],s=0,a=0;for(let i=0;s<24*60;i++){let d=Math.floor(s/60);if(d>=this.start&&d<=this.end){let h=s%60;t[a]=("0"+d).slice(-2)+":"+("0"+h).slice(-2),a++}s=s+o}return t}},mounted(){this.date=new Date,this.loadAppointmentSchedules()},methods:{removeAppointmentSchedule(o){this.loading=!0,this.$store.dispatch("removeAppointmentSchedule",{dataObject:{appointmentScheduleId:o}}).then(t=>{this.loading=!1,this.loadAppointmentSchedules(0),this.$notify("Время успешно удалено")}).catch(()=>{this.loading=!1,this.$notify("Ошибка удаления времени")})},loadAndOrder(o){this.order=o,this.direction=this.direction==="desc"?"asc":"desc",this.loadAppointmentSchedules(0)},nextAppointmentSchedule(o){this.loadAppointmentSchedules(o)},loadAppointmentSchedules(o=0){this.loading=!0,this.$store.dispatch("loadAppointmentSchedules",{dataObject:{date:this.date||null,event_id:this.eventId,bot_id:this.bot.id||null,order:this.order,direction:this.direction},page:o,size:20}).then(t=>{this.loading=!1,this.schedule=this.getAppointmentSchedules,this.paginate_object=this.getAppointmentSchedulesPaginateObject}).catch(()=>{this.loading=!1})},storeSchedule(){this.$store.dispatch("storeAppointmentSchedule",{dataObject:{schedule:[...this.schedule,...this.added_schedule],bot_id:this.bot.id,appointment_event_id:this.eventId}}).then(()=>{this.$notify("Расписание успешно сохранено"),this.loadAppointmentSchedules(),this.added_schedule=[]}).catch(()=>{this.$notify("Ошибка сохраения расписания")})},inScheduleRow(o){return this.schedule.findIndex(t=>t.start_time==this.times[o])!=-1||this.added_schedule.findIndex(t=>t.start_time==this.times[o])!=-1},inSchedule(o,t){return this.schedule.findIndex(s=>s.day==t&&s.start_time==this.times[o])!=-1||this.added_schedule.findIndex(s=>s.day==t&&s.start_time==this.times[o])!=-1},setScheduleItem(o,t){let s=this.schedule.findIndex(a=>a.day==t&&a.start_time==this.times[o]);if(s!==-1){this.schedule.splice(s,1);return}if(s=this.added_schedule.findIndex(a=>a.day==t&&a.start_time==this.times[o]),s!==-1){this.added_schedule.splice(s,1);return}this.added_schedule.push({day:t,start_time:this.times[o]||null,end_time:this.times[o+1]||null,week:this.date==null?this.currentWeek:new Date(this.date).getWeek(),month:this.date==null?this.currentMonth:new Date(this.date).getMonth(),year:this.date==null?this.currentYear:new Date(this.date).getFullYear()})}}},f3=Object.assign(b3,{__name:"AppointmentScheduleForm",setup(o){return(t,s)=>(l(),n(v,null,[e("div",v0,[e("div",y0,[e("div",$0,[c(e("input",{type:"number",class:"form-control","onUpdate:modelValue":s[0]||(s[0]=a=>t.step=a),min:"0",id:"config-step",placeholder:"30 минут"},null,512),[[_,t.step]]),k0])]),e("div",F0,[e("div",C0,[c(e("input",{type:"number","onUpdate:modelValue":s[1]||(s[1]=a=>t.start=a),min:"0",max:"23",class:"form-control",id:"config-start-time",placeholder:"Часы"},null,512),[[_,t.start]]),w0])]),e("div",S0,[e("div",j0,[c(e("input",{type:"number","onUpdate:modelValue":s[2]||(s[2]=a=>t.end=a),min:t.start,max:"23",class:"form-control",id:"config-end-time",placeholder:"Часы"},null,8,q0),[[_,t.end]]),z0])])]),V0,t.schedule.length>0||t.added_schedule.length>0?(l(),n("div",P0,[e("div",O0,[e("button",{onClick:s[3]||(s[3]=(...a)=>t.storeSchedule&&t.storeSchedule(...a)),class:"btn btn-primary"},"Сохранить текущий график ")]),e("div",U0,[e("div",A0,[e("a",{onClick:s[4]||(s[4]=a=>t.loadAndOrder("day")),href:"javascript:void(0)"},[m("День "),t.order==="day"&&t.direction==="asc"?(l(),n("i",Q0)):r("",!0),t.order==="day"&&t.direction==="desc"?(l(),n("i",I0)):r("",!0)])]),e("div",T0,[e("a",{onClick:s[5]||(s[5]=a=>t.loadAndOrder("start_time")),href:"javascript:void(0)"},[m("Начало "),t.order==="start_time"&&t.direction==="asc"?(l(),n("i",B0)):r("",!0),t.order==="start_time"&&t.direction==="desc"?(l(),n("i",R0)):r("",!0)])]),e("div",M0,[e("a",{onClick:s[6]||(s[6]=a=>t.loadAndOrder("end_time")),href:"javascript:void(0)"},[m("Конец "),t.order==="end_time"&&t.direction==="asc"?(l(),n("i",D0)):r("",!0),t.order==="end_time"&&t.direction==="desc"?(l(),n("i",E0)):r("",!0)])])])])):r("",!0),(l(!0),n(v,null,$([...t.schedule,...t.added_schedule],(a,i)=>(l(),n("div",{class:f(["row py-2",{"bg-warning":a.id==null}])},[e("div",L0,[e("div",K0,[c(e("input",{type:"text","onUpdate:modelValue":d=>t.days[a.day-1]=d,class:"form-control",id:"day-of-week-"+i,placeholder:"День недели"},null,8,N0),[[_,t.days[a.day-1]]]),e("label",{for:"day-of-week-"+i},"День недели",8,J0)])]),e("div",Y0,[e("div",G0,[c(e("input",{type:"text","onUpdate:modelValue":d=>a.start_time=d,class:"form-control",id:"day-of-start-at-"+i,placeholder:"Время начало"},null,8,H0),[[_,a.start_time]]),e("label",{for:"day-of-start-at-"+i},"Начало",8,W0)])]),e("div",X0,[e("div",Z0,[c(e("input",{type:"text","onUpdate:modelValue":d=>a.end_time=d,class:"form-control",id:"day-of-end-at-"+i,placeholder:"Время окончания"},null,8,x0),[[_,a.end_time]]),e("label",{for:"day-of-end-at-"+i},"Окончание",8,e3)])])],2))),256)),e("div",t3,[e("div",s3,[t.paginate_object?(l(),y(j,{key:0,onPagination_page:t.nextAppointmentSchedule,pagination:t.paginate_object},null,8,["onPagination_page","pagination"])):r("",!0)])]),e("div",o3,[e("div",l3,[e("button",{class:"btn btn-primary",onClick:s[7]||(s[7]=a=>t.schedule=[])},"Очистить таблицу")]),e("div",n3,[e("p",i3,[m(" Год: "),e("strong",null,u(t.currentYear),1),m(" Месяц: "),e("strong",null,u(t.months[t.currentMonth]),1),m(" Неделя: "),e("strong",null,u(t.currentWeek),1)])])]),e("div",a3,[e("div",d3,[g(M(le),{modelValue:t.date,"onUpdate:modelValue":s[8]||(s[8]=a=>t.date=a)},null,8,["modelValue"])])]),e("table",r3,[e("thead",null,[e("tr",null,[c3,(l(!0),n(v,null,$(t.days,a=>(l(),n("th",u3,u(a),1))),256))])]),e("tbody",null,[(l(!0),n(v,null,$(t.times,(a,i)=>(l(),n("tr",{class:f({"table-light":t.inScheduleRow(i)})},[e("th",m3,u(a),1),(l(),n(v,null,$(7,d=>e("td",null,[e("button",{class:f([{"btn-primary text-white":t.inSchedule(i,d)},"btn btn-outline-primary"]),onClick:h=>t.setScheduleItem(i,d)},[t.inSchedule(i,d)?(l(),n("i",_3)):(l(),n("i",p3))],10,h3)])),64))],2))),256))])])],64))}});(function(){try{if(typeof document<"u"){var o=document.createElement("style");o.appendChild(document.createTextNode(".vue3-star-ratings[data-v-7fab3f62]{width:fit-content;overflow:hidden;position:relative;white-space:nowrap}.vue3-star-ratings *[data-v-7fab3f62]{box-sizing:border-box;margin:0;padding:0;line-height:1}.vue3-star-ratings__inner[data-v-7fab3f62],.vue3-star-ratings__outer[data-v-7fab3f62]{height:inherit}.vue3-star-ratings__outer[data-v-7fab3f62]{position:absolute;top:0;left:0;width:var(--vue3StarRatingOuterWidth);max-width:100%;overflow:hidden;color:var(--vue3StarRatingsOuterColor);transition:width .32s cubic-bezier(.075,.82,.165,1)}.vue3-star-ratings__inner[data-v-7fab3f62]{color:var(--vue3StarRatingsInnerColor)}.vue3-star-ratings__icon[data-v-7fab3f62]{fill:currentColor;width:var(--vue3StarRatingIconSize);aspect-ratio:1;cursor:pointer;display:inline-block}")),document.head.appendChild(o)}}catch(t){console.error("vite-plugin-css-injected-by-js",t)}})();const ae=(o,t)=>{const s=o.__vccOpts||o;for(const[a,i]of t)s[a]=i;return s},g3={},v3={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512.002 512.002"},y3=e("path",{d:"M511.267 197.258a14.995 14.995 0 00-12.107-10.209l-158.723-23.065-70.985-143.827a14.998 14.998 0 00-26.901 0l-70.988 143.827-158.72 23.065a14.998 14.998 0 00-8.312 25.585l114.848 111.954-27.108 158.083a14.999 14.999 0 0021.763 15.812l141.967-74.638 141.961 74.637a15 15 0 0021.766-15.813l-27.117-158.081 114.861-111.955a14.994 14.994 0 003.795-15.375z"},null,-1),$3=[y3];function k3(o,t){return l(),n("svg",v3,$3)}const X=ae(g3,[["render",k3]]),F3={class:"vue3-star-ratings__outer"},C3={class:"vue3-star-ratings__inner"},w3=pe({__name:"Vue3StarRatings",props:{modelValue:{default:0},numberOfStars:{default:5},starColor:{default:"#ff9800"},inactiveColor:{default:"#333333"},starSize:{default:24},disableClick:{type:Boolean},customSvg:{default:X}},emits:["update:modelValue"],setup(o,{emit:t}){const s=o,a=K(()=>s.customSvg||X),i={rounded(C,U){const P=Math.pow(10,U);return Math.round(C*P)/P}},d=be(),h=K({get(){return s.modelValue},set(C){const U=i.rounded(C,1);t("update:modelValue",U)}});function p(C){if(s.disableClick)return;const U=this.getBoundingClientRect(),{pageX:P}=C,L=P-U.left,de=U.width,re=s.numberOfStars,ce=L/de*re;h.value=ce}const F=K(()=>(h.value<0?0:h.value>s.numberOfStars?s.numberOfStars:h.value)/s.numberOfStars*100);return fe(()=>{var C;const U={"--vue3StarRatingsInnerColor":s.inactiveColor,"--vue3StarRatingsOuterColor":s.starColor,"--vue3StarRatingOuterWidth":`${F.value}%`,"--vue3StarRatingIconSize":`${s.starSize}px`};for(const[P,L]of Object.entries(U))(C=d.value)==null||C.style.setProperty(P,L)}),ge(()=>{var C;(C=d.value)==null||C.addEventListener("click",p)}),ve(()=>{var C;(C=d.value)==null||C.removeEventListener("click",p)}),(C,U)=>(l(),n("div",{class:"vue3-star-ratings",ref_key:"starsContainer",ref:d,style:ee({pointerEvents:C.disableClick?"none":"auto"})},[e("div",F3,[(l(!0),n(v,null,$(C.numberOfStars,P=>(l(),y(H(a.value),{key:P,class:"vue3-star-ratings__icon"}))),128))]),e("div",C3,[(l(!0),n(v,null,$(C.numberOfStars,P=>(l(),y(H(a.value),{key:P,class:"vue3-star-ratings__icon"}))),128))])],4))}}),E=ae(w3,[["__scopeId","data-v-7fab3f62"]]),S3={class:"row py-3"},j3={class:"col-12"},q3={class:"row"},z3={class:"col-12"},V3={key:0},P3={key:1},O3={key:0,class:"col-12 mb-3"},U3={class:"col-12 mb-3"},A3={key:0},Q3={key:1},I3={key:1,class:"col-12 mb-3"},T3={class:"col-12 mb-3"},B3={class:"col-12 mb-3"},R3={class:"form-label",id:"event-on_after_appointment"},M3=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),D3=e("div",null," Текст, который пользователь оставляет после прохождения услуги ",-1),E3=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),L3={key:0,class:"text-gray-400 ml-3",style:{"font-size":"10px"}},K3={class:"row"},N3={class:"col-12"},J3={type:"submit",class:"btn btn-outline-success w-100 p-3"},Y3={key:0},G3={key:1},H3={props:["eventId","bot","review"],components:{vue3starRatings:E},data(){return{step:0,load:!1,selected_schedule_time:null,selected_bot_user:null,need_load_users:!1,need_schedule_time:!1,days:["понедельник","вторник","среду","четверг","пятницу","субботу","воскресенье"],reviewForm:{id:null,appointment_event_id:null,appointment_schedule_id:null,bot_user_id:null,rating:null,text:null}}},watch:{reviewForm:{handler(o){this.need_reset=!0},deep:!0}},mounted(){this.review&&this.$nextTick(()=>{this.reviewForm={id:this.review.id||null,appointment_event_id:this.review.appointment_event_id||null,appointment_schedule_id:this.review.appointment_schedule_id||null,bot_user_id:this.review.bot_user_id||null,rating:this.review.rating||null,text:this.review.text||null},this.selected_schedule_time=this.review.schedule||null,this.selected_bot_user=this.review.botUser||null})},methods:{selectScheduleTime(o){this.selected_schedule_time=o,this.need_schedule_time=!1},selectBotUser(o){this.selected_bot_user=o,this.need_load_users=!1},clearReviewForm(){this.reviewForm={id:null,appointment_event_id:null,appointment_schedule_id:null,bot_user_id:null,rating:null,text:null},this.selected_schedule_time=null,this.selected_bot_user=null},submitForm(){this.reviewForm.bot_user_id=this.selected_bot_user.id,this.reviewForm.appointment_schedule_id=this.selected_schedule_time.id,this.reviewForm.appointment_event_id=this.eventId;let o=new FormData;Object.keys(this.reviewForm).forEach(t=>{const s=this.reviewForm[t]||"";typeof s=="object"?o.append(t,JSON.stringify(s)):o.append(t,s)}),o.append("bot_id",this.bot.id),this.$store.dispatch("storeAppointmentReview",{dataObject:{appointmentReviewForm:o}}).then(t=>{this.$emit("callback",t.data),this.$notify("Отзыв успешно создан"),this.clearReviewForm()}).catch(t=>{this.$notify("Ошибка создания отзыва")})}}},W3=Object.assign(H3,{__name:"AppointmentReviewForm",setup(o){return(t,s)=>{const a=q("Popper");return l(),n(v,null,[e("div",S3,[e("div",j3,[e("button",{onClick:s[0]||(s[0]=(...i)=>t.clearReviewForm&&t.clearReviewForm(...i)),class:"btn btn-primary"},"Новый отзыв")])]),e("form",{onSubmit:s[5]||(s[5]=S((...i)=>t.submitForm&&t.submitForm(...i),["prevent"]))},[e("div",q3,[e("div",z3,[e("a",{href:"javascript:void(0)",class:"btn btn-link",onClick:s[1]||(s[1]=i=>t.need_load_users=!t.need_load_users)},[t.selected_bot_user==null?(l(),n("span",V3,"Выберите пользователя")):r("",!0),t.selected_bot_user?(l(),n("span",P3," Пользователь "+u(t.selected_bot_user.name||t.selected_bot_user.fio_from_telegram||t.selected_bot_user.telegram_chat_id||"-"),1)):r("",!0)])]),t.need_load_users?(l(),n("div",O3,[g(D,{simple:!0,onSelect:t.selectBotUser},null,8,["onSelect"])])):r("",!0),e("div",U3,[e("a",{href:"javascript:void(0)",class:"btn btn-link",onClick:s[2]||(s[2]=i=>t.need_schedule_time=!t.need_schedule_time)},[t.selected_schedule_time==null?(l(),n("span",A3,"Выберите время в расписании")):r("",!0),t.selected_schedule_time?(l(),n("span",Q3," Запись на "+u(t.days[t.selected_schedule_time.day-1]||"-")+" с "+u(t.selected_schedule_time.start_time||"-")+" до "+u(t.selected_schedule_time.end_time||"-"),1)):r("",!0)])]),t.need_schedule_time?(l(),n("div",I3,[g(oe,{"event-id":o.eventId,bot:o.bot,onSelect:t.selectScheduleTime},null,8,["event-id","bot","onSelect"])])):r("",!0),e("div",T3,[e("p",null," Рейтинг: "+u(t.reviewForm.rating||0),1),g(M(E),{modelValue:t.reviewForm.rating,"onUpdate:modelValue":s[3]||(s[3]=i=>t.reviewForm.rating=i)},null,8,["modelValue"])]),e("div",B3,[e("label",R3,[g(a,null,{content:b(()=>[D3]),default:b(()=>[M3]),_:1}),m(" Текст отзыва "),E3,t.reviewForm.text?(l(),n("small",L3," Длина текста "+u(t.reviewForm.text.length)+"/255",1)):r("",!0)]),c(e("textarea",{type:"text",class:"form-control",placeholder:"Текст отзыва","aria-label":"Текст отзыва","onUpdate:modelValue":s[4]||(s[4]=i=>t.reviewForm.text=i),maxlength:"255","aria-describedby":"review-text",required:""},`
                    `,512),[[_,t.reviewForm.text]])])]),e("div",K3,[e("div",N3,[e("button",J3,[t.reviewForm.id==null?(l(),n("span",Y3,"Оставить отзыв")):(l(),n("span",G3,"Обновить отзыв"))])])])],32)],64)}}}),X3={class:"row"},Z3={class:"col-12"},x3={key:0,class:"table"},eF=e("th",{scope:"col"},"Действие",-1),tF=["onClick"],sF={scope:"row"},oF={class:"d-flex align-items-center"},lF={class:"ml-2"},nF={key:0,class:"dropdown"},iF=e("button",{class:"btn btn-outline-secondary",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-solid fa-ellipsis"})],-1),aF={class:"dropdown-menu"},dF={key:0},rF=["onClick"],cF={key:1},uF={class:"col-12"},mF={props:["bot","eventId"],components:{vue3starRatings:E},data(){return{direction:"desc",order:"updated_at",show:!0,is_group:!1,loading:!0,reviews:[],search:null,paginate_object:null}},computed:{...w(["getAppointmentReviews","getAppointmentReviewsPaginateObject"])},mounted(){this.loadAppointmentReviews()},methods:{nextAppointmentReviews(o){this.loadAppointmentReviews(o)},selectReview(o){this.$emit("select",o)},loadAndOrder(o){this.order=o,this.direction=this.direction==="desc"?"asc":"desc",this.loadAppointmentReviews(0)},removeAppointmentReview(o){this.loading=!0,this.$store.dispatch("removeAppointmentReview",{dataObject:{appointmentReviewId:o}}).then(t=>{this.loadAppointmentReviews(0),this.$notify("Сервис успешно удален"),this.loading=!1}).catch(()=>{this.loading=!1,this.$notify("Ошибка удаления сервиса")})},loadAppointmentReviews(o=0){this.loading=!0,this.$store.dispatch("loadAppointmentReviews",{dataObject:{event_id:this.eventId,bot_id:this.bot.id||null,search:this.search,order:this.order,direction:this.direction},page:o,size:100}).then(t=>{this.loading=!1,this.reviews=this.getAppointmentReviews,this.paginate_object=this.getAppointmentReviewsPaginateObject}).catch(()=>{this.loading=!1})}}},hF=Object.assign(mF,{__name:"AppointmentReviewsTable",setup(o){return(t,s)=>(l(),n("div",X3,[e("div",Z3,[t.reviews.length>0?(l(),n("table",x3,[e("thead",null,[e("tr",null,[e("th",{scope:"col",class:"cursor-pointer",onClick:s[0]||(s[0]=a=>t.loadAndOrder("id"))},"#"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[1]||(s[1]=a=>t.loadAndOrder("bot_user_id"))},"Пользователь"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[2]||(s[2]=a=>t.loadAndOrder("rating"))},"Рейтинг"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[3]||(s[3]=a=>t.loadAndOrder("text"))},"Текст"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[4]||(s[4]=a=>t.loadAndOrder("updated_at"))},"Дата изменения"),eF])]),e("tbody",null,[(l(!0),n(v,null,$(t.reviews,(a,i)=>(l(),n("tr",{onClick:d=>t.selectReview(a),class:f({"border-info":a.deleted_at==null,"border-danger":a.deleted_at!=null})},[e("th",sF,u(a.id),1),e("td",null,u(a.botUser.fio_from_telegram||a.botUser.telegram_chat_id||"Не указано"),1),e("td",null,[e("p",oF,[g(M(E),{disableClick:!0,modelValue:a.rating,"onUpdate:modelValue":d=>a.rating=d},null,8,["modelValue","onUpdate:modelValue"]),e("span",lF,u(a.rating||0),1)])]),e("td",null,u(a.text||"Не указано"),1),e("td",null,u(t.$filters.current(a.updated_at)),1),e("td",null,[a.id?(l(),n("div",nF,[iF,e("ul",aF,[a.deleted_at==null?(l(),n("li",dF,[e("a",{class:"dropdown-item",onClick:d=>t.removeAppointmentReview(a.id),href:"javascript:void(0)"},"Удалить",8,rF)])):r("",!0)])])):r("",!0)])],10,tF))),256))])])):(l(),n("p",cF,"На текущий момент нет ни одного созданного отзыва"))]),e("div",uF,[t.paginate_object?(l(),y(j,{key:0,onPagination_page:t.nextAppointmentReviews,pagination:t.paginate_object},null,8,["onPagination_page","pagination"])):r("",!0)])]))}}),_F={key:0,class:"py-2"},pF={class:"row"},bF={class:"col-12"},fF={key:1,class:"py-2"},gF={class:"row"},vF={class:"col-12"},yF={key:2,class:"py-2"},$F={class:"row"},kF={class:"col-12"},FF={class:"nav nav-tabs justify-content-center"},CF={key:0,class:"row py-3"},wF={class:"col-12"},SF={key:1,class:"row py-3"},jF={class:"col-12"},qF={class:"col-12 py-3"},zF=e("h4",null,"Доступные сервисы в событии",-1),VF={key:2,class:"row"},PF={class:"col-12"},OF={key:3,class:"row"},UF={class:"col-12"},AF={class:"col-12 py-3"},QF=e("h4",null,"Актуальные записи на событие",-1),IF={key:4,class:"row"},TF={class:"col-12"},BF={class:"col-12 py-3"},RF=e("h4",null,"Отзывы к событию",-1),MF={props:["bot"],data(){return{part:0,tab:0,loadTable:!1,loadService:!1,loadReviewForm:!1,loadAppointments:!1,loadReviews:!1,loadAppointmentForm:!1,loadForm:!1,selectedEvent:null,selectedService:null,selectedAppointment:null,selectedReview:null}},computed:{...w(["getAppointmentEvents","getAppointmentEventsPaginateObject"])},mounted(){},methods:{callbackForm(){this.loadTable=!0,this.$nextTick(()=>{this.loadTable=!1})},callbackAppointment(){this.loadAppointments=!0,this.$nextTick(()=>{this.loadAppointments=!1})},callbackReview(){this.loadReviews=!0,this.$nextTick(()=>{this.loadReviews=!1})},createEvent(){this.part=2},selectAppointment(o){this.loadAppointmentForm=!0,this.selectedAppointment=o,this.$nextTick(()=>{this.loadAppointmentForm=!1})},selectService(o){this.loadService=!0,this.selectedService=o,this.$nextTick(()=>{this.loadService=!1})},selectReview(o){this.loadReviewForm=!0,this.selectedReview=o,this.$nextTick(()=>{this.loadReviewForm=!1})},selectEvent(o){this.loadForm=!0,this.$nextTick(()=>{this.loadForm=!1,this.selectedEvent=o,this.part=1,this.tab=0})}}},DF=Object.assign(MF,{__name:"Appointment",setup(o){return(t,s)=>(l(),n(v,null,[t.part===0?(l(),n("div",_F,[e("div",pF,[e("div",bF,[e("button",{type:"button",onClick:s[0]||(s[0]=(...a)=>t.createEvent&&t.createEvent(...a)),class:"btn btn-primary"}," Создать новое событие ")])]),t.loadTable?r("",!0):(l(),y(U2,{key:0,onSelect:t.selectEvent,bot:o.bot},null,8,["onSelect","bot"]))])):r("",!0),t.part===2?(l(),n("div",fF,[e("div",gF,[e("div",vF,[e("button",{type:"button",onClick:s[1]||(s[1]=a=>t.part=0),class:"btn btn-outline-primary"}," Назад ")])]),t.loadForm?r("",!0):(l(),y(W,{key:0,onCallback:t.callbackForm,bot:o.bot},null,8,["onCallback","bot"]))])):r("",!0),t.part===1?(l(),n("div",yF,[e("div",$F,[e("div",kF,[e("button",{type:"button",onClick:s[2]||(s[2]=a=>t.part=0),class:"btn btn-outline-primary"}," Назад ")])]),e("ul",FF,[e("li",{class:"nav-item",onClick:s[3]||(s[3]=a=>t.tab=0)},[e("a",{class:f(["nav-link",{active:t.tab===0}]),"aria-current":"page",href:"javascript:void(0)"},"Информация о событии",2)]),e("li",{class:"nav-item",onClick:s[4]||(s[4]=a=>t.tab=1)},[e("a",{class:f(["nav-link",{active:t.tab===1}]),href:"javascript:void(0)"},"Сервисы в событии",2)]),e("li",{class:"nav-item",onClick:s[5]||(s[5]=a=>t.tab=2)},[e("a",{class:f(["nav-link",{active:t.tab===2}]),href:"javascript:void(0)"},"График",2)]),e("li",{class:"nav-item",onClick:s[6]||(s[6]=a=>t.tab=3)},[e("a",{class:f(["nav-link",{active:t.tab===3}]),href:"javascript:void(0)"},"Записи на событие",2)]),e("li",{class:"nav-item",onClick:s[7]||(s[7]=a=>t.tab=4)},[e("a",{class:f(["nav-link",{active:t.tab===4}]),href:"javascript:void(0)"},"Отзывы о событии",2)])]),t.tab===0?(l(),n("div",CF,[e("div",wF,[t.loadForm?r("",!0):(l(),y(W,{key:0,onCallback:t.callbackForm,event:t.selectedEvent,bot:o.bot},null,8,["onCallback","event","bot"]))])])):r("",!0),t.tab===1?(l(),n("div",SF,[e("div",jF,[t.loadService?r("",!0):(l(),y(mt,{key:0,service:t.selectedService,"event-id":t.selectedEvent.id,bot:o.bot},null,8,["service","event-id","bot"]))]),e("div",qF,[zF,g(W2,{"event-id":t.selectedEvent.id,onSelect:t.selectService,bot:o.bot},null,8,["event-id","onSelect","bot"])])])):r("",!0),t.tab===2?(l(),n("div",VF,[e("div",PF,[g(f3,{"event-id":t.selectedEvent.id,bot:o.bot},null,8,["event-id","bot"])])])):r("",!0),t.tab===3?(l(),n("div",OF,[e("div",UF,[t.loadAppointmentForm?r("",!0):(l(),y(W$,{key:0,bot:o.bot,onCallback:t.callbackAppointment,"event-id":t.selectedEvent.id,appointment:t.selectedAppointment},null,8,["bot","onCallback","event-id","appointment"]))]),e("div",AF,[QF,t.loadAppointments?r("",!0):(l(),y(m2,{key:0,"event-id":t.selectedEvent.id,onSelect:t.selectAppointment,bot:o.bot},null,8,["event-id","onSelect","bot"]))])])):r("",!0),t.tab===4?(l(),n("div",IF,[e("div",TF,[t.loadReviewForm?r("",!0):(l(),y(W3,{key:0,review:t.selectedReview,bot:o.bot,onCallback:s[8]||(s[8]=a=>t.callbackReview()),"event-id":t.selectedEvent.id},null,8,["review","bot","event-id"]))]),e("div",BF,[RF,t.loadReviews?r("",!0):(l(),y(hF,{key:0,bot:o.bot,onSelect:t.selectReview,"event-id":t.selectedEvent.id},null,8,["bot","onSelect","event-id"]))])])):r("",!0)])):r("",!0)],64))}}),EF={props:["param"],data(){return{htmlInjections:[{title:"Кнопка синяя",value:"<a href='http://test.com/test' class='w-100 btn btn-primary'>Текст кнопки</a>"},{title:"Кнопка без цвета",value:"<a href='http://test.com/test' class='w-100 btn btn-link'>Текст кнопки</a>"},{title:"Кнопка с синей обводкой",value:"<a href='http://test.com/test' class='w-100 btn btn-outline-primary'>Текст кнопки</a>"}]}},mounted(){},methods:{attachTo(o){this.$emit("callback",{param:this.param||null,value:o})}}},LF={class:"dropdown"},KF=e("button",{class:"btn btn-link dropdown-toggle",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"}," Кнопки ",-1),NF={class:"dropdown-menu"},JF=["onClick"],YF={class:"dropdown-item",href:"javascript:void(0)"};function GF(o,t,s,a,i,d){return l(),n("div",LF,[KF,e("ul",NF,[(l(!0),n(v,null,$(i.htmlInjections,h=>(l(),n("li",{onClick:p=>d.attachTo(h.value)},[e("a",YF,u(h.title||"Не указано"),1)],8,JF))),256))])])}const R=O(EF,[["render",GF]]),HF={class:"row"},WF={class:"col-12 mb-3"},XF={class:"form-label",id:"quiz-title"},ZF=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),xF=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),e5={class:"col-12 mb-3"},t5={class:"form-check"},s5=e("label",{class:"form-check-label",for:"need_media"}," Нужен медиа-контент ",-1),o5={key:0,class:"col-12 mb-3"},l5={class:"form-label",id:"quiz-images"},n5=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),i5=e("div",null," Изображение, которое видит пользователь при выборе квиза ",-1),a5=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),d5={class:"col-12 mb-3"},r5={class:"form-label",id:"quiz-description"},c5=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),u5=e("div",null," Краткая информация о квизе ",-1),m5=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),h5={key:0,class:"text-gray-400 ml-3",style:{"font-size":"10px"}},_5={class:"col-12 mb-3"},p5={class:"form-check"},b5=e("label",{class:"form-check-label",for:"polling_mode"}," Квиз в режиме опроса (без команд и таймеров) ",-1),f5={key:1,class:"col-12 mb-3"},g5={class:"form-label",id:"quiz-time_limit"},v5=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),y5=e("div",null," Время на ответ ",-1),$5=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),k5={class:"col-12 mb-3"},F5={class:"form-check"},C5=e("label",{class:"form-check-label",for:"is-group"}," Показывать ответы по окончанию раунда ",-1),w5={class:"col-12 mb-3"},S5={class:"form-check"},j5=e("label",{class:"form-check-label",for:"is_active"}," Квиз виден пользователям ",-1),q5={key:2,class:"col-12 mb-3"},z5={class:"form-check"},V5=e("label",{class:"form-check-label",for:"round_mode"}," Использовать систему раундов ",-1),P5={class:"col-12 mb-3"},O5={class:"form-label",id:"quiz-time_limit"},U5=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),A5=e("div",null," Число попыток прохождения квиза ",-1),Q5=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),I5={class:"col-12 mb-3"},T5={class:"form-label",id:"quiz-time_limit"},B5=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),R5=e("div",null," Сколько % нужно ответить чтоб пройти ",-1),M5=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),D5={class:"row"},E5={class:"col-12 py-2"},L5={class:"col-12 mb-3"},K5={class:"row"},N5={class:"col-10"},J5={class:"d-flex justify-content-between"},Y5={class:"form-label",id:"quiz-success_message"},G5=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),H5=e("div",null," Текст в случае успешного прохождения квиза ",-1),W5=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),X5={key:0,class:"text-gray-400 ml-3",style:{"font-size":"10px"}},Z5=["onUpdate:modelValue"],x5={class:"col-2 d-flex align-items-center justify-content-center"},eC=["disabled","onClick"],tC={class:"row"},sC={class:"col-12 mb-2"},oC={class:"form-check"},lC=e("label",{class:"form-check-label",for:"need_inline_menu_on_success"}," Меню под текстом страницы при выигрыше ",-1),nC={key:0,class:"col-12 mb-2"},iC={class:"card"},aC={class:"card-header d-flex justify-between align-items-center"},dC=e("h6",null,"Конструктор меню в сообщении",-1),rC={key:0},cC={key:1},uC={class:"card-body"},mC={class:"row"},hC={class:"col-12 py-2"},_C={class:"col-12 mb-3"},pC={class:"row"},bC={class:"col-10"},fC={class:"d-flex justify-content-between"},gC=["id"],vC=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),yC=e("div",null," Текст в случае неудачного прохождения квиза ",-1),$C=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),kC={key:0,class:"text-gray-400 ml-3",style:{"font-size":"10px"}},FC=["onUpdate:modelValue"],CC={class:"col-2 d-flex align-items-center justify-content-center"},wC=["disabled","onClick"],SC={class:"row"},jC={class:"col-12 mb-2"},qC={class:"form-check"},zC=e("label",{class:"form-check-label",for:"need_template_selector_on_failure"}," Меню под текстом страницы при проигрыше ",-1),VC={key:0,class:"col-12 mb-2"},PC={class:"card"},OC={class:"card-header d-flex justify-between align-items-center"},UC=e("h6",null,"Конструктор меню в сообщении",-1),AC={key:0},QC={key:1},IC={class:"card-body"},TC={class:"row"},BC={class:"col-12 mb-3"},RC={class:"form-floating"},MC=["value","selected"],DC=e("label",{for:"quiz-display-type"},"Тип вывода вопросов",-1),EC={class:"row"},LC={class:"col-12"},KC={type:"submit",class:"btn btn-outline-success w-100 p-3"},NC={key:0},JC={key:1},YC={props:["quiz","bot"],data(){return{step:0,load:!1,need_reset:!1,need_services:!1,need_media:!1,need_inline_menu_on_success:!1,need_template_selector_on_success:!1,need_template_selector_on_failure:!1,need_inline_menu_on_failure:!1,types:["По порядку","Перемешать всё","Перемешать ответы","Перемешать вопросы"],quizForm:{id:null,title:null,image:null,description:null,completed_at:null,start_at:null,end_at:null,display_type:0,time_limit:30,show_answers:!1,polling_mode:!1,round_mode:!0,is_active:!1,try_count:1,success_percent:50,success_message:["Задание успешно пройдено!"],failure_message:["К сожалению вы не прошли задание!"],success_inline_keyboard_id:null,success_inline_keyboard:null,failure_inline_keyboard_id:null,failure_inline_keyboard:null}}},watch:{quizForm:{handler(o){this.need_reset=!0},deep:!0},"quizForm.polling_mode":{handler(o){this.quizForm.round_mode=!1},deep:!0}},mounted(){this.quiz&&this.$nextTick(()=>{this.quizForm={id:this.quiz.id||null,title:this.quiz.title||null,image:this.quiz.image||null,description:this.quiz.description||null,completed_at:this.quiz.completed_at?this.$filters.currentFull(this.quiz.completed_at):null,start_at:this.quiz.start_at?this.$filters.currentFull(this.quiz.start_at):null,end_at:this.quiz.end_at?this.$filters.currentFull(this.quiz.end_at):null,display_type:this.quiz.display_type||0,time_limit:this.quiz.time_limit||30,show_answers:this.quiz.show_answers||!1,polling_mode:this.quiz.polling_mode||!1,round_mode:this.quiz.round_mode||!1,is_active:this.quiz.is_active||!1,try_count:this.quiz.try_count||1,success_inline_keyboard_id:this.quiz.success_inline_keyboard_id||null,success_inline_keyboard:this.quiz.success_inline_keyboard||null,failure_inline_keyboard_id:this.quiz.failure_inline_keyboard_id||null,failure_inline_keyboard:this.quiz.failure_inline_keyboard||null,success_percent:this.quiz.success_percent||50,success_message:this.quiz.success_message||["Задание успешно пройдено!"],failure_message:this.quiz.failure_message||["К сожалению вы не прошли задание!"]},this.quizForm.success_inline_keyboard&&(this.need_inline_menu_on_success=!0),this.quizForm.failure_inline_keyboard&&(this.need_inline_menu_on_failure=!0)})},methods:{saveInlineKeyboardOnSuccess(o){this.quizForm.success_inline_keyboard=o},saveInlineKeyboardOnFailure(o){this.quizForm.failure_inline_keyboard=o},selectInlineKeyboardOnSuccess(o){this.quizForm.success_inline_keyboard=o,this.need_template_selector_on_success=!1},selectInlineKeyboardOnFailure(o){this.quizForm.failure_inline_keyboard=o,this.need_template_selector_on_failure=!1},attachTo(o,t){this.quizForm[o.param][t]==null?this.quizForm[o.param][t]=o.value:this.quizForm[o.param][t]+=o.value},selectPhoto(o){this.quizForm.image=o.file_id},removeMessage(o,t){this.quizForm[o||"success_message"].splice(t,1)},addMessage(o,t){this.quizForm[o||"success_message"].push(t)},submitForm(){let o=new FormData;Object.keys(this.quizForm).forEach(t=>{const s=this.quizForm[t]||"";typeof s=="object"?o.append(t,JSON.stringify(s)):o.append(t,s)}),o.append("bot_id",this.bot.id),this.$store.dispatch("storeQuiz",{quizForm:o}).then(t=>{this.quizForm={id:null,title:null,image:null,description:null,completed_at:null,start_at:null,end_at:null,display_type:0,time_limit:30,show_answers:!1,polling_mode:!1,round_mode:!1,is_active:!1,try_count:1,success_percent:50,success_inline_keyboard_id:null,success_inline_keyboard:null,failure_inline_keyboard_id:null,failure_inline_keyboard:null,success_message:["Задание успешно пройдено!"],failure_message:["К сожалению вы не прошли задание!"]},this.$emit("callback",t.data),this.$notify("Событие успешно создано")}).catch(t=>{this.$notify("Ошибка создания события")})}}},Z=Object.assign(YC,{__name:"QuizForm",setup(o){return(t,s)=>{const a=q("Popper");return l(),n("form",{onSubmit:s[17]||(s[17]=S((...i)=>t.submitForm&&t.submitForm(...i),["prevent"])),class:"py-3"},[e("div",HF,[e("div",WF,[e("label",XF,[g(a,{content:"Название вашего квиза"},{default:b(()=>[ZF]),_:1}),m(" Название квиза "),xF]),c(e("input",{type:"text",class:"form-control",placeholder:"Название","aria-label":"Название","onUpdate:modelValue":s[0]||(s[0]=i=>t.quizForm.title=i),maxlength:"255","aria-describedby":"quiz-title",required:""},null,512),[[_,t.quizForm.title]])]),e("div",e5,[e("div",t5,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[1]||(s[1]=i=>t.need_media=i),type:"checkbox",id:"need_media"},null,512),[[k,t.need_media]]),s5])]),t.need_media?(l(),n("div",o5,[e("label",l5,[g(a,null,{content:b(()=>[i5]),default:b(()=>[n5]),_:1}),m(" Изображение к квизу "),a5]),g(V,{"need-photo":!0,selected:t.quizForm.image,onSelect:t.selectPhoto},null,8,["selected","onSelect"])])):r("",!0),e("div",d5,[e("label",r5,[g(a,null,{content:b(()=>[u5]),default:b(()=>[c5]),_:1}),m(" Описание события "),m5,t.quizForm.description?(l(),n("small",h5," Длина текста "+u(t.quizForm.description.length)+"/255",1)):r("",!0)]),c(e("textarea",{class:"form-control",placeholder:"Описание мероприятия","aria-label":"Описание мероприятия",maxlength:"255","onUpdate:modelValue":s[2]||(s[2]=i=>t.quizForm.description=i),"aria-describedby":"quiz-description",required:""},`
                    `,512),[[_,t.quizForm.description]])]),e("div",_5,[e("div",p5,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[3]||(s[3]=i=>t.quizForm.polling_mode=i),type:"checkbox",id:"polling_mode"},null,512),[[k,t.quizForm.polling_mode]]),b5])]),t.quizForm.polling_mode?r("",!0):(l(),n("div",f5,[e("label",g5,[g(a,null,{content:b(()=>[y5]),default:b(()=>[v5]),_:1}),m(" Лимит времени на ответ в секундах "),$5]),c(e("input",{type:"number",class:"form-control",placeholder:"Лимит времени на ответ","aria-label":"Лимит времени на ответ",step:"0.1",min:"0","onUpdate:modelValue":s[4]||(s[4]=i=>t.quizForm.time_limit=i),"aria-describedby":"quiz-time_limit",required:""},null,512),[[_,t.quizForm.time_limit]])])),e("div",k5,[e("div",F5,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[5]||(s[5]=i=>t.quizForm.show_answers=i),type:"checkbox",id:"is-group"},null,512),[[k,t.quizForm.show_answers]]),C5])]),e("div",w5,[e("div",S5,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[6]||(s[6]=i=>t.quizForm.is_active=i),type:"checkbox",id:"is_active"},null,512),[[k,t.quizForm.is_active]]),j5])]),t.quizForm.polling_mode?r("",!0):(l(),n("div",q5,[e("div",z5,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[7]||(s[7]=i=>t.quizForm.round_mode=i),type:"checkbox",id:"round_mode"},null,512),[[k,t.quizForm.round_mode]]),V5])])),e("div",P5,[e("label",O5,[g(a,null,{content:b(()=>[A5]),default:b(()=>[U5]),_:1}),m(" Количество попыток "),Q5]),c(e("input",{type:"number",class:"form-control",placeholder:"Число попыток","aria-label":"Число попыток",step:"1",min:"1","onUpdate:modelValue":s[8]||(s[8]=i=>t.quizForm.try_count=i),"aria-describedby":"quiz-try_count",required:""},null,512),[[_,t.quizForm.try_count]])]),e("div",I5,[e("label",T5,[g(a,null,{content:b(()=>[R5]),default:b(()=>[B5]),_:1}),m(" % для прохождения "),M5]),c(e("input",{type:"number",class:"form-control",placeholder:"Процент для победы","aria-label":"Процент для победы",step:"1",min:"0","onUpdate:modelValue":s[9]||(s[9]=i=>t.quizForm.success_percent=i),"aria-describedby":"quiz-success_percent",required:""},null,512),[[_,t.quizForm.success_percent]])])]),e("div",D5,[e("div",E5,[e("button",{class:"btn btn-outline-info rounded-5",type:"button",onClick:s[10]||(s[10]=i=>t.addMessage("success_message",null))},"Добавить еще вариант текста ")]),(l(!0),n(v,null,$(t.quizForm.success_message,(i,d)=>(l(),n("div",L5,[e("div",K5,[e("div",N5,[e("div",J5,[e("label",Y5,[g(a,null,{content:b(()=>[H5]),default:b(()=>[G5]),_:1}),m(" Текст при победе "),W5,t.quizForm.success_message[d]?(l(),n("small",X5," Длина текста "+u(t.quizForm.success_message[d].length)+"/255",1)):r("",!0)]),g(R,{param:"success_message",onCallback:h=>t.attachTo(h,d)},null,8,["onCallback"])]),c(e("textarea",{class:"form-control",placeholder:"Текст при победе","aria-label":"Текст при победе",maxlength:"255","onUpdate:modelValue":h=>t.quizForm.success_message[d]=h,"aria-describedby":"quiz-success_message",required:""},`
                    `,8,Z5),[[_,t.quizForm.success_message[d]]])]),e("div",x5,[e("button",{class:"btn btn-outline-danger",disabled:t.quizForm.success_message.length<=1,onClick:h=>t.removeMessage("success_message",d)},"Удалить ",8,eC)])])]))),256))]),e("div",tC,[e("div",sC,[e("div",oC,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[11]||(s[11]=i=>t.need_inline_menu_on_success=i),type:"checkbox",id:"need_inline_menu_on_success"},null,512),[[k,t.need_inline_menu_on_success]]),lC])]),t.need_inline_menu_on_success?(l(),n("div",nC,[e("div",iC,[e("div",aC,[dC,e("button",{class:f(["btn",{"btn-outline-primary":!t.need_template_selector_on_success,"btn-primary":t.need_template_selector_on_success}]),type:"button",onClick:s[12]||(s[12]=i=>t.need_template_selector_on_success=!t.need_template_selector_on_success)},[t.need_template_selector_on_success?(l(),n("span",cC," Скрыть шаблоны меню")):(l(),n("span",rC," Открыть шаблоны меню"))],2)]),e("div",uC,[t.need_template_selector_on_success?(l(),y(I,{key:0,class:"mb-2",type:"inline",onSelect:t.selectInlineKeyboardOnSuccess,"select-mode":!0},null,8,["onSelect"])):(l(),y(Q,{key:1,type:"inline",onSave:t.saveInlineKeyboardOnSuccess,"edited-keyboard":t.quizForm.success_inline_keyboard},null,8,["onSave","edited-keyboard"]))])])])):r("",!0)]),e("div",mC,[e("div",hC,[e("button",{class:"btn btn-outline-info rounded-5",type:"button",onClick:s[13]||(s[13]=i=>t.addMessage("failure_message",null))},"Добавить еще вариант текста ")]),(l(!0),n(v,null,$(t.quizForm.failure_message,(i,d)=>(l(),n("div",_C,[e("div",pC,[e("div",bC,[e("div",fC,[e("label",{class:"form-label",id:"quiz-failure_message"+d},[g(a,null,{content:b(()=>[yC]),default:b(()=>[vC]),_:1}),m(" Текст при проигрыше "),$C,t.quizForm.failure_message[d]?(l(),n("small",kC," Длина текста "+u(t.quizForm.failure_message[d].length)+"/255",1)):r("",!0)],8,gC),g(R,{param:"failure_message",onCallback:h=>t.attachTo(h,d)},null,8,["onCallback"])]),c(e("textarea",{class:"form-control",placeholder:"Текст при проигрыше","aria-label":"Текст при проигрыше",maxlength:"255","onUpdate:modelValue":h=>t.quizForm.failure_message[d]=h,"aria-describedby":"quiz-success_message",required:""},`
                    `,8,FC),[[_,t.quizForm.failure_message[d]]])]),e("div",CC,[e("button",{class:"btn btn-outline-danger",disabled:t.quizForm.failure_message.length<=1,onClick:h=>t.removeMessage("failure_message",d)},"Удалить ",8,wC)])])]))),256))]),e("div",SC,[e("div",jC,[e("div",qC,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[14]||(s[14]=i=>t.need_inline_menu_on_failure=i),type:"checkbox",id:"need_template_selector_on_failure"},null,512),[[k,t.need_inline_menu_on_failure]]),zC])]),t.need_inline_menu_on_failure?(l(),n("div",VC,[e("div",PC,[e("div",OC,[UC,e("button",{class:f(["btn",{"btn-outline-primary":!t.need_template_selector_on_failure,"btn-primary":t.need_template_selector_on_failure}]),type:"button",onClick:s[15]||(s[15]=i=>t.need_template_selector_on_failure=!t.need_template_selector_on_failure)},[t.need_template_selector_on_failure?(l(),n("span",QC," Скрыть шаблоны меню")):(l(),n("span",AC," Открыть шаблоны меню"))],2)]),e("div",IC,[t.need_template_selector_on_failure?(l(),y(I,{key:0,class:"mb-2",type:"inline",onSelect:t.selectInlineKeyboardOnFailure,"select-mode":!0},null,8,["onSelect"])):(l(),y(Q,{key:1,type:"inline",onSave:t.saveInlineKeyboardOnFailure,"edited-keyboard":t.quizForm.failure_inline_keyboard},null,8,["onSave","edited-keyboard"]))])])])):r("",!0)]),e("div",TC,[e("div",BC,[e("div",RC,[c(e("select",{class:"form-select","onUpdate:modelValue":s[16]||(s[16]=i=>t.quizForm.display_type=i),id:"quiz-display-type","aria-label":"quiz-display-type"},[(l(!0),n(v,null,$(t.types,(i,d)=>(l(),n("option",{value:d,selected:d==t.quizForm.display_type},u(i),9,MC))),256))],512),[[T,t.quizForm.display_type]]),DC])])]),e("div",EC,[e("div",LC,[e("button",KC,[t.quizForm.id==null?(l(),n("span",NC,"Создать квиз")):(l(),n("span",JC,"Обновить квиз"))])])])],32)}}}),GC={class:"row py-2"},HC={class:"col-12"},WC={class:"input-group mb-3"},XC={class:"col-12"},ZC={key:0,class:"table"},xC=e("th",{scope:"col"},"Число вопросов",-1),ew=e("th",{scope:"col"},"Число команд",-1),tw=e("th",{scope:"col"},"Действие",-1),sw={scope:"row"},ow=["onClick"],lw={key:0,style:{width:"50px",height:"50px"},alt:""},nw={key:1},iw={key:0,class:"mb-0"},aw={key:1},dw={key:0,class:"mb-0"},rw={key:1},cw={key:0,class:"mb-0"},uw={key:1},mw={key:0,class:"fa-solid fa-chevron-down text-success"},hw={key:1,class:"fa-solid fa-xmark text-danger"},_w={key:0,class:"fa-solid fa-chevron-down text-success"},pw={key:1,class:"fa-solid fa-xmark text-danger"},bw={key:0,class:"dropdown"},fw=e("button",{class:"btn btn-outline-secondary",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-solid fa-ellipsis"})],-1),gw={class:"dropdown-menu"},vw={key:0},yw=["onClick"],$w={key:1},kw=e("div",{class:"alert alert-warning alert-dismissible fade show",role:"alert"},[e("strong",null,"Внимание!"),m(" Вы еще не добавили ни одного квиза! "),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"alert","aria-label":"Close"})],-1),Fw={class:"position-relative p-5 text-center text-muted bg-body border border-dashed rounded-2"},Cw={class:"d-flex justify-content-center mb-3"},ww={alt:"",width:"100",height:"100"},Sw=e("h1",{class:"text-body-emphasis"},"Создание Квиза",-1),jw=e("p",{class:"col-lg-8 mx-auto fs-5 text-muted"}," Квиз - это игра. Создавайте игры и делитесь с клиентами ссылкой на игру. Формируйте команды, начисляйте баллы, меняйте баллы на вкусные призы. Всё в ваших руках. ",-1),qw={class:"d-inline-flex gap-2 mb-5"},zw=e("a",{href:"https://telegra.ph/Sozdanie-Kviza-01-13",target:"_blank",class:"d-inline-flex align-items-center btn btn-outline-secondary btn-lg px-4 rounded-pill"}," Подробнее ",-1),Vw={key:0,class:"col-12"},Pw={props:["bot"],data(){return{direction:"desc",order:"updated_at",show:!0,loading:!0,quizzes:[],search:null,paginate_object:null}},computed:{...w(["getQuizzes","getQuizzesPaginateObject"])},mounted(){this.loadQuizzes()},methods:{removeQuiz(o){this.loading=!0,this.$store.dispatch("removeQuiz",{quizId:o}).then(t=>{this.loading=!1,this.loadQuizzes(0),this.$notify("Событие успешно удалено")}).catch(()=>{this.loading=!1,this.$notify("Ошибка удаления события")})},createQuiz(){this.$emit("create")},nextQuizzes(o){this.loadQuizzes(o)},selectEvent(o){this.$emit("select",o)},loadAndOrder(o){this.order=o,this.direction=this.direction==="desc"?"asc":"desc",this.loadQuizzes(0)},loadQuizzes(o=0){this.loading=!0,this.$store.dispatch("loadQuizzes",{dataObject:{bot_id:this.bot.id||null,search:this.search,order:this.order,direction:this.direction},page:o,size:20}).then(t=>{this.loading=!1,this.quizzes=this.getQuizzes,this.paginate_object=this.getQuizzesPaginateObject}).catch(()=>{this.loading=!1})}}},Ow=Object.assign(Pw,{__name:"QuizTable",setup(o){return(t,s)=>{const a=A("lazy");return l(),n("div",GC,[e("div",HC,[e("div",WC,[c(e("input",{type:"search",class:"form-control",placeholder:"Поиск квиза","aria-label":"Поиск квиза","onUpdate:modelValue":s[0]||(s[0]=i=>t.search=i),"aria-describedby":"quiz-search-quiz"},null,512),[[_,t.search]]),e("button",{class:"btn btn-outline-secondary",onClick:s[1]||(s[1]=i=>t.loadQuizzes(0)),type:"button",id:"quiz-search-quiz"},"Найти ")])]),e("div",XC,[t.quizzes.length>0?(l(),n("table",ZC,[e("thead",null,[e("tr",null,[e("th",{scope:"col",class:"cursor-pointer",onClick:s[2]||(s[2]=i=>t.loadAndOrder("id"))},"#"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[3]||(s[3]=i=>t.loadAndOrder("title"))},"Название"),xC,ew,e("th",{scope:"col",class:"cursor-pointer",onClick:s[4]||(s[4]=i=>t.loadAndOrder("image"))},"Изображение к квизу"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[5]||(s[5]=i=>t.loadAndOrder("description"))},"Описание"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[6]||(s[6]=i=>t.loadAndOrder("completed_at"))},"Квиз пройден"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[7]||(s[7]=i=>t.loadAndOrder("start_at"))},"Дата и время начала"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[8]||(s[8]=i=>t.loadAndOrder("end_at"))},"Дата и время завершения"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[9]||(s[9]=i=>t.loadAndOrder("display_type"))},"Тип отображения"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[10]||(s[10]=i=>t.loadAndOrder("show_answers"))},"Показывать ответы по окончанию раунда "),e("th",{scope:"col",class:"cursor-pointer",onClick:s[11]||(s[11]=i=>t.loadAndOrder("is_active"))},"Активный "),e("th",{scope:"col",class:"cursor-pointer",onClick:s[12]||(s[12]=i=>t.loadAndOrder("updated_at"))},"Дата изменения"),tw])]),e("tbody",null,[(l(!0),n(v,null,$(t.quizzes,(i,d)=>(l(),n("tr",{class:f({"border-info":i.deleted_at==null,"border-danger":i.deleted_at!=null})},[e("th",sw,u(i.id),1),e("td",{onClick:h=>t.selectEvent(i)},u(i.title||"Не указано"),9,ow),e("td",null,u((i.questions||[]).length),1),e("td",null,u((i.commands||[]).length),1),e("td",null,[i.image!=null?c((l(),n("img",lw,null,512)),[[a,"/file-by-file-id/"+i.image]]):(l(),n("p",nw,"не указано"))]),e("td",null,u(i.description||"Не указано"),1),e("td",null,[i.completed_at?(l(),n("p",iw,u(t.$filters.currentFull(i.completed_at)),1)):(l(),n("p",aw,"Не задано"))]),e("td",null,[i.start_at?(l(),n("p",dw,u(t.$filters.currentFull(i.start_at)),1)):(l(),n("p",rw,"Не задано"))]),e("td",null,[i.end_at?(l(),n("p",cw,u(t.$filters.currentFull(i.end_at)),1)):(l(),n("p",uw,"Не задано"))]),e("td",null,u(i.display_type),1),e("td",null,u(i.time_limit),1),e("td",null,[i.show_answers?(l(),n("i",mw)):(l(),n("i",hw))]),e("td",null,[i.is_active?(l(),n("i",_w)):(l(),n("i",pw))]),e("td",null,u(t.$filters.current(i.updated_at)),1),e("td",null,[i.id?(l(),n("div",bw,[fw,e("ul",gw,[i.deleted_at==null?(l(),n("li",vw,[e("a",{class:"dropdown-item",onClick:h=>t.removeQuiz(i.id),href:"javascript:void(0)"},"Удалить",8,yw)])):r("",!0)])])):r("",!0)])],2))),256))])])):(l(),n("div",$w,[kw,e("div",Fw,[e("div",Cw,[c(e("img",ww,null,512),[[a,"../images/icon.png"]])]),Sw,jw,e("div",qw,[e("button",{onClick:s[13]||(s[13]=(...i)=>t.createQuiz&&t.createQuiz(...i)),class:"d-inline-flex align-items-center btn btn-lg px-4 rounded-pill btn-primary",type:"button"}," Добавить "),zw])])]))]),t.quizzes.length>0?(l(),n("div",Vw,[t.paginate_object?(l(),y(j,{key:0,onPagination_page:t.nextQuizzes,pagination:t.paginate_object},null,8,["onPagination_page","pagination"])):r("",!0)])):r("",!0)])}}}),Uw={props:{type:String,value:String}},Aw={class:"d-flex mb-2"},Qw={class:"form-floating mb-3"},Iw=["value"],Tw=e("label",{for:"custom-url-link-for-success"},"Ссылка на файл",-1);function Bw(o,t,s,a,i,d){return l(),n(v,null,[e("div",Aw,[e("span",{class:f(["badge bg-secondary cursor-pointer mr-1",{"bg-success":s.type=="video"}]),onClick:t[0]||(t[0]=h=>o.$emit("update:type","video"))},"Видео",2),e("span",{class:f(["badge bg-secondary cursor-pointer mr-1",{"bg-success":s.type=="video_note"}]),onClick:t[1]||(t[1]=h=>o.$emit("update:type","video_note"))},"Кружок",2),e("span",{class:f(["badge bg-secondary cursor-pointer mr-1",{"bg-success":s.type=="photo"}]),onClick:t[2]||(t[2]=h=>o.$emit("update:type","photo"))},"Изображение",2),e("span",{class:f(["badge bg-secondary cursor-pointer mr-1",{"bg-success":s.type=="audio"}]),onClick:t[3]||(t[3]=h=>o.$emit("update:type","audio"))},"Звук",2)]),e("div",Qw,[e("input",{type:"text",class:"form-control",value:s.value,onInput:t[4]||(t[4]=h=>o.$emit("update:value",h.target.value)),id:"custom-url-link-for-success",placeholder:"https://...."},null,40,Iw),Tw])],64)}const N=O(Uw,[["render",Bw]]),Rw={class:"row py-3"},Mw={class:"col-12"},Dw={class:"row"},Ew={class:"col-12 mb-3"},Lw={key:0},Kw=["onClick"],Nw={class:"form-label",id:"quiz-round"},Jw=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),Yw=e("div",null," Раунд, в котором будет отображен вопрос ",-1),Gw=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),Hw={class:"col-12 mb-3"},Ww={class:"form-label",id:"event-on_after_appointment"},Xw=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),Zw=e("div",null," Текст вопроса ",-1),xw=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),e4={key:0,class:"text-gray-400 ml-3",style:{"font-size":"10px"}},t4={class:"col-12 mb-3"},s4={class:"form-check"},o4=e("label",{class:"form-check-label",for:"need_media"}," Нужен медиа-контент ",-1),l4={key:0,class:"col-12 mb-3"},n4={class:"form-label",id:"quiz-images"},i4=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),a4=e("div",null," Изображение, видео, аудио сопровождение вопроса ",-1),d4={key:0,class:"badge rounded-pill text-bg-info m-0"},r4=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),c4=e("h6",null,"Вставьте ссылку на контент...",-1),u4=e("h6",null,"...или выберите из доступных",-1),m4={class:"col-12 mb-3"},h4={class:"form-check"},_4=e("label",{class:"form-check-label",for:"is_multiply"}," Множественные ответы ",-1),p4={class:"col-12 mb-3"},b4={class:"form-check"},f4=e("label",{class:"form-check-label",for:"is_open"}," Открытый вопрос ",-1),g4={class:"col-12 mb-3"},v4={class:"d-flex justify-content-between"},y4={class:"form-label",id:"quiz-description"},$4=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),k4=e("div",null," Текст при выборе правильного ответа ",-1),F4=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),C4={key:0,class:"text-gray-400 ml-3",style:{"font-size":"10px"}},w4={class:"col-12 mb-3"},S4={class:"form-check"},j4=e("label",{class:"form-check-label",for:"need_media_for_success"}," Нужен медиа-контент при правильном ответе ",-1),q4={key:1,class:"col-12 mb-3"},z4=e("h6",null,"Вставьте ссылку на контент...",-1),V4=e("h6",null,"...или выберите из доступных",-1),P4={class:"col-12 mb-3"},O4={class:"d-flex justify-content-between"},U4={class:"form-label",id:"quiz-description"},A4=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),Q4=e("div",null," Текст в выбора неправильного ответа ",-1),I4=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),T4={key:0,class:"text-gray-400 ml-3",style:{"font-size":"10px"}},B4={class:"col-12 mb-3"},R4={class:"form-check"},M4=e("label",{class:"form-check-label",for:"need_media_for_failed"}," Нужен медиа-контент при неправильном ответе ",-1),D4={key:2,class:"col-12 mb-3"},E4=e("h6",null,"Вставьте ссылку на контент...",-1),L4=e("h6",null,"...или выберите из доступных",-1),K4={class:"row"},N4={class:"col-12"},J4={class:"col-12"},Y4={key:0,class:"table"},G4=e("thead",null,[e("tr",null,[e("th",{scope:"col"},"#"),e("th",{scope:"col"},"Текст вопроса"),e("th",{scope:"col"},"Баллы"),e("th",{scope:"col"},"Контент"),e("th",{scope:"col"},"Тип контента"),e("th",{scope:"col"},"Является верным"),e("th",{scope:"col"},"Действие")])],-1),H4={scope:"row"},W4={class:"form-floating mb-3"},X4=["onUpdate:modelValue","id"],Z4=["for"],x4={class:"form-floating mb-3"},e8=["onUpdate:modelValue","id"],t8=["for"],s8=["onClick"],o8={class:"form-check"},l8=["onUpdate:modelValue","id"],n8=["for"],i8={class:"dropdown"},a8=e("button",{class:"btn btn-outline-secondary",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-solid fa-ellipsis"})],-1),d8={class:"dropdown-menu"},r8={key:0},c8=["onClick"],u8={key:1},m8=["onClick"],h8={key:1},_8={class:"row"},p8={class:"col-12"},b8={type:"submit",class:"btn btn-outline-success w-100 p-3"},f8={key:0},g8={key:1},v8={class:"modal fade",id:"chooseMediaContent",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},y8={class:"modal-dialog"},$8={class:"modal-content"},k8={key:0,class:"modal-body"},F8=e("div",{class:"modal-footer"},[e("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Закрыть")],-1),C8={class:"modal fade",id:"chooseSuccessMediaContent",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},w8={class:"modal-dialog"},S8={class:"modal-content"},j8={class:"modal-body"},q8=e("div",{class:"modal-footer"},[e("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Закрыть")],-1),z8={class:"modal fade",id:"chooseFailureMediaContent",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},V8={class:"modal-dialog"},P8={class:"modal-content"},O8={class:"modal-body"},U8=e("div",{class:"modal-footer"},[e("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Закрыть")],-1),A8={class:"modal fade",id:"chooseBaseMediaContent",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},Q8={class:"modal-dialog"},I8={class:"modal-content"},T8={class:"modal-body"},B8=e("div",{class:"modal-footer"},[e("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Закрыть")],-1),R8={props:["quizId","bot","question"],data(){return{step:0,load:!1,selectedQuestionIndex:null,need_media:!1,need_media_for_success:!1,need_media_for_failed:!1,rounds:[],questionForm:{id:null,text:null,round:null,media_content:null,content_type:null,is_multiply:!1,is_open:!1,answers:[],success_message:null,failure_message:null,success_media_content:null,failure_media_content:null,success_media_content_type:null,failure_media_content_type:null}}},watch:{questionForm:{handler(o){this.need_reset=!0},deep:!0},need_media:function(o,t){this.need_page_images||(this.questionForm.media_content=null,this.questionForm.content_type=null)},need_media_for_success:function(o,t){this.need_page_images||(this.questionForm.success_media_content=null,this.questionForm.success_media_content_type=null)},need_media_for_failed:function(o,t){this.need_page_images||(this.questionForm.failure_media_content=null,this.questionForm.failure_media_content_type=null)}},mounted(){this.loadQuizRounds(),this.question&&(this.question.media_content!=null&&(this.need_media=!0),this.question.success_media_content!=null&&(this.need_media_for_success=!0),this.question.failure_media_content!=null&&(this.need_media_for_failed=!0),this.$nextTick(()=>{this.questionForm={id:this.question.id||null,text:this.question.text||null,round:this.question.round||null,media_content:this.question.media_content||null,content_type:this.question.content_type||null,is_multiply:this.question.is_multiply||!1,is_open:this.question.is_open||!1,answers:this.question.answers||[],success_message:this.question.success_message||null,failure_message:this.question.failure_message||null,success_media_content:this.question.success_media_content||null,failure_media_content:this.question.failure_media_content||null,success_media_content_type:this.question.success_media_content_type||null,failure_media_content_type:this.question.failure_media_content_type||null}}))},methods:{attachTo(o){this.questionForm[o.param]==null?this.questionForm[o.param]=o.value:this.questionForm[o.param]+=o.value},loadQuizRounds(){this.$store.dispatch("loadQuizRounds",{dataObject:{bot_id:this.bot.id||null,quiz_id:this.quizId||null}}).then(o=>{this.rounds=o})},chooseBaseMediaContent(o){new bootstrap.Modal(document.getElementById("chooseBaseMediaContent"),{}).show()},chooseSuccessMediaContent(o){new bootstrap.Modal(document.getElementById("chooseSuccessMediaContent"),{}).show()},chooseFailureMediaContent(o){new bootstrap.Modal(document.getElementById("chooseFailureMediaContent"),{}).show()},chooseMediaContent(o){this.selectedQuestionIndex=null,this.$nextTick(()=>{this.selectedQuestionIndex=o}),new bootstrap.Modal(document.getElementById("chooseMediaContent"),{}).show()},selectMediaForFailure(o){this.questionForm.failure_media_content=o.file_id,this.questionForm.failure_media_content_type=o.type},selectMediaForSuccess(o){this.questionForm.success_media_content=o.file_id,this.questionForm.success_media_content_type=o.type},selectMediaForAnswer(o){this.questionForm.answers[this.selectedQuestionIndex].media_content=o.file_id,this.questionForm.answers[this.selectedQuestionIndex].content_type=o.type},selectMedia(o){this.questionForm.media_content=o.file_id,this.questionForm.content_type=o.type},clearQuestionForm(){this.questionForm={id:null,text:null,round:null,media_content:null,content_type:null,is_multiply:!1,is_open:!1,answers:[],success_message:null,failure_message:null,success_media_content:null,failure_media_content:null,success_media_content_type:null,failure_media_content_type:null}},addNewAnswer(){this.questionForm.answers.push({text:null,media_content:null,content_type:null,is_right_answer:!1,points:0})},removeAnswerFromArray(o){this.questionForm.answers.splice(o,1)},removeAnswer(o){this.$store.dispatch("removeQuizAnswer",{quizAnswerId:o}).then(t=>{this.$notify("Вопрос успешно удален");let s=this.questionForm.answers.findIndex(a=>a.id==o);this.questionForm.answers.splice(s,1)}).catch(t=>{this.$notify("Ошибка удаления вопроса")})},submitForm(){let o=new FormData;Object.keys(this.questionForm).forEach(t=>{const s=this.questionForm[t]||"";typeof s=="object"?o.append(t,JSON.stringify(s)):o.append(t,s)}),o.append("bot_id",this.bot.id),o.append("quiz_id",this.quizId),this.$store.dispatch("storeQuizQuestion",{quizQuestionForm:o}).then(t=>{this.$emit("callback",t.data),this.$notify("Вопрос успешно создан"),this.clearQuestionForm(),this.loadQuizRounds()}).catch(t=>{this.$notify("Ошибка создания вопроса")})}}},M8=Object.assign(R8,{__name:"QuizQuestionForm",setup(o){return(t,s)=>{const a=q("Popper");return l(),n(v,null,[e("div",Rw,[e("div",Mw,[e("button",{onClick:s[0]||(s[0]=(...i)=>t.clearQuestionForm&&t.clearQuestionForm(...i)),class:"btn btn-primary"},"Новый вопрос ")])]),e("form",{onSubmit:s[20]||(s[20]=S((...i)=>t.submitForm&&t.submitForm(...i),["prevent"]))},[e("div",Dw,[e("div",Ew,[t.rounds.length>0?(l(),n("p",Lw,[m(" Ранее созданные раунды: "),(l(!0),n(v,null,$(t.rounds,i=>(l(),n("span",{onClick:d=>t.questionForm.round=i,class:"badge bg-primary mr-1 cursor-pointer"},u(i),9,Kw))),256))])):r("",!0),e("label",Nw,[g(a,null,{content:b(()=>[Yw]),default:b(()=>[Jw]),_:1}),m(" Раунд "),Gw]),c(e("input",{type:"number",class:"form-control",placeholder:"Раунд","aria-label":"Раундт",step:"1",min:"1","onUpdate:modelValue":s[1]||(s[1]=i=>t.questionForm.round=i),"aria-describedby":"quiz-round",required:""},null,512),[[_,t.questionForm.round]])]),e("div",Hw,[e("label",Ww,[g(a,null,{content:b(()=>[Zw]),default:b(()=>[Xw]),_:1}),m(" Текст вопроса "),xw,t.questionForm.text?(l(),n("small",e4," Длина текста "+u(t.questionForm.text.length)+"/255",1)):r("",!0)]),c(e("textarea",{type:"text",class:"form-control",placeholder:"Текст вопроса","aria-label":"Текст вопроса","onUpdate:modelValue":s[2]||(s[2]=i=>t.questionForm.text=i),maxlength:"255","aria-describedby":"review-text",required:""},`
                    `,512),[[_,t.questionForm.text]])]),e("div",t4,[e("div",s4,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[3]||(s[3]=i=>t.need_media=i),type:"checkbox",id:"need_media"},null,512),[[k,t.need_media]]),o4])]),t.need_media?(l(),n("div",l4,[e("label",n4,[g(a,null,{content:b(()=>[a4]),default:b(()=>[i4]),_:1}),m(" Медиа контент к вопросу "),t.questionForm.content_type?(l(),n("span",d4,u(t.questionForm.content_type),1)):r("",!0),r4]),c4,g(N,{value:t.questionForm.media_content,type:t.questionForm.content_type,"onUpdate:type":s[4]||(s[4]=i=>t.questionForm.content_type=i),"onUpdate:value":s[5]||(s[5]=i=>t.questionForm.media_content=i)},null,8,["value","type"]),u4,e("button",{type:"button",onClick:s[6]||(s[6]=(...i)=>t.chooseBaseMediaContent&&t.chooseBaseMediaContent(...i)),class:"btn btn-outline-info rounded-lg"},"Выбрать медиа-файл ")])):r("",!0),e("div",m4,[e("div",h4,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[7]||(s[7]=i=>t.questionForm.is_multiply=i),type:"checkbox",id:"is_multiply"},null,512),[[k,t.questionForm.is_multiply]]),_4])]),e("div",p4,[e("div",b4,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[8]||(s[8]=i=>t.questionForm.is_open=i),type:"checkbox",id:"is_open"},null,512),[[k,t.questionForm.is_open]]),f4])]),e("div",g4,[e("div",v4,[e("label",y4,[g(a,null,{content:b(()=>[k4]),default:b(()=>[$4]),_:1}),m(" Текст при выборе правильного ответа "),F4,t.questionForm.success_message?(l(),n("small",C4," Длина текста "+u(t.questionForm.success_message.length)+"/255",1)):r("",!0)]),g(R,{param:"success_message",onCallback:t.attachTo},null,8,["onCallback"])]),c(e("textarea",{class:"form-control",placeholder:"Текст при правильном ответе","aria-label":"Текст при правильном ответе",maxlength:"255","onUpdate:modelValue":s[9]||(s[9]=i=>t.questionForm.success_message=i),"aria-describedby":"quiz-question-success_message"},`
                    `,512),[[_,t.questionForm.success_message]])]),e("div",w4,[e("div",S4,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[10]||(s[10]=i=>t.need_media_for_success=i),type:"checkbox",id:"need_media_for_success"},null,512),[[k,t.need_media_for_success]]),j4])]),t.need_media_for_success?(l(),n("div",q4,[z4,g(N,{type:t.questionForm.success_media_content_type,"onUpdate:type":s[11]||(s[11]=i=>t.questionForm.success_media_content_type=i),value:t.questionForm.success_media_content,"onUpdate:value":s[12]||(s[12]=i=>t.questionForm.success_media_content=i)},null,8,["type","value"]),V4,e("button",{type:"button",onClick:s[13]||(s[13]=(...i)=>t.chooseSuccessMediaContent&&t.chooseSuccessMediaContent(...i)),class:"btn btn-outline-info rounded-lg"},"Выбрать медиа-файл ")])):r("",!0),e("div",P4,[e("div",O4,[e("label",U4,[g(a,null,{content:b(()=>[Q4]),default:b(()=>[A4]),_:1}),m(" Текст при выборе неправильного ответа "),I4,t.questionForm.failure_message?(l(),n("small",T4," Длина текста "+u(t.questionForm.failure_message.length)+"/255",1)):r("",!0)]),g(R,{param:"failure_message",onCallback:t.attachTo},null,8,["onCallback"])]),c(e("textarea",{class:"form-control",placeholder:"Текст при неправильном ответе","aria-label":"Текст при неправильном ответе",maxlength:"255","onUpdate:modelValue":s[14]||(s[14]=i=>t.questionForm.failure_message=i),"aria-describedby":"quiz-question-failure-message"},`
                    `,512),[[_,t.questionForm.failure_message]])]),e("div",B4,[e("div",R4,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[15]||(s[15]=i=>t.need_media_for_failed=i),type:"checkbox",id:"need_media_for_failed"},null,512),[[k,t.need_media_for_failed]]),M4])]),t.need_media_for_failed?(l(),n("div",D4,[E4,g(N,{type:t.questionForm.failure_media_content_type,"onUpdate:type":s[16]||(s[16]=i=>t.questionForm.failure_media_content_type=i),value:t.questionForm.failure_media_content,"onUpdate:value":s[17]||(s[17]=i=>t.questionForm.failure_media_content=i)},null,8,["type","value"]),L4,e("button",{type:"button",onClick:s[18]||(s[18]=(...i)=>t.chooseFailureMediaContent&&t.chooseFailureMediaContent(...i)),class:"btn btn-outline-info rounded-lg"},"Выбрать медиа-файл ")])):r("",!0)]),e("div",K4,[e("div",N4,[e("button",{onClick:s[19]||(s[19]=(...i)=>t.addNewAnswer&&t.addNewAnswer(...i)),type:"button",class:"btn btn-outline-success rounded-5"}," Добавить ответы ")]),e("div",J4,[t.questionForm.answers.length>0?(l(),n("table",Y4,[G4,e("tbody",null,[(l(!0),n(v,null,$(t.questionForm.answers,(i,d)=>(l(),n("tr",{class:f({"border-info":i.deleted_at==null,"border-danger":i.deleted_at!=null})},[e("th",H4,u(i.id||"Новый"),1),e("td",null,[e("div",W4,[c(e("input",{type:"text","onUpdate:modelValue":h=>t.questionForm.answers[d].text=h,class:"form-control",id:"answer-text-"+d,placeholder:"Текст ответа"},null,8,X4),[[_,t.questionForm.answers[d].text]]),e("label",{for:"answer-text-"+d},"Текст ответа",8,Z4)])]),e("td",null,[e("div",x4,[c(e("input",{type:"text","onUpdate:modelValue":h=>t.questionForm.answers[d].points=h,class:"form-control",id:"answer-points-"+d,placeholder:"Текст ответа"},null,8,e8),[[_,t.questionForm.answers[d].points]]),e("label",{for:"answer-points-"+d},"Баллы",8,t8)])]),e("td",null,[e("p",{class:"cursor-pointer",onClick:h=>t.chooseMediaContent(d)},u(i.media_content||"Не указано"),9,s8)]),e("td",null,u(i.content_type||"Не указано"),1),e("td",null,[e("div",o8,[c(e("input",{class:"form-check-input","onUpdate:modelValue":h=>t.questionForm.answers[d].is_right_answer=h,type:"checkbox",id:"answer-is_right_answer-"+d},null,8,l8),[[k,t.questionForm.answers[d].is_right_answer]]),e("label",{class:"form-check-label",for:"answer-is_right_answer-"+d}," Правильный ответ ",8,n8)])]),e("td",null,[e("div",i8,[a8,e("ul",d8,[i.id==null?(l(),n("li",r8,[e("a",{class:"dropdown-item",onClick:h=>t.removeAnswerFromArray(d),href:"javascript:void(0)"},"Удалить",8,c8)])):r("",!0),i.deleted_at==null&&i.id!=null?(l(),n("li",u8,[e("a",{class:"dropdown-item",onClick:h=>t.removeAnswer(i.id),href:"javascript:void(0)"},"Удалить",8,m8)])):r("",!0)])])])],2))),256))])])):(l(),n("p",h8,"На текущий момент нет ни одного созданного ответа"))])]),e("div",_8,[e("div",p8,[e("button",b8,[t.questionForm.id==null?(l(),n("span",f8,"Сохранить вопрос")):(l(),n("span",g8,"Обновить вопрос"))])])])],32),e("div",v8,[e("div",y8,[e("div",$8,[t.selectedQuestionIndex!=null?(l(),n("div",k8,[g(V,{"need-video":!0,"need-video-note":!0,"need-audio":!0,"need-photo":!0,selected:[t.questionForm.answers[t.selectedQuestionIndex||0].media_content||""],onSelect:t.selectMediaForAnswer},null,8,["selected","onSelect"])])):r("",!0),F8])])]),e("div",C8,[e("div",w8,[e("div",S8,[e("div",j8,[g(V,{"need-video":!0,"need-video-note":!0,"need-audio":!0,"need-photo":!0,selected:[t.questionForm.success_media_content],onSelect:t.selectMediaForSuccess},null,8,["selected","onSelect"])]),q8])])]),e("div",z8,[e("div",V8,[e("div",P8,[e("div",O8,[g(V,{"need-video":!0,"need-video-note":!0,"need-audio":!0,"need-photo":!0,selected:[t.questionForm.failure_media_content],onSelect:t.selectMediaForFailure},null,8,["selected","onSelect"])]),U8])])]),e("div",A8,[e("div",Q8,[e("div",I8,[e("div",T8,[g(V,{"need-video":!0,"need-video-note":!0,"need-audio":!0,"need-photo":!0,selected:[t.questionForm.media_content],onSelect:t.selectMedia},null,8,["selected","onSelect"])]),B8])])])],64)}}}),D8={class:"row"},E8={class:"col-12"},L8={key:0,class:"table"},K8=e("th",{scope:"col"},"Число ответов",-1),N8=e("th",{scope:"col"},"Действие",-1),J8={scope:"row"},Y8=["onClick"],G8={key:0,class:"fa-solid fa-chevron-down text-success"},H8={key:1,class:"fa-solid fa-xmark text-danger"},W8={key:0,class:"fa-solid fa-chevron-down text-success"},X8={key:1,class:"fa-solid fa-xmark text-danger"},Z8={key:0,class:"dropdown"},x8=e("button",{class:"btn btn-outline-secondary",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-solid fa-ellipsis"})],-1),e6={class:"dropdown-menu"},t6={key:0},s6=["onClick"],o6={key:1},l6={class:"col-12"},n6={props:["bot","quizId"],data(){return{direction:"desc",order:"updated_at",show:!0,is_group:!1,loading:!0,questions:[],search:null,paginate_object:null}},computed:{...w(["getQuizQuestions","getQuizQuestionsPaginateObject"])},mounted(){this.loadQuizQuestions()},methods:{nextQuizQuestion(o){this.loadQuizQuestions(o)},selectQuizQuestion(o){this.$emit("select",o),this.$notify("Вопрос успешно выбран")},removeQuizQuestion(o){this.loading=!0,this.$store.dispatch("removeQuizQuestion",{quizQuestionId:o}).then(t=>{this.loading=!1,this.loadQuizQuestions(0),this.$notify("Вопрос успешно удален")}).catch(()=>{this.loading=!1,this.$notify("Вопрос удаления сервиса")})},loadAndOrder(o){this.order=o,this.direction=this.direction==="desc"?"asc":"desc",this.loadQuizQuestions(0)},loadQuizQuestions(o=0){this.loading=!0,this.$store.dispatch("loadQuizQuestions",{dataObject:{quiz_id:this.quizId,bot_id:this.bot.id||null,search:this.search,order:this.order,direction:this.direction},page:o,size:100}).then(t=>{this.loading=!1,this.questions=this.getQuizQuestions,this.paginate_object=this.getQuizQuestionsPaginateObject}).catch(()=>{this.loading=!1})}}},i6=Object.assign(n6,{__name:"QuizQuestionTable",setup(o){return(t,s)=>(l(),n("div",D8,[e("div",E8,[t.questions.length>0?(l(),n("table",L8,[e("thead",null,[e("tr",null,[e("th",{scope:"col",class:"cursor-pointer",onClick:s[0]||(s[0]=a=>t.loadAndOrder("id"))},"#"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[1]||(s[1]=a=>t.loadAndOrder("text"))},"Текст вопроса"),K8,e("th",{scope:"col",class:"cursor-pointer",onClick:s[2]||(s[2]=a=>t.loadAndOrder("round"))},"Раунд"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[3]||(s[3]=a=>t.loadAndOrder("media_content"))},"Контент"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[4]||(s[4]=a=>t.loadAndOrder("content_type"))},"Тип контента"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[5]||(s[5]=a=>t.loadAndOrder("is_multiply"))},"Множественный"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[6]||(s[6]=a=>t.loadAndOrder("is_open"))},"Открытый"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[7]||(s[7]=a=>t.loadAndOrder("updated_at"))},"Дата изменения"),N8])]),e("tbody",null,[(l(!0),n(v,null,$(t.questions,(a,i)=>(l(),n("tr",{class:f({"border-info":a.deleted_at==null,"border-danger":a.deleted_at!=null})},[e("th",J8,u(a.id),1),e("td",{onClick:d=>t.selectQuizQuestion(a)},u(a.text||"Не указано"),9,Y8),e("td",null,u((a.answers||[]).length),1),e("td",null,u(a.round||"Не указано"),1),e("td",null,u(a.media_content||"Не указано"),1),e("td",null,u(a.content_type||"Не указано"),1),e("td",null,[a.is_multiply?(l(),n("i",G8)):(l(),n("i",H8))]),e("td",null,[a.is_open?(l(),n("i",W8)):(l(),n("i",X8))]),e("td",null,u(t.$filters.current(a.updated_at)),1),e("td",null,[a.id?(l(),n("div",Z8,[x8,e("ul",e6,[a.deleted_at==null?(l(),n("li",t6,[e("a",{class:"dropdown-item",onClick:d=>t.removeQuizQuestion(a.id),href:"javascript:void(0)"},"Удалить",8,s6)])):r("",!0)])])):r("",!0)])],2))),256))])])):(l(),n("p",o6,"На текущий момент нет ни одного созданного вопроса"))]),e("div",l6,[t.paginate_object?(l(),y(j,{key:0,onPagination_page:t.nextQuizQuestion,pagination:t.paginate_object},null,8,["onPagination_page","pagination"])):r("",!0)])]))}}),a6={class:"row py-3"},d6={class:"col-12"},r6={class:"row"},c6={class:"col-12 mb-3"},u6={class:"form-label",id:"command-title"},m6=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),h6=e("div",null," Название команды ",-1),_6=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),p6={class:"col-12 mb-3"},b6={class:"form-label",id:"event-on_after_appointment"},f6=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),g6=e("div",null," Текст описания команды ",-1),v6=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),y6={key:0,class:"text-gray-400 ml-3",style:{"font-size":"10px"}},$6=e("div",{class:"col-12 mb-3"},[e("button",{type:"button",class:"btn btn-outline-info rounded-5","data-bs-toggle":"modal","data-bs-target":"#select-players"}," Подобрать участников команды ")],-1),k6={key:0,class:"col-12 mb-3"},F6=e("h4",null,"Пользователи в команде",-1),C6={class:"list-group list-group-numbered"},w6={class:"list-group-item d-flex justify-content-between align-items-start"},S6={class:"ms-2 me-auto"},j6={class:"fw-bold"},q6={class:"dropdown"},z6=e("button",{class:"btn btn-outline-secondary",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-solid fa-ellipsis"})],-1),V6={class:"dropdown-menu"},P6=["onClick"],O6={class:"row"},U6={class:"col-12"},A6={type:"submit",class:"btn btn-outline-success w-100 p-3"},Q6={key:0},I6={key:1},T6={class:"modal fade",id:"select-players",tabindex:"-1","aria-labelledby":"select-players-label","aria-hidden":"true"},B6={class:"modal-dialog modal-fullscreen"},R6={class:"modal-content"},M6=e("div",{class:"modal-header"},[e("h1",{class:"modal-title fs-5",id:"select-players-label"},"Подбор участников команды"),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),D6={class:"modal-body"},E6=e("div",{class:"modal-footer"},[e("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Закрыть")],-1),L6={props:["quizId","bot","command"],data(){return{step:0,load:!1,commandForm:{id:null,title:null,description:null,players:[]}}},watch:{commandForm:{handler(o){this.need_reset=!0},deep:!0}},mounted(){this.command&&this.$nextTick(()=>{this.commandForm={id:this.command.id||null,title:this.command.title||null,description:this.command.description||null,players:this.command.players||[]}})},methods:{removePlayerFromCommand(o){},selectBotUser(o){if(this.commandForm.players.findIndex(s=>s.id==o.id)>=0){this.$notify("Такой пользователь уже есть в списке");return}this.$notify("Пользователь успешно добавлен"),this.commandForm.players.push(o)},clearCommandForm(){this.commandForm={id:null,title:null,description:null,players:[]}},submitForm(){let o=new FormData;Object.keys(this.commandForm).forEach(t=>{const s=this.commandForm[t]||"";typeof s=="object"?o.append(t,JSON.stringify(s)):o.append(t,s)}),o.append("bot_id",this.bot.id),o.append("quiz_id",this.quizId),this.$store.dispatch("storeQuizCommand",{quizCommandForm:o}).then(t=>{this.$emit("callback",t.data),this.$notify("Команда успешно создана"),this.clearCommandForm()}).catch(t=>{this.$notify("Ошибка создания команды")})}}},K6=Object.assign(L6,{__name:"QuizCommandForm",setup(o){return(t,s)=>{const a=q("Popper");return l(),n(v,null,[e("div",a6,[e("div",d6,[e("button",{onClick:s[0]||(s[0]=(...i)=>t.clearCommandForm&&t.clearCommandForm(...i)),class:"btn btn-primary"},"Новая команда")])]),e("form",{onSubmit:s[3]||(s[3]=S((...i)=>t.submitForm&&t.submitForm(...i),["prevent"]))},[e("div",r6,[e("div",c6,[e("label",u6,[g(a,null,{content:b(()=>[h6]),default:b(()=>[m6]),_:1}),m(" Название команды "),_6]),c(e("input",{type:"text",class:"form-control",placeholder:"Название команды","aria-label":"Название команды",maxlength:"255","onUpdate:modelValue":s[1]||(s[1]=i=>t.commandForm.title=i),"aria-describedby":"command-title",required:""},null,512),[[_,t.commandForm.title]])]),e("div",p6,[e("label",b6,[g(a,null,{content:b(()=>[g6]),default:b(()=>[f6]),_:1}),m(" Описание команды "),v6,t.commandForm.description?(l(),n("small",y6," Длина текста "+u(t.commandForm.description.length)+"/255",1)):r("",!0)]),c(e("textarea",{type:"text",class:"form-control",placeholder:"Текст описания","aria-label":"Текст описания","onUpdate:modelValue":s[2]||(s[2]=i=>t.commandForm.description=i),maxlength:"255","aria-describedby":"command-text",required:""},`
                    `,512),[[_,t.commandForm.description]])]),$6,t.commandForm.players.length>0?(l(),n("div",k6,[F6,e("ol",C6,[(l(!0),n(v,null,$(t.commandForm.players,i=>(l(),n("li",w6,[e("div",S6,[e("div",j6,"#"+u(i.id),1),m(" "+u(i.fio_from_telegram||i.telegram_chat_id),1)]),e("div",q6,[z6,e("ul",V6,[e("li",null,[e("a",{class:"dropdown-item",onClick:d=>t.removePlayerFromCommand(i.id),href:"javascript:void(0)"},"Удалить",8,P6)])])])]))),256))])])):r("",!0)]),e("div",O6,[e("div",U6,[e("button",A6,[t.commandForm.id==null?(l(),n("span",Q6,"Сохранить команду")):(l(),n("span",I6,"Обновить команду"))])])])],32),e("div",T6,[e("div",B6,[e("div",R6,[M6,e("div",D6,[g(D,{simple:!0,onSelect:t.selectBotUser},null,8,["onSelect"])]),E6])])])],64)}}}),N6={class:"row"},J6={class:"col-12"},Y6={key:0,class:"table"},G6=e("th",{scope:"col"},"Число участников",-1),H6=e("th",{scope:"col"},"Действие",-1),W6={scope:"row"},X6=["onClick"],Z6={key:0,class:"dropdown"},x6=e("button",{class:"btn btn-outline-secondary",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-solid fa-ellipsis"})],-1),e7={class:"dropdown-menu"},t7={key:0},s7=["onClick"],o7={key:1},l7={class:"col-12"},n7={props:["bot","quizId"],data(){return{direction:"desc",order:"updated_at",show:!0,is_group:!1,loading:!0,commands:[],search:null,paginate_object:null}},computed:{...w(["getQuizCommands","getQuizCommandsPaginateObject"])},mounted(){this.loadQuizCommands()},methods:{nextQuizCommand(o){this.loadQuizCommands(o)},selectQuizCommand(o){this.$emit("select",o),this.$notify("Вопрос успешно выбран")},removeQuizCommand(o){this.loading=!0,this.$store.dispatch("removeQuizCommand",{quizCommandId:o}).then(t=>{this.loading=!1,this.loadQuizCommands(0),this.$notify("Вопрос успешно удален")}).catch(()=>{this.loading=!1,this.$notify("Вопрос удаления сервиса")})},loadAndOrder(o){this.order=o,this.direction=this.direction==="desc"?"asc":"desc",this.loadQuizCommands(0)},loadQuizCommands(o=0){this.loading=!0,this.$store.dispatch("loadQuizCommands",{dataObject:{quiz_id:this.quizId,bot_id:this.bot.id||null,search:this.search,order:this.order,direction:this.direction},page:o,size:100}).then(t=>{this.loading=!1,this.commands=this.getQuizCommands,this.paginate_object=this.getQuizCommandsPaginateObject}).catch(()=>{this.loading=!1})}}},i7=Object.assign(n7,{__name:"QuizCommandTable",setup(o){return(t,s)=>(l(),n("div",N6,[e("div",J6,[t.commands.length>0?(l(),n("table",Y6,[e("thead",null,[e("tr",null,[e("th",{scope:"col",class:"cursor-pointer",onClick:s[0]||(s[0]=a=>t.loadAndOrder("id"))},"#"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[1]||(s[1]=a=>t.loadAndOrder("title"))},"Название"),G6,e("th",{scope:"col",class:"cursor-pointer",onClick:s[2]||(s[2]=a=>t.loadAndOrder("description"))},"Описание"),H6])]),e("tbody",null,[(l(!0),n(v,null,$(t.commands,(a,i)=>(l(),n("tr",{class:f({"border-info":a.deleted_at==null,"border-danger":a.deleted_at!=null})},[e("th",W6,u(a.id),1),e("td",{onClick:d=>t.selectQuizCommand(a)},u(a.title||"Не указано"),9,X6),e("td",null,u((a.players||[]).length),1),e("td",null,u(a.description||"Не указано"),1),e("td",null,[a.id?(l(),n("div",Z6,[x6,e("ul",e7,[a.deleted_at==null?(l(),n("li",t7,[e("a",{class:"dropdown-item",onClick:d=>t.removeQuizCommand(a.id),href:"javascript:void(0)"},"Удалить",8,s7)])):r("",!0)])])):r("",!0)])],2))),256))])])):(l(),n("p",o7,"На текущий момент нет ни одной созданной команды"))]),e("div",l7,[t.paginate_object?(l(),y(j,{key:0,onPagination_page:t.nextQuizCommand,pagination:t.paginate_object},null,8,["onPagination_page","pagination"])):r("",!0)])]))}}),a7={class:"row"},d7={class:"col-12"},r7={key:0,class:"table"},c7=e("th",{scope:"col"},"Название квиза",-1),u7=e("th",{scope:"col"},"Название команды",-1),m7=e("th",{scope:"col"},"Число участников",-1),h7=e("th",{scope:"col"},"Результат",-1),_7=e("th",{scope:"col"},"Действие",-1),p7={scope:"row"},b7=["onClick"],f7={key:0},g7=e("td",null,"-",-1),v7={key:0,class:"dropdown"},y7=e("button",{class:"btn btn-outline-secondary",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-solid fa-ellipsis"})],-1),$7={class:"dropdown-menu"},k7={key:0},F7=["onClick"],C7={key:1},w7={class:"col-12"},S7={props:["bot","quizId"],data(){return{direction:"desc",order:"updated_at",show:!0,is_group:!1,loading:!0,results:[],search:null,paginate_object:null}},computed:{...w(["getQuizResults","getQuizResultsPaginateObject"])},mounted(){this.loadQuizResults()},methods:{nextQuizResult(o){this.loadQuizResults(o)},selectQuizResult(o){this.$emit("select",o),this.$notify("Вопрос успешно выбран")},removeQuizResult(o){this.loading=!0,this.$store.dispatch("removeQuizResult",{quizResultId:o}).then(t=>{this.loading=!1,this.loadQuizResults(0),this.$notify("Вопрос успешно удален")}).catch(()=>{this.loading=!1,this.$notify("Вопрос удаления сервиса")})},loadAndOrder(o){this.order=o,this.direction=this.direction==="desc"?"asc":"desc",this.loadQuizResults(0)},loadQuizResults(o=0){this.loading=!0,this.$store.dispatch("loadQuizResults",{dataObject:{quiz_id:this.quizId,bot_id:this.bot.id||null,search:this.search,order:this.order,direction:this.direction},page:o,size:100}).then(t=>{this.loading=!1,this.results=this.getQuizResults,this.paginate_object=this.getQuizResultsPaginateObject}).catch(()=>{this.loading=!1})}}},j7=Object.assign(S7,{__name:"QuizResultTable",setup(o){return(t,s)=>(l(),n("div",a7,[e("div",d7,[t.results.length>0?(l(),n("table",r7,[e("thead",null,[e("tr",null,[e("th",{scope:"col",class:"cursor-pointer",onClick:s[0]||(s[0]=a=>t.loadAndOrder("id"))},"#"),c7,u7,m7,e("th",{scope:"col",class:"cursor-pointer",onClick:s[1]||(s[1]=a=>t.loadAndOrder("points"))},"Баллы"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[2]||(s[2]=a=>t.loadAndOrder("times"))},"Время"),h7,_7])]),e("tbody",null,[(l(!0),n(v,null,$(t.results,(a,i)=>(l(),n("tr",{class:f({"border-info":a.deleted_at==null,"border-danger":a.deleted_at!=null})},[e("th",p7,u(a.id),1),e("td",{onClick:d=>t.selectQuizResult(a)},u(a.quiz.title||"Не указано"),9,b7),e("td",null,[a.command?(l(),n("span",f7,u(a.command.title||"Не указано"),1)):r("",!0)]),e("td",null,u((a.command.players||[]).length),1),e("td",null,u(a.points||"Не указано"),1),e("td",null,u(a.times||"Не указано"),1),g7,e("td",null,[a.id?(l(),n("div",v7,[y7,e("ul",$7,[a.deleted_at==null?(l(),n("li",k7,[e("a",{class:"dropdown-item",onClick:d=>t.removeQuizResult(a.id),href:"javascript:void(0)"},"Удалить",8,F7)])):r("",!0)])])):r("",!0)])],2))),256))])])):(l(),n("p",C7,"На текущий момент нет ни одного созданного вопроса"))]),e("div",w7,[t.paginate_object?(l(),y(j,{key:0,onPagination_page:t.nextQuizResult,pagination:t.paginate_object},null,8,["onPagination_page","pagination"])):r("",!0)])]))}}),q7={key:0,class:"py-2"},z7={class:"row"},V7={class:"col-12"},P7={key:1,class:"py-2"},O7={class:"row"},U7={class:"col-12"},A7={key:2,class:"py-2"},Q7={class:"row"},I7={class:"col-12"},T7={class:"nav nav-tabs justify-content-center"},B7={key:0,class:"row py-3"},R7={class:"col-12"},M7={key:1,class:"row py-3"},D7={class:"col-12"},E7={class:"col-12 py-3"},L7=e("h4",null,"Доступные вопросы",-1),K7={key:2,class:"row"},N7={class:"col-12"},J7={class:"col-12 py-3"},Y7=e("h4",null,"Команды участники квиза",-1),G7={key:3,class:"row"},H7={class:"col-12 py-3"},W7=e("h4",null,"Статистика",-1),X7={key:4,class:"row"},Z7=e("div",{class:"col-12"},null,-1),x7=e("div",{class:"col-12 py-3"},[e("h4",null,"Отзывы к событию")],-1),e9=[Z7,x7],t9={props:["bot"],data(){return{part:0,tab:0,loadTable:!1,loadQuizCommand:!1,loadQuizQuestion:!1,loadQuizQuestionTable:!1,loadQuizCommandTable:!1,loadQuizResult:!1,loadForm:!1,selectedQuiz:null,selectedQuizQuestion:null,selectedQuizCommand:null,selectedQuizResult:null}},mounted(){},methods:{callbackCommandForm(){this.loadQuizCommandTable=!0,this.$nextTick(()=>{this.loadQuizCommandTable=!1})},callbackQuestionForm(){this.loadQuizQuestionTable=!0,this.$nextTick(()=>{this.loadQuizQuestionTable=!1})},callbackForm(){this.loadTable=!0,this.part=0,this.$nextTick(()=>{this.loadTable=!1})},createQuiz(){this.part=2},selectQuizResult(o){this.loadQuizResult=!0,this.$nextTick(()=>{this.loadQuizResult=!1,this.selectedQuizResult=o})},selectQuizCommand(o){this.loadQuizCommand=!0,this.$nextTick(()=>{this.loadQuizCommand=!1,this.selectedQuizCommand=o})},selectQuizQuestion(o){this.loadQuizQuestion=!0,this.$nextTick(()=>{this.loadQuizQuestion=!1,this.selectedQuizQuestion=o})},selectQuiz(o){this.loadForm=!0,this.$nextTick(()=>{this.loadForm=!1,this.selectedQuiz=o,this.part=1,this.tab=0})}}},s9=Object.assign(t9,{__name:"Quizzes",setup(o){return(t,s)=>(l(),n(v,null,[t.part===0?(l(),n("div",q7,[e("div",z7,[e("div",V7,[e("button",{type:"button",onClick:s[0]||(s[0]=(...a)=>t.createQuiz&&t.createQuiz(...a)),class:"btn btn-primary"}," Создать новый квиз ")])]),t.loadTable?r("",!0):(l(),y(Ow,{key:0,onCreate:t.createQuiz,onSelect:t.selectQuiz,bot:o.bot},null,8,["onCreate","onSelect","bot"]))])):r("",!0),t.part===2?(l(),n("div",P7,[e("div",O7,[e("div",U7,[e("button",{type:"button",onClick:s[1]||(s[1]=a=>t.part=0),class:"btn btn-outline-primary"}," Назад ")])]),t.loadForm?r("",!0):(l(),y(Z,{key:0,onCallback:t.callbackForm,bot:o.bot},null,8,["onCallback","bot"]))])):r("",!0),t.part===1?(l(),n("div",A7,[e("div",Q7,[e("div",I7,[e("button",{type:"button",onClick:s[2]||(s[2]=a=>t.part=0),class:"btn btn-outline-primary"}," Назад ")])]),e("ul",T7,[e("li",{class:"nav-item",onClick:s[3]||(s[3]=a=>t.tab=0)},[e("a",{class:f(["nav-link",{active:t.tab===0}]),"aria-current":"page",href:"javascript:void(0)"},"Информация о квизе",2)]),e("li",{class:"nav-item",onClick:s[4]||(s[4]=a=>t.tab=1)},[e("a",{class:f(["nav-link",{active:t.tab===1}]),href:"javascript:void(0)"},"Вопросы квиза",2)]),e("li",{class:"nav-item",onClick:s[5]||(s[5]=a=>t.tab=2)},[e("a",{class:f(["nav-link",{active:t.tab===2}]),href:"javascript:void(0)"},"Команды на квизе",2)]),e("li",{class:"nav-item",onClick:s[6]||(s[6]=a=>t.tab=3)},[e("a",{class:f(["nav-link",{active:t.tab===3}]),href:"javascript:void(0)"},"Командная статистика",2)])]),t.tab===0?(l(),n("div",B7,[e("div",R7,[t.loadForm?r("",!0):(l(),y(Z,{key:0,onCallback:t.callbackForm,quiz:t.selectedQuiz,bot:o.bot},null,8,["onCallback","quiz","bot"]))])])):r("",!0),t.tab===1?(l(),n("div",M7,[e("div",D7,[t.loadQuizQuestion?r("",!0):(l(),y(M8,{key:0,question:t.selectedQuizQuestion,"quiz-id":t.selectedQuiz.id,onCallback:t.callbackQuestionForm,bot:o.bot},null,8,["question","quiz-id","onCallback","bot"]))]),e("div",E7,[L7,t.loadQuizQuestionTable?r("",!0):(l(),y(i6,{key:0,"quiz-id":t.selectedQuiz.id,onSelect:t.selectQuizQuestion,bot:o.bot},null,8,["quiz-id","onSelect","bot"]))])])):r("",!0),t.tab===2?(l(),n("div",K7,[e("div",N7,[t.loadQuizCommand?r("",!0):(l(),y(K6,{key:0,command:t.selectedQuizCommand,"quiz-id":t.selectedQuiz.id,onCallback:t.callbackCommandForm,bot:o.bot},null,8,["command","quiz-id","onCallback","bot"]))]),e("div",J7,[Y7,t.loadQuizCommandTable?r("",!0):(l(),y(i7,{key:0,"quiz-id":t.selectedQuiz.id,onSelect:t.selectQuizCommand,bot:o.bot},null,8,["quiz-id","onSelect","bot"]))])])):r("",!0),t.tab===3?(l(),n("div",G7,[e("div",H7,[W7,g(j7,{"quiz-id":t.selectedQuiz.id,onSelect:t.selectQuizResult,bot:o.bot},null,8,["quiz-id","onSelect","bot"])])])):r("",!0),t.tab===4?(l(),n("div",X7,e9)):r("",!0)])):r("",!0)],64))}}),o9={class:"row"},l9={class:"col-12 mb-3 d-flex align-items-center"},n9={class:"dropdown mr-2"},i9={class:"btn btn-info dropdown-toggle",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},a9={key:0},d9={key:1},r9={class:"dropdown-menu"},c9=["onClick"],u9={class:"dropdown-item",href:"#"},m9=e("p",{class:"mb-0"}," - тип пункта меню",-1),h9={class:"col-12 col-md-12 mb-3"},_9={class:"form-label",id:"service-title"},p9=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),b9=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),f9={class:"col-12 mb-3"},g9={class:"form-label",id:"service-description"},v9=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),y9=e("div",null," Краткая информация о команде ",-1),$9=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),k9={key:0,class:"text-gray-400 ml-3",style:{"font-size":"10px"}},F9={class:"col-12 mb-3"},C9={class:"form-label",id:"service-input_message_content"},w9=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),S9=e("div",null," Текст, который будет в сообщении после выбора данного пункта меню ",-1),j9=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),q9={key:0,class:"text-gray-400 ml-3",style:{"font-size":"10px"}},z9={class:"col-12 mb-3"},V9={class:"form-check"},P9=e("label",{class:"form-check-label",for:"need_keyboard"}," Нужна клавиатура к тексту ",-1),O9={key:0,class:"col-12 mb-3"},U9={class:"card"},A9={class:"card-body"},Q9={class:"form-check"},I9=e("label",{class:"form-check-label",for:"need_show_inline_template_selector"}," Выбрать клавиатуру из шаблона ",-1),T9={class:"col-12 mb-3"},B9={class:"form-check"},R9=e("label",{class:"form-check-label",for:"need_custom_settings"}," Нужны дополнительные настройки ",-1),M9={class:"col-12"},D9={key:0,class:"card mb-2"},E9={class:"card-header d-flex justify-content-between align-items-center"},L9=e("h6",null,"Дополнительная конфигурация",-1),K9={class:"card-body"},N9={class:"row mb-2"},J9={class:"col-5"},Y9={class:"form-label",id:"service-title"},G9=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),H9=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),W9=["onUpdate:modelValue"],X9={class:"col-5"},Z9={class:"form-label",id:"service-title"},x9=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),eS=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),tS=["onUpdate:modelValue"],sS={class:"col-2 d-flex flex-column justify-content-end align-items-center"},oS=["onClick"],lS={key:1,class:"row mb-2"},nS=e("div",{class:"col-12"},[e("div",{class:"alert alert-info",role:"alert"}," Вы еще не добавили ни одной дополнительной настройки ")],-1),iS=[nS],aS=e("div",{class:"row"},[e("div",{class:"col-12"},[e("button",{type:"submit",class:"btn btn-outline-primary w-100"},"Сохранить пункт меню ")])],-1),dS={props:["item"],data(){return{need_custom_settings:!1,need_keyboard:!1,need_show_inline_template_selector:!1,types:[{title:"Текст",value:0},{title:"Фото",value:1}],itemForm:{id:null,type:0,title:null,description:null,input_message_content:null,inline_keyboard_id:null,inline_keyboard:{menu:null},custom_settings:[]}}},computed:{preparedTypeTile(){return this.types.filter(o=>o.value==this.itemForm.type)[0]||null},uuid(){return ke()}},watch:{itemForm:{handler(o){this.need_reset=!0},deep:!0}},mounted(){this.item&&this.$nextTick(()=>{console.log("menu",this.item.inline_keyboard),this.itemForm={id:this.item.id||uuid,type:this.item.type||0,title:this.item.title||null,description:this.item.description||null,input_message_content:this.item.input_message_content||null,need_keyboard:this.item.title||!1,inline_keyboard_id:this.item.inline_keyboard_id||null,inline_keyboard:this.item.inline_keyboard?this.item.inline_keyboard:{menu:null},custom_settings:this.item.custom_settings||[]},this.itemForm.inline_keyboard&&(this.need_keyboard=!0),this.itemForm.custom_settings&&(this.need_custom_settings=!0)})},methods:{submitForm(){this.$emit("callback",this.itemForm),this.itemForm={id:null,type:0,title:null,description:null,input_message_content:null,inline_keyboard_id:null,inline_keyboard:{menu:null},custom_settings:[]},this.need_keyboard=!1,this.need_custom_settings=!1,this.need_show_inline_template_selector=!1},addCustomSettings(){this.itemForm.custom_settings.push({key:null,value:null})},removeCustomSetting(o){this.itemForm.custom_settings.splice(o,1)},selectInlineKeyboard(o){console.log("selectInlineKeyboard",o),this.itemForm.inline_keyboard={id:null,menu:o,slug:null},this.need_show_inline_template_selector=!1}}},rS=Object.assign(dS,{__name:"InlineQueryItemForm",setup(o){return(t,s)=>{const a=q("Popper");return l(),n("form",{onSubmit:s[7]||(s[7]=S((...i)=>t.submitForm&&t.submitForm(...i),["prevent"])),class:"mb-2"},[e("div",o9,[e("div",l9,[e("div",n9,[e("button",i9,[t.itemForm.type?(l(),n("span",a9,u(t.preparedTypeTile.title),1)):(l(),n("span",d9,"Тип поля"))]),e("ul",r9,[(l(!0),n(v,null,$(t.types,i=>(l(),n("li",{onClick:d=>t.itemForm.type=i.value},[e("a",u9,u(i.title||"Не указан"),1)],8,c9))),256))])]),m9]),e("div",h9,[e("label",_9,[g(a,{content:"Заголовок"},{default:b(()=>[p9]),_:1}),m(" Заголовок "),b9]),c(e("input",{type:"text",class:"form-control",placeholder:"Заголовок","aria-label":"Заголовок","onUpdate:modelValue":s[0]||(s[0]=i=>t.itemForm.title=i),"aria-describedby":"title",required:""},null,512),[[_,t.itemForm.title]])]),e("div",f9,[e("label",g9,[g(a,null,{content:b(()=>[y9]),default:b(()=>[v9]),_:1}),m(" Описание команду "),$9,t.itemForm.description?(l(),n("small",k9," Длина текста "+u(t.itemForm.description.length)+" / 255",1)):r("",!0)]),c(e("textarea",{type:"text",class:"form-control",placeholder:"Описание команды","aria-label":"Описание команды",maxlength:"255","onUpdate:modelValue":s[1]||(s[1]=i=>t.itemForm.description=i),"aria-describedby":"service-description",required:""},`
                    `,512),[[_,t.itemForm.description]])]),e("div",F9,[e("label",C9,[g(a,null,{content:b(()=>[S9]),default:b(()=>[w9]),_:1}),m(" Текст после выбора "),j9,t.itemForm.input_message_content?(l(),n("small",q9," Длина текста "+u(t.itemForm.input_message_content.length)+" / 255",1)):r("",!0)]),c(e("textarea",{type:"text",class:"form-control",placeholder:"Текст поста","aria-label":"Текст поста",maxlength:"255","onUpdate:modelValue":s[2]||(s[2]=i=>t.itemForm.input_message_content=i),"aria-describedby":"service-input_message_content",required:""},`
                    `,512),[[_,t.itemForm.input_message_content]])]),e("div",z9,[e("div",V9,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[3]||(s[3]=i=>t.need_keyboard=i),type:"checkbox",id:"need_keyboard"},null,512),[[k,t.need_keyboard]]),P9])]),t.need_keyboard?(l(),n("div",O9,[e("div",U9,[e("div",A9,[e("div",Q9,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[4]||(s[4]=i=>t.need_show_inline_template_selector=i),type:"checkbox",id:"need_show_inline_template_selector"},null,512),[[k,t.need_show_inline_template_selector]]),I9]),t.need_show_inline_template_selector?(l(),y(I,{key:0,class:"mb-2",type:"inline",onSelect:t.selectInlineKeyboard,"select-mode":!0},null,8,["onSelect"])):(l(),y(Q,{key:1,type:"inline",onSave:t.selectInlineKeyboard,"edited-keyboard":t.itemForm.inline_keyboard.menu},null,8,["onSave","edited-keyboard"]))])])])):r("",!0),e("div",T9,[e("div",B9,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[5]||(s[5]=i=>t.need_custom_settings=i),type:"checkbox",id:"need_custom_settings"},null,512),[[k,t.need_custom_settings]]),R9])]),e("div",M9,[t.need_custom_settings?(l(),n("div",D9,[e("div",E9,[L9,e("button",{type:"button",onClick:s[6]||(s[6]=(...i)=>t.addCustomSettings&&t.addCustomSettings(...i)),class:"btn btn-outline-primary"},"Добавить настройку ")]),e("div",K9,[t.itemForm.custom_settings.length>0?(l(!0),n(v,{key:0},$(t.itemForm.custom_settings,(i,d)=>(l(),n("div",N9,[e("div",J9,[e("label",Y9,[g(a,{content:"Ключ"},{default:b(()=>[G9]),_:1}),m(" Ключ "),H9]),c(e("input",{type:"text",class:"form-control",placeholder:"Ключ","aria-label":"Ключ",min:"0","onUpdate:modelValue":h=>t.itemForm.custom_settings[d].key=h,"aria-describedby":"price",required:""},null,8,W9),[[_,t.itemForm.custom_settings[d].key]])]),e("div",X9,[e("label",Z9,[g(a,{content:"Значение"},{default:b(()=>[x9]),_:1}),m(" Значение "),eS]),c(e("input",{type:"text",class:"form-control",placeholder:"Значение","aria-label":"Значение",min:"0","onUpdate:modelValue":h=>t.itemForm.custom_settings[d].value=h,"aria-describedby":"price",required:""},null,8,tS),[[_,t.itemForm.custom_settings[d].value]])]),e("div",sS,[e("button",{onClick:h=>t.removeCustomSetting(d),class:"btn btn-outline-danger"},"Удалить ",8,oS)])]))),256)):(l(),n("div",lS,iS))])])):r("",!0)])]),aS],32)}}}),cS={class:"row"},uS={class:"col-12 mb-3"},mS={class:"form-label",id:"service-title"},hS=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),_S=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),pS={class:"col-12 mb-3"},bS={class:"form-label",id:"service-description"},fS=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),gS=e("div",null," Краткая информация о команде ",-1),vS=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),yS={key:0,class:"text-gray-400 ml-3",style:{"font-size":"10px"}},$S={class:"col-12 mb-2"},kS={key:0},FS={class:"table-responsive"},CS={class:"table"},wS=e("thead",null,[e("tr",null,[e("th",{scope:"col"},"Название"),e("th",{scope:"col"},"Описание"),e("th",{scope:"col"},"Текст"),e("th",{scope:"col"},"Есть клавиатура"),e("th",{scope:"col"},"Есть доп настройки"),e("th",{scope:"col"},"Действие")])],-1),SS=["onClick"],jS=["onClick"],qS=["onClick"],zS={key:0,class:"fa-solid fa-check text-success"},VS={key:1,class:"fa-solid fa-xmark text-danger"},PS={key:0,class:"fa-solid fa-check text-success"},OS={key:1,class:"fa-solid fa-xmark text-danger"},US={class:"dropdown"},AS=e("button",{class:"btn btn-link",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-solid fa-bars"})],-1),QS={class:"dropdown-menu"},IS=["onClick"],TS={class:"row"},BS={class:"col-12"},RS={type:"submit",class:"btn btn-outline-success w-100 p-3"},MS={key:0},DS={key:1},ES={class:"modal fade",id:"inline-query-item-editor",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},LS={class:"modal-dialog modal-lg"},KS={class:"modal-content"},NS={class:"modal-body"},JS={props:["bot","inlineQuery"],data(){return{load:!1,selectedInlineQueryItem:null,inlineQueryModal:null,inlineQueryForm:{id:null,command:null,description:null,items:[]}}},watch:{inlineQueryForm:{handler(o){this.need_reset=!0},deep:!0}},mounted(){this.inlineQueryModal=new bootstrap.Modal(document.getElementById("inline-query-item-editor"),{}),this.inlineQuery&&this.$nextTick(()=>{this.inlineQueryForm={id:this.inlineQuery.id||null,command:this.inlineQuery.command||null,description:this.inlineQuery.description||null,items:this.inlineQuery.items||[]}})},methods:{removeInlineQueryItem(o){const t=this.inlineQueryForm.items[o];this.inlineQueryForm.items.splice(o,1),this.$store.dispatch("removeInlineQueryItem",{queryItemId:t.id}).then(s=>{this.$notify("Команда успешно удалена")}).catch(s=>{this.$notify("Ошибка удаления команды")})},openModal(){this.load=!0,this.$nextTick(()=>{this.selectedInlineQueryItem=null,this.load=!1,this.inlineQueryModal.show()})},addInlineQueryItem(o){let t=this.inlineQueryForm.items.findIndex(s=>s.id===o.id);t===-1?this.inlineQueryForm.items.push(o):this.inlineQueryForm.items[t]=o},selectInlineQueryItem(o){this.load=!0,this.$nextTick(()=>{this.selectedInlineQueryItem=o,this.load=!1,this.inlineQueryModal.show()})},submitForm(){let o=new FormData;Object.keys(this.inlineQueryForm).forEach(t=>{const s=this.inlineQueryForm[t]||"";typeof s=="object"?o.append(t,JSON.stringify(s)):o.append(t,s)}),o.append("bot_id",this.bot.id),this.$store.dispatch("storeInlineQuery",{inlineQueryForm:o}).then(t=>{this.inlineQueryForm={id:null,command:null,description:null,items:[]},this.$emit("callback",t.data),this.$notify("Команда успешно создана")}).catch(t=>{this.$notify("Ошибка создания команды"),this.$emit("callback",response.data)})}}},YS=Object.assign(JS,{__name:"InlineQueryForm",setup(o){return(t,s)=>{const a=q("Popper");return l(),n(v,null,[e("form",{onSubmit:s[3]||(s[3]=S((...i)=>t.submitForm&&t.submitForm(...i),["prevent"]))},[e("div",cS,[e("div",uS,[e("label",mS,[g(a,{content:"Название оказываемой услуги"},{default:b(()=>[hS]),_:1}),m(" Название команды "),_S]),c(e("input",{type:"text",class:"form-control",placeholder:"Команда","aria-label":"Команда","onUpdate:modelValue":s[0]||(s[0]=i=>t.inlineQueryForm.command=i),maxlength:"255","aria-describedby":"service-title",required:""},null,512),[[_,t.inlineQueryForm.command]])]),e("div",pS,[e("label",bS,[g(a,null,{content:b(()=>[gS]),default:b(()=>[fS]),_:1}),m(" Описание команду "),vS,t.inlineQueryForm.description?(l(),n("small",yS," Длина текста "+u(t.inlineQueryForm.description.length)+" / 255",1)):r("",!0)]),c(e("textarea",{type:"text",class:"form-control",placeholder:"Описание команды","aria-label":"Описание команды",maxlength:"255","onUpdate:modelValue":s[1]||(s[1]=i=>t.inlineQueryForm.description=i),"aria-describedby":"service-description",required:""},`
                    `,512),[[_,t.inlineQueryForm.description]])]),e("div",$S,[e("button",{type:"button",class:"btn btn-outline-primary",onClick:s[2]||(s[2]=(...i)=>t.openModal&&t.openModal(...i))}," Добавление пункта меню ")]),t.inlineQueryForm.items.length>0?(l(),n("div",kS,[e("div",FS,[e("table",CS,[wS,e("tbody",null,[(l(!0),n(v,null,$(t.inlineQueryForm.items,(i,d)=>(l(),n("tr",null,[e("td",{onClick:h=>t.selectInlineQueryItem(i)},u(i.title||"-"),9,SS),e("td",{onClick:h=>t.selectInlineQueryItem(i)},u(i.description||"-"),9,jS),e("td",{onClick:h=>t.selectInlineQueryItem(i)},u(i.input_message_content||"-"),9,qS),e("td",null,[i.inline_keyboard?(l(),n("i",zS)):(l(),n("i",VS))]),e("td",null,[(i.custom_settings||[]).length>0?(l(),n("i",PS)):(l(),n("i",OS))]),e("td",null,[e("div",US,[AS,e("ul",QS,[e("li",null,[e("a",{class:"dropdown-item",onClick:h=>t.removeInlineQueryItem(d),href:"#"},"Удалить",8,IS)])])])])]))),256))])])])])):r("",!0)]),e("div",TS,[e("div",BS,[e("button",RS,[t.inlineQueryForm.id===null?(l(),n("span",MS,"Создать встроенное меню")):(l(),n("span",DS,"Обновить встроенное меню"))])])])],32),e("div",ES,[e("div",LS,[e("div",KS,[e("div",NS,[t.load?r("",!0):(l(),y(rS,{key:0,item:t.selectedInlineQueryItem,onCallback:t.addInlineQueryItem},null,8,["item","onCallback"]))])])])])],64)}}}),GS={class:"row"},HS={class:"col-12"},WS={key:0,class:"table"},XS=e("th",{scope:"col",class:"cursor-pointer"},"Кол-во пунктов меню",-1),ZS=e("th",{scope:"col"},"Действие",-1),xS={scope:"row"},ej=["onClick"],tj={key:0,class:"dropdown"},sj=e("button",{class:"btn btn-outline-secondary",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-solid fa-ellipsis"})],-1),oj={class:"dropdown-menu"},lj={key:0},nj=["onClick"],ij={key:1},aj={class:"col-12"},dj={props:["bot"],data(){return{direction:"desc",order:"updated_at",show:!0,loading:!0,queries:[],search:null,paginate_object:null}},computed:{...w(["getInlineQueries","getInlineQueriesPaginateObject"])},mounted(){this.loadInlineQueries()},methods:{nextInlineQuery(o){this.loadInlineQueries(o)},selectInlineQuery(o){this.$emit("select",o),this.$notify("Встроенное меню успешно выбрано")},removeInlineQuery(o){this.loading=!0,this.$store.dispatch("removeInlineQuery",{queryId:o}).then(t=>{this.loading=!1,this.loadInlineQueries(0),this.$notify("Встроенное меню успешно удалено")}).catch(()=>{this.loading=!1,this.$notify("Ошибка удаления встроенного меню")})},loadAndOrder(o){this.order=o,this.direction=this.direction==="desc"?"asc":"desc",this.loadInlineQueries(0)},loadInlineQueries(o=0){this.loading=!0,this.$store.dispatch("loadInlineQueries",{dataObject:{bot_id:this.bot.id||null,search:this.search,order:this.order,direction:this.direction},page:o,size:100}).then(t=>{this.loading=!1,this.queries=this.getInlineQueries,this.paginate_object=this.getInlineQueriesPaginateObject}).catch(()=>{this.loading=!1})}}},rj=Object.assign(dj,{__name:"InlineQueryTable",setup(o){return(t,s)=>(l(),n("div",GS,[e("div",HS,[t.queries.length>0?(l(),n("table",WS,[e("thead",null,[e("tr",null,[e("th",{scope:"col",class:"cursor-pointer",onClick:s[0]||(s[0]=a=>t.loadAndOrder("id"))},"#"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[1]||(s[1]=a=>t.loadAndOrder("command"))},"Команда"),XS,e("th",{scope:"col",class:"cursor-pointer",onClick:s[2]||(s[2]=a=>t.loadAndOrder("description"))},"Описание"),ZS])]),e("tbody",null,[(l(!0),n(v,null,$(t.queries,(a,i)=>(l(),n("tr",{class:f({"border-info":a.deleted_at==null,"border-danger":a.deleted_at!=null})},[e("th",xS,u(a.id),1),e("td",{onClick:d=>t.selectInlineQuery(a)},u(a.command||"Не указано"),9,ej),e("td",null,u(a.items.length),1),e("td",null,u(a.description||"Не указано"),1),e("td",null,[a.id?(l(),n("div",tj,[sj,e("ul",oj,[a.deleted_at==null?(l(),n("li",lj,[e("a",{class:"dropdown-item",onClick:d=>t.removeInlineQuery(a.id),href:"javascript:void(0)"},"Удалить",8,nj)])):r("",!0)])])):r("",!0)])],2))),256))])])):(l(),n("p",ij,"На текущий момент нет ни одной созданной команды"))]),e("div",aj,[t.paginate_object?(l(),y(j,{key:0,onPagination_page:t.nextInlineQuery,pagination:t.paginate_object},null,8,["onPagination_page","pagination"])):r("",!0)])]))}}),cj={class:"my-2"},uj={key:0,class:"row mb-2"},mj={class:"col-12"},hj={key:3,class:"spinner-border",role:"status"},_j=e("span",{class:"visually-hidden"},"Loading...",-1),pj=[_j],bj={props:["bot"],data(){return{load:!1,selectedInlineQuery:null}},mounted(){},methods:{selectInlineQuery(o){this.load=!0,this.$nextTick(()=>{this.selectedInlineQuery=o,this.load=!1})},reloadTable(){this.load=!0,this.$nextTick(()=>{this.load=!1})}}},fj=Object.assign(bj,{__name:"InlineQuery",setup(o){return(t,s)=>(l(),n("div",cj,[t.selectedInlineQuery!=null?(l(),n("div",uj,[e("div",mj,[e("button",{type:"button",onClick:s[0]||(s[0]=a=>t.selectInlineQuery(null)),class:"btn btn-primary"}," Добавить новое встроенное меню")])])):r("",!0),t.load?r("",!0):(l(),y(YS,{key:1,bot:o.bot,onCallback:t.reloadTable,"inline-query":t.selectedInlineQuery},null,8,["bot","onCallback","inline-query"])),t.load?r("",!0):(l(),y(rj,{key:2,bot:o.bot,onSelect:t.selectInlineQuery},null,8,["bot","onSelect"])),t.load?(l(),n("div",hj,pj)):r("",!0)]))}}),gj={class:"row"},vj={class:"col-12 mb-3"},yj={class:"form-label",id:"quiz-title"},$j=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),kj=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),Fj={class:"col-12 mb-3"},Cj={class:"form-label",id:"quiz-description"},wj=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),Sj=e("div",null," Краткая информация о назначении промокода ",-1),jj=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),qj={key:0,class:"text-gray-400 ml-3",style:{"font-size":"10px"}},zj={class:"col-12 mb-3"},Vj={class:"form-check"},Pj=e("label",{class:"form-check-label",for:"is_active"}," Доступен для активации ",-1),Oj={class:"col-12 mb-3"},Uj={class:"form-label",id:"promoCodeForm-max_activation_count"},Aj=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),Qj=e("div",null," Максимальное число активация кода ",-1),Ij=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),Tj={class:"col-12 mb-3"},Bj={class:"form-check"},Rj=e("label",{class:"form-check-label",for:"promoCodeForm-cashback_amount"}," Нужно начислить CashBack по промокоду ",-1),Mj={key:0,class:"col-12 mb-3"},Dj={class:"form-label",id:"quiz-time_limit"},Ej=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),Lj=e("div",null," Сколько % нужно ответить чтоб пройти ",-1),Kj=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),Nj={key:1,class:"col-12 mb-3"},Jj={class:"form-check"},Yj=e("label",{class:"form-check-label",for:"promoCodeForm-need_slots"}," Нужны слоты для активации ",-1),Gj={key:2,class:"col-12 mb-3"},Hj={class:"form-label",id:"promoCodeForm-slot_amount"},Wj=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),Xj=e("div",null," Укажите количество слотов, которые получит пользователь при активации (внимание, доступно только для администраторов) ",-1),Zj=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),xj={key:0,class:"col-12 mb-3"},eq={class:"form-check"},tq=e("label",{class:"form-check-label",for:"promoCodeForm-need_attach_scripts"}," Нужно добавить скрипты ",-1),sq={key:1,class:"col-12 mb-3"},oq=["onClick"],lq={class:"row"},nq={class:"col-12"},iq={type:"submit",class:"btn btn-outline-success w-100 p-3"},aq={key:0},dq={key:1},rq={props:["code","bot"],data(){return{step:0,load:!1,need_reset:!1,need_cashback:!1,need_slots:!1,need_attach_scripts:!1,promoCodeForm:{id:null,code:null,description:null,slot_amount:0,cashback_amount:0,max_activation_count:1,is_active:!1,scripts:[]}}},computed:{getSelf(){return window.profile}},watch:{promoCodeForm:{handler(o){this.need_reset=!0},deep:!0}},mounted(){this.code&&this.$nextTick(()=>{this.promoCodeForm={id:this.code.id||null,description:this.code.description||null,code:this.code.code||null,slot_amount:this.code.slot_amount||0,cashback_amount:this.code.cashback_amount||0,max_activation_count:this.code.max_activation_count||1,is_active:this.code.is_active||!1,scripts:this.code.scripts||[]},this.promoCodeForm.slot_amount>0&&(this.need_slots=!0),this.promoCodeForm.cashback_amount>0&&(this.need_slots=!0),this.promoCodeForm.scripts.length>0&&(this.need_attach_scripts=!0)})},methods:{removeSlug(o){this.promoCodeForm.scripts.splice(o,1)},selectSlugsCallback(o){this.promoCodeForm.scripts.findIndex(s=>s.id===o.id)===-1&&this.promoCodeForm.scripts.push(o)},submitForm(){let o=new FormData;Object.keys(this.promoCodeForm).forEach(t=>{const s=this.promoCodeForm[t]||"";typeof s=="object"?o.append(t,JSON.stringify(s)):o.append(t,s)}),o.append("bot_id",this.bot.id),this.$store.dispatch("storePromoCodes",{promoCodeForm:o}).then(t=>{this.promoCodeForm={id:null,code:null,description:null,slot_amount:0,cashback_amount:0,max_activation_count:1,scripts:[],is_active:!1},this.$emit("callback",t.data),this.$notify("Промокод успешно создан")}).catch(t=>{this.$notify("Ошибка создания промокода")})}}},x=Object.assign(rq,{__name:"PromoCodesForm",setup(o){return(t,s)=>{const a=q("Popper");return l(),n("form",{onSubmit:s[9]||(s[9]=S((...i)=>t.submitForm&&t.submitForm(...i),["prevent"])),class:"py-3"},[e("div",gj,[e("div",vj,[e("label",yj,[g(a,{content:"Название вашего квиза"},{default:b(()=>[$j]),_:1}),m(" Промокод (вписать или сгенерировать) "),kj]),c(e("input",{type:"text",class:"form-control",placeholder:"Название","aria-label":"Название","onUpdate:modelValue":s[0]||(s[0]=i=>t.promoCodeForm.code=i),maxlength:"255","aria-describedby":"quiz-title",required:""},null,512),[[_,t.promoCodeForm.code]])]),e("div",Fj,[e("label",Cj,[g(a,null,{content:b(()=>[Sj]),default:b(()=>[wj]),_:1}),m(" Назначение промокода "),jj,t.promoCodeForm.description?(l(),n("small",qj," Длина текста "+u(t.promoCodeForm.description.length)+"/255",1)):r("",!0)]),c(e("textarea",{class:"form-control",placeholder:"Описание промокода","aria-label":"Описание промокода",maxlength:"255","onUpdate:modelValue":s[1]||(s[1]=i=>t.promoCodeForm.description=i),"aria-describedby":"quiz-description",required:""},`
                    `,512),[[_,t.promoCodeForm.description]])]),e("div",zj,[e("div",Vj,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[2]||(s[2]=i=>t.promoCodeForm.is_active=i),type:"checkbox",id:"is_active"},null,512),[[k,t.promoCodeForm.is_active]]),Pj])]),e("div",Oj,[e("label",Uj,[g(a,null,{content:b(()=>[Qj]),default:b(()=>[Aj]),_:1}),m(" Количество активация кода "),Ij]),c(e("input",{type:"number",class:"form-control",placeholder:"Число попыток","aria-label":"Число попыток",step:"1",min:"1","onUpdate:modelValue":s[3]||(s[3]=i=>t.promoCodeForm.max_activation_count=i),"aria-describedby":"promoCodeForm-max_activation_count",required:""},null,512),[[_,t.promoCodeForm.max_activation_count]])]),e("div",Tj,[e("div",Bj,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[4]||(s[4]=i=>t.need_cashback=i),type:"checkbox",id:"promoCodeForm-cashback_amount"},null,512),[[k,t.need_cashback]]),Rj])]),t.need_cashback?(l(),n("div",Mj,[e("label",Dj,[g(a,null,{content:b(()=>[Lj]),default:b(()=>[Ej]),_:1}),m(" Сколько CashBack начислить по промокоду? "),Kj]),c(e("input",{type:"number",class:"form-control",placeholder:"Процент для победы","aria-label":"Процент для победы",step:"1",min:"0","onUpdate:modelValue":s[5]||(s[5]=i=>t.promoCodeForm.cashback_amount=i),"aria-describedby":"promoCodeForm-cashback_amount",required:""},null,512),[[_,t.promoCodeForm.cashback_amount]])])):r("",!0),t.getSelf.is_admin?(l(),n("div",Nj,[e("div",Jj,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[6]||(s[6]=i=>t.need_slots=i),type:"checkbox",id:"promoCodeForm-need_slots"},null,512),[[k,t.need_slots]]),Yj])])):r("",!0),t.need_slots?(l(),n("div",Gj,[e("label",Hj,[g(a,null,{content:b(()=>[Xj]),default:b(()=>[Wj]),_:1}),m(" Сколько нужно добавить слотов? "),Zj]),c(e("input",{type:"number",class:"form-control",placeholder:"Количество слотов","aria-label":"Количество слотов",step:"1",min:"0","onUpdate:modelValue":s[7]||(s[7]=i=>t.promoCodeForm.slot_amount=i),"aria-describedby":"promoCodeForm-slot_amount",required:""},null,512),[[_,t.promoCodeForm.slot_amount]])])):r("",!0)]),t.getSelf.is_admin?(l(),n("div",xj,[e("div",eq,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[8]||(s[8]=i=>t.need_attach_scripts=i),type:"checkbox",id:"promoCodeForm-need_attach_scripts"},null,512),[[k,t.need_attach_scripts]]),tq])])):r("",!0),t.need_attach_scripts?(l(),n("div",sq,[e("p",null,[(l(!0),n(v,null,$(t.promoCodeForm.scripts,(i,d)=>(l(),n("span",{class:"badge bg-primary mr-2 mb-2 cursor-pointer",onClick:h=>t.removeSlug(d)},u(i.command||"-"),9,oq))),256))]),o.bot?(l(),y(Y,{key:0,"can-add":!0,bot:o.bot,"hide-add-modal":!0,onSelect:t.selectSlugsCallback},null,8,["bot","onSelect"])):r("",!0)])):r("",!0),e("div",lq,[e("div",nq,[e("button",iq,[t.promoCodeForm.id==null?(l(),n("span",aq,"Создать промокод")):(l(),n("span",dq,"Обновить промокод"))])])])],32)}}}),cq={class:"row py-2"},uq={class:"col-12"},mq={class:"input-group mb-3"},hq={class:"col-12"},_q={key:0,class:"table"},pq=e("th",{scope:"col",class:"cursor-pointer"},"Число активаций",-1),bq=e("th",{scope:"col"},"Действие",-1),fq={scope:"row"},gq=["onClick"],vq={key:0},yq={key:0,class:"fa-solid fa-chevron-down text-success"},$q={key:1,class:"fa-solid fa-xmark text-danger"},kq={key:0,class:"dropdown"},Fq=e("button",{class:"btn btn-outline-secondary",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-solid fa-ellipsis"})],-1),Cq={class:"dropdown-menu"},wq={key:0},Sq=["onClick"],jq={key:1},qq=e("div",{class:"alert alert-warning alert-dismissible fade show",role:"alert"},[e("strong",null,"Внимание!"),m(" Вы еще не добавили ни одного промокода! "),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"alert","aria-label":"Close"})],-1),zq={class:"position-relative p-5 text-center text-muted bg-body border border-dashed rounded-2"},Vq={class:"d-flex justify-content-center mb-3"},Pq={alt:"",width:"100",height:"100"},Oq=e("h1",{class:"text-body-emphasis"},"Создание промокода",-1),Uq=e("p",{class:"col-lg-8 mx-auto fs-5 text-muted"}," Промокод - это инструмент мотивации пользователей пользоваться вашим сервисом. Он позволяет клиентам получать некоторые бонусы за активацию кода, а вы в свою очередь будете видеть статистику активация прмокода. ",-1),Aq={class:"d-inline-flex gap-2 mb-5"},Qq=e("a",{href:"#",target:"_blank",class:"d-inline-flex align-items-center btn btn-outline-secondary btn-lg px-4 rounded-pill"}," Подробнее ",-1),Iq={key:0,class:"col-12"},Tq={props:["bot"],data(){return{direction:"desc",order:"updated_at",show:!0,loading:!0,codes:[],search:null,paginate_object:null}},computed:{...w(["getPromoCodes","getPromoCodesPaginateObject"]),getSelf(){return window.profile}},mounted(){this.loadPromoCodes()},methods:{removeQuiz(o){this.loading=!0,this.$store.dispatch("removePromoCodes",{promoCodeId:o}).then(t=>{this.loading=!1,this.loadPromoCodes(0),this.$notify("Промокод успешно удален")}).catch(()=>{this.loading=!1,this.$notify("Ошибка удаления промокода")})},createPromoCode(){this.$emit("create")},nextPromoCodes(o){this.loadPromoCodes(o)},selectEvent(o){this.$emit("select",o)},loadAndOrder(o){this.order=o,this.direction=this.direction==="desc"?"asc":"desc",this.loadPromoCodes(0)},loadPromoCodes(o=0){this.loading=!0,this.$store.dispatch("loadPromoCodes",{dataObject:{bot_id:this.bot.id||null,search:this.search,order:this.order,direction:this.direction},page:o,size:20}).then(t=>{this.loading=!1,this.codes=this.getPromoCodes,this.paginate_object=this.getPromoCodesPaginateObject}).catch(()=>{this.loading=!1})}}},Bq=Object.assign(Tq,{__name:"PromoCodesTable",setup(o){return(t,s)=>{const a=A("lazy");return l(),n("div",cq,[e("div",uq,[e("div",mq,[c(e("input",{type:"search",class:"form-control",placeholder:"Поиск кода","aria-label":"Поиск кода","onUpdate:modelValue":s[0]||(s[0]=i=>t.search=i),"aria-describedby":"promocode-search-and-filter"},null,512),[[_,t.search]]),e("button",{class:"btn btn-outline-secondary",onClick:s[1]||(s[1]=i=>t.loadPromoCodes(0)),type:"button",id:"promocode-search-and-filter"},"Найти ")])]),e("div",hq,[t.codes.length>0?(l(),n("table",_q,[e("thead",null,[e("tr",null,[e("th",{scope:"col",class:"cursor-pointer",onClick:s[2]||(s[2]=i=>t.loadAndOrder("id"))},"#"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[3]||(s[3]=i=>t.loadAndOrder("code"))},"Код"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[4]||(s[4]=i=>t.loadAndOrder("description"))},"Описание"),t.getSelf.is_admin?(l(),n("th",{key:0,scope:"col",class:"cursor-pointer",onClick:s[5]||(s[5]=i=>t.loadAndOrder("slot_amount"))},"Число слотов ")):r("",!0),e("th",{scope:"col",class:"cursor-pointer",onClick:s[6]||(s[6]=i=>t.loadAndOrder("cashback_amount"))},"Величина CashBack-а, руб "),e("th",{scope:"col",class:"cursor-pointer",onClick:s[7]||(s[7]=i=>t.loadAndOrder("max_activation_count"))},"Максимальное число активаций "),pq,e("th",{scope:"col",class:"cursor-pointer",onClick:s[8]||(s[8]=i=>t.loadAndOrder("is_active"))},"Активный"),bq])]),e("tbody",null,[(l(!0),n(v,null,$(t.codes,(i,d)=>(l(),n("tr",{class:f({"border-info":i.deleted_at==null,"border-danger":i.deleted_at!=null})},[e("th",fq,u(i.id),1),e("td",{onClick:h=>t.selectEvent(i)},u(i.code||"Не указано"),9,gq),e("td",null,u(i.description||"Не указано"),1),t.getSelf.is_admin?(l(),n("td",vq,u(i.slot_amount),1)):r("",!0),e("td",null,u(i.cashback_amount),1),e("td",null,u(i.max_activation_count),1),e("td",null,u(i.current_activation_count||0),1),e("td",null,[i.is_active?(l(),n("i",yq)):(l(),n("i",$q))]),e("td",null,[i.id?(l(),n("div",kq,[Fq,e("ul",Cq,[i.deleted_at==null?(l(),n("li",wq,[e("a",{class:"dropdown-item",onClick:h=>t.removeQuiz(i.id),href:"javascript:void(0)"},"Удалить",8,Sq)])):r("",!0)])])):r("",!0)])],2))),256))])])):(l(),n("div",jq,[qq,e("div",zq,[e("div",Vq,[c(e("img",Pq,null,512),[[a,"../images/icon.png"]])]),Oq,Uq,e("div",Aq,[e("button",{onClick:s[9]||(s[9]=(...i)=>t.createPromoCode&&t.createPromoCode(...i)),class:"d-inline-flex align-items-center btn btn-lg px-4 rounded-pill btn-primary",type:"button"}," Добавить "),Qq])])]))]),t.codes.length>0?(l(),n("div",Iq,[t.paginate_object?(l(),y(j,{key:0,onPagination_page:t.nextPromoCodes,pagination:t.paginate_object},null,8,["onPagination_page","pagination"])):r("",!0)])):r("",!0)])}}}),Rq={key:0,class:"py-2"},Mq={class:"row"},Dq={class:"col-12"},Eq={key:1,class:"py-2"},Lq={class:"row"},Kq={class:"col-12"},Nq={key:2,class:"py-2"},Jq={class:"row"},Yq={class:"col-12"},Gq={class:"nav nav-tabs justify-content-center"},Hq={key:0,class:"row py-3"},Wq={class:"col-12"},Xq={key:1,class:"row py-3"},Zq=e("div",{class:"col-12 py-3"},[e("h4",null,"Статистика")],-1),xq=[Zq],ez={props:["bot"],data(){return{part:0,tab:0,selectedPromoCode:null,loadForm:!1,loadTable:!1}},methods:{callbackForm(){this.loadTable=!0,this.selectedPromoCode=null,this.part=0,this.$nextTick(()=>{this.loadTable=!1})},createPromoCode(){this.part=2},selectPromoCode(o){this.loadForm=!0,this.$nextTick(()=>{this.loadForm=!1,this.selectedPromoCode=o,this.part=1,this.tab=0})}}},tz=Object.assign(ez,{__name:"PromoCodes",setup(o){return(t,s)=>(l(),n(v,null,[t.part===0?(l(),n("div",Rq,[e("div",Mq,[e("div",Dq,[e("button",{type:"button",onClick:s[0]||(s[0]=(...a)=>t.createPromoCode&&t.createPromoCode(...a)),class:"btn btn-primary"}," Создать новый промокод ")])]),t.loadTable?r("",!0):(l(),y(Bq,{key:0,onCreate:t.createPromoCode,onSelect:t.selectPromoCode,bot:o.bot},null,8,["onCreate","onSelect","bot"]))])):r("",!0),t.part===2?(l(),n("div",Eq,[e("div",Lq,[e("div",Kq,[e("button",{type:"button",onClick:s[1]||(s[1]=a=>t.part=0),class:"btn btn-outline-primary"}," Назад ")])]),t.loadForm?r("",!0):(l(),y(x,{key:0,onCallback:t.callbackForm,bot:o.bot},null,8,["onCallback","bot"]))])):r("",!0),t.part===1?(l(),n("div",Nq,[e("div",Jq,[e("div",Yq,[e("button",{type:"button",onClick:s[2]||(s[2]=a=>t.part=0),class:"btn btn-outline-primary"}," Назад ")])]),e("ul",Gq,[e("li",{class:"nav-item",onClick:s[3]||(s[3]=a=>t.tab=0)},[e("a",{class:f(["nav-link",{active:t.tab===0}]),"aria-current":"page",href:"javascript:void(0)"},"Информация о Промокоде",2)]),e("li",{class:"nav-item",onClick:s[4]||(s[4]=a=>t.tab=1)},[e("a",{class:f(["nav-link",{active:t.tab===1}]),href:"javascript:void(0)"},"Статистика использования",2)])]),t.tab===0?(l(),n("div",Hq,[e("div",Wq,[t.loadForm?r("",!0):(l(),y(x,{key:0,onCallback:t.callbackForm,code:t.selectedPromoCode,bot:o.bot},null,8,["onCallback","code","bot"]))])])):r("",!0),t.tab===1?(l(),n("div",Xq,xq)):r("",!0)])):r("",!0)],64))}}),sz={props:["data"],data(){return{hasConnect:!1,bot:null,frontPadForm:{hook_url:null,channel:null,affiliate:null,point:null,token:null,statuses:[{value:null,key:"new",title:"Новый"}],bot_id:null,pays:[{value:null,key:"cash",title:"Наличные"},{value:null,key:"card",title:"Перевод на карту"}]}}},computed:{...w(["getCurrentBot"])},mounted(){this.bot=this.getCurrentBot,this.data?this.$nextTick(()=>{this.frontPadForm.hook_url=this.data.hook_url||null,this.frontPadForm.channel=this.data.channel||null,this.frontPadForm.affiliate=this.data.affiliate||null,this.frontPadForm.point=this.data.point||null,this.frontPadForm.token=this.data.token||null,this.frontPadForm.bot_id=this.data.bot_id||this.bot.id||null,this.data.pays!=null&&(this.frontPadForm.pays=this.data.pays),this.data.statuses!=null&&(this.frontPadForm.statuses=this.data.statuses)}):this.frontPadForm.bot_id=this.bot.id||null},methods:{submit(){let o=new FormData;Object.keys(this.frontPadForm).forEach(t=>{const s=this.frontPadForm[t]||"";typeof s=="object"?o.append(t,JSON.stringify(s)):o.append(t,s)}),this.$store.dispatch("saveFrontPad",{frontPadForm:o}).then(t=>{this.$notify("Данные CRM успешно сохранены")}).catch(t=>{})}}},oz={class:"col-md-6 col-12 mb-2"},lz={class:"form-label",id:"token"},nz=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),iz=e("div",null,"Токен интеграции",-1),az=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),dz={class:"col-md-6 col-12 mb-2"},rz={class:"form-label",id:"channel"},cz=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),uz=e("div",null,'Данные брать из справочника FrontPad "Каналы продаж". Создать канал. Telegram. Указать значение для API',-1),mz={class:"col-md-6 col-12 mb-2"},hz={class:"form-label",id:"affiliate"},_z=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),pz=e("div",null,"Филиал",-1),bz={class:"col-md-6 col-12 mb-2"},fz={class:"form-label",id:"point"},gz=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),vz=e("div",null,"Филиал",-1),yz={class:"col-12"},$z=e("div",{class:"alert alert-info",role:"alert"},' Данные брать из справочника FrontPad "Статусы". Указать значение для API ',-1),kz={key:0,class:"card mb-2 p-0"},Fz=e("div",{class:"card-header"},[e("h6",null,"Статусы")],-1),Cz={class:"card-body"},wz={class:"table"},Sz=e("thead",null,[e("tr",null,[e("th",{scope:"col"},"Название"),e("th",{scope:"col"},"Ключ"),e("th",{scope:"col"},"Значение")])],-1),jz=["onUpdate:modelValue"],qz={class:"col-12"},zz=e("div",{class:"alert alert-info",role:"alert"},' Данные брать из справочника FrontPad "Варианты оплат". Указать значение для API ',-1),Vz={key:0,class:"card mb-2 p-0"},Pz=e("div",{class:"card-header"},[e("h6",null,"Типы оплаты")],-1),Oz={class:"card-body"},Uz={class:"table"},Az=e("thead",null,[e("tr",null,[e("th",{scope:"col"},"Название"),e("th",{scope:"col"},"Ключ"),e("th",{scope:"col"},"Значение")])],-1),Qz=["onUpdate:modelValue"],Iz=e("div",{class:"col-md-12 col-12"},[e("button",{type:"submit",class:"btn btn-outline-primary p-3 w-100"},[e("i",{class:"fa-solid fa-cloud-arrow-down mr-1"}),m(" Сохранить настройку ")])],-1);function Tz(o,t,s,a,i,d){const h=q("Popper");return l(),n("form",{onSubmit:t[4]||(t[4]=S((...p)=>d.submit&&d.submit(...p),["prevent"])),class:"row"},[e("div",oz,[e("label",lz,[g(h,null,{content:b(()=>[iz]),default:b(()=>[nz]),_:1}),m(" Токен интеграции "),az]),c(e("input",{type:"text",class:"form-control",placeholder:"Токен","aria-label":"Токен","onUpdate:modelValue":t[0]||(t[0]=p=>i.frontPadForm.token=p),"aria-describedby":"token"},null,512),[[_,i.frontPadForm.token]])]),e("div",dz,[e("label",rz,[g(h,null,{content:b(()=>[uz]),default:b(()=>[cz]),_:1}),m(" Канал продаж ")]),c(e("input",{type:"text",class:"form-control",placeholder:"channel","aria-label":"channel","onUpdate:modelValue":t[1]||(t[1]=p=>i.frontPadForm.channel=p),"aria-describedby":"channel"},null,512),[[_,i.frontPadForm.channel]])]),e("div",mz,[e("label",hz,[g(h,null,{content:b(()=>[pz]),default:b(()=>[_z]),_:1}),m(" Филиал ")]),c(e("input",{type:"text",class:"form-control",placeholder:"Филиал","aria-label":"Филиал","onUpdate:modelValue":t[2]||(t[2]=p=>i.frontPadForm.affiliate=p),"aria-describedby":"Филиал"},null,512),[[_,i.frontPadForm.affiliate]])]),e("div",bz,[e("label",fz,[g(h,null,{content:b(()=>[vz]),default:b(()=>[gz]),_:1}),m(" Точка продаж ")]),c(e("input",{type:"text",class:"form-control",placeholder:"Точка продаж","aria-label":"Точка продаж","onUpdate:modelValue":t[3]||(t[3]=p=>i.frontPadForm.point=p),"aria-describedby":"Точка продаж"},null,512),[[_,i.frontPadForm.point]])]),e("div",yz,[$z,i.frontPadForm.statuses?(l(),n("div",kz,[Fz,e("div",Cz,[e("table",wz,[Sz,e("tbody",null,[(l(!0),n(v,null,$(i.frontPadForm.statuses,(p,F)=>(l(),n("tr",null,[e("td",null,u(p.title||"-"),1),e("td",null,u(p.key||"-"),1),e("td",null,[c(e("input",{type:"text",class:"form-control",placeholder:"Статус","aria-label":"Статус","onUpdate:modelValue":C=>i.frontPadForm.statuses[F].value=C,"aria-describedby":"Статус"},null,8,jz),[[_,i.frontPadForm.statuses[F].value]])])]))),256))])])])])):r("",!0)]),e("div",qz,[zz,i.frontPadForm.pays?(l(),n("div",Vz,[Pz,e("div",Oz,[e("table",Uz,[Az,e("tbody",null,[(l(!0),n(v,null,$(i.frontPadForm.pays,(p,F)=>(l(),n("tr",null,[e("td",null,u(p.title||"-"),1),e("td",null,u(p.key||"-"),1),e("td",null,[c(e("input",{type:"text",class:"form-control",placeholder:"Статус","aria-label":"Статус","onUpdate:modelValue":C=>i.frontPadForm.pays[F].value=C,"aria-describedby":"Статус"},null,8,Qz),[[_,i.frontPadForm.pays[F].value]])])]))),256))])])])])):r("",!0)]),Iz],32)}const Bz=O(sz,[["render",Tz]]);const Rz={class:"d-flex custom-dropdown justify-content-between align-items-center"},Mz={class:"btn-group"},Dz=e("i",{class:"fa-solid fa-info mr-2"},null,-1),Ez=e("i",{class:"fa-solid fa-file mr-2"},null,-1),Lz={key:0,class:"btn btn-primary",type:"button","data-bs-toggle":"offcanvas","data-bs-target":"#bot-section-menu","aria-controls":"staticBackdrop"},Kz=e("i",{class:"fa-solid fa-screwdriver-wrench p-2 text-primary"},null,-1),Nz=[Kz],Jz={key:0,class:"pb-5 mb-5"},Yz={key:1,class:"pb-5 mb-5"},Gz={key:2,class:"pb-5 mb-5"},Hz={key:3,class:"pb-5 mb-5"},Wz={key:4,class:"pb-5 mb-5"},Xz={key:5,class:"pb-5 mb-5"},Zz={key:6,class:"pb-5 mb-5"},xz={key:7,class:"pb-5 mb-5"},eV={key:8,class:"pb-5 pt-2 mb-5"},tV={key:9,class:"pb-5 mb-5"},sV={key:10,class:"pb-5 mb-5 pt-2"},oV={key:11,class:"pb-5 mb-5"},lV={key:12,class:"pb-5 mb-5 pt-2"},nV={key:13,class:"pb-5 mb-5 pt-2"},iV={key:14,class:"pb-5 mb-5 pt-2"},aV={key:15,class:"row pb-5 mb-5"},dV={key:0,class:"col-12 col-md-12"},rV={key:16,class:"pb-5 mb-5"},cV={class:"offcanvas offcanvas-end","data-bs-scroll":"true","data-bs-backdrop":"false",tabindex:"-1",id:"bot-section-menu","aria-labelledby":"staticBackdropLabel"},uV=e("div",{class:"offcanvas-header"},[e("h5",{class:"offcanvas-title",id:"staticBackdropLabel"},"Меню управления ботом"),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"offcanvas","aria-label":"Close"})],-1),mV={class:"offcanvas-body"},hV={class:"list-group list-group-flush bot-section-menu-group"},_V=e("i",{class:"fa-regular fa-newspaper mr-2"},null,-1),pV=e("i",{class:"fa-regular fa-calendar-days mr-2"},null,-1),bV=e("i",{class:"fa-solid fa-q mr-2"},null,-1),fV=e("i",{class:"fa-solid fa-q mr-2"},null,-1),gV=e("i",{class:"fa-solid fa-clipboard-list mr-2"},null,-1),vV=e("i",{class:"fa-solid fa-code mr-2"},null,-1),yV=e("i",{class:"fa-solid fa-keyboard mr-2"},null,-1),$V=e("i",{class:"fa-solid fa-scroll mr-2"},null,-1),kV=e("i",{class:"fa-solid fa-comment-dots mr-2"},null,-1),FV=e("i",{class:"fa-solid fa-users mr-2"},null,-1),CV=e("i",{class:"fa-solid fa-list-check mr-2"},null,-1),wV=e("i",{class:"fa-solid fa-list-check mr-2"},null,-1),SV=e("i",{class:"fa-solid fa-list-check mr-2"},null,-1),jV=e("i",{class:"fa-brands fa-shopify mr-2"},null,-1),qV=e("i",{class:"fa-brands fa-shopify mr-2"},null,-1),zV={props:["bot"],data(){return{page:null,step:0,load:!1,loadPage:!1}},mounted(){this.setStep(localStorage.getItem("cashman_set_botform_step_index")||0)},methods:{botCallbackUpdate(o){this.$store.dispatch("updateCurrentBot",{bot:o}).then(()=>{}),this.$emit("callback")},hasRole(o){return window.hasRole(o)||!1},setStep(o){this.step=parseInt(o),localStorage.setItem("cashman_set_botform_step_index",o)},pageListCallback(o){this.loadPage=!0,this.page=o,this.$nextTick(()=>{this.loadPage=!1})},pageCallback(o){this.page=o,this.loadPageList=!0,this.$nextTick(()=>{this.loadPageList=!1})},loadCurrentCompany(o=null){this.$store.dispatch("updateCurrentCompany",{company:o}).then(()=>{this.company=this.getCurrentCompany})},companyListCallback(o){this.load=!0,this.loadCurrentCompany(o),this.$nextTick(()=>{this.load=!1})}}},wO=Object.assign(zV,{__name:"BotSection",setup(o){return(t,s)=>(l(),n(v,null,[e("div",Rz,[e("div",Mz,[e("button",{type:"button",class:f(["btn btn-primary text-primary",{"bg-primary text-white":t.step==0}]),onClick:s[0]||(s[0]=a=>t.setStep(0))},[Dz,m("Информация о боте ")],2),e("button",{type:"button",class:f(["btn btn-primary text-primary",{"bg-primary text-white":t.step==4}]),onClick:s[1]||(s[1]=a=>t.setStep(4))},[Ez,m("Страницы (кнопки бота) ")],2)]),t.hasRole("admin")?(l(),n("button",Lz,Nz)):r("",!0)]),t.step===14?(l(),n("div",Jz,[t.load?r("",!0):(l(),y(s9,{key:0,bot:o.bot},null,8,["bot"]))])):r("",!0),t.step===16?(l(),n("div",Yz,[t.load?r("",!0):(l(),y(tz,{key:0,bot:o.bot},null,8,["bot"]))])):r("",!0),t.step===13?(l(),n("div",Gz,[t.load?r("",!0):(l(),y(DF,{key:0,bot:o.bot},null,8,["bot"]))])):r("",!0),t.step===0?(l(),n("div",Hz,[t.load?r("",!0):(l(),y($e,{key:0,onCallback:t.botCallbackUpdate,bot:o.bot},null,8,["onCallback","bot"]))])):r("",!0),t.step===15?(l(),n("div",Wz,[t.load?r("",!0):(l(),y(fj,{key:0,bot:o.bot},null,8,["bot"]))])):r("",!0),t.step===7?(l(),n("div",Xz,[t.load?r("",!0):(l(),y($v,{key:0,data:o.bot.amo},null,8,["data"]))])):r("",!0),t.step===17?(l(),n("div",Zz,[t.load?r("",!0):(l(),y(Bz,{key:0,data:o.bot.frontPad},null,8,["data"]))])):r("",!0),t.step===12?(l(),n("div",xz,[t.load?r("",!0):(l(),y(Iv,{key:0,data:o.bot.y_clients},null,8,["data"]))])):r("",!0),t.step===11?(l(),n("div",eV,[t.load?r("",!0):(l(),y(h$,{key:0}))])):r("",!0),t.step===8?(l(),n("div",tV,[t.load?r("",!0):(l(),y(Wg,{key:0}))])):r("",!0),t.step===10?(l(),n("div",sV,[t.load?r("",!0):(l(),y(Qy,{key:0}))])):r("",!0),t.step===1?(l(),n("div",oV,[t.load?r("",!0):(l(),y(I,{key:0,"select-mode":!1}))])):r("",!0),t.step===6?(l(),n("div",lV,[t.load?r("",!0):(l(),y(ie,{key:0}))])):r("",!0),t.step===2?(l(),n("div",nV,[t.load?r("",!0):(l(),y(ne,{key:0}))])):r("",!0),t.step===3?(l(),n("div",iV,[t.load?r("",!0):(l(),y(D,{key:0}))])):r("",!0),t.step===4?(l(),n("div",aV,[t.load?r("",!0):(l(),n("div",dV,[t.loadPage?r("",!0):(l(),y(Nb,{key:0,page:t.page,onCallback:t.pageCallback},null,8,["page","onCallback"]))]))])):r("",!0),t.step===9?(l(),n("div",rV,[g(Yv,{bot:o.bot},null,8,["bot"])])):r("",!0),e("div",cV,[uV,e("div",mV,[e("ul",hV,[e("li",null,[e("a",{class:"list-group-item list-group-item-action",href:"#bot-news",onClick:s[2]||(s[2]=a=>t.setStep(9))},[_V,m(" Рассылки")])]),e("li",null,[e("a",{class:"list-group-item list-group-item-action",href:"#bot-appointments",onClick:s[3]||(s[3]=a=>t.setStep(13))},[pV,m("Запись на событие (прием)")])]),e("li",null,[e("a",{class:"list-group-item list-group-item-action",href:"#bot-quizzes",onClick:s[4]||(s[4]=a=>t.setStep(14))},[bV,m("Квизы")])]),e("li",null,[e("a",{class:"list-group-item list-group-item-action",href:"#bot-promo-codes",onClick:s[5]||(s[5]=a=>t.setStep(16))},[fV,m("Промокоды")])]),e("li",null,[e("a",{class:"list-group-item list-group-item-action",href:"#bot-inline-queries",onClick:s[6]||(s[6]=a=>t.setStep(15))},[gV,m("Встраиваемые запросы")])]),e("li",null,[e("a",{class:"list-group-item list-group-item-action",href:"#bot-custom-fields",onClick:s[7]||(s[7]=a=>t.setStep(10))},[vV,m("Настраиваемые поля")])]),e("li",null,[e("a",{class:"list-group-item list-group-item-action",href:"#bot-menu-template",onClick:s[8]||(s[8]=a=>t.setStep(1))},[yV,m("Все клавиатуры в боте")])]),e("li",null,[e("a",{class:"list-group-item list-group-item-action",href:"#bot-slugs",onClick:s[9]||(s[9]=a=>t.setStep(2))},[$V,m("Все скрипты в боте")])]),e("li",null,[e("a",{class:"list-group-item list-group-item-action",href:"#bot-dialogs",onClick:s[10]||(s[10]=a=>t.setStep(6))},[kV,m("Все диалоги в боте")])]),e("li",null,[e("a",{class:"list-group-item list-group-item-action",href:"#bot-users",onClick:s[11]||(s[11]=a=>t.setStep(3))},[FV,m("Все пользователи в боте")])]),e("li",null,[e("a",{class:"list-group-item list-group-item-action",href:"#bot-amo",onClick:s[12]||(s[12]=a=>t.setStep(7))},[CV,m(" AMO CRM")])]),e("li",null,[e("a",{class:"list-group-item list-group-item-action",href:"#bot-front-pad",onClick:s[13]||(s[13]=a=>t.setStep(17))},[wV,m(" FrontPad")])]),e("li",null,[e("a",{class:"list-group-item list-group-item-action",href:"#bot-y-clients",onClick:s[14]||(s[14]=a=>t.setStep(12))},[SV,m(" YClients")])]),e("li",null,[e("a",{class:"list-group-item list-group-item-action",href:"#bot-shop",onClick:s[15]||(s[15]=a=>t.setStep(8))},[jV,m(" Магазин")])]),e("li",null,[e("a",{class:"list-group-item list-group-item-action",href:"#bot-media",onClick:s[16]||(s[16]=a=>t.setStep(11))},[qV,m(" Медиа файлы бота")])])])])])],64))}}),VV={key:0},PV={key:0,class:"row"},OV={class:"col-md-12"},UV=e("h4",null,"Боты в работе",-1),AV={class:"mb-0"},QV={class:"table mb-5"},IV=e("thead",null,[e("tr",null,[e("th",{scope:"col"},"#"),e("th",{scope:"col"},"Домен"),e("th",{scope:"col"},"Название"),e("th",{scope:"col"},"Шаблон"),e("th",{scope:"col"},"Дата изменения"),e("th",{scope:"col"},"Действие")])],-1),TV={scope:"row"},BV=["onClick"],RV=["onClick"],MV={key:0,class:"badge bg-primary"},DV={key:1},EV={class:"d-flex"},LV=["onClick"],KV=e("i",{class:"fa-regular fa-star"},null,-1),NV=[KV],JV=["onClick"],YV=e("i",{class:"fa-solid fa-chevron-down"},null,-1),GV=[YV],HV=["onClick"],WV=e("i",{class:"fa-solid fa-chevron-up"},null,-1),XV=[WV],ZV=e("hr",null,null,-1),xV={class:"row"},eP={class:"col-md-12 d-flex flex-column"},tP={class:"d-flex"},sP={class:"dropdown mr-2"},oP=e("button",{class:"btn btn-outline-primary dropdown-toggle",type:"button",id:"dropdownMenuButton1","data-bs-toggle":"dropdown","aria-expanded":"false"}," Фильтры ",-1),lP={class:"dropdown-menu","aria-labelledby":"dropdownMenuButton1"},nP=["onClick"],iP={class:"input-group mb-3"},aP={key:0,class:"mt-2"},dP={class:"badge bg-primary mr-1"},rP=["onClick"],cP=e("i",{class:"fa-solid fa-xmark"},null,-1),uP=[cP],mP={key:1,class:"row"},hP={class:"col-12"},_P=e("h4",null,"Все боты",-1),pP={class:"mb-0"},bP={class:"mb-0"},fP={key:2,class:"row"},gP={class:"col-12 mb-3"},vP={key:0,class:"col-12 mb-3"},yP={class:"table"},$P=e("th",{scope:"col"},"Действие",-1),kP={scope:"row"},FP=["onClick"],CP=["onClick"],wP={key:0,class:"badge bg-primary"},SP={key:1},jP={class:"d-flex"},qP=["onClick"],zP=e("i",{class:"fa-regular fa-star"},null,-1),VP=[zP],PP=["onClick"],OP=e("i",{class:"fa-regular fa-copy"},null,-1),UP=[OP],AP=["onClick"],QP=e("i",{class:"fa-solid fa-boxes-packing"},null,-1),IP=[QP],TP=["onClick"],BP=e("i",{class:"fa-solid fa-box-open"},null,-1),RP=[BP],MP=["onClick"],DP=e("i",{class:"fa-solid fa-trash-can text-white"},null,-1),EP=[DP],LP={class:"col-lg-4 col-12 mb-3"},KP={class:"card-body"},NP=["onClick"],JP={key:0,class:"badge bg-info"},YP={class:"card-footer d-flex"},GP=["onClick"],HP=e("i",{class:"fa-regular fa-star"},null,-1),WP=[HP],XP=["onClick"],ZP=e("i",{class:"fa-regular fa-copy"},null,-1),xP=[ZP],eO=["onClick"],tO=e("i",{class:"fa-solid fa-boxes-packing"},null,-1),sO=[tO],oO=["onClick"],lO=e("i",{class:"fa-solid fa-box-open"},null,-1),nO=[lO],iO=["onClick"],aO=e("i",{class:"fa-solid fa-trash-can text-white"},null,-1),dO=[aO],rO={class:"col-12"},cO={key:3,class:"row"},uO=e("div",{class:"col-12"},[e("div",{class:"alert alert-warning",role:"alert"}," У выбранной компании нет созданных ботов! ")],-1),mO=[uO],hO={props:["companyId","editor"],data(){return{displayType:1,direction:"desc",order:"updated_at",filters:[{name:"Активные",icon:"fa-brands fa-telegram",slug:"active"},{name:"Архивные",icon:"fa-solid fa-box-archive",slug:"archive"}],selectedFilters:[],show:!0,loading:!0,bots:[],favorites:[],search:null,bots_paginate_object:null}},watch:{displayType:function(o,t){localStorage.setItem("cashman_set_botlist_display_type",this.displayType)},selectedFilters:{handler:function(o){this.loadBots()},deep:!0}},computed:{...w(["getBots","getBotsPaginateObject","getCurrentCompany","getBotFavorites","inBotFav"]),filteredBots(){if(!this.bots)return[];if(this.selectedFilters.length===0&&this.search==null)return this.bots;if(this.selectedFilters.length===0&&this.search!=null)return this.bots.filter(t=>(t.bot_domain||"").trim().toLowerCase().indexOf(this.search.trim().toLowerCase())!==-1);let o=[];return this.selectedFilters.forEach(t=>{switch(t.slug){case"active":this.bots.filter(s=>s.deleted_at==null).forEach(s=>{o.push(s)});break;case"archive":this.bots.filter(s=>s.deleted_at!=null).forEach(s=>{o.push(s)});break}}),this.search==null?o:o.filter(t=>(t.bot_domain||"").trim().toLowerCase().indexOf(this.search.trim().toLowerCase())!==-1)}},mounted(){this.selectFilter("active"),this.displayType=parseInt(localStorage.getItem("cashman_set_botlist_display_type")||0)},methods:{hasRole(o){return window.hasRole(o)||!1},loadBotsByIds(){if(this.getBotFavorites.length==0){this.favorites=[];return}this.loading=!0,this.$store.dispatch("loadBotsByIds",{ids:this.getBotFavorites}).then(o=>{this.loading=!1,this.favorites=o}).catch(()=>{this.loading=!1})},prepareFavorites(){this.$store.dispatch("loadBotFavs").then(o=>{this.loadBotsByIds()})},moveOrderFavBot(o,t){this.$store.dispatch("swapBotInFav",{id:o,direction:t}).then(s=>{this.loadBotsByIds()})},addToFavorite(o){if(this.inBotFav(o)){this.$store.dispatch("removeFromBotFavorites",o).then(t=>{this.$notify("Указанный бот успешно удален из избранного"),this.loadBotsByIds()});return}this.$store.dispatch("addBotToFavorites",o).then(t=>{this.$notify("Указанный бот успешно добавлен в избранное"),this.loadBotsByIds()})},duplicate(o){if(!this.getCurrentCompany){this.$notify("У Вас не выбран клиент!");return}this.$store.dispatch("duplicateBot",{dataObject:{bot_id:o,company_id:this.getCurrentCompany.id}}).then(t=>{let s=this.bots_paginate_object.meta.current_page||0;this.loadBots(s),this.$notify("Указанный бот успешно продублирован")})},addToArchive(o){this.$store.dispatch("removeBot",{botId:o}).then(t=>{let s=this.bots_paginate_object.meta.current_page||0;this.$store.dispatch("resetCurrentBot"),this.loadBots(s),this.$notify("Указанный бот успешно перемещен в архив")})},forceDelete(o){this.$store.dispatch("forceDeleteBot",{botId:o}).then(t=>{let s=this.bots_paginate_object.meta.current_page||0;this.$store.dispatch("resetCurrentBot"),this.loadBots(s),this.$notify("Указанный бот успешно перемещен из архива")})},extractFromArchive(o){this.$store.dispatch("restoreBot",{botId:o}).then(t=>{let s=this.bots_paginate_object.meta.current_page||0;this.loadBots(s),this.$notify("Указанный бот успешно перемещен из архива")})},selectFilter(o){let t=this.filters.find(s=>s.slug===o);t&&this.selectedFilters.filter(s=>s.slug===o).length===0&&this.selectedFilters.push(t)},removeSelectedFilter(o){let t=this.selectedFilters.findIndex(s=>s.slug===o);this.selectedFilters.splice(t,1)},selectBot(o){this.$emit("callback",o),this.show=!1,this.$notify("Вы выбрали бота из списка! Все остальные действия будут производится для этого бота.")},nextBots(o){this.loadBots(o)},loadAndOrder(o){this.order=o,this.direction=this.direction==="desc"?"asc":"desc",this.loadBots(0)},loadBots(o=0){this.loading=!0,this.$store.dispatch("loadBots",{dataObject:{companyId:this.companyId||null,search:this.search,order:this.order,direction:this.direction,filters:this.selectedFilters.map(t=>t.slug)},page:o,size:20}).then(t=>{this.loading=!1,this.bots=this.getBots,this.bots_paginate_object=this.getBotsPaginateObject,this.prepareFavorites()}).catch(()=>{this.loading=!1})}}},SO=Object.assign(hO,{__name:"BotList",setup(o){return(t,s)=>t.show?(l(),n("div",VV,[t.favorites.length>0?(l(),n("div",PV,[e("div",OV,[UV,e("p",AV,"Количество ботов в работе "+u(t.favorites.length||0),1),e("table",QV,[IV,e("tbody",null,[(l(!0),n(v,null,$(t.favorites,(a,i)=>(l(),n("tr",{class:f({"border-info":a.deleted_at==null,"border-danger":a.deleted_at!=null})},[e("th",TV,u(a.id),1),e("td",{onClick:d=>t.selectBot(a)},[e("i",{class:f([{"text-danger":a.deleted_at!=null},"fa-solid fa-robot mr-2"])},null,2),m(" "+u(a.bot_domain||"Не указано"),1)],8,BV),e("td",{onClick:d=>t.selectBot(a)},u(a.title||"Не указано"),9,RV),e("td",null,[a.is_template?(l(),n("span",MV,u(a.template_description||"Не указано"),1)):(l(),n("span",DV,"Не является шаблоном"))]),e("td",null,u(t.$filters.current(a.updated_at)),1),e("td",null,[e("div",EV,[e("button",{class:f(["btn btn-outline-danger mr-2",{"btn-danger text-white":t.inBotFav(a.id)}]),type:"button",onClick:d=>t.addToFavorite(a.id),title:"Добавить в избранное"},NV,10,LV),t.favorites.length>1?(l(),n("button",{key:0,class:"btn btn-outline-primary mr-2",type:"button",onClick:d=>t.moveOrderFavBot(a.id,1),title:"Переместить вниз"},GV,8,JV)):r("",!0),t.favorites.length>1?(l(),n("button",{key:1,class:"btn btn-outline-primary mr-2",type:"button",onClick:d=>t.moveOrderFavBot(a.id,0),title:"Переместить вверх"},XV,8,HV)):r("",!0)])])],2))),256))])]),ZV])])):r("",!0),e("div",xV,[e("div",eP,[e("div",tP,[e("div",sP,[oP,e("ul",lP,[(l(!0),n(v,null,$(t.filters,a=>(l(),n("li",null,[e("a",{class:"dropdown-item",onClick:i=>t.selectFilter(a.slug),href:"#filter"},[e("i",{class:f([a.icon,"mr-2"])},null,2),m(" "+u(a.name||"Не указано"),1)],8,nP)]))),256))])]),e("div",iP,[c(e("input",{type:"search",class:"form-control",placeholder:"Поиск бота","aria-label":"Поиск бота","onUpdate:modelValue":s[0]||(s[0]=a=>t.search=a),onKeydown:s[1]||(s[1]=ye((...a)=>t.loadBots&&t.loadBots(...a),["enter"])),"aria-describedby":"button-addon2"},null,544),[[_,t.search]]),e("button",{class:"btn btn-outline-secondary",onClick:s[2]||(s[2]=(...a)=>t.loadBots&&t.loadBots(...a)),type:"button",id:"button-addon2"},"Найти ")])]),t.selectedFilters.length>0?(l(),n("p",aP,[(l(!0),n(v,null,$(t.selectedFilters,a=>(l(),n("span",dP,[m(u(a.name||"не указан")+" ",1),e("a",{onClick:i=>t.removeSelectedFilter(a.slug),class:"ml-1 text-white",href:"#filter"},uP,8,rP)]))),256))])):r("",!0)])]),t.bots_paginate_object?(l(),n("div",mP,[e("div",hP,[_P,e("p",pP,"Количество найденных ботов "+u(t.bots_paginate_object.meta.total||0),1),e("p",bP,"Количество результатов на странице "+u(t.bots.length||0),1),e("p",null,[m(" Тип отображения списка: "),e("span",{onClick:s[3]||(s[3]=a=>t.displayType=0),class:f([{"bg-primary":t.displayType===0,"bg-secondary":t.displayType!==0},"badge cursor-pointer mr-2"])},"Карточки",2),e("span",{class:f([{"bg-primary":t.displayType===1,"bg-secondary":t.displayType!==1},"badge cursor-pointer mr-2"]),onClick:s[4]||(s[4]=a=>t.displayType=1)},"Таблица",2)])])])):r("",!0),t.bots.length>0?(l(),n("div",fP,[e("div",gP,[o.editor?r("",!0):(l(),n("button",{key:0,type:"button",class:"btn btn-outline-info",onClick:s[5]||(s[5]=a=>t.selectBot(null))},"Создать нового бота "))]),t.displayType===1?(l(),n("div",vP,[e("table",yP,[e("thead",null,[e("tr",null,[e("th",{scope:"col",class:"cursor-pointer",onClick:s[6]||(s[6]=a=>t.loadAndOrder("id"))},"#"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[7]||(s[7]=a=>t.loadAndOrder("bot_domain"))},"Домен"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[8]||(s[8]=a=>t.loadAndOrder("title"))},"Название"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[9]||(s[9]=a=>t.loadAndOrder("template_description"))},"Шаблон"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[10]||(s[10]=a=>t.loadAndOrder("updated_at"))},"Дата изменения"),$P])]),e("tbody",null,[(l(!0),n(v,null,$(t.bots,(a,i)=>(l(),n("tr",{class:f({"border-info":a.deleted_at==null,"border-danger":a.deleted_at!=null})},[e("th",kP,u(a.id),1),e("td",{onClick:d=>t.selectBot(a)},[e("i",{class:f([{"text-danger":a.deleted_at!=null},"fa-solid fa-robot mr-2"])},null,2),m(" "+u(a.bot_domain||"Не указано"),1)],8,FP),e("td",{onClick:d=>t.selectBot(a)},u(a.title||"Не указано"),9,CP),e("td",null,[a.is_template?(l(),n("span",wP,u(a.template_description||"Не указано"),1)):(l(),n("span",SP,"Не является шаблоном"))]),e("td",null,u(t.$filters.current(a.updated_at)),1),e("td",null,[e("div",jP,[e("button",{class:f(["btn btn-outline-danger mr-2",{"btn-danger text-white":t.inBotFav(a.id)}]),type:"button",onClick:d=>t.addToFavorite(a.id),title:"Добавить в избранное"},VP,10,qP),e("button",{class:"btn btn-outline-info mr-2",type:"button",onClick:d=>t.duplicate(a.id),title:"Дублировать"},UP,8,PP),a.deleted_at==null&&t.hasRole("admin")?(l(),n("button",{key:0,class:"btn btn-outline-info",type:"button",onClick:d=>t.addToArchive(a.id),title:"В архив"},IP,8,AP)):r("",!0),a.deleted_at!=null&&t.hasRole("admin")?(l(),n("button",{key:1,class:"btn btn-outline-info mr-2",onClick:d=>t.extractFromArchive(a.id),title:"Из архива"},RP,8,TP)):r("",!0),a.deleted_at!=null&&t.hasRole("admin")?(l(),n("button",{key:2,class:"btn btn-danger mr-2",onClick:d=>t.forceDelete(a.id),title:"Удалить на совсем"},EP,8,MP)):r("",!0)])])],2))),256))])])])):r("",!0),t.displayType===0?(l(!0),n(v,{key:1},$(t.bots,(a,i)=>(l(),n("div",LP,[e("div",{class:f(["card w-100",{"border-info":a.deleted_at==null,"border-secondary":a.deleted_at!=null}])},[e("div",KP,[e("p",{class:"d-flex justify-content-between",onClick:d=>t.selectBot(a),style:{"word-wrap":"break-word"}},[e("span",null,[e("i",{class:f([{"text-danger":a.deleted_at!=null},"fa-solid fa-robot mr-2"])},null,2),m(" "+u(a.bot_domain||"Не указано"),1)]),a.is_template?(l(),n("span",JP,u(a.template_description||"Шаблон без названия"),1)):r("",!0)],8,NP)]),e("div",YP,[e("button",{class:f(["btn btn-outline-danger mr-2",{"btn-danger text-white":t.inBotFav(a.id)}]),type:"button",onClick:d=>t.addToFavorite(a.id),title:"Добавить в избранное"},WP,10,GP),e("button",{class:"btn btn-outline-info mr-2",type:"button",onClick:d=>t.duplicate(a.id),title:"Дублировать"},xP,8,XP),a.deleted_at==null&&t.hasRole("admin")?(l(),n("button",{key:0,class:"btn btn-outline-info",type:"button",onClick:d=>t.addToArchive(a.id),title:"В архив"},sO,8,eO)):r("",!0),a.deleted_at!=null&&t.hasRole("admin")?(l(),n("button",{key:1,class:"btn btn-outline-info mr-2",onClick:d=>t.extractFromArchive(a.id),title:"Из архива"},nO,8,oO)):r("",!0),a.deleted_at!=null&&t.hasRole("admin")?(l(),n("button",{key:2,class:"btn btn-danger mr-2",onClick:d=>t.forceDelete(a.id),title:"Удалить на совсем"},dO,8,iO)):r("",!0)])],2)]))),256)):r("",!0),e("div",rO,[t.bots_paginate_object?(l(),y(j,{key:0,onPagination_page:t.nextBots,pagination:t.bots_paginate_object},null,8,["onPagination_page","pagination"])):r("",!0)])])):(l(),n("div",cO,mO))])):r("",!0)}});export{SO as _,wO as a,Nb as b,ie as c};
