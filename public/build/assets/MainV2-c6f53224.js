import{L as T,q as l,t as a,v as t,H as p,J as u,D as h,y as m,A as c,F as v,C as V,T as $,P as x,G as F,B as k,O as C,u as S,a1 as B,N as I,x as y,R as w,K as j}from"./index.es-f98e90e3.js";import{_ as U}from"./_plugin-vue_export-helper-c27b6911.js";const L={data(){return{companyForm:{id:null,title:null,description:null,address:null,phones:[],links:{vk:null,inst:null,map_link:null},email:null,schedule:[{day:"Понедельник",start_at:"08:00",end_at:"20:00",closed:!1,closed_comment:"Выходной"},{day:"Вторник",start_at:"08:00",end_at:"20:00",closed:!1,closed_comment:"Выходной"},{day:"Среда",start_at:"08:00",end_at:"20:00",closed:!1,closed_comment:"Выходной"},{day:"Четверг",start_at:"08:00",end_at:"20:00",closed:!1,closed_comment:"Выходной"},{day:"Пятница",start_at:"08:00",end_at:"20:00",closed:!1,closed_comment:"Выходной"},{day:"Суббота",start_at:"08:00",end_at:"20:00",closed:!1,closed_comment:"Выходной"},{day:"Воскресенье",start_at:"08:00",end_at:"20:00",closed:!1,closed_comment:"Выходной"}]}}},computed:{currentBot(){return window.currentBot}},mounted(){const s=this.currentBot.company;this.companyForm.id=s.id||null,this.companyForm.title=s.title||null,this.companyForm.description=s.description||null,this.companyForm.email=s.email||null,this.companyForm.address=s.address||null,this.companyForm.phones=s.phones||["+7"];let e=r=>{let o=["inst","vk","map_link"],f=!1,b=0;return Object.keys(r).forEach(i=>{o.indexOf(i)!==-1&&(f=!0,b++)}),f&&b===o.length};this.companyForm.links=e(s.links)?s.links:this.companyForm.links;let n=r=>{if((r||[]).length<7)return!1;let o=!0;return r.forEach(f=>{o=o&&typeof f=="object"}),o};this.companyForm.schedule=n(s.schedule)?s.schedule:this.companyForm.schedule},methods:{submitForm(){let s=new FormData;Object.keys(this.companyForm).forEach(e=>{const n=this.companyForm[e]||"";typeof n=="object"?s.append(e,JSON.stringify(n)):s.append(e,n)}),this.$store.dispatch("updateCompany",{companyForm:s}).then(e=>{this.$notify({title:"Информация о компании",text:"Информация о компании успешно обновлена!",type:"success"}),this.$emit("callback",e.data),window.location.reload()}).catch(e=>{this.$notify({title:"Информация о компании",text:"Ошибка обновления информации о компании",type:"error"})})}}},M={class:"form-floating mb-3"},z={for:"floatingInput"},E={key:0,class:"ml-1",style:{"font-size":"10px"}},q={class:"form-floating"},D={for:"floatingTextarea2"},O={key:0,class:"ml-1",style:{"font-size":"10px"}},A=t("h6",{class:"opacity-75 my-3"},"Контактная информация",-1),N={class:"form-floating mb-2"},H=t("label",{for:"floatingInput"},"Телефон",-1),P={class:"form-floating mb-2"},J=t("label",{for:"floatingInput"},"Инста",-1),R={class:"form-floating mb-2"},W=t("label",{for:"floatingInput"},"Вконтакте",-1),G={class:"form-floating mb-2"},K=t("label",{for:"floatingInput"},"Почта",-1),X=t("h6",{class:"opacity-75 my-3"},"Расположение заведения",-1),Y={class:"form-floating mb-2"},Q={for:"floatingInput"},Z={key:0,class:"ml-1",style:{"font-size":"10px"}},tt={class:"form-floating mb-2"},et=t("label",{for:"floatingInput"},"Виджет с Яндекс.Картой",-1),ot=t("h6",{class:"opacity-75 my-3"},"График работы",-1),st=t("div",{class:"alert alert-light p-2",style:{"font-size":"12px"},role:"alert"},[h(" Укажите график работы вашего заведения. Если в какой-то день ваше заведение "),t("span",{class:"fw-bold"},"закрыто"),h(" - поставьте галочку сбоку от времени и укажите причину. ")],-1),nt={class:"mb-0",style:{"font-size":"12px"}},lt={class:"input-group mb-2"},at={class:"input-group-text"},it=["onUpdate:modelValue"],rt={key:0,class:"form-floating"},ct=["onUpdate:modelValue"],mt=t("label",{for:"floatingInput"},"Начало",-1),dt={key:1,class:"form-floating"},pt=["onUpdate:modelValue"],ht=t("label",{for:"floatingInput"},"Окончание",-1),ut={key:2,class:"form-floating"},ft=["onUpdate:modelValue"],_t=t("label",{for:"floatingInput"},"Причина закрытия",-1),yt=t("button",{type:"submit",class:"btn btn-primary w-100 p-3 mb-3"},"Сохранить изменения",-1);function bt(s,e,n,r,o,f){const b=T("mask");return l(),a("form",{onSubmit:e[8]||(e[8]=x((...i)=>f.submitForm&&f.submitForm(...i),["prevent"]))},[t("div",M,[p(t("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=i=>o.companyForm.title=i),maxlength:"255",class:"form-control",id:"floatingInput",placeholder:"name@example.com",required:""},null,512),[[u,o.companyForm.title]]),t("label",z,[h("Название "),(o.companyForm.title||"").length>0?(l(),a("span",E,"("+m(o.companyForm.title.length)+"/255)",1)):c("",!0)])]),t("div",q,[p(t("textarea",{"onUpdate:modelValue":e[1]||(e[1]=i=>o.companyForm.description=i),maxlength:"1000",required:"",class:"form-control",placeholder:"Leave a comment here",id:"floatingTextarea2",style:{height:"200px"}},null,512),[[u,o.companyForm.description]]),t("label",D,[h("Описание "),(o.companyForm.description||"").length>0?(l(),a("span",O,"("+m(o.companyForm.description.length)+"/1000)",1)):c("",!0)])]),A,t("div",N,[p(t("input",{type:"text","onUpdate:modelValue":e[2]||(e[2]=i=>o.companyForm.phones[0]=i),class:"form-control",id:"floatingInput",placeholder:"name@example.com"},null,512),[[b,["+7(###)###-##-##"]],[u,o.companyForm.phones[0]]]),H]),t("div",P,[p(t("input",{type:"text","onUpdate:modelValue":e[3]||(e[3]=i=>o.companyForm.links.inst=i),class:"form-control",id:"floatingInput",placeholder:"name@example.com"},null,512),[[u,o.companyForm.links.inst]]),J]),t("div",R,[p(t("input",{type:"text","onUpdate:modelValue":e[4]||(e[4]=i=>o.companyForm.links.vk=i),class:"form-control",id:"floatingInput",placeholder:"name@example.com"},null,512),[[u,o.companyForm.links.vk]]),W]),t("div",G,[p(t("input",{type:"email","onUpdate:modelValue":e[5]||(e[5]=i=>o.companyForm.email=i),class:"form-control",id:"floatingInput",placeholder:"name@example.com"},null,512),[[u,o.companyForm.email]]),K]),X,t("div",Y,[p(t("input",{type:"text","onUpdate:modelValue":e[6]||(e[6]=i=>o.companyForm.address=i),class:"form-control",id:"floatingInput",placeholder:"name@example.com"},null,512),[[u,o.companyForm.address]]),t("label",Q,[h("Адрес расположения "),(o.companyForm.address||"").length>0?(l(),a("span",Z,"("+m(o.companyForm.address.length)+"/255)",1)):c("",!0)])]),t("div",tt,[p(t("textarea",{"onUpdate:modelValue":e[7]||(e[7]=i=>o.companyForm.links.map_link=i),class:"form-control",placeholder:"Leave a comment here",id:"floatingTextarea2",style:{height:"200px"}},null,512),[[u,o.companyForm.links.map_link]]),et]),ot,st,(l(!0),a(v,null,V(o.companyForm.schedule,(i,d)=>(l(),a(v,null,[t("p",nt,m(o.companyForm.schedule[d].day),1),t("div",lt,[t("div",at,[p(t("input",{class:"form-check-input mt-0","onUpdate:modelValue":_=>o.companyForm.schedule[d].closed=_,type:"checkbox",value:"","aria-label":"Checkbox for following text input"},null,8,it),[[$,o.companyForm.schedule[d].closed]])]),o.companyForm.schedule[d].closed?c("",!0):(l(),a("div",rt,[p(t("input",{type:"time","onUpdate:modelValue":_=>o.companyForm.schedule[d].start_at=_,class:"form-control",id:"floatingInput",placeholder:"name@example.com"},null,8,ct),[[u,o.companyForm.schedule[d].start_at]]),mt])),o.companyForm.schedule[d].closed?c("",!0):(l(),a("div",dt,[p(t("input",{type:"time","onUpdate:modelValue":_=>o.companyForm.schedule[d].end_at=_,class:"form-control",id:"floatingInput",placeholder:"name@example.com"},null,8,pt),[[u,o.companyForm.schedule[d].end_at]]),ht])),o.companyForm.schedule[d].closed?(l(),a("div",ut,[p(t("input",{type:"text","onUpdate:modelValue":_=>o.companyForm.schedule[d].closed_comment=_,class:"form-control",id:"floatingInput",placeholder:"name@example.com"},null,8,ft),[[u,o.companyForm.schedule[d].closed_comment]]),_t])):c("",!0)])],64))),256)),yt],32)}const gt=U(L,[["render",bt]]);const kt=t("title",null,"CashMan - система твоего бизнеса внутри",-1),vt=t("meta",{name:"description",content:"CashMan - система твоего бизнеса внутри"},null,-1),wt={"data-bs-theme":"dark"},Ft={class:"navbar shadow shadow-sm"},Ct={class:"container flex-row-reverse p-2"},Tt={key:0,class:"mb-0 fw-bold d-flex flex-column",style:{"font-size":"12px"}},Vt={key:0,class:"text-primary"},$t=t("i",{class:"fa-solid fa-location-dot mr-1"},null,-1),xt={key:1,class:"text-primary"},St={key:2,class:"small d-flex justify-content-end"},Bt={href:"javascript:void(0)",class:"text-secondary fw-bold"},It={key:1,class:"mb-0 text-primary",style:{"font-size":"12px"}},jt=t("button",{class:"btn btn-link rounded-0 border-0 p-1",type:"button","data-bs-toggle":"offcanvas","data-bs-target":"#sidebar-menu","aria-controls":"sidebar-menu"},[t("span",{class:"navbar-toggler-icon"})],-1),Ut={class:"text-body-secondary",style:{padding:"0px 0px 90px 0px"}},Lt={class:"container g-2 d-flex justify-content-center flex-column align-items-center"},Mt={class:"text-center mb-3"},zt=["innerHTML"],Et={key:0,"data-bs-toggle":"modal","data-bs-target":"#edit-shop-footer-description-modal",href:"javascript:void(0)",class:"text-primary ml-2",style:{"font-size":"12px"}},qt=t("i",{class:"fa-solid fa-pen-to-square"},null,-1),Dt={key:1,class:"mb-3 text-center"},Ot=t("i",{class:"fa-solid fa-map-location-dot mr-2"},null,-1),At={class:"mb-0"},Nt={class:"d-flex justify-content-center my-3"},Ht=t("i",{class:"fa-solid fa-arrow-up mr-2"},null,-1),Pt={class:"offcanvas offcanvas-start custom-offcanvas",style:{width:"70%","border-radius":"0px 10px 10px 0px"},tabindex:"-1",id:"sidebar-menu","aria-labelledby":"offcanvasExampleLabel"},Jt={class:"offcanvas-header"},Rt={class:"offcanvas-title",id:"offcanvasExampleLabel"},Wt=t("button",{type:"button",class:"btn-close","data-bs-dismiss":"offcanvas","aria-label":"Close"},null,-1),Gt={class:"offcanvas-body"},Kt={class:"list-unstyled"},Xt={class:"p-1"},Yt={class:"p-1"},Qt={class:"p-1"},Zt={class:"p-1"},te={key:0,class:"fw-bold"},ee={class:"p-1"},oe={class:"p-1"},se={class:"p-1"},ne=t("div",{class:"border-top my-3"},null,-1),le={key:0,class:"p-2"},ae={class:"list-unstyled"},ie={key:0},re=t("p",{class:"mb-0"},"Телефон",-1),ce=[re],me={key:1,class:"mb-2"},de=["href"],pe={key:2},he=t("p",{class:"mb-0"},"Ссылки",-1),ue=[he],fe={key:3},_e=["href"],ye=t("i",{class:"fa-brands fa-instagram mr-1"},null,-1),be={key:4},ge=["href"],ke=t("i",{class:"fa-brands fa-vk mr-1"},null,-1),ve={key:5},we=t("p",{class:"mb-0"},"Почта",-1),Fe=[we],Ce=["href"],Te={class:"modal fade",id:"edit-shop-footer-description-modal",tabindex:"-1","aria-labelledby":"edit-shop-footer-description","aria-hidden":"true"},Ve={class:"modal-dialog modal-fullscreen"},$e={class:"modal-content"},xe=t("div",{class:"modal-header"},[t("h1",{class:"modal-title fs-5",id:"exampleModalLabel"},"Редактор"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),Se={class:"modal-body"},Be=t("div",{class:"modal-footer p-2"},null,-1),Ie={data(){return{currentTheme:"",themes:[{title:"Тема 3",href:"/theme5.bootstrap.min.css"},{title:"Тема 4",href:"/theme6.bootstrap.min.css"},{title:"Тема 5",href:"/theme8.bootstrap.min.css"},{title:"Тема 6",href:"/theme9.bootstrap.min.css"},{title:"Тема 7",href:"/theme10.bootstrap.min.css"},{title:"Тема 8",href:"/theme11.bootstrap.min.css"},{title:"Тема 9",href:"/theme12.bootstrap.min.css"},{title:"Тема 10",href:"/theme13.bootstrap.min.css"},{title:"Тема 11",href:"/theme14.bootstrap.min.css"},{title:"Тема 12",href:"/theme15.bootstrap.min.css"},{title:"Тема 13",href:"/theme16.bootstrap.min.css"}]}},watch:{$route(s){let e=localStorage.getItem("cashman_global_client_theme")||null;e&&this.$nextTick(()=>{this.currentTheme=e}),this.$preloader.show(),this.$nextTick(()=>{document.body.scrollTop=document.documentElement.scrollTop=0})}},computed:{...F(["getSelf","cartTotalCount"]),tg(){return window.Telegram.WebApp},bot(){return window.currentBot}},mounted(){let s=localStorage.getItem("cashman_global_client_theme")||null;s&&this.$nextTick(()=>{this.currentTheme=s}),this.changeTheme(this.tg.colorScheme),this.tg.BackButton.show(),this.tg.BackButton.onClick(()=>{document.querySelectorAll('[data-bs-dismiss="modal"]').forEach(e=>e.click()),this.$router.back()})},methods:{switchTheme(s){let e=document.querySelector("#theme");e.href=this.themes[s].href,localStorage.setItem("cashman_global_client_theme",e.href),this.$nextTick(()=>{this.currentTheme=e.href})},goTo(s){this.$router.push({name:s})},changeTheme(s){document.querySelectorAll("[data-bs-theme]").forEach(n=>{n.setAttribute("data-bs-theme",s)})},scrollTop(){window.scrollTo(0,80)},openLink(s){this.tg.openLink(s,{try_instant_view:!0})},closeShop(){this.tg.close()}}},je=Object.assign(Ie,{__name:"V2Layout",setup(s){return(e,n)=>(l(),a(v,null,[k(S(B),null,{default:C(()=>[kt,vt]),_:1}),t("header",wt,[t("div",Ft,[t("div",Ct,[e.bot.company?(l(),a("p",Tt,[e.bot.company.address?(l(),a("span",Vt,[$t,h(" "+m(e.bot.company.address),1)])):(l(),a("span",xt,m(e.bot.title||"Магазин"),1)),(e.bot.company.phones||[]).length>0?(l(),a("span",St,[t("a",Bt,m(e.bot.company.phones[0]),1)])):c("",!0)])):(l(),a("p",It,m(e.bot.title||"Бот"),1)),jt])])]),I(e.$slots,"default"),t("footer",Ut,[t("div",Lt,[e.$route.name!="FeedBackV2"?(l(),a("button",{key:0,onClick:n[0]||(n[0]=r=>e.goTo("FeedBackV2")),class:"btn btn-link mb-2 w-100 p-3 text-primary"},"Обратная связь ")):c("",!0),t("p",Mt,[t("span",{innerHTML:e.bot.company.description},null,8,zt),(e.getSelf||{is_admin:!1}).is_admin?(l(),a("a",Et,[qt,h(" редактировать")])):c("",!0)]),e.bot.company.address?(l(),a("p",Dt,[Ot,h(m(e.bot.company.address),1)])):c("",!0),t("p",At,m(e.bot.company.title)+"©"+m(new Date().getFullYear()),1),t("p",Nt,[t("a",{href:"javascript:void(0)",onClick:n[1]||(n[1]=(...r)=>e.scrollTop&&e.scrollTop(...r))},[Ht,h("Вернуться наверх")])])])]),t("div",Pt,[t("div",Jt,[t("h6",Rt,m(e.bot.title||"Магазин"),1),Wt]),t("div",Gt,[t("ul",Kt,[t("li",Xt,[t("a",{class:y([{"fw-bold":e.$route.name==="MenuV2"},"text-decoration-none fw-normal"]),onClick:n[2]||(n[2]=r=>e.goTo("MenuV2")),href:"javascript:void(0)"}," Главное меню",2)]),t("li",Yt,[t("a",{class:y([{"fw-bold":e.$route.name==="ProfileV2"},"text-decoration-none fw-normal"]),onClick:n[3]||(n[3]=r=>e.goTo("ProfileV2")),href:"javascript:void(0)"}," Профиль",2)]),t("li",Qt,[t("a",{class:y([{"fw-bold":e.$route.name==="CatalogV2"},"text-decoration-none fw-normal"]),onClick:n[4]||(n[4]=r=>e.goTo("CatalogV2")),href:"javascript:void(0)"}," Каталог товаров",2)]),t("li",Zt,[t("a",{class:y([{"fw-bold":e.$route.name==="ShopCartV2"},"text-decoration-none fw-normal"]),onClick:n[5]||(n[5]=r=>e.goTo("ShopCartV2")),href:"javascript:void(0)"},[h(" Корзина "),e.cartTotalCount>0?(l(),a("span",te,"("+m(e.cartTotalCount)+")",1)):c("",!0)],2)]),t("li",ee,[t("a",{class:y([{"fw-bold":e.$route.name==="OrdersV2"},"text-decoration-none fw-normal"]),onClick:n[6]||(n[6]=r=>e.goTo("OrdersV2")),href:"javascript:void(0)"}," История заказов",2)]),t("li",oe,[t("a",{class:y([{"fw-bold":e.$route.name==="CashBackV2"},"text-decoration-none fw-normal"]),onClick:n[7]||(n[7]=r=>e.goTo("CashBackV2")),href:"javascript:void(0)"}," CashBack",2)]),t("li",se,[t("a",{class:y([{"fw-bold":e.$route.name==="FeedBackV2"},"text-decoration-none fw-normal"]),onClick:n[8]||(n[8]=r=>e.goTo("FeedBackV2")),href:"javascript:void(0)"}," Оставить отзыв",2)])]),ne,e.bot.company?(l(),a("div",le,[t("ul",ae,[(e.bot.company.phones||[]).length>0?(l(),a("li",ie,ce)):c("",!0),(e.bot.company.phones||[]).length>0?(l(),a("li",me,[t("a",{target:"_blank",href:"tel:"+e.bot.company.phones[0],class:"text-decoration-none fw-bold"},m(e.bot.company.phones[0]||"-"),9,de)])):c("",!0),e.bot.company.links.inst||e.bot.company.links.vk?(l(),a("li",pe,ue)):c("",!0),e.bot.company.links.inst?(l(),a("li",fe,[t("a",{target:"_blank",href:"http://instagram.com/"+e.bot.company.links.inst,style:{"font-size":"12px"},class:"text-primary"},[ye,h(" "+m((e.bot.company.links||{ins:null}).inst||"ссылка"),1)],8,_e)])):c("",!0),(e.bot.company.links||{vk:null}).vk?(l(),a("li",be,[t("a",{target:"_blank",href:"https://vk.com/"+e.bot.company.links.vk,style:{"font-size":"12px"},class:"text-primary"},[ke,h(" "+m(e.bot.company.links.vk||"ссылка"),1)],8,ge)])):c("",!0),e.bot.company.email?(l(),a("li",ve,Fe)):c("",!0),t("li",null,[e.bot.company.email?(l(),a("a",{key:0,href:"mailto:"+e.bot.company.email,class:"text-decoration-none fw-bold"},m(e.bot.company.email),9,Ce)):c("",!0)])])])):c("",!0)])]),t("div",Te,[t("div",Ve,[t("div",$e,[xe,t("div",Se,[k(gt)]),Be])])])],64))}}),Ue={computed:{...F(["getSelf"]),logo(){return`/images-by-bot-id/${this.currentBot.id}/${this.currentBot.image}`},self(){return window.self||null},tg(){return window.Telegram.WebApp},tgUser(){const s=new URLSearchParams(this.tg.initData);return JSON.parse(s.get("user"))},currentBot(){return window.currentBot},qr(){return"https://api.qrserver.com/v1/create-qr-code/?size=450x450&qzone=2&data="+this.link},link(){return"https://t.me/"+this.currentBot.bot_domain+"?start="+btoa("001"+this.self.telegram_chat_id)}},created(){window.currentBot=this.bot.data;const s=window.currentBot.company.schedule||[];if(window.isCorrectSchedule=e=>{if((e||[]).length<7)return!1;let n=!0;return e.forEach(r=>{n=n&&typeof r=="object"}),n},window.isCorrectSchedule(s)){const e=new Date().getDay(),n=new Date().getHours(),r=new Date().getMinutes();let o=s[e-1].start_at||"08:00",f=parseInt(o.split(":")[0]),b=parseInt(o.split(":")[1]),i=s[e-1].end_at||"20:00",d=parseInt(i.split(":")[0]),_=parseInt(i.split(":")[1]),g=!1;f===n&&(g=r>=b),d===n&&(g=r<_),n>f&&n<d&&(g=!0),window.currentBot.company.is_work=!s[e-1].closed&&g}window.currentScript=this.slug_id||null,this.$store.dispatch("loadSelf").then(()=>{window.self=this.getSelf}),this.$notify({title:"Главная",text:"Успешно!",type:"success"})},methods:{open(s){this.tg.openLink(s)}}},ze=Object.assign(Ue,{__name:"MainV2",props:{bot:{type:Object},slug_id:{type:String}},setup(s){return(e,n)=>{const r=w("notifications"),o=w("router-view");return l(),j(je,null,{default:C(()=>[k(r,{position:"top right",width:"100%",speed:"100"}),k(o,{bot:s.bot},null,8,["bot"])]),_:1})}}});export{ze as default};
