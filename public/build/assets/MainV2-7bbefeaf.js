import{L as $,q as l,t as a,v as e,H as p,J as u,D as h,y as m,A as c,F as v,C as T,T as V,P as x,G as F,B as k,O as C,u as B,a2 as S,N as I,x as y,R as w,K as j}from"./index.es-bac3219e.js";import{_ as U}from"./_plugin-vue_export-helper-c27b6911.js";const L={data(){return{companyForm:{id:null,title:null,description:null,address:null,phones:[],links:{vk:null,inst:null,map_link:null},email:null,schedule:[{day:"Воскресенье",start_at:"08:00",end_at:"20:00",closed:!1,closed_comment:"Выходной"},{day:"Понедельник",start_at:"08:00",end_at:"20:00",closed:!1,closed_comment:"Выходной"},{day:"Вторник",start_at:"08:00",end_at:"20:00",closed:!1,closed_comment:"Выходной"},{day:"Среда",start_at:"08:00",end_at:"20:00",closed:!1,closed_comment:"Выходной"},{day:"Четверг",start_at:"08:00",end_at:"20:00",closed:!1,closed_comment:"Выходной"},{day:"Пятница",start_at:"08:00",end_at:"20:00",closed:!1,closed_comment:"Выходной"},{day:"Суббота",start_at:"08:00",end_at:"20:00",closed:!1,closed_comment:"Выходной"}]}}},computed:{currentBot(){return window.currentBot}},mounted(){const s=this.currentBot.company;this.companyForm.id=s.id||null,this.companyForm.title=s.title||null,this.companyForm.description=s.description||null,this.companyForm.email=s.email||null,this.companyForm.address=s.address||null,this.companyForm.phones=s.phones||["+7"];let t=r=>{let o=["inst","vk","map_link"],f=!1,b=0;return Object.keys(r).forEach(i=>{o.indexOf(i)!==-1&&(f=!0,b++)}),f&&b===o.length};this.companyForm.links=t(s.links)?s.links:this.companyForm.links;let n=r=>{if((r||[]).length<7)return!1;let o=!0;return r.forEach(f=>{o=o&&typeof f=="object"}),o};this.companyForm.schedule=n(s.schedule)?s.schedule:this.companyForm.schedule},methods:{submitForm(){let s=new FormData;Object.keys(this.companyForm).forEach(t=>{const n=this.companyForm[t]||"";typeof n=="object"?s.append(t,JSON.stringify(n)):s.append(t,n)}),this.$store.dispatch("updateCompany",{companyForm:s}).then(t=>{this.$notify({title:"Информация о компании",text:"Информация о компании успешно обновлена!",type:"success"}),this.$emit("callback",t.data),window.location.reload()}).catch(t=>{this.$notify({title:"Информация о компании",text:"Ошибка обновления информации о компании",type:"error"})})}}},z={class:"form-floating mb-3"},M={for:"floatingInput"},E={key:0,class:"ml-1",style:{"font-size":"10px"}},q={class:"form-floating"},D={for:"floatingTextarea2"},O={key:0,class:"ml-1",style:{"font-size":"10px"}},A=e("h6",{class:"opacity-75 my-3"},"Контактная информация",-1),N={class:"form-floating mb-2"},H=e("label",{for:"floatingInput"},"Телефон",-1),P={class:"form-floating mb-2"},J=e("label",{for:"floatingInput"},"Инста",-1),R={class:"form-floating mb-2"},W=e("label",{for:"floatingInput"},"Вконтакте",-1),G={class:"form-floating mb-2"},K=e("label",{for:"floatingInput"},"Почта",-1),X=e("h6",{class:"opacity-75 my-3"},"Расположение заведения",-1),Y={class:"form-floating mb-2"},Q={for:"floatingInput"},Z={key:0,class:"ml-1",style:{"font-size":"10px"}},tt={class:"form-floating mb-2"},et=e("label",{for:"floatingInput"},"Виджет с Яндекс.Картой",-1),ot=e("h6",{class:"opacity-75 my-3"},"График работы",-1),st=e("div",{class:"alert alert-light p-2",style:{"font-size":"12px"},role:"alert"},[h(" Укажите график работы вашего заведения. Если в какой-то день ваше заведение "),e("span",{class:"fw-bold"},"закрыто"),h(" - поставьте галочку сбоку от времени и укажите причину. ")],-1),nt={class:"mb-0",style:{"font-size":"12px"}},lt={class:"input-group mb-2"},at={class:"input-group-text"},it=["onUpdate:modelValue"],rt={key:0,class:"form-floating"},ct=["onUpdate:modelValue"],mt=e("label",{for:"floatingInput"},"Начало",-1),dt={key:1,class:"form-floating"},pt=["onUpdate:modelValue"],ht=e("label",{for:"floatingInput"},"Окончание",-1),ut={key:2,class:"form-floating"},ft=["onUpdate:modelValue"],_t=e("label",{for:"floatingInput"},"Причина закрытия",-1),yt=e("button",{style:{"z-index":"100"},type:"submit",class:"btn btn-primary w-100 p-3 mb-3 position-sticky bottom-0"},"Сохранить изменения",-1);function bt(s,t,n,r,o,f){const b=$("mask");return l(),a("form",{onSubmit:t[8]||(t[8]=x((...i)=>f.submitForm&&f.submitForm(...i),["prevent"]))},[e("div",z,[p(e("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=i=>o.companyForm.title=i),maxlength:"255",class:"form-control",id:"floatingInput",placeholder:"name@example.com",required:""},null,512),[[u,o.companyForm.title]]),e("label",M,[h("Название "),(o.companyForm.title||"").length>0?(l(),a("span",E,"("+m(o.companyForm.title.length)+"/255)",1)):c("",!0)])]),e("div",q,[p(e("textarea",{"onUpdate:modelValue":t[1]||(t[1]=i=>o.companyForm.description=i),maxlength:"1000",required:"",class:"form-control",placeholder:"Leave a comment here",id:"floatingTextarea2",style:{height:"200px"}},null,512),[[u,o.companyForm.description]]),e("label",D,[h("Описание "),(o.companyForm.description||"").length>0?(l(),a("span",O,"("+m(o.companyForm.description.length)+"/1000)",1)):c("",!0)])]),A,e("div",N,[p(e("input",{type:"text","onUpdate:modelValue":t[2]||(t[2]=i=>o.companyForm.phones[0]=i),class:"form-control",id:"floatingInput",placeholder:"name@example.com"},null,512),[[b,["+7(###)###-##-##"]],[u,o.companyForm.phones[0]]]),H]),e("div",P,[p(e("input",{type:"text","onUpdate:modelValue":t[3]||(t[3]=i=>o.companyForm.links.inst=i),class:"form-control",id:"floatingInput",placeholder:"name@example.com"},null,512),[[u,o.companyForm.links.inst]]),J]),e("div",R,[p(e("input",{type:"text","onUpdate:modelValue":t[4]||(t[4]=i=>o.companyForm.links.vk=i),class:"form-control",id:"floatingInput",placeholder:"name@example.com"},null,512),[[u,o.companyForm.links.vk]]),W]),e("div",G,[p(e("input",{type:"email","onUpdate:modelValue":t[5]||(t[5]=i=>o.companyForm.email=i),class:"form-control",id:"floatingInput",placeholder:"name@example.com"},null,512),[[u,o.companyForm.email]]),K]),X,e("div",Y,[p(e("input",{type:"text","onUpdate:modelValue":t[6]||(t[6]=i=>o.companyForm.address=i),class:"form-control",id:"floatingInput",placeholder:"name@example.com"},null,512),[[u,o.companyForm.address]]),e("label",Q,[h("Адрес расположения "),(o.companyForm.address||"").length>0?(l(),a("span",Z,"("+m(o.companyForm.address.length)+"/255)",1)):c("",!0)])]),e("div",tt,[p(e("textarea",{"onUpdate:modelValue":t[7]||(t[7]=i=>o.companyForm.links.map_link=i),class:"form-control",placeholder:"Leave a comment here",id:"floatingTextarea2",style:{height:"200px"}},null,512),[[u,o.companyForm.links.map_link]]),et]),ot,st,(l(!0),a(v,null,T(o.companyForm.schedule,(i,d)=>(l(),a(v,null,[e("p",nt,m(o.companyForm.schedule[d].day),1),e("div",lt,[e("div",at,[p(e("input",{class:"form-check-input mt-0","onUpdate:modelValue":_=>o.companyForm.schedule[d].closed=_,type:"checkbox",value:"","aria-label":"Checkbox for following text input"},null,8,it),[[V,o.companyForm.schedule[d].closed]])]),o.companyForm.schedule[d].closed?c("",!0):(l(),a("div",rt,[p(e("input",{type:"time","onUpdate:modelValue":_=>o.companyForm.schedule[d].start_at=_,class:"form-control",id:"floatingInput",placeholder:"name@example.com"},null,8,ct),[[u,o.companyForm.schedule[d].start_at]]),mt])),o.companyForm.schedule[d].closed?c("",!0):(l(),a("div",dt,[p(e("input",{type:"time","onUpdate:modelValue":_=>o.companyForm.schedule[d].end_at=_,class:"form-control",id:"floatingInput",placeholder:"name@example.com"},null,8,pt),[[u,o.companyForm.schedule[d].end_at]]),ht])),o.companyForm.schedule[d].closed?(l(),a("div",ut,[p(e("input",{type:"text","onUpdate:modelValue":_=>o.companyForm.schedule[d].closed_comment=_,class:"form-control",id:"floatingInput",placeholder:"name@example.com"},null,8,ft),[[u,o.companyForm.schedule[d].closed_comment]]),_t])):c("",!0)])],64))),256)),yt],32)}const gt=U(L,[["render",bt]]);const kt=e("title",null,"CashMan - система твоего бизнеса внутри",-1),vt=e("meta",{name:"description",content:"CashMan - система твоего бизнеса внутри"},null,-1),wt={key:0,"data-bs-theme":"dark"},Ft={class:"navbar shadow shadow-sm"},Ct={class:"container flex-row-reverse p-2"},$t={key:0,class:"mb-0 fw-bold d-flex flex-column",style:{"font-size":"12px"}},Tt={key:0,class:"text-primary"},Vt=e("i",{class:"fa-solid fa-location-dot mr-1"},null,-1),xt={key:1,class:"text-primary"},Bt={key:2,class:"small d-flex justify-content-end"},St={href:"javascript:void(0)",class:"text-secondary fw-bold"},It={key:1,class:"mb-0 text-primary",style:{"font-size":"12px"}},jt=e("button",{class:"btn btn-link rounded-0 border-0 p-1",type:"button","data-bs-toggle":"offcanvas","data-bs-target":"#sidebar-menu","aria-controls":"sidebar-menu"},[e("span",{class:"navbar-toggler-icon"})],-1),Ut={class:"text-body-secondary",style:{padding:"0px 0px 90px 0px"}},Lt={class:"container g-2 d-flex justify-content-center flex-column align-items-center"},zt={class:"text-center mb-3"},Mt=["innerHTML"],Et=e("br",null,null,-1),qt={key:0,"data-bs-toggle":"modal","data-bs-target":"#edit-shop-footer-description-modal",href:"javascript:void(0)",class:"text-primary ml-2",style:{"font-size":"12px"}},Dt=e("i",{class:"fa-solid fa-pen-to-square"},null,-1),Ot={key:1,class:"mb-3 text-center"},At=e("i",{class:"fa-solid fa-map-location-dot mr-2"},null,-1),Nt={class:"mb-0"},Ht={class:"d-flex justify-content-center my-3"},Pt=e("i",{class:"fa-solid fa-arrow-up mr-2"},null,-1),Jt={class:"offcanvas offcanvas-start custom-offcanvas",style:{width:"70%","border-radius":"0px 10px 10px 0px"},tabindex:"-1",id:"sidebar-menu","aria-labelledby":"offcanvasExampleLabel"},Rt={class:"offcanvas-header"},Wt={class:"offcanvas-title",id:"offcanvasExampleLabel"},Gt=e("button",{type:"button",class:"btn-close","data-bs-dismiss":"offcanvas","aria-label":"Close"},null,-1),Kt={class:"offcanvas-body"},Xt={class:"list-unstyled"},Yt={class:"p-1"},Qt={class:"p-1"},Zt={class:"p-1"},te={class:"p-1"},ee={key:0,class:"fw-bold"},oe={class:"p-1"},se={class:"p-1"},ne={class:"p-1"},le=e("div",{class:"border-top my-3"},null,-1),ae={key:0,class:"p-2"},ie={class:"list-unstyled"},re={key:0},ce=e("p",{class:"mb-0"},"Телефон",-1),me=[ce],de={key:1,class:"mb-2"},pe=["href"],he={key:2},ue=e("p",{class:"mb-0"},"Ссылки",-1),fe=[ue],_e={key:3},ye=["href"],be=e("i",{class:"fa-brands fa-instagram mr-1"},null,-1),ge={key:4},ke=["href"],ve=e("i",{class:"fa-brands fa-vk mr-1"},null,-1),we={key:5},Fe=e("p",{class:"mb-0"},"Почта",-1),Ce=[Fe],$e=["href"],Te={class:"modal fade",id:"edit-shop-footer-description-modal",tabindex:"-1","aria-labelledby":"edit-shop-footer-description","aria-hidden":"true"},Ve={class:"modal-dialog modal-fullscreen"},xe={class:"modal-content"},Be=e("div",{class:"modal-header"},[e("h1",{class:"modal-title fs-5",id:"exampleModalLabel"},"Редактор"),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),Se={class:"modal-body"},Ie={data(){return{currentTheme:"",themes:[{title:"Тема 3",href:"/theme5.bootstrap.min.css"},{title:"Тема 4",href:"/theme6.bootstrap.min.css"},{title:"Тема 5",href:"/theme8.bootstrap.min.css"},{title:"Тема 6",href:"/theme9.bootstrap.min.css"},{title:"Тема 7",href:"/theme10.bootstrap.min.css"},{title:"Тема 8",href:"/theme11.bootstrap.min.css"},{title:"Тема 9",href:"/theme12.bootstrap.min.css"},{title:"Тема 10",href:"/theme13.bootstrap.min.css"},{title:"Тема 11",href:"/theme14.bootstrap.min.css"},{title:"Тема 12",href:"/theme15.bootstrap.min.css"},{title:"Тема 13",href:"/theme16.bootstrap.min.css"}]}},watch:{$route(s){let t=localStorage.getItem("cashman_global_client_theme")||null;t&&this.$nextTick(()=>{this.currentTheme=t}),this.$preloader.show(),this.$nextTick(()=>{document.body.scrollTop=document.documentElement.scrollTop=0})}},computed:{...F(["getSelf","cartTotalCount"]),tg(){return window.Telegram.WebApp},bot(){return window.currentBot},links(){return{inst:(this.bot.company.links||{inst:null}).inst||null,vk:(this.bot.company.links||{inst:null}).vk||null,map_link:(this.bot.company.links||{inst:null}).map_link||null}}},mounted(){let s=localStorage.getItem("cashman_global_client_theme")||null;s&&this.$nextTick(()=>{this.currentTheme=s}),this.changeTheme(this.tg.colorScheme),this.tg.BackButton.show(),this.tg.BackButton.onClick(()=>{document.querySelectorAll('[data-bs-dismiss="modal"]').forEach(t=>t.click()),this.$router.back()})},methods:{switchTheme(s){let t=document.querySelector("#theme");t.href=this.themes[s].href,localStorage.setItem("cashman_global_client_theme",t.href),this.$nextTick(()=>{this.currentTheme=t.href})},goTo(s){this.$router.push({name:s})},changeTheme(s){document.querySelectorAll("[data-bs-theme]").forEach(n=>{n.setAttribute("data-bs-theme",s)})},scrollTop(){window.scrollTo(0,80)},openLink(s){this.tg.openLink(s,{try_instant_view:!0})},closeShop(){this.tg.close()}}},je=Object.assign(Ie,{__name:"V2Layout",setup(s){return(t,n)=>(l(),a(v,null,[k(B(S),null,{default:C(()=>[kt,vt]),_:1}),t.$route.meta.hide_menu?c("",!0):(l(),a("header",wt,[e("div",Ft,[e("div",Ct,[t.bot.company?(l(),a("p",$t,[t.bot.company.address?(l(),a("span",Tt,[Vt,h(" "+m(t.bot.company.address),1)])):(l(),a("span",xt,m(t.bot.title||"Магазин"),1)),(t.bot.company.phones||[]).length>0?(l(),a("span",Bt,[e("a",St,m(t.bot.company.phones[0]),1)])):c("",!0)])):(l(),a("p",It,m(t.bot.title||"Бот"),1)),jt])])])),I(t.$slots,"default"),e("footer",Ut,[e("div",Lt,[t.$route.name!="FeedBackV2"?(l(),a("button",{key:0,onClick:n[0]||(n[0]=r=>t.goTo("FeedBackV2")),class:"btn btn-link mb-2 w-100 p-3 text-primary"},"Обратная связь ")):c("",!0),e("p",zt,[e("span",{innerHTML:t.bot.company.description},null,8,Mt),Et,(t.getSelf||{is_admin:!1}).is_admin?(l(),a("a",qt,[Dt,h(" редактировать")])):c("",!0)]),t.bot.company.address?(l(),a("p",Ot,[At,h(m(t.bot.company.address),1)])):c("",!0),e("p",Nt,m(t.bot.company.title)+"©"+m(new Date().getFullYear()),1),e("p",Ht,[e("a",{href:"javascript:void(0)",onClick:n[1]||(n[1]=(...r)=>t.scrollTop&&t.scrollTop(...r))},[Pt,h("Вернуться наверх")])])])]),e("div",Jt,[e("div",Rt,[e("h6",Wt,m(t.bot.title||"Магазин"),1),Gt]),e("div",Kt,[e("ul",Xt,[e("li",Yt,[e("a",{class:y([{"fw-bold":t.$route.name==="MenuV2"},"text-decoration-none fw-normal"]),onClick:n[2]||(n[2]=r=>t.goTo("MenuV2")),href:"javascript:void(0)"}," Главное меню",2)]),e("li",Qt,[e("a",{class:y([{"fw-bold":t.$route.name==="ProfileV2"},"text-decoration-none fw-normal"]),onClick:n[3]||(n[3]=r=>t.goTo("ProfileV2")),href:"javascript:void(0)"}," Профиль",2)]),e("li",Zt,[e("a",{class:y([{"fw-bold":t.$route.name==="CatalogV2"},"text-decoration-none fw-normal"]),onClick:n[4]||(n[4]=r=>t.goTo("CatalogV2")),href:"javascript:void(0)"}," Каталог товаров",2)]),e("li",te,[e("a",{class:y([{"fw-bold":t.$route.name==="ShopCartV2"},"text-decoration-none fw-normal"]),onClick:n[5]||(n[5]=r=>t.goTo("ShopCartV2")),href:"javascript:void(0)"},[h(" Корзина "),t.cartTotalCount>0?(l(),a("span",ee,"("+m(t.cartTotalCount)+")",1)):c("",!0)],2)]),e("li",oe,[e("a",{class:y([{"fw-bold":t.$route.name==="OrdersV2"},"text-decoration-none fw-normal"]),onClick:n[6]||(n[6]=r=>t.goTo("OrdersV2")),href:"javascript:void(0)"}," История заказов",2)]),e("li",se,[e("a",{class:y([{"fw-bold":t.$route.name==="CashBackV2"},"text-decoration-none fw-normal"]),onClick:n[7]||(n[7]=r=>t.goTo("CashBackV2")),href:"javascript:void(0)"}," CashBack",2)]),e("li",ne,[e("a",{class:y([{"fw-bold":t.$route.name==="FeedBackV2"},"text-decoration-none fw-normal"]),onClick:n[8]||(n[8]=r=>t.goTo("FeedBackV2")),href:"javascript:void(0)"}," Оставить отзыв",2)])]),le,t.bot.company?(l(),a("div",ae,[e("ul",ie,[(t.bot.company.phones||[]).length>0?(l(),a("li",re,me)):c("",!0),(t.bot.company.phones||[]).length>0?(l(),a("li",de,[e("a",{target:"_blank",href:"tel:"+t.bot.company.phones[0],class:"text-decoration-none fw-bold"},m(t.bot.company.phones[0]||"-"),9,pe)])):c("",!0),t.links.inst||t.links.vk?(l(),a("li",he,fe)):c("",!0),t.links.inst?(l(),a("li",_e,[e("a",{target:"_blank",href:"http://instagram.com/"+t.links.inst,style:{"font-size":"12px"},class:"text-primary"},[be,h(" "+m(t.links.inst||"ссылка"),1)],8,ye)])):c("",!0),t.links.vk?(l(),a("li",ge,[e("a",{target:"_blank",href:"https://vk.com/"+t.links.vk,style:{"font-size":"12px"},class:"text-primary"},[ve,h(" "+m(t.links.vk||"ссылка"),1)],8,ke)])):c("",!0),t.bot.company.email?(l(),a("li",we,Ce)):c("",!0),e("li",null,[t.bot.company.email?(l(),a("a",{key:0,href:"mailto:"+t.bot.company.email,class:"text-decoration-none fw-bold"},m(t.bot.company.email),9,$e)):c("",!0)])])])):c("",!0)])]),e("div",Te,[e("div",Ve,[e("div",xe,[Be,e("div",Se,[k(gt)])])])])],64))}}),Ue={computed:{...F(["getSelf"]),logo(){return`/images-by-bot-id/${this.currentBot.id}/${this.currentBot.image}`},self(){return window.self||null},tg(){return window.Telegram.WebApp},tgUser(){const s=new URLSearchParams(this.tg.initData);return JSON.parse(s.get("user"))},currentBot(){return window.currentBot},qr(){return"https://api.qrserver.com/v1/create-qr-code/?size=450x450&qzone=2&data="+this.link},link(){return"https://t.me/"+this.currentBot.bot_domain+"?start="+btoa("001"+this.self.telegram_chat_id)}},created(){window.currentBot=this.bot.data;const s=window.currentBot.company.schedule||[];if(window.isCorrectSchedule=t=>{if((t||[]).length<7)return!1;let n=!0;return t.forEach(r=>{n=n&&typeof r=="object"}),n},window.isCorrectSchedule(s)&&((!s||(s||[]).length===0)&&(window.currentBot.company.is_work=!0),s&&(s||[]).length>0)){console.log(s);const t=new Date().getDay();console.log("day=>",t);const n=new Date().getHours(),r=new Date().getMinutes();let o=s[t].start_at||"08:00",f=parseInt(o.split(":")[0]),b=parseInt(o.split(":")[1]),i=s[t].end_at||"20:00",d=parseInt(i.split(":")[0]),_=parseInt(i.split(":")[1]),g=!1;f===n&&(g=r>=b),d===n&&(g=r<_),n>f&&n<d&&(g=!0),window.currentBot.company.is_work=!s[t].closed&&g}window.currentScript=this.slug_id||null,this.$store.dispatch("loadSelf").then(()=>{window.self=this.getSelf}),this.$notify({title:"Главная",text:"Успешно!",type:"success"})},methods:{open(s){this.tg.openLink(s)}}},Me=Object.assign(Ue,{__name:"MainV2",props:{bot:{type:Object},slug_id:{type:String}},setup(s){return(t,n)=>{const r=w("notifications"),o=w("router-view");return l(),j(je,null,{default:C(()=>[k(r,{position:"top right",width:"100%",speed:"100"}),k(o,{bot:s.bot},null,8,["bot"])]),_:1})}}});export{Me as default};
