import{_,c as u,L as p,b as y,a as h,I as k,d as v,e as $,f,g,h as C,i as w,j as B}from"./BotCreator-8ee36efa.js";import{o,c as l,e as b,d as a,a as s,f as d,m as E,b as c,j as T,u as M,t as D,n as m,F as L,X as j,z as N}from"./app-c30e5ab1.js";import"./_plugin-vue_export-helper-c27b6911.js";import"./Pagination-7d9128ef.js";const V={class:"row"},W={key:0,class:"card mb-3 p-0"},A=s("div",{class:"card-header"},[s("h3",null,"Шаг 1: найдите или создайте компанию")],-1),I={key:0,class:"card-body"},O=s("h5",{class:"mt-2 mb-2"},"Найдите существующую компанию",-1),z=s("h5",{class:"mb-2"},"или создайте новую компанию",-1),F={key:1,class:"card-body"},S=s("div",{class:"alert alert-success",role:"alert"}," Отлично! Шаг создания компании пройден! Далее следует приступить к следующим шагам! ",-1),G=[S],X={key:1,class:"card mb-3 p-0"},q=s("div",{class:"card-header"},[s("h3",null,"Шаг 2: Добавьте локации заведений (не объязательно)")],-1),H={key:0,class:"card-body"},J={class:"alert alert-success",role:"alert"},K={key:1,class:"card-body"},P=s("div",{class:"alert alert-warning",role:"alert"}," Внимание! Вы еще не справились с прошлыми шагами! ",-1),Q=[P],R={key:2,class:"card-body"},U=s("div",{class:"alert alert-success",role:"alert"}," Отлично! Вы создалии локации в завдении! Приступаем к следующим шагам! ",-1),Y=[U],Z={key:2,class:"card mb-3 p-0"},x=s("div",{class:"card-header"},[s("h3",null,"Шаг 3: Добавьте бота ")],-1),ss={key:0,class:"card-body"},ts={class:"alert alert-success",role:"alert"},os=s("h5",{class:"mt-2 mb-2"},"Найдите существующего бота",-1),es=s("h5",{class:"mb-2"},"или создайте нового бота",-1),as={key:1,class:"card-body"},ls=s("div",{class:"alert alert-warning",role:"alert"}," Внимание! Вы еще не справились с прошлыми шагами! ",-1),ns=[ls],is={key:2,class:"card-body"},ds=s("div",{class:"alert alert-success",role:"alert"}," Отлично! Бот создан! ",-1),cs=[ds],rs={key:3,class:"card mb-3 p-0"},bs=s("div",{class:"card-header"},[s("h3",null,"Шаг 4: Добавьте в бота меню")],-1),ms={key:0,class:"card-body"},hs={class:"alert alert-success",role:"alert"},_s={key:1,class:"card-body"},us=s("div",{class:"alert alert-warning",role:"alert"}," Внимание! Вы еще не справились с прошлыми шагами! ",-1),ps=[us],ys={key:2,class:"card-body"},ks={class:"alert alert-success",role:"alert"},vs={key:4,class:"card mb-3 p-0"},$s=s("div",{class:"card-header"},[s("h3",null,"Шаг 5: Обновите зависимости веб-хуков")],-1),fs={class:"card-body"},gs={class:"row"},Cs=s("div",{class:"alert alert-warning",role:"alert"},[s("strong",null,"Важно!"),d(" новые боты начнут работать только после того, как вы обновите зависимости! ")],-1),ws={class:"col-12 mb-3"},Bs={class:"col-12"},Es={data(){return{step:0,load:!1,company:null,location:null,bot:null}},methods:{reloadWebhooks(){axios.get("/bot/register-webhooks").then(()=>{this.$notify({title:"Конструктор ботов",text:"Зависимости успешно обновлены!",type:"success"})})},reset(){this.step=0,this.company=null,this.bot=null},skip(){this.step++},companyListCallback(n){this.load=!0,this.company=n,this.$nextTick(()=>{this.load=!1})},companyCallback(n){this.step++,this.load=!0,this.$nextTick(()=>{this.load=!1}),document.documentElement.scrollTop=0},locationCallback(){this.step++,this.load=!1,document.documentElement.scrollTop=0},botListCallback(n){this.load=!0,this.bot=n,this.$nextTick(()=>{this.load=!1})},botCallback(n){this.step++,this.bot=n,document.documentElement.scrollTop=0},imageMenuCallback(n){this.step++,document.documentElement.scrollTop=0}}},Ts=Object.assign(Es,{__name:"InitialStepper",setup(n){return(t,e)=>(o(),l("div",V,[t.step===0?(o(),l("div",W,[A,t.step===0?(o(),l("div",I,[O,t.load?a("",!0):(o(),b(_,{key:0,onCallback:t.companyListCallback},null,8,["onCallback"])),z,t.load?a("",!0):(o(),b(u,{key:1,company:t.company,onCallback:t.companyCallback},null,8,["company","onCallback"]))])):(o(),l("div",F,G))])):a("",!0),t.step===1?(o(),l("div",X,[q,t.step===1?(o(),l("div",H,[s("div",J,[d(" Если нет необходимости в локациях, вы можете пропустить данный шаг "),s("button",{type:"button",class:"btn btn-primary",onClick:e[0]||(e[0]=(...i)=>t.skip&&t.skip(...i))},"Пропустить "),d(" или же вы можете вернуться на прошлый шаг "),s("button",{type:"button",class:"btn btn-primary",onClick:e[1]||(e[1]=(...i)=>t.reset&&t.reset(...i))},"Начать заново ")]),t.company?(o(),b(p,{key:0,"company-id":t.company.id,onCallback:t.locationCallback},null,8,["company-id","onCallback"])):a("",!0)])):a("",!0),t.step<1?(o(),l("div",K,Q)):a("",!0),t.step>1?(o(),l("div",R,Y)):a("",!0)])):a("",!0),t.step===2?(o(),l("div",Z,[x,t.step===2?(o(),l("div",ss,[s("div",ts,[d(" При необходимости вы можете начать по новой "),s("button",{type:"button",class:"btn btn-primary",onClick:e[2]||(e[2]=(...i)=>t.reset&&t.reset(...i))},"Начать заново ")]),os,t.company?(o(),b(y,{key:0,"company-id":t.company.id,onCallback:t.botListCallback},null,8,["company-id","onCallback"])):a("",!0),es,t.bot&&t.company&&!t.load?(o(),b(h,{key:1,bot:t.bot,"company-id":t.company.id,onCallback:t.botCallback},null,8,["bot","company-id","onCallback"])):t.bot==null&&t.company&&!t.load?(o(),b(h,{key:2,"company-id":t.company.id,onCallback:t.botCallback},null,8,["company-id","onCallback"])):a("",!0)])):a("",!0),t.step<2?(o(),l("div",as,ns)):a("",!0),t.step>2?(o(),l("div",is,cs)):a("",!0)])):a("",!0),t.step===3?(o(),l("div",rs,[bs,t.step===3?(o(),l("div",ms,[s("div",hs,[d(" При необходимости вы можете начать по новой "),s("button",{type:"button",class:"btn btn-primary",onClick:e[3]||(e[3]=(...i)=>t.reset&&t.reset(...i))},"Начать заново ")]),t.bot?(o(),b(k,{key:0,"bot-id":t.bot.id,onCallback:t.imageMenuCallback},null,8,["bot-id","onCallback"])):a("",!0)])):a("",!0),t.step<3?(o(),l("div",_s,ps)):a("",!0),t.step>3?(o(),l("div",ys,[s("div",ks,[d(" Отлично! Все шаги выполнены "),s("button",{type:"button",class:"btn btn-primary",onClick:e[4]||(e[4]=(...i)=>t.reset&&t.reset(...i))},"Начать заново ")])])):a("",!0)])):a("",!0),t.step===4?(o(),l("div",vs,[$s,s("div",fs,[s("div",gs,[Cs,s("div",ws,[s("a",{class:"btn btn-outline-success w-100",onClick:e[5]||(e[5]=(...i)=>t.reloadWebhooks&&t.reloadWebhooks(...i))},"Обновить зависимости")]),s("div",Bs,[s("a",{onClick:e[6]||(e[6]=(...i)=>t.reset&&t.reset(...i)),class:"btn btn-outline-primary w-100"},"Начать заново")])])])])):a("",!0)]))}});const Ms=s("title",null,"Административная панель",-1),Ds=s("meta",{name:"description",content:"Административная панель<"},null,-1),Ls={class:"navbar navbar-dark sticky-top bg-dark flex-md-nowrap p-0 shadow"},js=s("a",{class:"navbar-brand col-md-3 col-lg-2 me-0 px-3 fs-6",href:"#"},"CashMan",-1),Ns=s("button",{class:"navbar-toggler position-absolute d-md-none collapsed",type:"button","data-bs-toggle":"collapse","data-bs-target":"#sidebarMenu","aria-controls":"sidebarMenu","aria-expanded":"false","aria-label":"Toggle navigation"},[s("span",{class:"navbar-toggler-icon"})],-1),Vs={key:0,class:"navbar-nav"},Ws={class:"nav-item text-nowrap"},As={class:"bot-label d-flex justify-between align-items-center"},Is={class:"p-2 text-white"},Os=["href"],zs=s("i",{class:"fa-solid fa-xmark text-white"},null,-1),Fs=[zs],Ss=s("div",{class:"navbar-nav d-none d-md-block"},[s("div",{class:"nav-item text-nowrap"},[s("a",{class:"nav-link px-3",href:"/logout"},"Выход")])],-1),Gs={class:"container-fluid"},Xs={class:"row"},qs={id:"sidebarMenu",class:"col-md-3 col-lg-2 d-md-block bg-body-tertiary sidebar",style:{}},Hs={class:"position-sticky pt-3 sidebar-sticky"},Js={class:"nav flex-column"},Ks={class:"nav-item"},Ps=s("i",{class:"fa-regular fa-building"},null,-1),Qs={class:"nav-item"},Rs=s("i",{class:"fa-regular fa-building"},null,-1),Us={class:"nav-item"},Ys=s("i",{class:"fa-brands fa-android"},null,-1),Zs={class:"nav-item"},xs=s("i",{class:"fa-solid fa-robot"},null,-1),st={class:"nav-item p-2"},tt=["disabled"],ot={key:0,class:"col-md-9 ms-sm-auto col-lg-10 px-md-4"},et={class:"pt-3 pb-2 mb-3 border-bottom"},at=s("h1",{class:"mb-3 mt-3"},"Создание нового клиента",-1),lt={key:1,class:"col-md-9 ms-sm-auto col-lg-10 px-md-4"},nt={class:"pt-3 pb-2 mb-3 border-bottom"},it=s("h1",{class:"mb-3 mt-3"},"Редактор компаний",-1),dt=s("div",{class:"alert alert-success mb-2",role:"alert"}," Выберите компанию из списка! ",-1),ct={key:2,class:"col-md-9 ms-sm-auto col-lg-10 px-md-4"},rt={class:"pt-3 pb-2 mb-3 border-bottom"},bt=s("h1",{class:"mb-3 mt-3"},"Редактор локаций",-1),mt=s("div",{class:"alert alert-success mb-2",role:"alert"}," Выберите компанию из списка! ",-1),ht={key:3,class:"col-md-9 ms-sm-auto col-lg-10 px-md-4"},_t={class:"pt-3 pb-2 mb-3 border-bottom"},ut=s("h1",{class:"mb-3 mt-3"},"Редактор ботов",-1),pt=s("div",{class:"alert alert-success mb-2",role:"alert"}," Выберите бота из списка! ",-1),yt={key:4,class:"col-md-9 ms-sm-auto col-lg-10 px-md-4"},kt={class:"pt-3 pb-2 mb-3 border-bottom"},vt=s("h1",{class:"mb-3 mt-3"},"Создание бота",-1),$t=s("div",{class:"alert alert-success mb-2",role:"alert"}," Выберите компанию из списка! ",-1),ft={key:5,class:"col-md-9 ms-sm-auto col-lg-10 px-md-4"},gt={class:"pt-3 pb-2 mb-3 border-bottom"},Ct=s("h1",{class:"mb-3 mt-3"},"Редактор меню",-1),wt=s("div",{class:"alert alert-success mb-2",role:"alert"}," Выберите бота из списка! ",-1),Bt={key:6,class:"col-md-9 ms-sm-auto col-lg-10 px-md-4"},Et={class:"pt-3 pb-2 mb-3 border-bottom"},Tt=s("h1",{class:"mb-3 mt-3"},"Конструктор страниц",-1),Mt=s("div",{class:"alert alert-success mb-2",role:"alert"}," Выберите бота из списка! ",-1),Dt={key:7,class:"col-md-9 ms-sm-auto col-lg-10 px-md-4"},Lt={class:"pt-3 pb-2 mb-3 border-bottom"},jt=s("h1",{class:"mb-3 mt-3"},"Конструктор диалогов",-1),Nt=s("div",{class:"alert alert-success mb-2",role:"alert"}," Выберите бота из списка! ",-1),Vt={data(){return{tab:0,load:!1,bot:null}},computed:{...E(["getErrors","getCurrentBot"])},watch:{getErrors:function(n,t){Object.keys(n).forEach(e=>{this.$notify({title:"Конструктор ботов",text:n[e],type:"warn"})})}},mounted(){this.loadCurrentBot(),window.addEventListener("store_current_bot-change-event",n=>{this.bot=this.getCurrentBot})},methods:{loadCurrentBot(n=null){this.$store.dispatch("updateCurrentBot",{bot:n}).then(()=>{this.bot=this.getCurrentBot})},resetBot(){this.$store.dispatch("resetCurrentBot").then(()=>{this.bot=null})},stopAllDialogs(){this.$store.dispatch("stopDialogs").then(n=>{this.$notify({title:"Конструктор ботов",text:"Все диалоги остановлены",type:"success"})}).catch(n=>{})},reloadWebhooks(){this.load=!0,this.$notify({title:"Конструктор ботов",text:"Процедура обновления зависимостей началась"}),axios.get("/bot/register-webhooks").then(()=>{this.load=!1,this.$notify({title:"Конструктор ботов",text:"Зависимости успешно обновлены!",type:"success"})}).catch(()=>{this.load=!1,this.$notify({title:"Конструктор ботов",text:"Неудалось обновить зависимости",type:"error"})})}}},zt=Object.assign(Vt,{__name:"Dashboard",setup(n){return(t,e)=>{const i=N("notifications");return o(),l(L,null,[c(M(j),null,{default:T(()=>[Ms,Ds]),_:1}),c(i,{position:"top right"}),s("header",Ls,[js,Ns,t.bot?(o(),l("div",Vs,[s("div",Ws,[s("div",As,[s("span",Is,[d("У вас выбран бот: "),s("a",{href:"https://t.me/"+(t.bot.bot_domain||"botfather"),target:"_blank"},D(t.bot.bot_domain||"Без имени"),9,Os)]),s("span",{onClick:e[0]||(e[0]=(...r)=>t.resetBot&&t.resetBot(...r)),class:"p-2 text-white"},Fs)])])])):a("",!0),Ss]),s("div",Gs,[s("div",Xs,[s("nav",qs,[s("div",Hs,[s("ul",Js,[s("li",Ks,[s("a",{class:m(["nav-link",{active:t.tab===1}]),href:"#company-editor","aria-current":"page",onClick:e[1]||(e[1]=r=>t.tab=1)},[Ps,d(" Создание компании ")],2)]),s("li",Qs,[s("a",{class:m(["nav-link",{active:t.tab===8}]),href:"#company-editor","aria-current":"page",onClick:e[2]||(e[2]=r=>t.tab=8)},[Rs,d(" Создание редактирование компании ")],2)]),s("li",Us,[s("a",{class:m(["nav-link",{active:t.tab===7}]),href:"#new-bot","aria-current":"page",onClick:e[3]||(e[3]=r=>t.tab=7)},[Ys,d(" Создание нового бота ")],2)]),s("li",Zs,[s("a",{class:m(["nav-link",{active:t.tab===3}]),href:"#bot-editor","aria-current":"page",onClick:e[4]||(e[4]=r=>t.tab=3)},[xs,d(" Редактирование ботов ")],2)]),s("li",st,[s("button",{type:"button",disabled:t.load,class:"nav-lin btn btn-outline-success w-100",onClick:e[5]||(e[5]=(...r)=>t.stopAllDialogs&&t.stopAllDialogs(...r))},"Остановить все диалоги",8,tt)])])])]),t.tab===0?(o(),l("main",ot,[s("div",et,[at,c(Ts)])])):a("",!0),t.tab===1?(o(),l("main",lt,[s("div",nt,[it,dt,c(v)])])):a("",!0),t.tab===2?(o(),l("main",ct,[s("div",rt,[bt,mt,c($)])])):a("",!0),t.tab===3?(o(),l("main",ht,[s("div",_t,[ut,pt,c(f)])])):a("",!0),t.tab===7?(o(),l("main",yt,[s("div",kt,[vt,$t,c(g)])])):a("",!0),t.tab===4?(o(),l("main",ft,[s("div",gt,[Ct,wt,c(C)])])):a("",!0),t.tab===5?(o(),l("main",Bt,[s("div",Et,[Tt,Mt,c(w)])])):a("",!0),t.tab===6?(o(),l("main",Dt,[s("div",Lt,[jt,Nt,c(B)])])):a("",!0)])])],64)}}});export{zt as default};
