import{m as p,o as l,c as r,b as c,l as _,u as m,X as v,a as t,t as d,d as h,n as o,f as n,y as b,F as f,h as g,z as y}from"./app-3bc4e1d2.js";const C=t("title",null,"Административная панель",-1),k=t("meta",{name:"description",content:"Административная панель<"},null,-1),w=g('<header class="navbar navbar-dark sticky-top bg-dark flex-md-nowrap p-0 shadow"><a class="navbar-brand col-md-3 col-lg-2 me-0 px-3 fs-6" href="#">CashMan</a><button class="navbar-toggler position-absolute d-md-none collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#sidebarMenu" aria-controls="sidebarMenu" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="navbar-nav d-none d-md-block"><div class="nav-item text-nowrap"><a class="nav-link px-3" href="/logout">Выход</a></div></div></header>',1),B={class:"container-fluid"},x={class:"row"},$={id:"sidebarMenu",class:"col-md-3 col-lg-2 d-md-block bg-body-tertiary sidebar",style:{}},E={class:"position-sticky pt-3 sidebar-sticky"},M={class:"nav flex-column"},N={key:0,class:"nav-item p-2"},V={class:"card border-info"},j={class:"card-body"},L=t("p",null,"У вас выбран клиент:",-1),A={class:"d-flex justify-content-between w-100"},D=t("i",{class:"fa-solid fa-xmark"},null,-1),S=[D],z={key:1,class:"nav-item p-2"},F={class:"card border-info"},O={class:"card-body"},T=t("p",null,"У вас выбран бот:",-1),G={class:"d-flex justify-content-between w-100"},W=["href"],X=t("i",{class:"fa-solid fa-xmark"},null,-1),q=[X],H={class:"nav-item"},I=t("i",{class:"fa-solid fa-house"},null,-1),J={class:"nav-item"},K=t("i",{class:"fa-solid fa-mug-hot"},null,-1),P={class:"nav-item"},Q=t("i",{class:"fa-solid fa-robot"},null,-1),R={class:"nav-item active"},U=t("i",{class:"fa-solid fa-users"},null,-1),Y={class:"nav-item"},Z=t("i",{class:"fa-regular fa-paper-plane"},null,-1),tt={class:"col-md-9 ms-sm-auto col-lg-10 px-md-4"},et={class:"pt-3 pb-2 mb-3 border-bottom"},st={props:["active"],data(){return{load:!1,bot:null,company:null}},computed:{...p(["getErrors","getCurrentBot","getCurrentCompany"])},watch:{getErrors:function(e,s){Object.keys(e).forEach(a=>{this.$notify({title:"Конструктор ботов",text:e[a],type:"warn"})})}},mounted(){this.loadCurrentCompany(),this.loadCurrentBot(),window.addEventListener("store_current_bot-change-event",e=>{this.bot=this.getCurrentBot}),window.addEventListener("store_current_company-change-event",e=>{this.company=this.getCurrentCompany})},methods:{loadCurrentCompany(e=null){this.$store.dispatch("updateCurrentCompany",{company:e}).then(()=>{this.company=this.getCurrentCompany})},loadCurrentBot(e=null){this.$store.dispatch("updateCurrentBot",{bot:e}).then(()=>{this.bot=this.getCurrentBot})},resetCompany(){this.$store.dispatch("resetCurrentCompany").then(()=>{this.company=null,window.dispatchEvent(new CustomEvent("store_current_company-change-event"))})},resetBot(){this.$store.dispatch("resetCurrentBot").then(()=>{this.bot=null,window.dispatchEvent(new CustomEvent("store_current_bot-change-event"))})},stopAllDialogs(){this.$store.dispatch("stopDialogs").then(e=>{this.$notify({title:"Конструктор ботов",text:"Все диалоги остановлены",type:"success"})}).catch(e=>{})},reloadWebhooks(){this.load=!0,this.$notify({title:"Конструктор ботов",text:"Процедура обновления зависимостей началась"}),axios.get("/bot/register-webhooks").then(()=>{this.load=!1,this.$notify({title:"Конструктор ботов",text:"Зависимости успешно обновлены!",type:"success"})}).catch(()=>{this.load=!1,this.$notify({title:"Конструктор ботов",text:"Неудалось обновить зависимости",type:"error"})})}}},ot=Object.assign(st,{__name:"MainAdminLayout",setup(e){return(s,a)=>{const u=y("notifications");return l(),r(f,null,[c(m(v),null,{default:_(()=>[C,k]),_:1}),c(u,{position:"top right"}),w,t("div",B,[t("div",x,[t("nav",$,[t("div",E,[t("ul",M,[s.company?(l(),r("li",N,[t("div",V,[t("div",j,[L,t("div",A,[t("span",null,d(s.company.title||"Без имени"),1),t("span",{onClick:a[0]||(a[0]=(...i)=>s.resetCompany&&s.resetCompany(...i))},S)])])])])):h("",!0),s.bot?(l(),r("li",z,[t("div",F,[t("div",O,[T,t("div",G,[t("span",null,[t("a",{href:"https://t.me/"+(s.bot.bot_domain||"botfather"),target:"_blank"},d(s.bot.bot_domain||"Без имени"),9,W)]),t("span",{onClick:a[1]||(a[1]=(...i)=>s.resetBot&&s.resetBot(...i))},q)])])])])):h("",!0),t("li",H,[t("a",{class:o(["nav-link",{active:e.active==3}]),href:"/dashboard","aria-current":"page"},[I,n(" Главная страница ")],2)]),t("li",J,[t("a",{class:o(["nav-link",{active:e.active==0}]),href:"/company-page","aria-current":"page"},[K,n(" Клиенты ")],2)]),t("li",P,[t("a",{class:o(["nav-link",{active:e.active==1}]),href:"/bot-page","aria-current":"page"},[Q,n(" Боты ")],2)]),t("li",R,[t("a",{class:o(["nav-link",{active:e.active==2}]),href:"/user-page","aria-current":"page"},[U,n(" Пользователи ")],2)]),t("li",Y,[t("a",{class:o(["nav-link",{active:e.active==4}]),href:"/mail-page","aria-current":"page"},[Z,n(" Рассылки сообщений ")],2)])])])]),t("main",tt,[t("div",et,[b(s.$slots,"default")])])])])],64)}}});export{ot as _};
