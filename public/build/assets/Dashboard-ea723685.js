/* empty css                                                    */import{_ as $}from"./CompanyList-79a37d9b.js";import{a as _,_ as k,I as f,b as G,c as L,d as T,e as j}from"./BotList-970d8e50.js";import{o as a,c as e,e as d,d as n,a as s,f as c,m as b,b as r,w as C,v,F as m,r as y,t as h,n as p,g as D,h as E,j as O,u as F,X as M,z as I}from"./app-27d48897.js";import{_ as w,L as B}from"./CompanyForm-6e0be4b6.js";import{P as S}from"./Pagination-7fb1d793.js";import"./_plugin-vue_export-helper-c27b6911.js";const V={class:"row"},P={key:0,class:"card mb-3 p-0"},N=s("div",{class:"card-header"},[s("h3",null,"Шаг 1: найдите или создайте компанию")],-1),A={key:0,class:"card-body"},W=s("h5",{class:"mt-2 mb-2"},"Найдите существующую компанию",-1),z=s("h5",{class:"mb-2"},"или создайте новую компанию",-1),U={key:1,class:"card-body"},q=s("div",{class:"alert alert-success",role:"alert"}," Отлично! Шаг создания компании пройден! Далее следует приступить к следующим шагам! ",-1),J=[q],X={key:1,class:"card mb-3 p-0"},Z=s("div",{class:"card-header"},[s("h3",null,"Шаг 2: Добавьте локации заведений (не объязательно)")],-1),H={key:0,class:"card-body"},K={class:"alert alert-success",role:"alert"},Q={key:1,class:"card-body"},R=s("div",{class:"alert alert-warning",role:"alert"}," Внимание! Вы еще не справились с прошлыми шагами! ",-1),Y=[R],x={key:2,class:"card-body"},tt=s("div",{class:"alert alert-success",role:"alert"}," Отлично! Вы создалии локации в завдении! Приступаем к следующим шагам! ",-1),st=[tt],ot={key:2,class:"card mb-3 p-0"},at=s("div",{class:"card-header"},[s("h3",null,"Шаг 3: Добавьте бота ")],-1),et={key:0,class:"card-body"},lt={class:"alert alert-success",role:"alert"},nt=s("h5",{class:"mt-2 mb-2"},"Найдите существующего бота",-1),it=s("h5",{class:"mb-2"},"или создайте нового бота",-1),dt={key:1,class:"card-body"},rt=s("div",{class:"alert alert-warning",role:"alert"}," Внимание! Вы еще не справились с прошлыми шагами! ",-1),ct=[rt],ut={key:2,class:"card-body"},bt=s("div",{class:"alert alert-success",role:"alert"}," Отлично! Бот создан! ",-1),ht=[bt],mt={key:3,class:"card mb-3 p-0"},pt=s("div",{class:"card-header"},[s("h3",null,"Шаг 4: Добавьте в бота меню")],-1),_t={key:0,class:"card-body"},gt={class:"alert alert-success",role:"alert"},yt={key:1,class:"card-body"},kt=s("div",{class:"alert alert-warning",role:"alert"}," Внимание! Вы еще не справились с прошлыми шагами! ",-1),$t=[kt],Ct={key:2,class:"card-body"},vt={class:"alert alert-success",role:"alert"},ft={key:4,class:"card mb-3 p-0"},wt=s("div",{class:"card-header"},[s("h3",null,"Шаг 5: Обновите зависимости веб-хуков")],-1),Bt={class:"card-body"},Gt={class:"row"},Lt=s("div",{class:"alert alert-warning",role:"alert"},[s("strong",null,"Важно!"),c(" новые боты начнут работать только после того, как вы обновите зависимости! ")],-1),Tt={class:"col-12 mb-3"},jt={class:"col-12"},Dt={data(){return{step:0,load:!1,company:null,location:null,bot:null}},methods:{reloadWebhooks(){axios.get("/bot/register-webhooks").then(()=>{this.$notify({title:"Конструктор ботов",text:"Зависимости успешно обновлены!",type:"success"})})},reset(){this.step=0,this.company=null,this.bot=null},skip(){this.step++},companyListCallback(o){this.load=!0,this.company=o,this.$nextTick(()=>{this.load=!1})},companyCallback(o){this.step++,this.load=!0,this.$nextTick(()=>{this.load=!1}),document.documentElement.scrollTop=0},locationCallback(){this.step++,this.load=!1,document.documentElement.scrollTop=0},botListCallback(o){this.load=!0,this.bot=o,this.$nextTick(()=>{this.load=!1})},botCallback(o){this.step++,this.bot=o,document.documentElement.scrollTop=0},imageMenuCallback(o){this.step++,document.documentElement.scrollTop=0}}},Et=Object.assign(Dt,{__name:"InitialStepper",setup(o){return(t,l)=>(a(),e("div",V,[t.step===0?(a(),e("div",P,[N,t.step===0?(a(),e("div",A,[W,t.load?n("",!0):(a(),d($,{key:0,onCallback:t.companyListCallback},null,8,["onCallback"])),z,t.load?n("",!0):(a(),d(w,{key:1,company:t.company,onCallback:t.companyCallback},null,8,["company","onCallback"]))])):(a(),e("div",U,J))])):n("",!0),t.step===1?(a(),e("div",X,[Z,t.step===1?(a(),e("div",H,[s("div",K,[c(" Если нет необходимости в локациях, вы можете пропустить данный шаг "),s("button",{type:"button",class:"btn btn-primary",onClick:l[0]||(l[0]=(...i)=>t.skip&&t.skip(...i))},"Пропустить "),c(" или же вы можете вернуться на прошлый шаг "),s("button",{type:"button",class:"btn btn-primary",onClick:l[1]||(l[1]=(...i)=>t.reset&&t.reset(...i))},"Начать заново ")]),t.company?(a(),d(B,{key:0,"company-id":t.company.id,onCallback:t.locationCallback},null,8,["company-id","onCallback"])):n("",!0)])):n("",!0),t.step<1?(a(),e("div",Q,Y)):n("",!0),t.step>1?(a(),e("div",x,st)):n("",!0)])):n("",!0),t.step===2?(a(),e("div",ot,[at,t.step===2?(a(),e("div",et,[s("div",lt,[c(" При необходимости вы можете начать по новой "),s("button",{type:"button",class:"btn btn-primary",onClick:l[2]||(l[2]=(...i)=>t.reset&&t.reset(...i))},"Начать заново ")]),nt,t.company?(a(),d(_,{key:0,"company-id":t.company.id,onCallback:t.botListCallback},null,8,["company-id","onCallback"])):n("",!0),it,t.bot&&t.company&&!t.load?(a(),d(k,{key:1,bot:t.bot,"company-id":t.company.id,onCallback:t.botCallback},null,8,["bot","company-id","onCallback"])):t.bot==null&&t.company&&!t.load?(a(),d(k,{key:2,"company-id":t.company.id,onCallback:t.botCallback},null,8,["company-id","onCallback"])):n("",!0)])):n("",!0),t.step<2?(a(),e("div",dt,ct)):n("",!0),t.step>2?(a(),e("div",ut,ht)):n("",!0)])):n("",!0),t.step===3?(a(),e("div",mt,[pt,t.step===3?(a(),e("div",_t,[s("div",gt,[c(" При необходимости вы можете начать по новой "),s("button",{type:"button",class:"btn btn-primary",onClick:l[3]||(l[3]=(...i)=>t.reset&&t.reset(...i))},"Начать заново ")]),t.bot?(a(),d(f,{key:0,"bot-id":t.bot.id,onCallback:t.imageMenuCallback},null,8,["bot-id","onCallback"])):n("",!0)])):n("",!0),t.step<3?(a(),e("div",yt,$t)):n("",!0),t.step>3?(a(),e("div",Ct,[s("div",vt,[c(" Отлично! Все шаги выполнены "),s("button",{type:"button",class:"btn btn-primary",onClick:l[4]||(l[4]=(...i)=>t.reset&&t.reset(...i))},"Начать заново ")])])):n("",!0)])):n("",!0),t.step===4?(a(),e("div",ft,[wt,s("div",Bt,[s("div",Gt,[Lt,s("div",Tt,[s("a",{class:"btn btn-outline-success w-100",onClick:l[5]||(l[5]=(...i)=>t.reloadWebhooks&&t.reloadWebhooks(...i))},"Обновить зависимости")]),s("div",jt,[s("a",{onClick:l[6]||(l[6]=(...i)=>t.reset&&t.reset(...i)),class:"btn btn-outline-primary w-100"},"Начать заново")])])])])):n("",!0)]))}}),Ot={class:"row"},Ft={class:"col-12"},Mt={class:"col-12"},It={data(){return{load:!1,bot:null}},computed:{...b(["getCurrentBot"])},mounted(){this.loadCurrentBot()},methods:{loadCurrentBot(o=null){this.$store.dispatch("updateCurrentBot",{bot:o}).then(()=>{this.bot=this.getCurrentBot})},botCallback(o){this.load=!0,this.bot=null,this.$nextTick(()=>{this.load=!1})},botListCallback(o){this.load=!0,this.loadCurrentBot(o),this.$nextTick(()=>{this.load=!1})}}},St=Object.assign(It,{__name:"BotEditor",setup(o){return(t,l)=>(a(),e("div",Ot,[s("div",Ft,[t.load?n("",!0):(a(),d(_,{key:0,editor:!0,onCallback:t.botListCallback},null,8,["onCallback"]))]),s("div",Mt,[t.bot&&!t.load?(a(),d(k,{key:0,bot:t.bot,editor:!0,onCallback:t.botCallback},null,8,["bot","onCallback"])):n("",!0)])]))}}),Vt={class:"row pb-2 pt-2"},Pt={class:"col-12"},Nt={key:0,class:"col-12"},At={key:1},Wt={data(){return{bot:null,page:null,load:!1}},mounted(){this.loadCurrentBot()},computed:{...b(["getCurrentBot"])},methods:{loadCurrentBot(o=null){this.$store.dispatch("updateCurrentBot",{bot:o}).then(()=>{this.bot=this.getCurrentBot})},botListCallback(o){this.load=!0,this.bot=o,this.$nextTick(()=>{this.load=!1})},pageListCallback(o){this.load=!0,this.page=o,this.$nextTick(()=>{this.load=!1})},pageCallback(o){this.load=!0,this.$nextTick(()=>{this.load=!1})}}},zt=Object.assign(Wt,{__name:"BotPageConstructor",setup(o){return(t,l)=>(a(),e("div",Vt,[s("div",Pt,[t.load?n("",!0):(a(),d(_,{key:0,editor:!0,onCallback:t.botListCallback},null,8,["onCallback"]))]),t.bot?(a(),e("div",Nt,[!t.load&&t.bot?(a(),d(G,{key:0,"bot-id":t.bot.id,editor:!0,onCallback:t.pageListCallback},null,8,["bot-id","onCallback"])):n("",!0)])):n("",!0),t.bot&&!t.load?(a(),e("div",At,[r(L,{page:t.page,bot:t.bot,onCallback:t.pageCallback},null,8,["page","bot","onCallback"])])):n("",!0)]))}}),Ut={class:"row"},qt={class:"col-12"},Jt={class:"col-12"},Xt={data(){return{load:!1,bot:null}},mounted(){this.loadCurrentBot()},computed:{...b(["getCurrentBot"])},methods:{loadCurrentBot(o=null){this.$store.dispatch("updateCurrentBot",{bot:o}).then(()=>{this.bot=this.getCurrentBot})},imageMenuCallback(o){this.load=!0,this.$nextTick(()=>{this.load=!1})},botListCallback(o){this.load=!0,this.bot=o,this.$nextTick(()=>{this.load=!1})}}},Zt=Object.assign(Xt,{__name:"ImageMenuEditor",setup(o){return(t,l)=>(a(),e("div",Ut,[s("div",qt,[t.load?n("",!0):(a(),d(_,{key:0,editor:!0,onCallback:t.botListCallback},null,8,["onCallback"]))]),s("div",Jt,[t.bot&&!t.load?(a(),d(f,{key:0,bot:t.bot,onCallback:t.imageMenuCallback},null,8,["bot","onCallback"])):n("",!0)])]))}}),Ht={class:"row"},Kt={class:"col-12"},Qt={class:"col-12"},Rt={data(){return{load:!1,company:null}},computed:{...b(["getCurrentCompany"])},mounted(){this.loadCurrentCompany()},methods:{loadCurrentCompany(o=null){this.$store.dispatch("updateCurrentCompany",{company:o}).then(()=>{this.company=this.getCurrentCompany,console.log("company",this.company)})},companyListCallback(o){this.load=!0,this.loadCurrentCompany(o),this.$nextTick(()=>{this.load=!1})},companyCallback(o){this.load=!0,this.$nextTick(()=>{this.load=!1}),document.documentElement.scrollTop=0}}},Yt=Object.assign(Rt,{__name:"CompanyEditor",setup(o){return(t,l)=>(a(),e("div",Ht,[s("div",Kt,[t.load?n("",!0):(a(),d($,{key:0,onCallback:t.companyListCallback},null,8,["onCallback"]))]),s("div",Qt,[!t.load&&t.company?(a(),d(w,{key:0,company:t.company,onCallback:t.companyCallback},null,8,["company","onCallback"])):n("",!0)])]))}}),xt={class:"row"},ts={class:"col-12"},ss={class:"col-12"},os={data(){return{load:!1,company:null}},computed:{...b(["getCurrentCompany"])},mounted(){this.loadCurrentCompany()},methods:{loadCurrentCompany(o=null){this.$store.dispatch("updateCurrentCompany",{company:o}).then(()=>{this.company=this.getCurrentCompany})},companyListCallback(o){this.load=!0,this.company=o,this.$nextTick(()=>{this.load=!1})},locationCallback(){this.step++,this.load=!1,document.documentElement.scrollTop=0}}},as=Object.assign(os,{__name:"LocationEditor",setup(o){return(t,l)=>(a(),e("div",xt,[s("div",ts,[t.load?n("",!0):(a(),d($,{key:0,onCallback:t.companyListCallback},null,8,["onCallback"]))]),s("div",ss,[t.company&&!t.load?(a(),d(B,{key:0,company:t.company,onCallback:t.locationCallback},null,8,["company","onCallback"])):n("",!0)])]))}});({...b(["getErrors"])});const es={class:"row"},ls={class:"input-group mb-3"},ns=E('<div class="row"><div class="col-md-6 col-12"><button type="button" data-bs-toggle="modal" data-bs-target="#group-create-modal" class="btn btn-outline-success mt-2 w-100 p-3 mb-2"><i class="fa-solid fa-layer-group" style="margin-right:10px;"></i>Создать новую группу </button></div><div class="col-12 col-md-6"><button type="button" data-bs-toggle="modal" data-bs-target="#dialog-create-modal" class="btn btn-outline-success mt-2 w-100 p-3 mb-2"><i class="fa-regular fa-comment-dots" style="margin-right:10px;"></i>Создать новый диалоговый скрипт </button></div></div>',1),is={key:0,class:"row"},ds={class:"col-12 mb-3"},rs={class:"card mb-2"},cs={class:"card-header"},us=["onClick"],bs=s("i",{class:"fa-solid fa-trash-can"},null,-1),hs=[bs],ms={class:"card-body"},ps={key:0,class:"row"},_s={class:"col-md-12 col-lg-4 col-12 col-sm-12 mb-2"},gs={key:1,class:"row"},ys=s("div",{class:"col-12"},[s("p",null,"Диалоговых скриптов не найдено")],-1),ks=[ys],$s={class:"col-12"},Cs={key:1,class:"row"},vs=s("div",{class:"col-12"},[s("div",{class:"alert alert-warning",role:"alert"}," У выбранного бота нет созданных диалоговых групп ")],-1),fs=[vs],ws={class:"modal fade",id:"link-modal",tabindex:"-1"},Bs={class:"modal-dialog modal-lg"},Gs={class:"modal-content"},Ls=s("div",{class:"modal-header"},[s("h1",{class:"modal-title fs-5",id:"staticBackdropLabel"}," Диалог связывания "),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),Ts={key:0,class:"modal-body"},js=s("h6",null,"Связать её с:",-1),Ds={class:"row"},Es={class:"col-md-2 mb-1"},Os=["onClick"],Fs=s("div",{class:"modal-footer"},[s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Закрыть")],-1),Ms={class:"modal fade",id:"group-modal",tabindex:"-1"},Is={class:"modal-dialog modal-lg"},Ss={class:"modal-content"},Vs=s("div",{class:"modal-header"},[s("h1",{class:"modal-title fs-5",id:"staticBackdropLabel"}," Диалог перемещения между группами "),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),Ps={key:0,class:"modal-body"},Ns=s("h6",null,"Переместить её в группу",-1),As={key:0,class:"row"},Ws={class:"col-md-6 mb-1"},zs=["onClick"],Us={key:1,class:"row"},qs=s("div",{class:"col-12"},[s("h6",null,"Перемещаем-с...")],-1),Js=[qs],Xs=s("div",{class:"modal-footer"},[s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Закрыть")],-1),Zs={class:"modal fade",id:"group-create-modal",tabindex:"-1"},Hs={class:"modal-dialog modal-lg"},Ks={class:"modal-content"},Qs=s("div",{class:"modal-header"},[s("h1",{class:"modal-title fs-5",id:"staticBackdropLabel"}," Диалог создания группы "),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),Rs={class:"modal-body"},Ys=s("div",{class:"alert alert-warning",role:"alert"}," Группировка имеет исключительно логическое значение! Группа помогает Вам ориентироваться в цепочках диалогов ",-1),xs={class:"form-floating mb-3"},to=s("label",{for:"floatingInput"},"Мнемоническое имя (англ)",-1),so={class:"form-floating mb-3"},oo=s("label",{for:"floatingInput"},"Название группы",-1),ao=s("button",{type:"submit",class:"btn btn-outline-primary w-100 p-3"},"Создать",-1),eo=s("div",{class:"modal-footer"},[s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Закрыть")],-1),lo={class:"modal fade",id:"dialog-create-modal",tabindex:"-1"},no={class:"modal-dialog modal-lg"},io={class:"modal-content"},ro=s("div",{class:"modal-header"},[s("h1",{class:"modal-title fs-5",id:"staticBackdropLabel"}," Создание диалогового сообщения "),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),co={class:"modal-body"},uo=s("div",{class:"modal-footer"},[s("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Закрыть")],-1),bo={props:["bot"],data(){return{groupForm:{slug:null,title:null,bot_id:null},loading:!0,dialog_groups:[],search:null,dialog_groups_paginate_object:null,link:null,group:null}},computed:{...b(["getDialogGroups","getDialogGroupsPaginateObject"]),filteredCommands(){return this.link?this.dialog_groups.find(t=>t.id===this.link.group_id).bot_dialog_commands.filter(t=>t.id!=this.link.id):[]}},mounted(){this.loadGroups()},methods:{removeGroup(o){this.loading=!0,this.$store.dispatch("removeDialogGroup",{dataObject:{dialogGroupId:o}}).then(t=>{this.loading=!1,this.$notify("Диалоговая группа успешно удалена"),this.loadGroups()}).catch(t=>{this.loading=!1})},addGroup(){this.loading=!0,this.groupForm.bot_id=this.bot.id;let o=new FormData;Object.keys(this.groupForm).forEach(t=>{const l=this.groupForm[t]||"";typeof l=="object"?o.append(t,JSON.stringify(l)):o.append(t,l)}),this.$store.dispatch("createDialogGroup",{dialogGroupForm:o}).then(t=>{this.loading=!1,this.$notify("Диалоговая группа успешно создана"),this.groupForm={slug:null,title:null},this.loadGroups()}).catch(t=>{this.loading=!1})},doSwapGroup(o){this.loading=!0,this.$store.dispatch("swapDialogGroup",{swapForm:{dialogCommandId:this.group.command_id,dialogGroupId:o}}).then(t=>{this.loading=!1,this.$notify({title:"Конструктор ботов",text:"Диалоговая команда успешно перемещена в другую группу!",type:"success"}),this.loadGroups(),this.group.group_id=o}).catch(t=>{this.loading=!1})},doCommandLink(o){this.loading=!0,this.$store.dispatch("swapDialogCommand",{swapForm:{dialogCommandFromId:o,dialogCommandToId:this.link.id}}).then(t=>{this.loading=!1,this.$notify({title:"Конструктор ботов",text:"Диалоговая команда успешно слинкована!",type:"success"}),this.loadGroups(),this.link.current_next_id=o}).catch(t=>{this.loading=!1})},swapGroupInit(o){this.group=o,new bootstrap.Modal("#group-modal",{}).show()},tryLink(o){this.link=o,new bootstrap.Modal("#link-modal",{}).show()},selectDialog(o){this.$emit("select-dialog",o),this.$notify("Вы выбрали диалог из списка!")},selectGroup(o){this.$emit("select-group",o),this.$notify("Вы выбрали группу из списка!")},nextGroups(o){this.loadGroups(o)},loadGroups(o=0){this.loading=!0,this.$store.dispatch("loadDialogGroups",{dataObject:{botId:this.bot.id||null,search:this.search},page:o}).then(t=>{this.loading=!1,this.dialog_groups=this.getDialogGroups,this.dialog_groups_paginate_object=this.getDialogGroupsPaginateObject}).catch(()=>{this.loading=!1})}}},ho=Object.assign(bo,{__name:"BotDialogGroupList",setup(o){return(t,l)=>(a(),e(m,null,[s("div",es,[s("div",ls,[C(s("input",{type:"search",class:"form-control",placeholder:"Поиск группы","aria-label":"Поиск группы","onUpdate:modelValue":l[0]||(l[0]=i=>t.search=i),"aria-describedby":"button-addon2"},null,512),[[v,t.search]]),s("button",{class:"btn btn-outline-secondary",onClick:l[1]||(l[1]=(...i)=>t.loadGroups&&t.loadGroups(...i)),type:"button",id:"button-addon2"},"Найти ")])]),ns,t.dialog_groups.length>0?(a(),e("div",is,[s("div",ds,[(a(!0),e(m,null,y(t.dialog_groups,(i,u)=>(a(),e("div",rs,[s("div",cs,[s("h6",null,[c(" #"+h(i.id)+" - "+h(i.title||"Не указано ")+" ",1),s("button",{onClick:g=>t.removeGroup(i.id),type:"button",class:"btn btn-outline-danger"},hs,8,us)])]),s("div",ms,[i.bot_dialog_commands.length>0?(a(),e("div",ps,[(a(!0),e(m,null,y(i.bot_dialog_commands,(g,Ea)=>(a(),e("div",_s,[r(T,{bot:o.bot,onCallback:t.loadGroups,onSelect:t.selectDialog,onSwap:t.swapGroupInit,onLink:t.tryLink,item:g},null,8,["bot","onCallback","onSelect","onSwap","onLink","item"])]))),256))])):(a(),e("div",gs,ks))])]))),256))]),s("div",$s,[t.dialog_groups_paginate_object?(a(),d(S,{key:0,onPagination_page:t.nextGroups,pagination:t.dialog_groups_paginate_object},null,8,["onPagination_page","pagination"])):n("",!0)])])):(a(),e("div",Cs,fs)),s("div",ws,[s("div",Bs,[s("div",Gs,[Ls,t.link?(a(),e("div",Ts,[s("p",null,"Вы выбрали диалоговую команду #"+h(t.link.id),1),js,s("div",Ds,[(a(!0),e(m,null,y(t.filteredCommands,(i,u)=>(a(),e("div",Es,[s("button",{type:"button",onClick:g=>t.doCommandLink(i.id),class:p([{"btn-primary text-white":t.link.current_next_id==i.id},"btn btn-outline-primary w-100"])},"#"+h(i.id)+" "+h(i.pre_text||"Без текста"),11,Os)]))),256))])])):n("",!0),Fs])])]),s("div",Ms,[s("div",Is,[s("div",Ss,[Vs,t.group?(a(),e("div",Ps,[s("p",null,"Вы выбрали диалоговую команду #"+h(t.group.command_id),1),Ns,t.loading?(a(),e("div",Us,Js)):(a(),e("div",As,[(a(!0),e(m,null,y(t.dialog_groups,(i,u)=>(a(),e("div",Ws,[s("button",{type:"button",onClick:g=>t.doSwapGroup(i.id),class:p([{"btn-primary text-white":i.id==t.group.group_id},"btn btn-outline-primary w-100"])},"#"+h(i.id)+" "+h(i.title||"Без названия"),11,zs)]))),256))]))])):n("",!0),Xs])])]),s("div",Zs,[s("div",Hs,[s("div",Ks,[Qs,s("div",Rs,[Ys,s("form",{onSubmit:l[4]||(l[4]=D((...i)=>t.addGroup&&t.addGroup(...i),["prevent"]))},[s("div",xs,[C(s("input",{type:"text",class:"form-control",id:"floatingInput",maxlength:"255",pattern:"[a-zA-Z0-9_]+","onUpdate:modelValue":l[2]||(l[2]=i=>t.groupForm.slug=i),required:""},null,512),[[v,t.groupForm.slug]]),to]),s("div",so,[C(s("input",{type:"text",class:"form-control",id:"floatingInput",maxlength:"255","onUpdate:modelValue":l[3]||(l[3]=i=>t.groupForm.title=i),required:""},null,512),[[v,t.groupForm.title]]),oo]),ao],32)]),eo])])]),s("div",lo,[s("div",no,[s("div",io,[ro,s("div",co,[r(j,{onCallback:t.loadGroups,bot:o.bot},null,8,["onCallback","bot"])]),uo])])])],64))}}),mo={class:"row"},po={class:"col-12"},_o={key:0,class:"col-12"},go=s("div",{class:"col-12"},null,-1),yo={data(){return{load:!1,bot:null}},mounted(){this.loadCurrentBot()},computed:{...b(["getCurrentBot"])},methods:{loadCurrentBot(o=null){this.$store.dispatch("updateCurrentBot",{bot:o}).then(()=>{this.bot=this.getCurrentBot})},dialogGroupListCallback(o){this.load=!0,this.company=o,this.$nextTick(()=>{this.load=!1})},botListCallback(o){this.load=!0,this.bot=o,this.$nextTick(()=>{this.load=!1})}}},ko=Object.assign(yo,{__name:"BotDialogGroupEditor",setup(o){return(t,l)=>(a(),e("div",mo,[s("div",po,[t.load?n("",!0):(a(),d(_,{key:0,editor:!0,onCallback:t.botListCallback},null,8,["onCallback"]))]),t.bot?(a(),e("div",_o,[t.load?n("",!0):(a(),d(ho,{key:0,bot:t.bot,onCallback:t.dialogGroupListCallback},null,8,["bot","onCallback"]))])):n("",!0),go]))}}),$o={class:"row"},Co={class:"col-12"},vo=s("h5",{class:"mt-2 mb-2"},"Найдите существующую компанию",-1),fo={data(){return{company:null,load:!1}},computed:{...b(["getCurrentCompany"])},mounted(){this.loadCurrentCompany()},methods:{loadCurrentCompany(o=null){this.$store.dispatch("updateCurrentCompany",{company:o}).then(()=>{this.company=this.getCurrentCompany})},botCallback(o){this.load=!0,this.bot=o,this.$nextTick(()=>{this.load=!1})},companyListCallback(o){this.load=!0,this.loadCurrentCompany(o),this.$nextTick(()=>{this.load=!1})}}},wo=Object.assign(fo,{__name:"BotCreator",setup(o){return(t,l)=>(a(),e("div",$o,[s("div",Co,[vo,t.load?n("",!0):(a(),d($,{key:0,onCallback:t.companyListCallback},null,8,["onCallback"])),t.company&&!t.load?(a(),d(k,{key:1,company:t.company,onCallback:t.botCallback},null,8,["company","onCallback"])):n("",!0)])]))}});const Bo=s("title",null,"Административная панель",-1),Go=s("meta",{name:"description",content:"Административная панель<"},null,-1),Lo={class:"navbar navbar-dark sticky-top bg-dark flex-md-nowrap p-0 shadow"},To=s("a",{class:"navbar-brand col-md-3 col-lg-2 me-0 px-3 fs-6",href:"#"},"CashMan",-1),jo=s("button",{class:"navbar-toggler position-absolute d-md-none collapsed",type:"button","data-bs-toggle":"collapse","data-bs-target":"#sidebarMenu","aria-controls":"sidebarMenu","aria-expanded":"false","aria-label":"Toggle navigation"},[s("span",{class:"navbar-toggler-icon"})],-1),Do={key:0,class:"navbar-nav"},Eo={class:"nav-item text-nowrap"},Oo={class:"bot-label d-flex justify-between align-items-center"},Fo={class:"p-2 text-white"},Mo=["href"],Io=s("i",{class:"fa-solid fa-xmark text-white"},null,-1),So=[Io],Vo=s("div",{class:"navbar-nav d-none d-md-block"},[s("div",{class:"nav-item text-nowrap"},[s("a",{class:"nav-link px-3",href:"/logout"},"Выход")])],-1),Po={class:"container-fluid"},No={class:"row"},Ao={id:"sidebarMenu",class:"col-md-3 col-lg-2 d-md-block bg-body-tertiary sidebar",style:{}},Wo={class:"position-sticky pt-3 sidebar-sticky"},zo={class:"nav flex-column"},Uo={class:"nav-item"},qo=s("i",{class:"fa-regular fa-building"},null,-1),Jo={class:"nav-item"},Xo=s("i",{class:"fa-regular fa-building"},null,-1),Zo={class:"nav-item"},Ho=s("i",{class:"fa-brands fa-android"},null,-1),Ko={class:"nav-item"},Qo=s("i",{class:"fa-solid fa-robot"},null,-1),Ro={class:"nav-item p-2"},Yo=["disabled"],xo={key:0,class:"col-md-9 ms-sm-auto col-lg-10 px-md-4"},ta={class:"pt-3 pb-2 mb-3 border-bottom"},sa=s("h1",{class:"mb-3 mt-3"},"Создание нового клиента",-1),oa={key:1,class:"col-md-9 ms-sm-auto col-lg-10 px-md-4"},aa={class:"pt-3 pb-2 mb-3 border-bottom"},ea=s("h1",{class:"mb-3 mt-3"},"Редактор компаний",-1),la=s("div",{class:"alert alert-success mb-2",role:"alert"}," Выберите компанию из списка! ",-1),na={key:2,class:"col-md-9 ms-sm-auto col-lg-10 px-md-4"},ia={class:"pt-3 pb-2 mb-3 border-bottom"},da=s("h1",{class:"mb-3 mt-3"},"Редактор локаций",-1),ra=s("div",{class:"alert alert-success mb-2",role:"alert"}," Выберите компанию из списка! ",-1),ca={key:3,class:"col-md-9 ms-sm-auto col-lg-10 px-md-4"},ua={class:"pt-3 pb-2 mb-3 border-bottom"},ba=s("h1",{class:"mb-3 mt-3"},"Редактор ботов",-1),ha=s("div",{class:"alert alert-success mb-2",role:"alert"}," Выберите бота из списка! ",-1),ma={key:4,class:"col-md-9 ms-sm-auto col-lg-10 px-md-4"},pa={class:"pt-3 pb-2 mb-3 border-bottom"},_a=s("h1",{class:"mb-3 mt-3"},"Создание бота",-1),ga=s("div",{class:"alert alert-success mb-2",role:"alert"}," Выберите компанию из списка! ",-1),ya={key:5,class:"col-md-9 ms-sm-auto col-lg-10 px-md-4"},ka={class:"pt-3 pb-2 mb-3 border-bottom"},$a=s("h1",{class:"mb-3 mt-3"},"Редактор меню",-1),Ca=s("div",{class:"alert alert-success mb-2",role:"alert"}," Выберите бота из списка! ",-1),va={key:6,class:"col-md-9 ms-sm-auto col-lg-10 px-md-4"},fa={class:"pt-3 pb-2 mb-3 border-bottom"},wa=s("h1",{class:"mb-3 mt-3"},"Конструктор страниц",-1),Ba=s("div",{class:"alert alert-success mb-2",role:"alert"}," Выберите бота из списка! ",-1),Ga={key:7,class:"col-md-9 ms-sm-auto col-lg-10 px-md-4"},La={class:"pt-3 pb-2 mb-3 border-bottom"},Ta=s("h1",{class:"mb-3 mt-3"},"Конструктор диалогов",-1),ja=s("div",{class:"alert alert-success mb-2",role:"alert"}," Выберите бота из списка! ",-1),Da={data(){return{tab:0,load:!1,bot:null}},computed:{...b(["getErrors","getCurrentBot"])},watch:{getErrors:function(o,t){Object.keys(o).forEach(l=>{this.$notify({title:"Конструктор ботов",text:o[l],type:"warn"})})}},mounted(){this.loadCurrentBot(),window.addEventListener("store_current_bot-change-event",o=>{this.bot=this.getCurrentBot})},methods:{loadCurrentBot(o=null){this.$store.dispatch("updateCurrentBot",{bot:o}).then(()=>{this.bot=this.getCurrentBot})},resetBot(){this.$store.dispatch("resetCurrentBot").then(()=>{this.bot=null})},stopAllDialogs(){this.$store.dispatch("stopDialogs").then(o=>{this.$notify({title:"Конструктор ботов",text:"Все диалоги остановлены",type:"success"})}).catch(o=>{})},reloadWebhooks(){this.load=!0,this.$notify({title:"Конструктор ботов",text:"Процедура обновления зависимостей началась"}),axios.get("/bot/register-webhooks").then(()=>{this.load=!1,this.$notify({title:"Конструктор ботов",text:"Зависимости успешно обновлены!",type:"success"})}).catch(()=>{this.load=!1,this.$notify({title:"Конструктор ботов",text:"Неудалось обновить зависимости",type:"error"})})}}},Na=Object.assign(Da,{__name:"Dashboard",setup(o){return(t,l)=>{const i=I("notifications");return a(),e(m,null,[r(F(M),null,{default:O(()=>[Bo,Go]),_:1}),r(i,{position:"top right"}),s("header",Lo,[To,jo,t.bot?(a(),e("div",Do,[s("div",Eo,[s("div",Oo,[s("span",Fo,[c("У вас выбран бот: "),s("a",{href:"https://t.me/"+(t.bot.bot_domain||"botfather"),target:"_blank"},h(t.bot.bot_domain||"Без имени"),9,Mo)]),s("span",{onClick:l[0]||(l[0]=(...u)=>t.resetBot&&t.resetBot(...u)),class:"p-2 text-white"},So)])])])):n("",!0),Vo]),s("div",Po,[s("div",No,[s("nav",Ao,[s("div",Wo,[s("ul",zo,[s("li",Uo,[s("a",{class:p(["nav-link",{active:t.tab===1}]),href:"#company-editor","aria-current":"page",onClick:l[1]||(l[1]=u=>t.tab=1)},[qo,c(" Создание компании ")],2)]),s("li",Jo,[s("a",{class:p(["nav-link",{active:t.tab===8}]),href:"#company-editor","aria-current":"page",onClick:l[2]||(l[2]=u=>t.tab=8)},[Xo,c(" Создание редактирование компании ")],2)]),s("li",Zo,[s("a",{class:p(["nav-link",{active:t.tab===7}]),href:"#new-bot","aria-current":"page",onClick:l[3]||(l[3]=u=>t.tab=7)},[Ho,c(" Создание нового бота ")],2)]),s("li",Ko,[s("a",{class:p(["nav-link",{active:t.tab===3}]),href:"#bot-editor","aria-current":"page",onClick:l[4]||(l[4]=u=>t.tab=3)},[Qo,c(" Редактирование ботов ")],2)]),s("li",Ro,[s("button",{type:"button",disabled:t.load,class:"nav-lin btn btn-outline-success w-100",onClick:l[5]||(l[5]=(...u)=>t.stopAllDialogs&&t.stopAllDialogs(...u))},"Остановить все диалоги",8,Yo)])])])]),t.tab===0?(a(),e("main",xo,[s("div",ta,[sa,r(Et)])])):n("",!0),t.tab===1?(a(),e("main",oa,[s("div",aa,[ea,la,r(Yt)])])):n("",!0),t.tab===2?(a(),e("main",na,[s("div",ia,[da,ra,r(as)])])):n("",!0),t.tab===3?(a(),e("main",ca,[s("div",ua,[ba,ha,r(St)])])):n("",!0),t.tab===7?(a(),e("main",ma,[s("div",pa,[_a,ga,r(wo)])])):n("",!0),t.tab===4?(a(),e("main",ya,[s("div",ka,[$a,Ca,r(Zt)])])):n("",!0),t.tab===5?(a(),e("main",va,[s("div",fa,[wa,Ba,r(zt)])])):n("",!0),t.tab===6?(a(),e("main",Ga,[s("div",La,[Ta,ja,r(ko)])])):n("",!0)])])],64)}}});export{Na as default};
