import{G as p,Y as _,q as n,t as i,B as h,O as f,u as v,a0 as y,v as t,D as r,y as d,A as l,x as c,N as g,F as m,C}from"./index.es-71d37bd0.js";const w=t("title",null,"Административная панель",-1),k=t("meta",{name:"description",content:"Административная панель<"},null,-1),x={key:0,class:"navbar navbar-dark sticky-top bg-dark flex-md-nowrap p-0 shadow"},$={class:"navbar-brand col-md-3 col-lg-2 me-0 px-3 fs-6 cursor-pointer align-items-center d-flex","data-bs-toggle":"modal","data-bs-target":"#selected-company-bot-info"},B={key:0,style:{"font-size":"12px","margin-left":"10px"}},T=["href"],E=t("button",{class:"navbar-toggler position-absolute d-md-none collapsed",type:"button","data-bs-toggle":"collapse","data-bs-target":"#sidebarMenu","aria-controls":"sidebarMenu","aria-expanded":"false","aria-label":"Toggle navigation"},[t("span",{class:"navbar-toggler-icon"})],-1),M={class:"navbar-nav d-flex justify-content-center align-items-center flex-row"},j={class:"nav-item text-nowrap"},L=t("i",{class:"fa-solid fa-mug-hot"},null,-1),N={class:"nav-item text-nowrap"},S=t("i",{class:"fa-solid fa-robot"},null,-1),A={key:0,class:"nav-item text-nowrap"},D=t("i",{class:"fa-solid fa-scroll"},null,-1),O=t("div",{class:"navbar-nav d-none d-md-block"},[t("div",{class:"nav-item text-nowrap"},[t("a",{class:"nav-link px-3",href:"/logout"},"Выход")])],-1),V={class:"container-fluid"},R={class:"row"},q={class:"col-md-12 ms-sm-auto col-lg-12 px-md-4"},z={class:"pt-3 pb-2 mb-3"},F={class:"modal fade",id:"selected-company-bot-info",tabindex:"-1","aria-labelledby":"open-construct-label","aria-hidden":"true"},G={class:"modal-dialog"},I={class:"modal-content"},W=t("div",{class:"modal-header"},[t("h1",{class:"modal-title fs-5",id:"open-construct-label"},"У вас выбрано"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),X={class:"modal-body"},Y={key:0,class:"card border-info mb-2"},H={class:"card-body"},J=t("p",null,"У Вас выбран клиент:",-1),K={class:"d-flex justify-content-between w-100"},P=t("i",{class:"fa-solid fa-xmark"},null,-1),Q=[P],U={key:1,class:"card border-info"},Z={class:"card-body"},tt=t("p",null,"У Вас выбран бот:",-1),et={class:"d-flex justify-content-between w-100"},st=["href"],ot=t("i",{class:"fa-solid fa-xmark"},null,-1),at=[ot],nt=t("div",{class:"modal-footer"},[t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Закрыть")],-1),it=t("div",{class:"theme-switcher"},[t("button",{id:"switch-theme","data-bs-toggle":"modal","data-bs-target":"#theme-switch-modal",class:"btn btn-primary"},[t("i",{class:"fa-solid fa-palette"})])],-1),lt={class:"modal",id:"theme-switch-modal",tabindex:"-1"},rt={class:"modal-dialog"},dt={class:"modal-content"},ct=t("div",{class:"modal-header"},[t("h5",{class:"modal-title"},"Выбор темы оформления"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),ht={class:"modal-body"},mt={class:"list-group"},bt=["onClick"],ut=t("div",{class:"modal-footer"},[t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Закрыть")],-1),pt={props:["active","needMenu"],data(){return{load:!1,bot:null,currentTheme:"",company:null,themes:[{title:"Тема 1",href:"/theme1.bootstrap.min.css"},{title:"Тема 2",href:"/theme2.bootstrap.min.css"},{title:"Тема 3",href:"/theme3.bootstrap.min.css"},{title:"Тема 4",href:"/theme4.bootstrap.min.css"},{title:"Тема 5",href:"/theme5.bootstrap.min.css"},{title:"Тема 6",href:"/theme6.bootstrap.min.css"},{title:"Тема 7",href:"/theme7.bootstrap.min.css"},{title:"Тема 8",href:"/theme8.bootstrap.min.css"},{title:"Тема 9",href:"/theme9.bootstrap.min.css"},{title:"Тема 10",href:"/theme10.bootstrap.min.css"},{title:"Тема 11",href:"/theme11.bootstrap.min.css"},{title:"Тема 12",href:"/theme12.bootstrap.min.css"},{title:"Тема 13",href:"/theme13.bootstrap.min.css"},{title:"Тема 14",href:"/theme14.bootstrap.min.css"},{title:"Тема 15",href:"/theme15.bootstrap.min.css"},{title:"Тема 16",href:"/theme16.bootstrap.min.css"}]}},computed:{...p(["getErrors","getCurrentBot","getCurrentCompany"])},watch:{getErrors:function(s,e){Object.keys(s).forEach(o=>{this.$notify({title:"Конструктор ботов",text:s[o],type:"warn"})})}},mounted(){this.loadCurrentCompany(),this.loadCurrentBot();let s=localStorage.getItem("cashman_global_admin_theme")||null;s&&this.$nextTick(()=>{this.currentTheme=s}),window.addEventListener("store_current_bot-change-event",e=>{this.bot=this.getCurrentBot}),window.addEventListener("store_current_company-change-event",e=>{this.company=this.getCurrentCompany})},methods:{hasRole(s){return window.hasRole(s)||!1},switchTheme(s){let e=document.querySelector("#theme");e.href=this.themes[s].href,localStorage.setItem("cashman_global_admin_theme",e.href),this.$nextTick(()=>{this.currentTheme=e.href})},loadCurrentCompany(s=null){this.$store.dispatch("updateCurrentCompany",{company:s}).then(()=>{this.company=this.getCurrentCompany})},loadCurrentBot(s=null){this.$store.dispatch("updateCurrentBot",{bot:s}).then(()=>{this.bot=this.getCurrentBot})},resetCompany(){this.$store.dispatch("resetCurrentCompany").then(()=>{this.company=null,window.dispatchEvent(new CustomEvent("store_current_company-change-event"))})},resetBot(){this.$store.dispatch("resetCurrentBot").then(()=>{this.bot=null,window.dispatchEvent(new CustomEvent("store_current_bot-change-event"))})},stopAllDialogs(){this.$store.dispatch("stopDialogs").then(s=>{this.$notify({title:"Конструктор ботов",text:"Все диалоги остановлены",type:"success"})}).catch(s=>{})},reloadWebhooks(){this.load=!0,this.$notify({title:"Конструктор ботов",text:"Процедура обновления зависимостей началась"}),axios.get("/bot/register-webhooks").then(()=>{this.load=!1,this.$notify({title:"Конструктор ботов",text:"Зависимости успешно обновлены!",type:"success"})}).catch(()=>{this.load=!1,this.$notify({title:"Конструктор ботов",text:"Неудалось обновить зависимости",type:"error"})})}}},vt=Object.assign(pt,{__name:"MainAdminLayout",setup(s){return(e,o)=>{const b=_("notifications");return n(),i(m,null,[h(v(y),null,{default:f(()=>[w,k]),_:1}),h(b,{position:"top right"}),s.needMenu?(n(),i("header",x,[t("a",$,[r("CashMan: "),e.bot?(n(),i("span",B,[t("a",{href:"https://t.me/"+(e.bot.bot_domain||"botfather"),target:"_blank"},d(e.bot.bot_domain||"Без имени"),9,T)])):l("",!0)]),E,t("div",M,[t("div",j,[t("a",{class:c(["nav-link px-3",{"border-bottom-active active":s.active==0}]),onClick:o[0]||(o[0]=a=>s.active=0),href:"/company-page"},[L,r(" Клиенты")],2)]),t("div",N,[t("a",{class:c(["nav-link px-3",{"border-bottom-active active":s.active==1}]),onClick:o[1]||(o[1]=a=>s.active=1),href:"/bot-page"},[S,r(" Боты")],2)]),e.hasRole("admin")?(n(),i("div",A,[t("a",{class:c(["nav-link px-3",{"border-bottom-active active":s.active==6}]),onClick:o[2]||(o[2]=a=>s.active=6),href:"/script-page"},[D,r(" Скрипты")],2)])):l("",!0)]),O])):l("",!0),t("div",V,[t("div",R,[t("main",q,[t("div",z,[g(e.$slots,"default")])])])]),t("div",F,[t("div",G,[t("div",I,[W,t("div",X,[e.company?(n(),i("div",Y,[t("div",H,[J,t("div",K,[t("span",null,d(e.company.title||"Без имени"),1),t("span",{onClick:o[3]||(o[3]=(...a)=>e.resetCompany&&e.resetCompany(...a))},Q)])])])):l("",!0),e.bot?(n(),i("div",U,[t("div",Z,[tt,t("div",et,[t("span",null,[t("a",{href:"https://t.me/"+(e.bot.bot_domain||"botfather"),target:"_blank"},d(e.bot.bot_domain||"Без имени"),9,st)]),t("span",{onClick:o[4]||(o[4]=(...a)=>e.resetBot&&e.resetBot(...a))},at)])])])):l("",!0)]),nt])])]),it,t("div",lt,[t("div",rt,[t("div",dt,[ct,t("div",ht,[t("div",mt,[(n(!0),i(m,null,C(e.themes,(a,u)=>(n(),i("button",{type:"button",onClick:_t=>e.switchTheme(u),class:c([{active:e.currentTheme.indexOf(a.href)!=-1},"list-group-item list-group-item-action"]),"aria-current":"true"},d(a.title||"-"),11,bt))),256))])]),ut])])])],64)}}});export{vt as _};
