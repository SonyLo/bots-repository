import{a as U,_ as K,b as H,c as T,d as re,e as ce,f as ue}from"./MailingTable-7d37e228.js";import{R as q,q as l,t as i,v as e,B as p,O as h,D as m,H as c,J as b,F as v,C as y,y as u,A as r,S as k,P as S,x as _,Y as I,K as $,G as C,L as Q,a3 as z,M as me,u as Y,k as _e,g as E,o as he,a8 as pe,a4 as be,a9 as fe,aa as W,z as ge,a7 as ve}from"./index.es-b188fb53.js";import{_ as ee,a as J}from"./GlobalSlugList-37de49e0.js";import{P as j}from"./Pagination-0b2e35d4.js";import{_ as R,a as te,K as se}from"./InlineInjectionsHelper.vue_vue_type_style_index_0_lang-f2e262e7.js";import{_ as $e}from"./BotForm-c86f2df9.js";import{T as oe}from"./TelegramChannelHelper-a3ce9357.js";import{_ as A}from"./_plugin-vue_export-helper-c27b6911.js";import{_ as O,B as N}from"./vue3-json-editor.esm.prod-22c6b7fc.js";import{v as ye}from"./v4-a960c1f4.js";const ke={class:"row"},Fe={class:"col-12 mb-3"},we={class:"form-label",id:"service-title"},Ce=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),Se=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),je={class:"col-12 mb-3"},qe={key:0},ze=["onClick"],Oe={class:"form-label",id:"service-category"},Ve=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),Pe=e("div",null,"Категория услуги (используется для группировки) ",-1),Ae=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),Qe={class:"col-12 mb-3"},Ue={class:"form-label",id:"service-description"},Ie=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),Te=e("div",null," Краткая информация об оказываемой услуге ",-1),Be=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),Re={key:0,class:"text-gray-400 ml-3",style:{"font-size":"10px"}},Me={class:"col-12 col-md-6 mb-3"},De={class:"form-label",id:"service-title"},Ee=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),Le=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),Ke={class:"col-12 col-md-6 mb-3"},Ne={class:"form-label",id:"service-title"},Ye=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),Je=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),He={class:"col-12 mb-3"},We={class:"form-check"},Ge=e("label",{class:"form-check-label",for:"need_images"}," Необходимо добавить изображения к сервиус ",-1),Xe={key:0,class:"col-12 mb-3"},Ze={class:"form-label",id:"service-images"},xe=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),et=e("div",null," Изображение, которое видит пользователь при выборе услуги ",-1),tt=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),st={class:"col-12 mb-3"},ot={class:"form-check"},lt=e("label",{class:"form-check-label",for:"need_prepayment"}," Необходима предоплата ",-1),it={class:"row"},nt={class:"col-12"},at={type:"submit",class:"btn btn-outline-success w-100 p-3"},dt={key:0},rt={key:1},ct={props:["eventId","bot","service"],data(){return{load:!1,need_reset:!1,need_images:!1,categories:[],serviceForm:{id:null,title:null,appointment_event_id:null,description:null,category:null,images:[],need_prepayment:!1,price:0,discount_price:0}}},watch:{serviceForm:{handler(o){this.need_reset=!0},deep:!0}},mounted(){this.loadAppointmentServiceCategories(),console.log("Service form",this.service),this.service&&this.$nextTick(()=>{this.serviceForm={id:this.service.id||null,appointment_event_id:this.service.appointment_event_id||null,title:this.service.title||null,category:this.service.category||null,description:this.service.description||null,images:this.service.images||[],need_prepayment:this.service.need_prepayment||!1,price:this.service.price||0,discount_price:this.service.discount_price||0}})},methods:{loadAppointmentServiceCategories(){this.$store.dispatch("loadAppointmentServiceCategories",{dataObject:{bot_id:this.bot.id||null,event_id:this.eventId||null}}).then(o=>{this.categories=o})},selectPhotos(o){this.serviceForm.images||(this.serviceForm.images=[]);let t=this.serviceForm.images.indexOf(o.file_id);t!==-1?this.serviceForm.images.splice(t,1):this.serviceForm.images.push(o.file_id)},resetForm(){},submitForm(){let o=new FormData;Object.keys(this.serviceForm).forEach(t=>{const s=this.serviceForm[t]||"";typeof s=="object"?o.append(t,JSON.stringify(s)):o.append(t,s)}),o.append("bot_id",this.bot.id),o.append("appointment_event_id",this.eventId),this.$store.dispatch(this.serviceForm.id===null?"addAppointmentService":"updateAppointmentService",{appointmentServiceForm:o}).then(t=>{this.$emit("callback",t.data),this.$notify("Услуги успешно создано")}).catch(t=>{this.$notify("Услуги создания события")})}}},ut=Object.assign(ct,{__name:"AppointmentServiceForm",setup(o){return(t,s)=>{const n=q("Popper");return l(),i("form",{onSubmit:s[7]||(s[7]=S((...a)=>t.submitForm&&t.submitForm(...a),["prevent"]))},[e("div",ke,[e("div",Fe,[e("label",we,[p(n,{content:"Название оказываемой услуги"},{default:h(()=>[Ce]),_:1}),m(" Название услуги "),Se]),c(e("input",{type:"text",class:"form-control",placeholder:"Название","aria-label":"Название","onUpdate:modelValue":s[0]||(s[0]=a=>t.serviceForm.title=a),maxlength:"255","aria-describedby":"service-title",required:""},null,512),[[b,t.serviceForm.title]])]),e("div",je,[t.categories?(l(),i("p",qe,[m(" Ранее созданные категории: "),(l(!0),i(v,null,y(t.categories,a=>(l(),i("span",{onClick:d=>t.serviceForm.category=a,class:"badge bg-primary mr-1 cursor-pointer"},u(a),9,ze))),256))])):r("",!0),e("label",Oe,[p(n,null,{content:h(()=>[Pe]),default:h(()=>[Ve]),_:1}),m(" Категория услуги "),Ae]),c(e("input",{type:"text",class:"form-control",placeholder:"Категория услуги","aria-label":"Категория услуги","onUpdate:modelValue":s[1]||(s[1]=a=>t.serviceForm.category=a),maxlength:"255","aria-describedby":"service-category",required:""},null,512),[[b,t.serviceForm.category]])]),e("div",Qe,[e("label",Ue,[p(n,null,{content:h(()=>[Te]),default:h(()=>[Ie]),_:1}),m(" Описание услуги "),Be,t.serviceForm.description?(l(),i("small",Re," Длина текста "+u(t.serviceForm.description.length)+" / 255",1)):r("",!0)]),c(e("textarea",{type:"text",class:"form-control",placeholder:"Описание услуги","aria-label":"Описание услуги",maxlength:"255","onUpdate:modelValue":s[2]||(s[2]=a=>t.serviceForm.description=a),"aria-describedby":"service-description",required:""},`
                    `,512),[[b,t.serviceForm.description]])]),e("div",Me,[e("label",De,[p(n,{content:"Цена оказываемой услуги"},{default:h(()=>[Ee]),_:1}),m(" Цена услуги, руб "),Le]),c(e("input",{type:"number",class:"form-control",placeholder:"Цена","aria-label":"Цена",min:"0","onUpdate:modelValue":s[3]||(s[3]=a=>t.serviceForm.price=a),"aria-describedby":"price",required:""},null,512),[[b,t.serviceForm.price]])]),e("div",Ke,[e("label",Ne,[p(n,{content:"Цена скидки на оказываемую услугу"},{default:h(()=>[Ye]),_:1}),m(" Цена скидки на услугу, руб "),Je]),c(e("input",{type:"number",class:"form-control",placeholder:"Цена","aria-label":"Цена",min:"0","onUpdate:modelValue":s[4]||(s[4]=a=>t.serviceForm.discount_price=a),"aria-describedby":"price",required:""},null,512),[[b,t.serviceForm.discount_price]])]),e("div",He,[e("div",We,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[5]||(s[5]=a=>t.need_images=a),type:"checkbox",id:"need_images"},null,512),[[k,t.need_images]]),Ge])]),t.need_images?(l(),i("div",Xe,[e("label",Ze,[p(n,null,{content:h(()=>[et]),default:h(()=>[xe]),_:1}),m(" Изображение к услуге "),tt]),p(O,{"need-photo":!0,selected:t.serviceForm.images,onSelect:t.selectPhotos},null,8,["selected","onSelect"])])):r("",!0),e("div",st,[e("div",ot,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[6]||(s[6]=a=>t.serviceForm.need_prepayment=a),type:"checkbox",id:"need_prepayment"},null,512),[[k,t.serviceForm.need_prepayment]]),lt])])]),e("div",it,[e("div",nt,[e("button",at,[t.serviceForm.id===null?(l(),i("span",dt,"Создать услугу")):(l(),i("span",rt,"Обновить услугу"))])])])],32)}}}),mt={props:["param"],data(){return{expressions:[{expression:"{{userName}}",description:"Имя пользователя"},{expression:"{{telegramChatId}}",description:"Идентификатор чата"},{expression:"{{referralLink}}",description:"Реферальная ссылка"},{expression:"{{referralQr}}",description:"Реферальный QR-код"}]}},methods:{expressionsSelect(o){this.$emit("callback",{param:this.param,text:o.expression})}}},_t={class:"dropdown"},ht=e("button",{class:"btn btn-link dropdown-toggle",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-brands fa-hire-a-helper"})],-1),pt={class:"dropdown-menu item-with-text cursor-pointer text-muted p-2"},bt=["onClick"];function ft(o,t,s,n,a,d){return l(),i("div",_t,[ht,e("div",pt,[e("li",null,[(l(!0),i(v,null,y(a.expressions,g=>(l(),i("a",{class:"dropdown-item",onClick:f=>d.expressionsSelect(g)},u(g.description||"-"),9,bt))),256))])])])}const gt=A(mt,[["render",ft]]);const vt={class:"card-header d-flex justify-content-between align-items-center"},$t={class:"d-flex"},yt=e("i",{class:"fa-solid fa-arrow-left"},null,-1),kt=[yt],Ft={class:"dropdown"},wt=e("i",{class:"fa-solid fa-ellipsis"},null,-1),Ct=[wt],St={class:"dropdown-menu"},jt=["data-bs-target"],qt=e("i",{class:"fa-regular fa-pen-to-square mr-1"},null,-1),zt=e("i",{class:"fa-solid fa-clone mr-1"},null,-1),Ot=e("i",{class:"fa-regular fa-trash-can text-danger mr-1"},null,-1),Vt={key:0,class:"fa-solid fa-arrow-up-short-wide"},Pt={key:1,class:"fa-solid fa-arrow-down-short-wide"},At={class:"card-body"},Qt={class:"row"},Ut={class:"col-12"},It={key:0},Tt={key:1,class:"list-group list-group-numbered"},Bt={class:"list-group-item d-flex justify-content-between align-items-start"},Rt={class:"ms-2 me-auto"},Mt=e("div",{class:"fw-bold"},"Идентификатор",-1),Dt={class:"list-group-item d-flex justify-content-between align-items-start"},Et={class:"ms-2 me-auto"},Lt=e("div",{class:"fw-bold"},"Команда",-1),Kt={class:"list-group-item d-flex justify-content-between align-items-start"},Nt={class:"ms-2 me-auto"},Yt=e("div",{class:"fw-bold"},"Мнемоническое имя",-1),Jt={class:"list-group-item d-flex justify-content-between align-items-start"},Ht={class:"ms-2 me-auto"},Wt=e("div",{class:"fw-bold"},"Пояснение",-1),Gt={key:0,class:"list-group-item d-flex justify-content-between align-items-start"},Xt={class:"ms-2 me-auto"},Zt=e("div",{class:"fw-bold"},"Набор параметров скрипта",-1),xt={key:1,class:"list-group-item d-flex justify-content-between align-items-start"},es=e("div",{class:"ms-2 me-auto"},[e("div",{class:"fw-bold"},"Привязана страница")],-1),ts=[es],ss={key:2,class:"list-group-item d-flex justify-content-between align-items-start"},os=e("div",{class:"ms-2 me-auto"},[e("div",{class:"fw-bold"},"Глобальный скрипт")],-1),ls=[os],is={class:"list-group-item d-flex justify-content-between align-items-start"},ns={class:"ms-2 me-auto w-100"},as=e("div",{class:"fw-bold"},"Перенести данные из:",-1),ds=e("option",{value:null},"Не выбрано",-1),rs=["value"],cs=e("p",{class:"my-2"},[e("em",null,"Перенос данных затирает текущие данные в данном скрипте")],-1),us=["disabled"],ms=["id"],_s={class:"modal-dialog modal-fullscreen"},hs={class:"modal-content"},ps={class:"modal-header"},bs={class:"modal-title",id:"exampleModalLabel"},fs=e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),gs={class:"modal-body"},vs=e("div",{class:"modal-footer"},[e("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Закрыть")],-1),$s={props:["item","bot","selectMode","isActive"],data(){return{selected_slug_id:null,slugs:[],load:!1,simple:!0}},watch:{simple:function(){this.simple||this.loadAllSlugs()}},mounted(){},methods:{selectCard(){this.$emit("select",this.item)},slugFormCallback(){this.load=!0,this.$emit("callback"),this.$nextTick(()=>{this.load=!1})},editSlug(){this.load=!0,this.$nextTick(()=>{this.load=!1})},selectSlug(){this.load=!0,this.$emit("select",this.item),this.$nextTick(()=>{this.load=!1})},duplicateSlug(){this.load=!0,this.$store.dispatch("duplicateSlug",{dataObject:{slugId:this.item.id}}).then(o=>{this.$notify({title:"Конструктор команд",text:"Команда успешно продублирована",type:"success"}),this.$emit("callback"),this.$nextTick(()=>{this.load=!1})}).catch(o=>{this.$emit("callback"),this.$nextTick(()=>{this.load=!1})}),this.$emit("callback"),this.$nextTick(()=>{this.load=!1})},submitRelocateData(){this.$store.dispatch("relocateSlugActionData",{slug_sender_id:this.selected_slug_id,slug_recipient_id:this.item.id,bot_id:this.bot.id}).then(o=>{this.$notify({title:"Конструктор команд",text:"Данные команды успешно перенесены",type:"success"})}).catch(o=>{this.$notify({title:"Конструктор команд",text:"Ошибка переноса данных",type:"error"})})},loadAllSlugs(){this.$store.dispatch("loadAllSlugs",{botId:this.bot.id}).then(o=>{this.slugs=o.data})},removeSlug(){this.load=!0,this.$store.dispatch("removeSlug",{dataObject:{slugId:this.item.id}}).then(o=>{this.$notify({title:"Конструктор команд",text:"Команда успешно удалена",type:"success"}),this.$emit("callback"),this.$nextTick(()=>{this.load=!1})}).catch(o=>{this.$emit("callback"),this.$nextTick(()=>{this.load=!1})})}}},ys=Object.assign($s,{__name:"Slug",setup(o){return(t,s)=>(l(),i(v,null,[e("div",{class:_(["card",{"deprecated-slug":o.item.deprecated_at!=null,"global-slug":o.item.is_global,"bg-success text-white":o.isActive}])},[e("div",vt,[e("div",$t,[e("button",{onClick:s[0]||(s[0]=(...n)=>t.selectSlug&&t.selectSlug(...n)),type:"button",title:"Выбрать команду",class:_(["btn btn-outline-primary mr-2",{"text-white":o.isActive}])},kt,2),e("div",Ft,[e("button",{class:_([{"text-white border-white":o.isActive},"btn btn-outline-secondary"]),type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},Ct,2),e("ul",St,[e("li",null,[e("a",{class:"dropdown-item cursor-pointer",onClick:s[1]||(s[1]=(...n)=>t.editSlug&&t.editSlug(...n)),"data-bs-toggle":"modal","data-bs-target":"#edit-slug-"+o.item.id},[qt,m(" Редактировать")],8,jt)]),e("li",null,[e("a",{class:"dropdown-item cursor-pointer",onClick:s[2]||(s[2]=(...n)=>t.duplicateSlug&&t.duplicateSlug(...n))},[zt,m(" Дублировать")])]),e("li",null,[e("a",{class:"dropdown-item cursor-pointer",onClick:s[3]||(s[3]=(...n)=>t.removeSlug&&t.removeSlug(...n))},[Ot,m(" Удалить")])])])])]),e("span",null,[e("small",null,[e("strong",null,"#"+u(o.item.id),1)])]),e("button",{type:"button",onClick:s[4]||(s[4]=n=>t.simple=!t.simple),class:_([{"text-white border-white":o.isActive},"btn btn-outline-primary ml-2"])},[t.simple?(l(),i("i",Vt)):(l(),i("i",Pt))],2)]),e("div",At,[e("div",Qt,[e("div",Ut,[t.simple?(l(),i("p",It,u(o.item.command||"Нет команды"),1)):(l(),i("ol",Tt,[e("li",Bt,[e("div",Rt,[Mt,m(" №"+u(o.item.id||"Нет идентификатора"),1)])]),e("li",Dt,[e("div",Et,[Lt,m(" "+u(o.item.command||"Нет команды"),1)])]),e("li",Kt,[e("div",Nt,[Yt,m(" "+u(o.item.slug||"Slug"),1)])]),e("li",Jt,[e("div",Ht,[Wt,m(" "+u(o.item.comment||"Пояснение не указано"),1)])]),o.item.config?(l(),i("li",Gt,[e("div",Xt,[Zt,o.item.config?(l(!0),i(v,{key:0},y(o.item.config,n=>(l(),i("p",null,[e("strong",null,u(n.key||"Ключ не найден")+":",1),m(u(n.value||"Не указано"),1)]))),256)):r("",!0)])])):r("",!0),o.item.page?(l(),i("li",xt,ts)):r("",!0),o.item.is_global?(l(),i("li",ss,ls)):r("",!0),e("li",is,[e("div",ns,[e("form",{onSubmit:s[6]||(s[6]=S((...n)=>t.submitRelocateData&&t.submitRelocateData(...n),["prevent"]))},[as,c(e("select",{class:"form-control w-100","onUpdate:modelValue":s[5]||(s[5]=n=>t.selected_slug_id=n),required:""},[ds,(l(!0),i(v,null,y(t.slugs,n=>(l(),i("option",{value:n.id},"#"+u(n.id)+" "+u(n.slug||"Не указан"),9,rs))),256))],512),[[I,t.selected_slug_id]]),cs,e("button",{disabled:t.selected_slug_id==null,class:"btn btn-outline-warning w-100"}," Выполнить перенос ",8,us)],32)])])]))])])])],2),e("div",{class:"modal fade",id:"edit-slug-"+o.item.id,tabindex:"-1"},[e("div",_s,[e("div",hs,[e("div",ps,[e("h5",bs,[m("Редактирование команды #"),e("span",null,u(o.item.id),1)]),fs]),e("div",gs,[t.load?r("",!0):(l(),$(ee,{key:0,item:o.item,onCallback:t.slugFormCallback},null,8,["item","onCallback"]))]),vs])])],8,ms)],64))}}),ks={key:0,class:"row"},Fs={class:"col-12 mb-2"},ws={key:0},Cs=e("i",{class:"fa-solid fa-scroll"},null,-1),Ss={key:1},js=e("i",{class:"fa-regular fa-square-minus"},null,-1),qs={key:0,class:"col-12"},zs={class:"col-12"},Os={class:"form-floating mb-3"},Vs=e("label",{for:"floatingInput"},"Быстрый поиск команды",-1),Ps={class:"col-12 mb-2"},As={class:"form-check"},Qs={class:"form-check-label",for:"need_global"},Us={key:0},Is={key:1},Ts={class:"form-check"},Bs=e("label",{class:"form-check-label",for:"need_show_deleted"}," Удаленные ",-1),Rs={key:1,class:"mb-3 col-12 col-sm-12"},Ms={class:"table"},Ds=e("thead",null,[e("tr",null,[e("th",{scope:"col"},"#"),e("th",{scope:"col"},"Команда"),e("th",{scope:"col"},"Пояснение"),e("th",{scope:"col"},"Глобальный"),e("th",{scope:"col"},"Действия")])],-1),Es=["onClick"],Ls={key:0},Ks=e("i",{class:"fa-solid fa-check text-success"},null,-1),Ns=[Ks],Ys={key:1},Js=e("i",{class:"fa-solid fa-xmark text-danger"},null,-1),Hs=[Js],Ws={class:"dropdown"},Gs=e("button",{class:"btn btn-outline-secondary",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-solid fa-ellipsis"})],-1),Xs={class:"dropdown-menu"},Zs={key:0},xs=["onClick"],eo=e("i",{class:"fa-solid fa-arrow-left mr-1"},null,-1),to={key:1},so=["onClick"],oo=e("a",{class:"dropdown-item cursor-pointer","data-bs-toggle":"modal","data-bs-target":"#edit-table-slug"},[e("i",{class:"fa-regular fa-pen-to-square mr-1"}),m(" Редактировать")],-1),lo=[oo],io=["onClick"],no=e("i",{class:"fa-solid fa-clone mr-1"},null,-1),ao=["href"],ro=e("i",{class:"fa-regular fa-file-excel mr-1"},null,-1),co={key:2},uo=["onClick"],mo=e("i",{class:"fa-regular fa-trash-can text-danger mr-1"},null,-1),_o={key:3},ho=["onClick"],po=e("i",{class:"fa-regular fa-trash-can text-danger mr-1"},null,-1),bo={key:3,class:"mb-3 col-md-12"},fo=e("div",{class:"alert alert-danger",role:"alert"}," У Вас еще нет добавленных скриптов! ",-1),go=[fo],vo={class:"modal fade",id:"edit-table-slug",tabindex:"-1"},$o={class:"modal-dialog modal-fullscreen"},yo={key:0,class:"modal-content"},ko={class:"modal-header"},Fo={class:"modal-title",id:"exampleModalLabel"},wo=e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),Co={class:"modal-body"},So={class:"row"},jo={class:"col-8"},qo={class:"col-4"},zo={class:"list-group list-group-numbered"},Oo={key:0,class:"list-group-item d-flex justify-content-between align-items-start"},Vo={class:"ms-2 me-auto"},Po=e("div",{class:"fw-bold"},"Набор параметров скрипта",-1),Ao={key:1},Qo={key:1,class:"list-group-item d-flex justify-content-between align-items-start"},Uo=e("div",{class:"ms-2 me-auto"},[e("div",{class:"fw-bold"},"Привязана страница")],-1),Io=[Uo],To={key:2,class:"list-group-item d-flex justify-content-between align-items-start"},Bo=e("div",{class:"ms-2 me-auto"},[e("div",{class:"fw-bold"},"Является глобальным скриптом")],-1),Ro=[Bo],Mo={class:"list-group-item d-flex justify-content-between align-items-start"},Do={class:"ms-2 me-auto w-100"},Eo=e("div",{class:"fw-bold"},"Перенести данные из:",-1),Lo=e("option",{value:null},"Не выбрано",-1),Ko=["value"],No=e("p",{class:"my-2"},[e("em",null,"Перенос данных затирает текущие данные в данном скрипте")],-1),Yo=["disabled"],Jo=e("div",{class:"modal-footer"},[e("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Закрыть")],-1),Ho={props:["command","canSelect"],data(){return{bot:null,relocated_slug_id:null,need_global:!0,need_show_deleted:!0,show:!1,load:!1,slugs:[],paginate:[],selectedSlug:null,ownSearch:null,slugForm:{command:null,comment:null,slug:null}}},watch:{ownSearch:function(o,t){this.loadSlugs()},need_global:function(o,t){this.loadSlugs()},need_show_deleted:function(o,t){this.loadSlugs()}},computed:{...C(["getCurrentBot","getSlugs","getSlugsPaginateObject"])},mounted(){this.loadCurrentBot().then(()=>{this.loadSlugs(),this.command&&this.$nextTick(()=>{this.slugForm.command=this.command})})},methods:{nextSlugs(o){this.loadSlugs(o)},loadSlugs(o=0){return this.$store.dispatch("loadSlugs",{dataObject:{botId:this.bot.id,needGlobal:this.need_global,needDeleted:this.need_show_deleted,search:this.ownSearch},page:o}).then(t=>{this.slugs=this.getSlugs,this.paginate=this.getSlugsPaginateObject})},loadCurrentBot(o=null){return this.$store.dispatch("updateCurrentBot",{bot:o}).then(()=>{this.bot=this.getCurrentBot})},callbackSlugs(){this.loadSlugs()},selectSlug(o){this.load=!0,this.$nextTick(()=>{this.selectedSlug=o,this.load=!1}),this.$emit("select",o)},selectCard(){this.$emit("select",this.item)},slugFormCallback(){this.load=!0;const o=this.selectedSlug;this.loadSlugs().then(()=>{let t=this.slugs.find(s=>s.id===o.id);this.selectSlug(t||null)}),this.$emit("callback"),this.$nextTick(()=>{this.load=!1})},editSlug(){this.load=!0,this.$nextTick(()=>{this.load=!1})},duplicateSlug(o){this.load=!0,this.$store.dispatch("duplicateSlug",{dataObject:{slugId:o.id}}).then(t=>{this.$notify({title:"Конструктор команд",text:"Команда успешно продублирована",type:"success"}),this.$emit("callback"),this.$nextTick(()=>{this.load=!1})}).catch(t=>{this.$emit("callback"),this.$nextTick(()=>{this.load=!1})}),this.loadSlugs(),this.$emit("callback"),this.$nextTick(()=>{this.load=!1})},submitRelocateData(){this.$store.dispatch("relocateSlugActionData",{slug_sender_id:this.relocated_slug_id,slug_recipient_id:this.item.id,bot_id:this.bot.id}).then(o=>{this.$notify({title:"Конструктор команд",text:"Данные команды успешно перенесены",type:"success"})}).catch(o=>{this.$notify({title:"Конструктор команд",text:"Ошибка переноса данных",type:"error"})})},restoreSlug(o){this.load=!0,this.$store.dispatch("restoreSlug",{dataObject:{slugId:o.id}}).then(t=>{this.$notify({title:"Конструктор команд",text:"Команда успешно восстановлена",type:"success"}),this.loadSlugs(),this.$nextTick(()=>{this.load=!1})}).catch(t=>{this.$emit("callback"),this.$nextTick(()=>{this.load=!1})})},removeSlug(o){this.load=!0,this.$store.dispatch("removeSlug",{dataObject:{slugId:o.id}}).then(t=>{this.$notify({title:"Конструктор команд",text:"Команда успешно удалена",type:"success"}),this.loadSlugs()}).catch(t=>{this.$emit("callback"),this.$nextTick(()=>{this.load=!1})})}}},Wo=Object.assign(Ho,{__name:"BotSlugTableList",setup(o){return(t,s)=>(l(),i(v,null,[t.bot?(l(),i("div",ks,[e("div",Fs,[e("button",{type:"button",onClick:s[0]||(s[0]=n=>t.show=!t.show),class:"btn btn-outline-success p-3 w-100"},[t.show?(l(),i("span",Ss,[js,m(" Свернуть форму добавления")])):(l(),i("span",ws,[Cs,m(" Добавить глобальный скрипт")]))])]),t.show?(l(),i("div",qs,[t.bot?(l(),$(J,{key:0,"can-add":!0,bot:t.bot,onCallback:t.loadSlugs},null,8,["bot","onCallback"])):r("",!0)])):r("",!0),e("div",zs,[e("div",Os,[c(e("input",{type:"search","onUpdate:modelValue":s[1]||(s[1]=n=>t.ownSearch=n),class:"form-control",id:"floatingInput",placeholder:"name@example.com"},null,512),[[b,t.ownSearch]]),Vs])]),e("div",Ps,[e("div",As,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[2]||(s[2]=n=>t.need_global=n),type:"checkbox",id:"need_global"},null,512),[[k,t.need_global]]),e("label",Qs,[t.need_global?(l(),i("span",Us,"Глобальные")):(l(),i("span",Is,"Локальные"))])]),e("div",Ts,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[3]||(s[3]=n=>t.need_show_deleted=n),type:"checkbox",id:"need_show_deleted"},null,512),[[k,t.need_show_deleted]]),Bs])]),t.slugs&&t.bot?(l(),i("div",Rs,[e("table",Ms,[Ds,e("tbody",null,[(l(!0),i(v,null,y(t.slugs,(n,a)=>(l(),i("tr",{class:_({"border-info":n.deleted_at==null,"border-danger":n.deleted_at!=null})},[e("th",{scope:"row",class:_({"text-danger":n.deleted_at!=null})},u(n.id||"Нет идентификатора"),3),e("td",{onClick:d=>t.selectSlug(n),"data-bs-toggle":"modal","data-bs-target":"#edit-table-slug",class:_({"text-danger":n.deleted_at!=null})},u(n.command||"Нет команды"),11,Es),e("td",{class:_({"text-danger":n.deleted_at!=null})},u(n.comment||"Пояснение не указано"),3),e("td",null,[n.is_global?(l(),i("span",Ls,Ns)):(l(),i("span",Ys,Hs))]),e("td",null,[e("div",Ws,[Gs,e("ul",Xs,[o.canSelect?(l(),i("li",Zs,[e("a",{onClick:d=>t.selectSlug(n),title:"Выбрать команду",class:"dropdown-item cursor-pointer"},[eo,m(" Выбрать команду ")],8,xs)])):r("",!0),o.canSelect?(l(),i("hr",to)):r("",!0),e("li",{onClick:d=>t.selectSlug(n)},lo,8,so),e("li",null,[e("a",{class:"dropdown-item cursor-pointer",onClick:d=>t.duplicateSlug(n)},[no,m(" Дублировать")],8,io)]),e("li",null,[e("a",{class:"dropdown-item cursor-pointer",target:"_blank",href:"/admin/slugs/action-data-export/"+n.id},[ro,m(" Скачать данные участников")],8,ao)]),n.deleted_at==null?(l(),i("li",co,[e("a",{class:"dropdown-item cursor-pointer",onClick:d=>t.removeSlug(n)},[mo,m(" Удалить")],8,uo)])):r("",!0),n.deleted_at!=null?(l(),i("li",_o,[e("a",{class:"dropdown-item cursor-pointer",onClick:d=>t.restoreSlug(n)},[po,m(" Восстановить")],8,ho)])):r("",!0)])])])],2))),256))])])])):r("",!0),t.paginate?(l(),$(j,{key:2,onPagination_page:t.nextSlugs,pagination:t.paginate},null,8,["onPagination_page","pagination"])):r("",!0),t.slugs.length===0?(l(),i("div",bo,go)):r("",!0)])):r("",!0),e("div",vo,[e("div",$o,[t.selectedSlug&&!t.load?(l(),i("div",yo,[e("div",ko,[e("h5",Fo,[m("Редактирование команды #"),e("span",null,u(t.selectedSlug.id),1)]),wo]),e("div",Co,[e("div",So,[e("div",jo,[p(ee,{item:t.selectedSlug,onCallback:t.slugFormCallback},null,8,["item","onCallback"])]),e("div",qo,[e("ol",zo,[t.selectedSlug.config?(l(),i("li",Oo,[e("div",Vo,[Po,(t.selectedSlug.config||[]).length>0?(l(!0),i(v,{key:0},y(t.selectedSlug.config,n=>(l(),i("p",null,[e("strong",null,u(n.key||"Ключ не найден")+":",1),m(u(n.value||"Не указано"),1)]))),256)):(l(),i("p",Ao,"Отсутствует"))])])):r("",!0),t.selectedSlug.page?(l(),i("li",Qo,Io)):r("",!0),t.selectedSlug.is_global?(l(),i("li",To,Ro)):r("",!0),e("li",Mo,[e("div",Do,[e("form",{onSubmit:s[5]||(s[5]=S((...n)=>t.submitRelocateData&&t.submitRelocateData(...n),["prevent"]))},[Eo,c(e("select",{class:"form-control w-100","onUpdate:modelValue":s[4]||(s[4]=n=>t.relocated_slug_id=n),required:""},[Lo,(l(!0),i(v,null,y(t.slugs,n=>(l(),i("option",{value:n.id},"#"+u(n.id)+" "+u(n.slug||"Не указан"),9,Ko))),256))],512),[[I,t.relocated_slug_id]]),No,e("button",{disabled:t.relocated_slug_id==null,class:"btn btn-outline-warning w-100"}," Выполнить перенос ",8,Yo)],32)])])])])])]),Jo])):r("",!0)])])],64))}}),Go={class:"row"},Xo={class:"col-12"},Zo=e("h6",null,"Добавление нового скрипта в бота",-1),xo={key:0,class:"row"},el={class:"col-md-6 col-lg-4 col-sm-6 col-12 mb-2"},tl={key:1,class:"row"},sl=e("div",{class:"col-12"},[e("div",{class:"alert alert-danger",role:"alert"},' У Вас еще нет добавленных скриптов! Воспользуйтесь разделом "Скрипты" для добавления. ')],-1),ol=[sl],ll={props:["bot","global","selected"],data(){return{load:!1,search:null,slugs:[],paginate:[]}},computed:{...C(["getSlugs","getSlugsPaginateObject"]),filteredSlugs(){return this.slugs?this.slugs.length===0?[]:this.search==null?this.slugs:this.slugs.filter(o=>{let t=o.slug||"",s=o.command||"",n=o.comment||"";return s.toLowerCase().indexOf(this.search.toLowerCase())!==-1||n.toLowerCase().indexOf(this.search.toLowerCase())!==-1||t.toLowerCase().indexOf(this.search.toLowerCase())!==-1}):[]}},mounted(){this.loadSlugs()},methods:{nextSlugs(o){this.loadSlugs(o)},selectSlug(o){this.$emit("callback",{id:o.id||null,slug:o.slug,comment:o.comment,command:o.command}),this.$notify("Вы выбрали скрипт из списка!")},loadSlugs(o=0){this.$store.dispatch("loadSlugs",{dataObject:{botId:this.bot.id,search:this.search,needGlobal:this.global},page:o}).then(t=>{this.slugs=this.getSlugs,this.paginate=this.getSlugsPaginateObject})},callbackSlugs(){}}},il=Object.assign(ll,{__name:"BotSlugListSimple",setup(o){return(t,s)=>(l(),i("div",Go,[e("div",Xo,[Zo,e("div",null,[c(e("input",{type:"text",class:"form-control mt-1 mb-1","onUpdate:modelValue":s[0]||(s[0]=n=>t.search=n),onKeyup:s[1]||(s[1]=(...n)=>t.loadSlugs&&t.loadSlugs(...n)),placeholder:"Поиск нужного скрипта по описанию"},null,544),[[b,t.search]])]),t.slugs.length>0?(l(),i("div",xo,[(l(!0),i(v,null,y(t.slugs,(n,a)=>(l(),i("div",el,[p(ys,{"is-active":(o.selected||[]).indexOf(n.id)!=-1,item:n,bot:o.bot,onCallback:t.callbackSlugs,onSelect:t.selectSlug},null,8,["is-active","item","bot","onCallback","onSelect"])]))),256)),t.paginate?(l(),$(j,{key:0,onPagination_page:t.nextSlugs,pagination:t.paginate},null,8,["onPagination_page","pagination"])):r("",!0)])):(l(),i("div",tl,ol))])]))}});const nl={props:["param"],data(){return{expressions:[{expression:null,description:"Нет проверки"},{expression:"/([a-z0-9]+)/i",description:"Проверка набора из латинских букв и цифр"},{expression:"/([а-яё0-9]+)/iu",description:"Проверка на кириллицу и цифры"},{expression:"/(?P<digit>\\d+)/",description:"Проверка на число"},{expression:"/^([a-z0-9_-]+.)*[a-z0-9_-]+@[a-z0-9_-]+(.[a-z0-9_-]+)*.[a-z]{2,6}$/",description:"Проверка Email"},{expression:"/^((8|+7)[- ]?)?((?d{3})?[- ]?)?[d- ]{7,10}$/",description:"Проверка номера телефона: +7(982)000-00-00"},{expression:"/^(0[1-9]|[12][0-9]|3[01])[.](0[1-9]|1[012])[.](19|20)dd$/",description:"Проверка даты по формату DD.MM.YYYY"},{expression:"/^[0-9]{4}-(0[1-9]|1[012])-(0[1-9]|1[0-9]|2[0-9]|3[01])$/",description:"Проверка даты по формату YYYY-MM-DD"},{expression:"/^(https?://)?([da-z.-]+).([a-z.]{2,6})([/w .-]*)*/?$/",description:"Проверка доменного имени"}]}},methods:{expressionsSelect(o){this.$emit("callback",{param:this.param,text:o.expression})}}},al={class:"dropdown"},dl=e("button",{class:"btn btn-link dropdown-toggle",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-regular fa-registered"})],-1),rl={class:"dropdown-menu item-with-text cursor-pointer text-muted p-2"},cl=["onClick"];function ul(o,t,s,n,a,d){return l(),i("div",al,[dl,e("div",rl,[e("li",null,[(l(!0),i(v,null,y(a.expressions,g=>(l(),i("a",{class:"dropdown-item",onClick:f=>d.expressionsSelect(g)},u(g.description||"-"),9,cl))),256))])])])}const ml=A(nl,[["render",ul]]),_l={key:0,class:"mb-2 d-flex justify-content-start flex-wrap"},hl=e("p",null,"Связь цепочек: ",-1),pl=["onClick"],bl={key:0,class:"fa-solid fa-arrow-right font-12"},fl={class:"form-floating mb-2"},gl=["id"],vl=["for"],$l={class:"form-check mb-2"},yl=e("label",{class:"form-check-label",for:"need-empty-dialog"}," Диалог без ожидания ответа ",-1),kl={key:1,class:"form-floating mb-2"},Fl=["id"],wl=["for"],Cl={key:2,class:"form-floating mb-2"},Sl=["id"],jl=["for"],ql={key:3,class:"mb-2"},zl={class:"d-flex justify-content-between"},Ol=["for"],Vl=["id"],Pl={class:"mb-2"},Al={class:"d-flex justify-content-between"},Ql=["for"],Ul=["id"],Il={class:"mb-2"},Tl={class:"form-check"},Bl=e("label",{class:"form-check-label",for:"need-dialog-image"}," В диалоге нужно изображение ",-1),Rl={class:"form-check"},Ml=e("label",{class:"form-check-label",for:"need-dialog-menu-inline"}," В диалоге нужно меню тексту ",-1),Dl={class:"form-check"},El=e("label",{class:"form-check-label",for:"need-dialog-menu-reply"}," В диалоге нужно нижнее меню ",-1),Ll={key:4,class:"card mb-2"},Kl={class:"card-body"},Nl=e("h6",null,"Фотографии к диалогу",-1),Yl={class:"photo-preview d-flex justify-content-start flex-wrap w-100"},Jl={for:"location-photos",style:{"margin-right":"10px"},class:"photo-loader ml-2"},Hl=e("span",null,"+",-1),Wl={class:"mb-2 img-preview",style:{"margin-right":"10px"}},Gl={class:"remove"},Xl=["onClick"],Zl={class:"mb-2 img-preview",style:{"margin-right":"10px"}},xl={class:"remove"},ei=["onClick"],ti={key:5,class:"card mb-2"},si=e("div",{class:"card-header"},[e("h6",null,"Кнопки к тексту вопроса")],-1),oi={class:"card-body"},li={key:6,class:"card mb-2"},ii=e("div",{class:"card-header"},[e("h6",null,"Кнопки в виде нижнего меню")],-1),ni={class:"card-body"},ai={class:"mb-2"},di=e("label",{class:"form-check-label",for:"need-empty-dialog"}," Сохранить в переменную ",-1),ri=e("option",{selected:""},"Не выбрано",-1),ci=["value"],ui={class:"form-check mb-2"},mi=e("label",{class:"form-check-label",for:"need-set-flags"}," Установить флаги в соответствующее значение ",-1),_i={key:7,class:"mb-2"},hi=e("p",null,"Выбрать флаги",-1),pi=["onClick"],bi={key:8,class:"mb-2"},fi={key:0,class:"row"},gi=e("div",{class:"col-12"},[e("p",null,"Доступные для связывания диалоги:")],-1),vi={class:"col-md-12 mb-1"},$i={type:"button",class:"btn btn-outline-primary w-100 d-flex justify-content-between align-items-center",style:{"text-align":"left"}},yi=["onClick"],ki={key:0,class:"fa-solid fa-link mr-2 text-success"},Fi={key:1,class:"row"},wi=e("div",{class:"col-12"},[e("div",{class:"alert alert-danger",role:"alert"}," Диалогов для связывания нет ")],-1),Ci=[wi],Si=e("hr",null,null,-1),ji={class:"mb-2"},qi={type:"submit",class:"btn btn-outline-success p-3 w-100"},zi={key:0},Oi={key:1},Vi={props:["item","bot"],data(){return{loading:!0,dialog_commands:[],dialog_commands_paginate_object:null,need_images:!1,need_inline_keyboard:!1,need_reply_keyboard:!1,need_set_flags:!1,flags_variants:[{title:"Является VIP",key:"is_vip",value:null},{title:"Является Админом",key:"is_admin",value:null},{title:"За работой",key:"is_work",value:null},{title:"Является менеджером",key:"is_manager",value:null}],store_variants:[{title:"Имя",key:"name"},{title:"Почта",key:"email"},{title:"Возраст",key:"age"},{title:"Город",key:"city"},{title:"Страна",key:"country"},{title:"Адрес",key:"address"},{title:"Телефон",key:"phone"},{title:"День рождение",key:"birthday"}],commandForm:{id:null,slug:null,pre_text:null,post_text:null,error_text:null,bot_id:null,input_pattern:null,inline_keyboard_id:null,reply_keyboard_id:null,images:null,next_bot_dialog_command_id:null,bot_dialog_group_id:null,is_empty:!1,result_flags:[],store_to:null,result_channel:null,inline_keyboard:null,reply_keyboard:null},photos:[]}},watch:{need_inline_keyboard:function(o,t){this.need_inline_keyboard||(this.commandForm.inline_keyboard_id=null,this.commandForm.inline_keyboard=null)},need_reply_keyboard:function(o,t){this.need_reply_keyboard||(this.commandForm.reply_keyboard_id=null,this.commandForm.reply_keyboard=null)},need_set_flags:function(o,t){this.need_set_flags||(this.commandForm.result_flags=[])},need_images:function(o,t){this.need_images||(this.commandForm.images=null)}},computed:{...C(["getDialogCommands","getDialogCommandsPaginateObject"]),filteredCommands(){return this.dialog_commands?this.dialog_commands.filter(o=>o.id!=this.commandForm.id):[]}},mounted(){this.item&&this.$nextTick(()=>{this.commandForm={id:this.item.id||null,slug:this.item.slug||null,pre_text:this.item.pre_text||null,post_text:this.item.post_text||null,error_text:this.item.error_text||null,is_empty:this.item.is_empty||!1,input_pattern:this.item.input_pattern||null,inline_keyboard_id:this.item.inline_keyboard_id||null,reply_keyboard_id:this.item.reply_keyboard_id||null,images:this.item.images||[],next_bot_dialog_command_id:this.item.next_bot_dialog_command_id||null,bot_dialog_group_id:this.item.bot_dialog_group_id||null,result_channel:this.item.result_channel||null,inline_keyboard:this.item.inline_keyboard||null,reply_keyboard:this.item.reply_keyboard||null,result_flags:this.item.result_flags||[],store_to:this.item.store_to||null},this.bot&&(this.commandForm.bot_id=this.bot.id||null),this.commandForm.inline_keyboard_id!=null&&(this.need_inline_keyboard=!0),this.commandForm.reply_keyboard_id!=null&&(this.need_reply_keyboard=!0),this.commandForm.images.length>0&&(this.need_images=!0),this.commandForm.result_flags.length>0&&(this.need_set_flags=!0)}),this.bot&&this.$nextTick(()=>{this.commandForm.bot_id=this.bot.id}),this.item&&(this.dialog_commands=this.getDialogCommands,this.dialog_commands_paginate_object=this.getDialogCommandsPaginateObject)},methods:{nextDialogs(o){this.loadDialogs(o)},loadDialogs(o=0){this.loading=!0,this.$store.dispatch("loadDialogCommands",{dataObject:{botId:this.bot.id||null,search:this.search},page:o}).then(t=>{this.loading=!1,this.dialog_commands=this.getDialogCommands,this.dialog_commands_paginate_object=this.getDialogCommandsPaginateObject}).catch(()=>{this.loading=!1})},doCommandLink(o){this.loading=!0,this.commandForm.next_bot_dialog_command_id=o},submit(){this.loading=!0;let o=new FormData;if(Object.keys(this.commandForm).forEach(t=>{const s=this.commandForm[t]||"";typeof s=="object"?o.append(t,JSON.stringify(s)):o.append(t,s)}),this.photos){for(let t=0;t<this.photos.length;t++)o.append("files[]",this.photos[t]);o.delete("photos")}this.$store.dispatch(this.commandForm.id?"updateDialogCommand":"createDialogCommand",{dialogCommandForm:o}).then(t=>{this.loading=!1,this.$notify({title:"Конструктор ботов",text:"Успешная обработка диалоговой команды",type:"success"}),this.commandForm.id==null&&(this.commandForm={id:null,slug:null,pre_text:null,post_text:null,error_text:null,input_pattern:null,inline_keyboard_id:null,images:null,next_bot_dialog_command_id:null,bot_dialog_group_id:null,result_channel:null,inline_keyboard:null,is_empty:!1,result_flags:[],store_to:null},this.photos=[]),this.$emit("callback")}).catch(t=>{this.loading=!1})},getPhoto(o){return{imageUrl:URL.createObjectURL(o)}},removePhoto(o,t){this[o].splice(t,1)},onChangePhotos(o){const t=o.target.files;for(let s=0;s<t.length;s++)this.photos.push(t[s])},saveInlineKeyboard(o){this.commandForm.inline_keyboard=o},saveReplyKeyboard(o){this.commandForm.reply_keyboard=o},addTextTo(o={param:null,text:null}){this.commandForm[o.param]=o.text},selectElementById(o){this.$emit("select-element",o)},selectFlag(o){(!this.commandForm.result_flags||!Array.isArray(this.commandForm.result_flags))&&(this.commandForm.result_flags=[]);let t=this.commandForm.result_flags.indexOf(o.key);t===-1?this.commandForm.result_flags.push(o.key):this.commandForm.result_flags.splice(t,1)}}},Pi=Object.assign(Vi,{__name:"BotDialogCommandForm",setup(o){return(t,s)=>{const n=Q("lazy");return l(),i("form",{onSubmit:s[13]||(s[13]=S((...a)=>t.submit&&t.submit(...a),["prevent"]))},[t.commandForm.next_bot_dialog_command_id?(l(),i("div",_l,[hl,(l(!0),i(v,null,y(o.item.chain,(a,d)=>(l(),i("div",null,[e("span",{class:_(["badge cursor-pointer",{"bg-success":t.commandForm.id==a,"bg-primary":t.commandForm.id!=a}]),onClick:g=>t.selectElementById(a)},u(a),11,pl),d<o.item.chain.length-1?(l(),i("i",bl)):r("",!0)]))),256))])):r("",!0),e("div",fl,[c(e("input",{type:"text",class:"form-control",id:"commandForm-pre-text-"+t.commandForm.id,placeholder:"Начни с малого...","onUpdate:modelValue":s[0]||(s[0]=a=>t.commandForm.pre_text=a),required:""},null,8,gl),[[b,t.commandForm.pre_text]]),e("label",{for:"commandForm-pre-text-"+t.commandForm.id},"Текст диалога",8,vl)]),e("div",$l,[c(e("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":s[1]||(s[1]=a=>t.commandForm.is_empty=a),id:"need-empty-dialog",checked:""},null,512),[[k,t.commandForm.is_empty]]),yl]),t.commandForm.is_empty?r("",!0):(l(),i("div",kl,[c(e("input",{type:"text",class:"form-control",id:"commandForm-post-text-"+t.commandForm.id,placeholder:"Начни с малого...","onUpdate:modelValue":s[2]||(s[2]=a=>t.commandForm.post_text=a),required:""},null,8,Fl),[[b,t.commandForm.post_text]]),e("label",{for:"commandForm-post-text-"+t.commandForm.id},"Текст после успешного завершения диалога",8,wl)])),t.commandForm.is_empty?r("",!0):(l(),i("div",Cl,[c(e("input",{type:"text",class:"form-control",id:"commandForm-error-text-"+t.commandForm.id,placeholder:"Начни с малого...","onUpdate:modelValue":s[3]||(s[3]=a=>t.commandForm.error_text=a),required:""},null,8,Sl),[[b,t.commandForm.error_text]]),e("label",{for:"commandForm-error-text-"+t.commandForm.id},"Текст на случай ошибки корректности данных",8,jl)])),t.commandForm.is_empty?r("",!0):(l(),i("div",ql,[e("div",zl,[e("label",{class:"form-label",for:"commandForm-result-channel-"+t.commandForm.id},"Регулярное выражение для валидации данных ",8,Ol),p(ml,{param:"input_pattern",onCallback:t.addTextTo},null,8,["onCallback"])]),c(e("input",{type:"text",class:"form-control",placeholder:"Регулярное выражение","aria-label":"Регулярное выражение","onUpdate:modelValue":s[4]||(s[4]=a=>t.commandForm.input_pattern=a),maxlength:"255",id:"commandForm-input-pattern-"+t.commandForm.id,"aria-describedby":"commandForm-input-pattern"},null,8,Vl),[[b,t.commandForm.input_pattern]])])),e("div",Pl,[e("div",Al,[e("label",{class:"form-label",for:"commandForm-result-channel-"+t.commandForm.id},"Канал для отправки данных ",8,Ql),o.bot?(l(),$(oe,{key:0,token:o.bot.bot_token,param:"result_channel",onCallback:t.addTextTo},null,8,["token","onCallback"])):r("",!0)]),c(e("input",{type:"number",class:"form-control",placeholder:"id канала","aria-label":"id канала","onUpdate:modelValue":s[5]||(s[5]=a=>t.commandForm.result_channel=a),id:"commandForm-result-channel-"+t.commandForm.id,"aria-describedby":"bot-order-channel"},null,8,Ul),[[b,t.commandForm.result_channel]])]),e("div",Il,[e("div",Tl,[c(e("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":s[6]||(s[6]=a=>t.need_images=a),id:"need-dialog-image",checked:""},null,512),[[k,t.need_images]]),Bl]),e("div",Rl,[c(e("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":s[7]||(s[7]=a=>t.need_inline_keyboard=a),id:"need-dialog-menu-inline",checked:""},null,512),[[k,t.need_inline_keyboard]]),Ml]),e("div",Dl,[c(e("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":s[8]||(s[8]=a=>t.need_reply_keyboard=a),id:"need-dialog-menu-reply",checked:""},null,512),[[k,t.need_reply_keyboard]]),El])]),t.need_images?(l(),i("div",Ll,[e("div",Kl,[Nl,e("div",Yl,[e("label",Jl,[Hl,e("input",{type:"file",id:"location-photos",multiple:"",accept:"image/*",onChange:s[9]||(s[9]=(...a)=>t.onChangePhotos&&t.onChangePhotos(...a)),style:{display:"none"}},null,32)]),t.photos.length>0?(l(!0),i(v,{key:0},y(t.photos,(a,d)=>(l(),i("div",Wl,[c(e("img",null,null,512),[[n,t.getPhoto(a).imageUrl]]),e("div",Gl,[e("a",{onClick:g=>t.removePhoto("photos",d)},"Удалить",8,Xl)])]))),256)):r("",!0),t.commandForm.images&&o.bot?(l(!0),i(v,{key:1},y(t.commandForm.images,(a,d)=>(l(),i("div",Zl,[c(e("img",null,null,512),[[n,"/images-by-bot-id/"+o.bot.id+"/"+a]]),e("div",xl,[e("a",{onClick:g=>t.removePhoto("images",d)},"Удалить",8,ei)])]))),256)):r("",!0)])])])):r("",!0),t.need_inline_keyboard?(l(),i("div",ti,[si,e("div",oi,[p(U,{type:"inline",onSave:t.saveInlineKeyboard,"edited-keyboard":t.commandForm.inline_keyboard},null,8,["onSave","edited-keyboard"])])])):r("",!0),t.need_reply_keyboard?(l(),i("div",li,[ii,e("div",ni,[p(U,{type:"reply",onSave:t.saveReplyKeyboard,"edited-keyboard":t.commandForm.reply_keyboard},null,8,["onSave","edited-keyboard"])])])):r("",!0),e("div",ai,[di,c(e("select",{class:"form-control","onUpdate:modelValue":s[10]||(s[10]=a=>t.commandForm.store_to=a)},[ri,(l(!0),i(v,null,y(t.store_variants,a=>(l(),i("option",{value:a.key},u(a.title||"Не указано"),9,ci))),256))],512),[[I,t.commandForm.store_to]])]),e("div",ui,[c(e("input",{class:"form-check-input",type:"checkbox","onUpdate:modelValue":s[11]||(s[11]=a=>t.need_set_flags=a),id:"need-set-flags",checked:""},null,512),[[k,t.need_set_flags]]),mi]),t.need_set_flags?(l(),i("div",_i,[hi,(l(!0),i(v,null,y(t.flags_variants,a=>(l(),i("span",{class:_(["badge text-info mr-2",{"bg-info text-white":t.commandForm.result_flags.indexOf(a.key)!=-1}]),onClick:d=>t.selectFlag(a)},u(a.title),11,pi))),256))])):r("",!0),t.commandForm.id?(l(),i("div",bi,[t.filteredCommands.length>0?(l(),i("div",fi,[gi,(l(!0),i(v,null,y(t.filteredCommands,(a,d)=>(l(),i("div",vi,[e("button",$i,[e("span",{onClick:g=>t.doCommandLink(a.id)},[t.commandForm.next_bot_dialog_command_id==a.id?(l(),i("i",ki)):r("",!0),m(" #"+u(a.id)+" "+u(a.pre_text||"Без текста"),1)],8,yi),t.commandForm.next_bot_dialog_command_id==a.id?(l(),i("i",{key:0,class:"fa-solid fa-unlink text-danger",onClick:s[12]||(s[12]=g=>t.doCommandLink(null))})):r("",!0)])]))),256)),t.dialog_commands_paginate_object?(l(),$(j,{key:0,onPagination_page:t.nextDialogs,pagination:t.dialog_commands_paginate_object},null,8,["onPagination_page","pagination"])):r("",!0)])):(l(),i("div",Fi,Ci))])):r("",!0),Si,e("div",ji,[e("button",qi,[t.commandForm.id?(l(),i("span",zi,"Обновить диалог")):(l(),i("span",Oi,"Добавить диалог"))])])],32)}}});const Ai={class:"row"},Qi={class:"col-md-2 col-12"},Ui=e("i",{class:"fa-regular fa-comment-dots",style:{"margin-right":"10px"}},null,-1),Ii={class:"col-md-10 col-12"},Ti={class:"input-group mb-3"},Bi={key:0,class:"row"},Ri={class:"col-md-12"},Mi={class:"table"},Di=e("thead",null,[e("tr",null,[e("th",{class:"text-center",scope:"col"},"#"),e("th",{class:"text-center",scope:"col"},"Текст диалога"),e("th",{class:"text-center",scope:"col"},"Цепочки"),e("th",{class:"text-center",scope:"col"},"Текст успеха"),e("th",{class:"text-center",scope:"col"},"Текст ошибки"),e("th",{class:"text-center",scope:"col"},"Канал результата"),e("th",{class:"text-center",scope:"col"},"Флаги"),e("th",{class:"text-center",scope:"col"},"Сохранить в"),e("th",{class:"text-center",scope:"col"},"Есть изображения"),e("th",{class:"text-center",scope:"col"},"Есть паттерны"),e("th",{class:"text-center",scope:"col"},"Пустой"),e("th",{class:"text-center",scope:"col"},"Есть кнопки"),e("th",{class:"text-center",scope:"col"},"Есть меню"),e("th",{class:"text-center",scope:"col"},"Команды")])],-1),Ei={scope:"row"},Li={class:"text-center"},Ki=["onClick"],Ni={class:"text-center"},Yi={key:0,class:"badge bg-primary"},Ji={key:1},Hi=e("i",{class:"fa-solid fa-xmark text-danger"},null,-1),Wi=[Hi],Gi={class:"text-center"},Xi={key:0},Zi={key:1},xi=e("i",{class:"fa-solid fa-xmark text-danger"},null,-1),en=[xi],tn={class:"text-center"},sn={key:0},on={key:1},ln=e("i",{class:"fa-solid fa-xmark text-danger"},null,-1),nn=[ln],an={class:"text-center"},dn={key:0},rn={key:1},cn=e("i",{class:"fa-solid fa-xmark text-danger"},null,-1),un=[cn],mn={class:"text-center"},_n={key:0},hn={class:"badge bg-primary"},pn={key:1},bn=e("i",{class:"fa-solid fa-xmark text-danger"},null,-1),fn=[bn],gn={class:"text-center"},vn={key:0},$n={key:1},yn=e("i",{class:"fa-solid fa-xmark text-danger"},null,-1),kn=[yn],Fn={class:"text-center"},wn={key:0,class:"fa-solid fa-check text-success"},Cn={key:1,class:"fa-solid fa-xmark text-danger"},Sn={class:"text-center"},jn={key:0},qn={key:1},zn=e("i",{class:"fa-solid fa-xmark text-danger"},null,-1),On=[zn],Vn={class:"text-center"},Pn={key:0,class:"fa-solid fa-check text-success"},An={key:1,class:"fa-solid fa-xmark text-danger"},Qn={class:"text-center"},Un={key:0,class:"fa-solid fa-check text-success"},In={key:1,class:"fa-solid fa-xmark text-danger"},Tn={class:"text-center"},Bn={key:0,class:"fa-solid fa-check text-success"},Rn={key:1,class:"fa-solid fa-xmark text-danger"},Mn={class:"text-center"},Dn={class:"dropdown"},En=["disabled"],Ln=e("i",{class:"fa-solid fa-ellipsis"},null,-1),Kn=[Ln],Nn={class:"dropdown-menu"},Yn=["onClick"],Jn=e("i",{class:"fa-solid fa-arrow-left mr-1"},null,-1),Hn=e("hr",null,null,-1),Wn=["onClick"],Gn=e("i",{class:"fa-solid fa-clone mr-1"},null,-1),Xn=["onClick"],Zn=e("i",{class:"fa-solid fa-trash-can mr-1"},null,-1),xn={key:1,class:"row"},ea=e("div",{class:"col-12"},[e("div",{class:"alert alert-danger",role:"alert"}," Не найдено ни одного диалога! ")],-1),ta=[ea],sa={class:"modal fade",id:"dialog-command-modal-editor",tabindex:"-1"},oa={class:"modal-dialog modal-fullscreen"},la={class:"modal-content"},ia=e("div",{class:"modal-header"},[e("h1",{class:"modal-title fs-5",id:"staticBackdropLabel"}," Создание диалогового сообщения "),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),na={class:"modal-body"},aa=e("div",{class:"modal-footer"},[e("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Закрыть")],-1),da={data(){return{bot:null,selected:null,loading:!0,dialog_commands:[],search:null,dialog_commands_paginate_object:null}},computed:{...C(["getDialogCommands","getCurrentBot","getDialogCommandsPaginateObject"])},mounted(){this.loadCurrentBot().then(()=>{this.loadDialogs()})},methods:{openEditor(o){this.loading=!0,this.$nextTick(()=>{this.selected=o,this.loading=!1})},removeCommand(o){this.loading=!0,this.$store.dispatch("removeDialogCommand",{dataObject:{dialogCommandId:o}}).then(t=>{this.loading=!1,this.$notify({title:"Конструктор ботов",text:"Диалоговая команда успешно удалена!",type:"success"}),this.loadDialogs(),this.$emit("callback")}).catch(t=>{this.loading=!1})},duplicate(o){this.loading=!0,this.$store.dispatch("duplicateDialogCommand",{dataObject:{dialogCommandId:o}}).then(t=>{this.loading=!1,this.$notify({title:"Конструктор ботов",text:"Диалоговая команда успешно продублирована!",type:"success"}),this.loadDialogs(),this.$emit("callback")}).catch(t=>{this.loading=!1})},loadCurrentBot(o=null){return this.$store.dispatch("updateCurrentBot",{bot:o}).then(()=>{this.bot=this.getCurrentBot})},selectDialog(o){this.$emit("select-dialog",o),this.$notify("Вы выбрали диалог из списка!")},nextDialogs(o){this.loadDialogs(o)},selectElement(o){this.loading=!0,this.$nextTick(()=>{this.selected=this.dialog_commands.find(t=>t.id===o)||null,this.loading=!1})},loadDialogs(o=0){this.$store.dispatch("loadDialogCommands",{dataObject:{botId:this.bot.id||null,search:this.search},page:o}).then(t=>{const s=this.selected;this.dialog_commands=this.getDialogCommands,this.dialog_commands_paginate_object=this.getDialogCommandsPaginateObject,this.loading=!0,this.$nextTick(()=>{s&&(this.selected=this.dialog_commands.find(n=>n.id===s.id)||null),this.loading=!1})}).catch(()=>{this.loading=!1})}}},le=Object.assign(da,{__name:"BotDialogGroupList",setup(o){return(t,s)=>(l(),i(v,null,[e("div",Ai,[e("div",Qi,[e("button",{type:"button",onClick:s[0]||(s[0]=n=>t.openEditor(null)),"data-bs-toggle":"modal","data-bs-target":"#dialog-command-modal-editor",class:"btn btn-outline-success mb-2 w-100"},[Ui,m("Новый диалог ")])]),e("div",Ii,[e("div",Ti,[c(e("input",{type:"search",class:"form-control",placeholder:"Поиск диалога","aria-label":"Поиск диалога","onUpdate:modelValue":s[1]||(s[1]=n=>t.search=n),"aria-describedby":"button-addon2"},null,512),[[b,t.search]]),e("button",{class:"btn btn-outline-secondary",onClick:s[2]||(s[2]=n=>t.loadDialogs(0)),type:"button",id:"button-addon2"},"Найти ")])])]),t.dialog_commands.length>0?(l(),i("div",Bi,[e("div",Ri,[e("table",Mi,[Di,e("tbody",null,[(l(!0),i(v,null,y(t.dialog_commands,(n,a)=>(l(),i("tr",null,[e("th",Ei,u(n.id),1),e("td",Li,[e("a",{"data-bs-toggle":"modal",onClick:d=>t.openEditor(n),"data-bs-target":"#dialog-command-modal-editor",href:"javascript:void(0)"},u(n.pre_text||"-"),9,Ki)]),e("td",Ni,[n.next_bot_dialog_command_id?(l(),i("span",Yi,"#"+u(n.next_bot_dialog_command_id||"-")+" ("+u(n.chain.length||0)+")",1)):(l(),i("span",Ji,Wi))]),e("td",Gi,[n.post_text?(l(),i("p",Xi,u(n.post_text),1)):(l(),i("p",Zi,en))]),e("td",tn,[n.error_text?(l(),i("p",sn,u(n.error_text),1)):(l(),i("p",on,nn))]),e("td",an,[n.result_channel?(l(),i("p",dn,u(n.result_channel),1)):(l(),i("p",rn,un))]),e("td",mn,[n.result_flags.length>0?(l(),i("p",_n,[(l(!0),i(v,null,y(n.result_flags,d=>(l(),i("span",hn,u(d||"-"),1))),256))])):(l(),i("p",pn,fn))]),e("td",gn,[n.store_to?(l(),i("p",vn,u(n.store_to),1)):(l(),i("p",$n,kn))]),e("td",Fn,[n.images.length>0?(l(),i("i",wn)):(l(),i("i",Cn))]),e("td",Sn,[n.input_pattern?(l(),i("p",jn,u(n.input_pattern),1)):(l(),i("p",qn,On))]),e("td",Vn,[n.is_empty?(l(),i("i",Pn)):(l(),i("i",An))]),e("td",Qn,[n.inline_keyboard_id!=null?(l(),i("i",Un)):(l(),i("i",In))]),e("td",Tn,[n.reply_keyboard_id!=null?(l(),i("i",Bn)):(l(),i("i",Rn))]),e("td",Mn,[e("div",Dn,[e("button",{disabled:t.loading,class:"btn btn-outline-secondary",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},Kn,8,En),e("ul",Nn,[e("li",null,[e("a",{onClick:d=>t.selectDialog(n),title:"Выбрать диалог",class:"dropdown-item cursor-pointer"},[Jn,m(" Выбрать диалог ")],8,Yn)]),Hn,e("li",null,[e("a",{title:"Дублирование команды",onClick:d=>t.duplicate(n.id),class:"dropdown-item cursor-pointer"},[Gn,m(" Дублирование диалога ")],8,Wn)]),e("li",null,[e("a",{onClick:d=>t.removeCommand(n.id),title:"Удаление команды",class:"dropdown-item cursor-pointer"},[Zn,m(" Удаление диалога ")],8,Xn)])])])])]))),256))])]),t.dialog_commands_paginate_object?(l(),$(j,{key:0,onPagination_page:t.nextDialogs,pagination:t.dialog_commands_paginate_object},null,8,["onPagination_page","pagination"])):r("",!0)])])):(l(),i("div",xn,ta)),e("div",sa,[e("div",oa,[e("div",la,[ia,e("div",na,[t.bot&&!t.loading?(l(),$(Pi,{key:0,item:t.selected,onCallback:t.loadDialogs,onSelectElement:t.selectElement,bot:t.bot},null,8,["item","onCallback","onSelectElement","bot"])):r("",!0)]),aa])])])],64))}}),ra=e("div",{class:"alert alert-success",role:"alert"},' Проверка правил идет по методу "И" - все правила должны выполняться для перехода на данную страницу, иначе будет вызвана страница из блока "иначе". Действия для "иначе" добавлять не обязательно. ',-1),ca=e("h6",null,"Блок условий",-1),ua={key:0,class:"py-2"},ma={class:"form-label",id:"bot-domain"},_a=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),ha=e("div",null,"Напишите текст, который будет отображен пользователю вместе с основным контентом в случае если условие будет выполнено ",-1),pa={class:"dropdown mb-2"},ba=e("button",{class:"btn btn-outline-info dropdown-toggle w-100",type:"button",id:"dropdownMenuButton1","data-bs-toggle":"dropdown","aria-expanded":"false"}," Добавить условие ",-1),fa={class:"dropdown-menu","aria-labelledby":"dropdownMenuButton1"},ga=["onClick"],va={key:1},$a={key:2,class:"list-group"},ya={key:0,class:"list-group-item d-flex justify-content-between align-items-center"},ka={class:"form-check"},Fa={class:"form-check-label",for:"bot-user-is-vip"},wa={key:0},Ca={key:1},Sa=e("i",{class:"fa-solid fa-trash-can"},null,-1),ja=[Sa],qa={key:1,class:"list-group-item d-flex justify-content-between align-items-center"},za={class:"form-check"},Oa={class:"form-check-label",for:"bot-user-is-admin"},Va={key:0},Pa={key:1},Aa=e("i",{class:"fa-solid fa-trash-can"},null,-1),Qa=[Aa],Ua={key:2,class:"list-group-item d-flex justify-content-between align-items-center"},Ia={class:"form-check"},Ta={class:"form-check-label",for:"bot-user-is-deliveryman"},Ba={key:0},Ra={key:1},Ma=e("i",{class:"fa-solid fa-trash-can"},null,-1),Da=[Ma],Ea={key:3,class:"list-group-item d-flex justify-content-between align-items-center"},La={class:"form-check"},Ka={class:"form-check-label",for:"bot-user-is-work"},Na={key:0},Ya={key:1},Ja=e("i",{class:"fa-solid fa-trash-can"},null,-1),Ha=[Ja],Wa={key:4,class:"list-group-item d-flex justify-content-between align-items-center"},Ga={class:"form-check"},Xa={class:"form-check-label",for:"bot-user-in-location"},Za={key:0},xa={key:1},ed=e("i",{class:"fa-solid fa-trash-can"},null,-1),td=[ed],sd={key:5,class:"list-group-item d-flex justify-content-between align-items-center"},od=e("label",{class:"form-label",id:"bot-domain"}," Возраст от ",-1),ld=e("i",{class:"fa-solid fa-trash-can"},null,-1),id=[ld],nd={key:6,class:"list-group-item d-flex justify-content-between align-items-center"},ad=e("label",{class:"form-label",id:"bot-domain"}," Только для города ",-1),dd=e("i",{class:"fa-solid fa-trash-can"},null,-1),rd=[dd],cd={key:7,class:"list-group-item d-flex justify-content-between align-items-center"},ud={class:"form-check"},md={class:"form-check-label",for:"bot-user-sex"},_d={key:0},hd={key:1},pd=e("i",{class:"fa-solid fa-trash-can"},null,-1),bd=[pd],fd={key:8,class:"list-group-item"},gd={class:"mb-3"},vd={class:"d-flex justify-content-between align-items-center"},$d={class:"form-label d-flex w-100 align-items-center",id:"bot-order-channel"},yd=["onClick"],kd=e("i",{class:"fa-solid fa-trash-can"},null,-1),Fd=[kd],wd=["onUpdate:modelValue"],Cd={key:3,class:"mt-5"},Sd={key:4,class:"d-flex justify-content-between"},jd={key:6,class:"py-2"},qd={class:"form-label",id:"bot-domain"},zd=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),Od=e("div",null,'Напишите текст, который будет отображен пользователю вместе с основным контентом в случае если условие не будет выполнено и будет вызван блок "иначе" ',-1),Vd={props:["bot","rulesForm"],data(){return{rules:[{id:1,title:"Является администратором",rules_block:"bot_user",rule:{is_admin:!0}},{id:2,title:"Является VIP-пользователем",rules_block:"bot_user",rule:{is_vip:!0}},{id:3,title:"Находится в заведении",rules_block:"bot_user",rule:{user_in_location:!0}},{id:4,title:"За работой",rules_block:"bot_user",rule:{is_work:!0}},{id:5,title:"Возраст от ...",rules_block:"bot_user",rule:{age:18}},{id:6,title:"Находится в городе ...",rules_block:"bot_user",rule:{city:"Краснодар"}},{id:7,title:"Пол",rules_block:"bot_user",rule:{sex:!0}},{id:8,title:"Состоит в канале",rules_block:"channels",rule:{channel:1}},{id:9,title:"Является Менеджером",rules_block:"bot_user",rule:{is_manager:!0}}]}},computed:{rulesForCustomFields(){let o=this.rules.filter(t=>t.key!=null);return console.log("filtered rules",o),o}},mounted(){},methods:{hasRuleKey(o){return this.rulesForm.rules_if==null?!1:(console.log("key=>",o||"-"),Object.keys(this.rulesForm.rules_if.bot_user).find(t=>t===o)!=null)},modifyChannel(o){this.rulesForm.rules_if.channels[o.param]=o.text},removeChannelFromRule(o){this.rulesForm.rules_if.channels.splice(o,1)},removeRule(o){delete this.rulesForm.rules_if.bot_user[o]},addRules(o){this.rulesForm.rules_if||(this.rulesForm.rules_if={bot_user:{},channels:[]}),o.rules_block==="bot_user"&&(this.rulesForm.rules_if.bot_user={...this.rulesForm.rules_if.bot_user,...o.rule}),o.rules_block==="channels"&&this.rulesForm.rules_if.channels.push(o.rule.channel)},loadCurrentBotFields(){return this.$store.dispatch("loadCurrentBotFields",{bot_id:this.bot.id}).then(o=>{(o.data||[]).forEach(s=>{s.is_active&&(this.rules.push({id:this.rules.length+1,title:s.label,key:s.key,type:s.type,rules_block:"bot_user",rule:{}}),s.type===0&&(this.rules[this.rules.length-1].rule[s.key]=""),s.type===1&&(this.rules[this.rules.length-1].rule[s.key]=0),s.type===2&&(this.rules[this.rules.length-1].rule[s.key]=!0))}),console.log("new rules=>",this.rules)})},attachPageToRule(o){o.id!=this.rulesForm.id?this.rulesForm.rules_else_page_id=o.id:this.$notify({title:"Конструктор страниц",text:"Вы не можете связать данную страницу с собой",type:"error"})}}},Pd=Object.assign(Vd,{__name:"PageRules",setup(o){return(t,s)=>{const n=q("Popper");return l(),i(v,null,[ra,ca,o.rulesForm.rules_if?(l(),i("div",ua,[e("label",ma,[p(n,null,{content:h(()=>[ha]),default:h(()=>[_a]),_:1}),m(" Сообщение при успешном прохождении условий (не обязательно) ")]),c(e("textarea",{type:"text",class:"form-control",placeholder:"Текст сообщения","aria-label":"Текст сообщения","onUpdate:modelValue":s[0]||(s[0]=a=>o.rulesForm.rules_if_message=a),maxlength:"255","aria-describedby":"rules-else-message"},`
            `,512),[[b,o.rulesForm.rules_if_message]])])):r("",!0),e("div",pa,[ba,e("ul",fa,[(l(!0),i(v,null,y(t.rules,a=>(l(),i("li",null,[e("a",{onClick:d=>t.addRules(a),class:"dropdown-item",href:"javascript:void(0)"},u(a.title||"Не указан"),9,ga)]))),256))])]),o.rulesForm.rules_if?(l(),i("h6",va,"Выбранные условия")):r("",!0),o.rulesForm.rules_if?(l(),i("ul",$a,[t.hasRuleKey("is_vip")?(l(),i("li",ya,[e("div",ka,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[1]||(s[1]=a=>o.rulesForm.rules_if.bot_user.is_vip=a),type:"checkbox",id:"bot-user-is-vip"},null,512),[[k,o.rulesForm.rules_if.bot_user.is_vip]]),e("label",Fa,[o.rulesForm.rules_if.bot_user.is_vip?(l(),i("span",wa,"Является VIP-пользователем")):(l(),i("span",Ca,"Не является VIP-пользователем"))])]),e("button",{type:"button",class:"btn btn-outline-info",onClick:s[2]||(s[2]=a=>t.removeRule("is_vip"))},ja)])):r("",!0),t.hasRuleKey("is_admin")?(l(),i("li",qa,[e("div",za,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[3]||(s[3]=a=>o.rulesForm.rules_if.bot_user.is_admin=a),type:"checkbox",id:"bot-user-is-admin"},null,512),[[k,o.rulesForm.rules_if.bot_user.is_admin]]),e("label",Oa,[o.rulesForm.rules_if.bot_user.is_admin?(l(),i("span",Va,"Является администратором")):(l(),i("span",Pa,"Не является администратором"))])]),e("button",{type:"button",class:"btn btn-outline-info",onClick:s[4]||(s[4]=a=>t.removeRule("is_admin"))},Qa)])):r("",!0),t.hasRuleKey("is_deliveryman")?(l(),i("li",Ua,[e("div",Ia,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[5]||(s[5]=a=>o.rulesForm.rules_if.bot_user.is_deliveryman=a),type:"checkbox",id:"bot-user-is-deliveryman"},null,512),[[k,o.rulesForm.rules_if.bot_user.is_deliveryman]]),e("label",Ta,[o.rulesForm.rules_if.bot_user.is_deliveryman?(l(),i("span",Ba,"Является доставщиком")):(l(),i("span",Ra,"Не является доставщиком"))])]),e("button",{type:"button",class:"btn btn-outline-info",onClick:s[6]||(s[6]=a=>t.removeRule("is_deliveryman"))},Da)])):r("",!0),t.hasRuleKey("is_work")?(l(),i("li",Ea,[e("div",La,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[7]||(s[7]=a=>o.rulesForm.rules_if.bot_user.is_work=a),type:"checkbox",id:"bot-user-is-work"},null,512),[[k,o.rulesForm.rules_if.bot_user.is_work]]),e("label",Ka,[o.rulesForm.rules_if.bot_user.is_work?(l(),i("span",Na,"За работой")):(l(),i("span",Ya,"Не работает"))])]),e("button",{type:"button",class:"btn btn-outline-info",onClick:s[8]||(s[8]=a=>t.removeRule("is_work"))},Ha)])):r("",!0),t.hasRuleKey("user_in_location")?(l(),i("li",Wa,[e("div",Ga,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[9]||(s[9]=a=>o.rulesForm.rules_if.bot_user.user_in_location=a),type:"checkbox",id:"bot-user-in-location"},null,512),[[k,o.rulesForm.rules_if.bot_user.user_in_location]]),e("label",Xa,[o.rulesForm.rules_if.bot_user.user_in_location?(l(),i("span",Za,"Находится в заведении")):(l(),i("span",xa,"Не находится в заведении"))])]),e("button",{type:"button",class:"btn btn-outline-info",onClick:s[10]||(s[10]=a=>t.removeRule("user_in_location"))},td)])):r("",!0),t.hasRuleKey("age")?(l(),i("li",sd,[e("div",null,[od,c(e("input",{type:"text",class:"form-control",placeholder:"Возраст от","aria-label":"Возраст от","onUpdate:modelValue":s[11]||(s[11]=a=>o.rulesForm.rules_if.bot_user.age=a),maxlength:"255","aria-describedby":"bot-user-age"},null,512),[[b,o.rulesForm.rules_if.bot_user.age]])]),e("button",{type:"button",class:"btn btn-outline-info",onClick:s[12]||(s[12]=a=>t.removeRule("age"))},id)])):r("",!0),t.hasRuleKey("city")?(l(),i("li",nd,[e("div",null,[ad,c(e("input",{type:"text",class:"form-control",placeholder:"Город","aria-label":"Город","onUpdate:modelValue":s[13]||(s[13]=a=>o.rulesForm.rules_if.bot_user.city=a),maxlength:"255","aria-describedby":"bot-user-city"},null,512),[[b,o.rulesForm.rules_if.bot_user.city]])]),e("button",{type:"button",class:"btn btn-outline-info",onClick:s[14]||(s[14]=a=>t.removeRule("city"))},rd)])):r("",!0),t.hasRuleKey("sex")?(l(),i("li",cd,[e("div",ud,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[15]||(s[15]=a=>o.rulesForm.rules_if.bot_user.sex=a),type:"checkbox",id:"bot-user-sex"},null,512),[[k,o.rulesForm.rules_if.bot_user.sex]]),e("label",md,[o.rulesForm.rules_if.bot_user.sex?(l(),i("span",_d,"Только для мужчин")):(l(),i("span",hd,"Только для женщин"))])]),e("button",{type:"button",class:"btn btn-outline-info",onClick:s[16]||(s[16]=a=>t.removeRule("sex"))},bd)])):r("",!0),o.rulesForm.rules_if.channels.length>0?(l(),i("li",fd,[m("Проверка нахождения в канале \\ группе: "),(l(!0),i(v,null,y(o.rulesForm.rules_if.channels,(a,d)=>(l(),i("div",gd,[e("div",vd,[e("label",$d,[p(oe,{token:o.bot.bot_token,param:`${d}`,onCallback:t.modifyChannel},null,8,["token","param","onCallback"]),m(" Канал для проверки ")]),e("button",{type:"button",class:"btn btn-link text-danger",onClick:g=>t.removeChannelFromRule(d)},Fd,8,yd)]),c(e("input",{type:"text",class:"form-control",placeholder:"id канала","aria-label":"id канала","onUpdate:modelValue":g=>o.rulesForm.rules_if.channels[d]=g,maxlength:"255","aria-describedby":"bot-order-channel"},null,8,wd),[[b,o.rulesForm.rules_if.channels[d]]])]))),256))])):r("",!0)])):r("",!0),o.rulesForm.rules_if?(l(),i("h6",Cd,"Иначе")):r("",!0),o.rulesForm.rules_else_page_id?(l(),i("p",Sd,[m("Вы выбрали страницу #"+u(o.rulesForm.rules_else_page_id)+' в качестве условия "иначе" ',1),e("a",{href:"javascript:void(0)",onClick:s[17]||(s[17]=a=>o.rulesForm.rules_else_page_id=null)},"Очистить")])):r("",!0),o.rulesForm.rules_if?(l(),$(K,{key:5,current:o.rulesForm.id,onCallback:t.attachPageToRule,editor:!1},null,8,["current","onCallback"])):r("",!0),o.rulesForm.rules_if?(l(),i("div",jd,[e("label",qd,[p(n,null,{content:h(()=>[Od]),default:h(()=>[zd]),_:1}),m(" Сообщение в случае невыполнения условий (не обязательно) ")]),c(e("textarea",{type:"text",class:"form-control",placeholder:"Текст сообщения","aria-label":"Текст сообщения","onUpdate:modelValue":s[18]||(s[18]=a=>o.rulesForm.rules_else_message=a),maxlength:"255","aria-describedby":"rules-else-message"},`
            `,512),[[b,o.rulesForm.rules_else_message]])])):r("",!0)],64)}}}),Ad={class:"page-container"},Qd={class:"page-content"},Ud={class:"row"},Id={class:"col"},Td={class:"row"},Bd={class:"col"},Rd={class:"row"},Md={class:"col"},Dd={class:"row"},Ed={class:"col-12"},Ld=["innerHTML"],Kd={key:0,class:"row"},Nd={class:"col-12"},Yd={key:1,class:"row mt-2"},Jd=e("p",{class:"mb-0"},[e("strong",null,"Нижнее меню")],-1),Hd={class:"col-12"},Wd={props:["page"]},Gd=Object.assign(Wd,{__name:"PagePreview",setup(o){return(t,s)=>{const n=Q("lazy");return l(),i("div",Ad,[e("div",Qd,[e("div",Ud,[o.page.images?(l(!0),i(v,{key:0},y(o.page.images,(a,d)=>(l(),i("div",Id,[c(e("img",null,null,512),[[n,"/images-by-bot-id/"+o.page.bot_id+"/"+a]])]))),256)):r("",!0)]),e("div",Td,[o.page.videos?(l(!0),i(v,{key:0},y(o.page.videos,(a,d)=>(l(),i("div",Bd,[p(N,{content:a,type:"video"},null,8,["content"])]))),256)):r("",!0)]),e("div",Rd,[o.page.audios?(l(!0),i(v,{key:0},y(o.page.audios,(a,d)=>(l(),i("div",Md,[p(N,{content:a,type:"audio"},null,8,["content"])]))),256)):r("",!0)]),e("div",Dd,[e("div",Ed,[e("p",{innerHTML:o.page.content},null,8,Ld)])])]),o.page.inlineKeyboard?(l(),i("div",Kd,[e("div",Nd,[o.page.inlineKeyboard.deleted_at?r("",!0):(l(),$(H,{key:0,simple:!0,"select-mode":!0,keyboard:o.page.inlineKeyboard},null,8,["keyboard"]))])])):r("",!0),o.page.replyKeyboard?(l(),i("div",Yd,[Jd,e("div",Hd,[o.page.replyKeyboard.deleted_at?r("",!0):(l(),$(H,{key:0,simple:!0,"select-mode":!0,keyboard:o.page.replyKeyboard},null,8,["keyboard"]))])])):r("",!0)])}}});const Xd={key:0,class:"row pt-3"},Zd={class:"col-12"},xd={class:"alert alert-info",role:"alert"},er=e("strong",null,"Внимание!",-1),tr={style:{"font-size":"16px"}},sr={key:0,class:"row"},or={class:"col-12 mb-2"},lr=e("h6",null,"На странице выбраны следующие разделы",-1),ir={class:"mini-pics justify-content-start d-inline-flex text-primary"},nr=e("i",{class:"fa-regular fa-images"},null,-1),ar=[nr],dr=e("i",{class:"fa-regular fa-note-sticky"},null,-1),rr=[dr],cr=e("i",{class:"fa-solid fa-photo-film"},null,-1),ur=[cr],mr=e("i",{class:"fa-regular fa-file-audio"},null,-1),_r=[mr],hr=e("i",{class:"fa-regular fa-file-word"},null,-1),pr=[hr],br=e("i",{class:"fa-solid fa-link"},null,-1),fr=[br],gr=e("i",{class:"fa-solid fa-scroll"},null,-1),vr=[gr],$r=e("i",{class:"fa-regular fa-comment-dots"},null,-1),yr=[$r],kr=e("i",{class:"fa-solid fa-scale-balanced"},null,-1),Fr=[kr],wr=e("i",{class:"fa-regular fa-keyboard"},null,-1),Cr=[wr],Sr=e("i",{class:"fa-solid fa-ellipsis"},null,-1),jr=[Sr],qr={class:"row"},zr={class:"col-md-8 col-12 mb-2"},Or={class:"form-label",id:"bot-domain"},Vr=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),Pr=e("div",null,[m(" Команда должна начинаться с символа . и *"),e("br"),m(" Например: .*Меню"),e("br")],-1),Ar=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),Qr={class:"col-md-4 col-12 mb-2 d-flex justify-content-end align-items-end"},Ur={class:"btn-group",style:{background:"white"},role:"group","aria-label":"Basic example"},Ir={key:0,type:"submit",title:"Сохранить страницу",id:"save-page-btn",class:"btn btn-primary min-menu-btn"},Tr=e("i",{class:"fa-regular fa-floppy-disk"},null,-1),Br=[Tr],Rr=e("i",{class:"fa-solid fa-xmark text-danger"},null,-1),Mr=[Rr],Dr=e("button",{type:"button",title:"Список страниц","data-bs-toggle":"offcanvas","data-bs-target":"#offcanvas",class:"btn btn-outline-primary text-primary min-menu-btn"},[e("i",{class:"fa-solid fa-list-ol"})],-1),Er={class:"row"},Lr={class:"col-12 mb-2"},Kr={class:"form-label d-flex justify-content-between align-items-center mb-0",id:"bot-domain"},Nr=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),Yr=e("div",null,[m(" Текстовый редактор. Данный текст будет в таком"),e("br"),m(" же виде отображен в посте в телеграм. ")],-1),Jr=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),Hr={class:"form-floating"},Wr={for:"floatingTextarea2"},Gr={key:0},Xr={class:"col-12 mb-2"},Zr={class:"nav nav-tabs justify-content-center"},xr=e("i",{class:"fa-regular fa-keyboard"},null,-1),ec=e("span",null,"Нижнее меню",-1),tc=[xr,ec],sc=e("i",{class:"fa-solid fa-ellipsis"},null,-1),oc=e("span",null,"Меню под текстом",-1),lc=[sc,oc],ic=e("i",{class:"fa-regular fa-images"},null,-1),nc=e("span",null,"Изображения",-1),ac=[ic,nc],dc=e("i",{class:"fa-solid fa-photo-film"},null,-1),rc=e("span",null,"Видео",-1),cc=[dc,rc],uc=e("i",{class:"fa-regular fa-note-sticky"},null,-1),mc=e("span",null,"Стикеры",-1),_c=[uc,mc],hc=e("i",{class:"fa-regular fa-file-audio"},null,-1),pc=e("span",null,"Аудио",-1),bc=[hc,pc],fc=e("i",{class:"fa-regular fa-file-word"},null,-1),gc=e("span",null,"Документы",-1),vc=[fc,gc],$c=e("i",{class:"fa-solid fa-link"},null,-1),yc=e("span",null,"Другая страница",-1),kc=[$c,yc],Fc=e("i",{class:"fa-solid fa-scroll"},null,-1),wc=e("span",null,"Скрипт",-1),Cc=[Fc,wc],Sc=e("i",{class:"fa-regular fa-comment-dots"},null,-1),jc=e("span",null,"Начало диалога",-1),qc=[Sc,jc],zc=e("i",{class:"fa-solid fa-scale-balanced"},null,-1),Oc=e("span",null,"Правила",-1),Vc=[zc,Oc],Pc={key:0,class:"col-12 mb-2"},Ac={class:"form-check"},Qc=e("label",{class:"form-check-label",for:"need-reply-menu"}," Нижнее меню страницы ",-1),Uc={key:1,class:"col-12 mb-2"},Ic={class:"card"},Tc={class:"card-header d-flex justify-between align-items-center"},Bc=e("h6",null,"Конструктор нижнего меню",-1),Rc={key:0},Mc={key:1},Dc={class:"card-body"},Ec={class:"row"},Lc={class:"col-12 mb-2"},Kc={class:"form-label",id:"bot-domain"},Nc=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),Yc=e("div",null," Заголовок для нижнего меню ",-1),Jc={key:2,class:"col-12 mb-2"},Hc={class:"position-relative p-5 text-center text-muted bg-body border border-dashed rounded-2"},Wc={class:"d-flex justify-content-center mb-3"},Gc={alt:"",width:"100",height:"100"},Xc=e("h1",{class:"text-body-emphasis"},"Нижнее меню",-1),Zc=e("p",{class:"col-lg-8 mx-auto fs-5 text-muted"}," Создание и настройка нижнего меню страницы бота. Добавление и редактирование функций кнопок бота на странице. Данное меню отображается пользователю всегда. ",-1),xc={class:"d-inline-flex gap-2 mb-5"},eu=["disabled"],tu=e("a",{href:"https://telegra.ph/Nizhnee-menyu-bota-01-03",target:"_blank",class:"d-inline-flex align-items-center btn btn-outline-secondary btn-lg px-4 rounded-pill"}," Подробнее ",-1),su={key:0,class:"col-12 mb-2"},ou={class:"form-check"},lu=e("label",{class:"form-check-label",for:"need-inline-menu"}," Меню под текстом страницы ",-1),iu={key:1,class:"col-12 mb-2"},nu={class:"card"},au={class:"card-header d-flex justify-between align-items-center"},du=e("h6",null,"Конструктор меню в сообщении",-1),ru={key:0},cu={key:1},uu={class:"card-body"},mu={key:2,class:"col-12 mb-2"},_u={class:"position-relative p-5 text-center text-muted bg-body border border-dashed rounded-2"},hu={class:"d-flex justify-content-center mb-3"},pu={alt:"",width:"100",height:"100"},bu=e("h1",{class:"text-body-emphasis"},"Меню под текстом",-1),fu=e("p",{class:"col-lg-8 mx-auto fs-5 text-muted"}," В отличии от нижнего меню, которое отображается всегда, меню под текстом показывается под контентом только в момент отображения этого контента. ",-1),gu={class:"d-inline-flex gap-2 mb-5"},vu=["disabled"],$u=e("a",{href:"https://telegra.ph/Menyu-k-tekstu-01-03",target:"_blank",class:"d-inline-flex align-items-center btn btn-outline-secondary btn-lg px-4 rounded-pill"}," Подробнее ",-1),yu={key:0,class:"col-12 mb-2"},ku={class:"form-check"},Fu=e("label",{class:"form-check-label",for:"need-page-images"}," Изображения на странице (максимум 10) ",-1),wu={key:1,class:"col-12 mb-2"},Cu={class:"card mb-3"},Su=e("div",{class:"card-header"},[e("h6",null,"Загрузите изображения с файловой системы")],-1),ju={class:"card-body d-flex justify-content-start"},qu={for:"photos",style:{"margin-right":"10px"},class:"photo-loader ml-2"},zu={class:"row"},Ou={key:0,class:"col-12 d-flex flex-wrap"},Vu={class:"mb-2 img-preview",style:{"margin-right":"10px"}},Pu={class:"remove"},Au=["onClick"],Qu={key:1},Uu={key:2,class:"col-12 d-flex flex-wrap"},Iu={class:"mb-2 img-preview",style:{"margin-right":"10px"}},Tu={class:"remove"},Bu=["onClick"],Ru={key:2,class:"col-12 mb-2"},Mu={class:"position-relative p-5 text-center text-muted bg-body border border-dashed rounded-2"},Du={class:"d-flex justify-content-center mb-3"},Eu={alt:"",width:"100",height:"100"},Lu=e("h1",{class:"text-body-emphasis"},"Изображения",-1),Ku=e("p",{class:"col-lg-8 mx-auto fs-5 text-muted"},[m(" Вы можете добавить к одной странице от "),e("b",null,"1"),m(" до "),e("b",null,"10"),m(" изображений. Изображения (от 2х) будут собраны в группу и показаны под текстовым содержимым страницы. Если изображение одно, то текст будет отображен под ним. ")],-1),Nu={class:"d-inline-flex gap-2 mb-5"},Yu=["disabled"],Ju=e("a",{href:"https://telegra.ph/Dobavlenie-izobrazhenij-01-03",target:"_blank",class:"d-inline-flex align-items-center btn btn-outline-secondary btn-lg px-4 rounded-pill"}," Подробнее ",-1),Hu={key:0,class:"col-12 mb-2"},Wu={class:"form-check"},Gu=e("label",{class:"form-check-label",for:"need-page-video"}," Видео к странице ",-1),Xu={key:1,class:"col-12 mb-2"},Zu={key:2,class:"col-12 mb-2"},xu={class:"position-relative p-5 text-center text-muted bg-body border border-dashed rounded-2"},em={class:"d-flex justify-content-center mb-3"},tm={alt:"",width:"100",height:"100"},sm=e("h1",{class:"text-body-emphasis"},"Видео",-1),om=e("p",{class:"col-lg-8 mx-auto fs-5 text-muted"},[m(" Вы можете добавить к одной странице от "),e("b",null,"1"),m(" до "),e("b",null,"10"),m(" видео. Ролики (от 2х) будут собраны в группу и показаны под текстовым содержимым страницы. ")],-1),lm={class:"d-inline-flex gap-2 mb-5"},im=["disabled"],nm=e("a",{href:"https://telegra.ph/Dobavlenie-video-na-stranicu-01-03",target:"_blank",class:"d-inline-flex align-items-center btn btn-outline-secondary btn-lg px-4 rounded-pill"}," Подробнее ",-1),am={key:0,class:"col-12 mb-2"},dm={class:"form-check"},rm=e("label",{class:"form-check-label",for:"need-page-sticker"}," Стикер к странице ",-1),cm={key:1,class:"col-12 mb-2"},um={key:2,class:"col-12 mb-2"},mm={class:"position-relative p-5 text-center text-muted bg-body border border-dashed rounded-2"},_m={class:"d-flex justify-content-center mb-3"},hm={alt:"",width:"100",height:"100"},pm=e("h1",{class:"text-body-emphasis"},"Стикеры",-1),bm=e("p",{class:"col-lg-8 mx-auto fs-5 text-muted"}," Вы можете переслать любой стикер в бота (от лица администратора) и затем этот стикер использовать для взаимодействия с пользователем. ",-1),fm={class:"d-inline-flex gap-2 mb-5"},gm=["disabled"],vm=e("a",{href:"https://telegra.ph/Dobavlenie-stikera-na-stranicu-01-03",target:"_blank",class:"d-inline-flex align-items-center btn btn-outline-secondary btn-lg px-4 rounded-pill"}," Подробнее ",-1),$m={key:0,class:"col-12 mb-2"},ym={class:"form-check"},km=e("label",{class:"form-check-label",for:"need-page-audio"}," Звук к странице ",-1),Fm={key:1,class:"col-12 mb-2"},wm={key:2,class:"col-12 mb-2"},Cm={class:"position-relative p-5 text-center text-muted bg-body border border-dashed rounded-2"},Sm={class:"d-flex justify-content-center mb-3"},jm={alt:"",width:"100",height:"100"},qm=e("h1",{class:"text-body-emphasis"},"Аудио",-1),zm=e("p",{class:"col-lg-8 mx-auto fs-5 text-muted"},[m(" Вы можете добавить к одной странице от "),e("b",null,"1"),m(" до "),e("b",null,"10"),m(" аудио. Музыка (от 2х) будет собрана в группу и показана под текстовым содержимым страницы. Если вы хотите использовать "),e("b",{class:"text-danger"},"голосовое"),m(", то можно использовать максимум "),e("b",{class:"text-danger"},"одну запись"),m(". Или же, вы можете конвертировать её в mp3 и залить как музыкальный файл в бота. ")],-1),Om={class:"d-inline-flex gap-2 mb-5"},Vm=["disabled"],Pm=e("a",{href:"https://telegra.ph/Dobavlenie-audio-na-stranicu-01-03",target:"_blank",class:"d-inline-flex align-items-center btn btn-outline-secondary btn-lg px-4 rounded-pill"}," Подробнее ",-1),Am={key:0,class:"col-12 mb-2"},Qm={class:"form-check"},Um=e("label",{class:"form-check-label",for:"need-page-document"}," Документ \\ презентацию к странице \\ картинку в оригинале ",-1),Im={key:1,class:"col-12 mb-2"},Tm={key:2,class:"col-12 mb-2"},Bm={class:"position-relative p-5 text-center text-muted bg-body border border-dashed rounded-2"},Rm={class:"d-flex justify-content-center mb-3"},Mm={alt:"",width:"100",height:"100"},Dm=e("h1",{class:"text-body-emphasis"},"Документы",-1),Em=e("p",{class:"col-lg-8 mx-auto fs-5 text-muted"},[m(" Вы можете добавить к одной странице от "),e("b",null,"1"),m(" до "),e("b",null,"10"),m(" документов. Документы (от 2х) будут собраны в группу и показана под текстовым содержимым страницы. В качестве файлов вы можете использовать текстовые документы, презентации, файлы-pdf, изображения в оригинальном размере. ")],-1),Lm={class:"d-inline-flex gap-2 mb-5"},Km=["disabled"],Nm=e("a",{href:"https://telegra.ph/Dobavlenie-dokumenta-01-03",target:"_blank",class:"d-inline-flex align-items-center btn btn-outline-secondary btn-lg px-4 rounded-pill"}," Подробнее ",-1),Ym={class:"col-12 mb-2"},Jm={class:"position-relative p-5 text-center text-muted bg-body border border-dashed rounded-2"},Hm={class:"d-flex justify-content-center mb-3"},Wm={alt:"",width:"100",height:"100"},Gm=e("h1",{class:"text-body-emphasis"},"Связь со страницей",-1),Xm=e("p",{class:"col-lg-8 mx-auto fs-5 text-muted"}," Вы можете привязать вызов другой страницы непосредственно после вызова текущей. Это позволит выводить контент по цепочке для пользователя. ",-1),Zm={key:0,class:"my-3 text-success font-bold"},xm={class:"d-inline-flex gap-2 mb-5"},e_={key:1,"data-bs-toggle":"modal","data-bs-target":"#page-list-modal",class:"d-inline-flex align-items-center btn btn-lg px-4 rounded-pill btn-primary",type:"button"},t_=e("a",{href:"https://telegra.ph/Svyazyvanie-so-stranicej-01-03",target:"_blank",class:"d-inline-flex align-items-center btn btn-outline-secondary btn-lg px-4 rounded-pill"}," Подробнее ",-1),s_=e("h6",{class:"mb-3"},"Конструктор цепочек",-1),o_={class:"d-flex justify-content-center align-items-center flex-wrap"},l_=e("span",{class:"px-2"},"Текущая страница",-1),i_=e("i",{class:"fa-solid fa-arrow-right"},null,-1),n_={class:"d-flex justify-content-center align-items-center px-3 py-2"},a_=["onClick"],d_={class:"position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger"},r_={key:0,class:"fa-solid fa-arrow-right ml-2"},c_={key:0,class:"fa-solid fa-arrow-right"},u_=e("button",{type:"button","data-bs-toggle":"modal","data-bs-target":"#page-list-modal",class:"btn btn-outline-secondary position-relative rounded-5 ml-5"},[e("i",{class:"fa-solid fa-plus"})],-1),m_={key:0,class:"col-12 mb-2"},__=e("div",{class:"alert alert-info",role:"alert"}," Если в вашем боте нет каких-то предустановленных скриптов вы можете найти их в глобальном магазине скриптов ",-1),h_={class:"form-check"},p_=e("label",{class:"form-check-label",for:"need-show-global-slug-list"}," Добавить скрипты из глобального магазина? ",-1),b_={key:1,class:"col-12 mb-2"},f_={class:"form-check"},g_=e("label",{class:"form-check-label",for:"need-slug-attach"}," Привязать скрипт ",-1),v_={key:2,class:"col-12 mb-2"},$_={key:0,class:"alert alert-success d-flex justify-content-between align-items-center",role:"alert"},y_={key:3,class:"col-12 mb-2"},k_={class:"position-relative p-5 text-center text-muted bg-body border border-dashed rounded-2"},F_={class:"d-flex justify-content-center mb-3"},w_={alt:"",width:"100",height:"100"},C_=e("h1",{class:"text-body-emphasis"},"Скрипты",-1),S_=e("p",{class:"col-lg-8 mx-auto fs-5 text-muted"}," Скрипты содержат основной функционал системы. Вы можете к каждой странице привязать один скрипт, который будет вызван после вывода основного содержимого страницы. ",-1),j_={class:"d-inline-flex gap-2 mb-5"},q_=["disabled"],z_=e("a",{href:"https://telegra.ph/Svyazyvanie-so-skriptom-01-03",target:"_blank",class:"d-inline-flex align-items-center btn btn-outline-secondary btn-lg px-4 rounded-pill"}," Подробнее ",-1),O_={key:0,class:"col-12 mb-2"},V_={class:"form-check"},P_=e("label",{class:"form-check-label",for:"need-dialog-attach"}," Привязать начало диалога ",-1),A_={key:1,class:"col-12 mb-2"},Q_={key:0},U_={key:2,class:"col-12 mb-2"},I_={class:"position-relative p-5 text-center text-muted bg-body border border-dashed rounded-2"},T_={class:"d-flex justify-content-center mb-3"},B_={alt:"",width:"100",height:"100"},R_=e("h1",{class:"text-body-emphasis"},"Диалоги",-1),M_=e("p",{class:"col-lg-8 mx-auto fs-5 text-muted"}," Диалоги страницы - это инструмент запроса данных от пользователя. Вы можете привязать начало диалога к странице, а сам диалог будет вызван по цепочке. ",-1),D_={class:"d-inline-flex gap-2 mb-5"},E_=["disabled"],L_=e("a",{href:"https://telegra.ph/Dobavlenie-dialoga-01-03",target:"_blank",class:"d-inline-flex align-items-center btn btn-outline-secondary btn-lg px-4 rounded-pill"}," Подробнее ",-1),K_={key:0,class:"col-12 mb-2"},N_={class:"form-check"},Y_=e("label",{class:"form-check-label",for:"need-rules"}," Нужны правила загрузки страницы ",-1),J_={key:1,class:"col-12 mb-2"},H_={key:2,class:"col-12 mb-2"},W_={class:"position-relative p-5 text-center text-muted bg-body border border-dashed rounded-2"},G_={class:"d-flex justify-content-center mb-3"},X_={alt:"",width:"100",height:"100"},Z_=e("h1",{class:"text-body-emphasis"},"Правила отображения страницы",-1),x_=e("p",{class:"col-lg-8 mx-auto fs-5 text-muted"}," Вы можете создать правила, согласно которым будет отображена та или иная страница. Вы можете перенаправить пользователя с одной страницы на другую, в случае если ваше условие не выполнено. ",-1),eh={class:"d-inline-flex gap-2 mb-5"},th=["disabled"],sh=e("a",{href:"https://telegra.ph/Pravila-na-stranice-01-03",target:"_blank",class:"d-inline-flex align-items-center btn btn-outline-secondary btn-lg px-4 rounded-pill"}," Подробнее ",-1),oh=e("div",{class:"row"},[e("div",{class:"col-12"},[e("div",{class:"alert alert-info",role:"alert"},[e("h6",null,"Страница поддерживает комбинации клавиш:"),e("ul",{class:"mb-0 mr-0 p-0"},[e("li",null,[e("strong",null,"Ctrl+S"),m(" - открыть\\закрыть окно сохранения")]),e("li",null,[e("strong",null,"Ctrl+D"),m(" - просмотр страницы (для сохраненных страниц)")]),e("li",null,[e("strong",null,"Ctrl+пробел"),m(" - открыть\\закрыть список страниц")]),e("li",null,[e("strong",null,"Ctrl+backspace"),m(" - очистить страницу\\новая страница")]),e("li",null,[e("strong",null,"Ctrl+стрелка вправо"),m(" - переключение между вкладка вперед")]),e("li",null,[e("strong",null,"Ctrl+стрелка влево"),m(" - переключение между вкладка назад")])])])])],-1),lh={class:"modal fade",id:"save-modal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},ih={class:"modal-dialog"},nh={class:"modal-content"},ah=e("div",{class:"modal-header"},[e("h5",{class:"modal-title",id:"exampleModalLabel"},"Сохранение страницы"),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),dh={class:"modal-body"},rh={key:0,class:"row"},ch={class:"col-12 mb-2"},uh={class:"d-flex justify-between"},mh=["href"],_h={class:"col-12 mb-2"},hh=e("h6",null,"На странице выбраны следующие разделы",-1),ph={class:"mini-pics text-primary"},bh=e("i",{class:"fa-regular fa-images"},null,-1),fh=[bh],gh=e("i",{class:"fa-regular fa-note-sticky"},null,-1),vh=[gh],$h=e("i",{class:"fa-solid fa-photo-film"},null,-1),yh=[$h],kh=e("i",{class:"fa-regular fa-file-audio"},null,-1),Fh=[kh],wh=e("i",{class:"fa-regular fa-file-word"},null,-1),Ch=[wh],Sh=e("i",{class:"fa-solid fa-link"},null,-1),jh=[Sh],qh=e("i",{class:"fa-solid fa-scroll"},null,-1),zh=[qh],Oh=e("i",{class:"fa-regular fa-comment-dots"},null,-1),Vh=[Oh],Ph=e("i",{class:"fa-solid fa-scale-balanced"},null,-1),Ah=[Ph],Qh=e("i",{class:"fa-regular fa-keyboard"},null,-1),Uh=[Qh],Ih=e("i",{class:"fa-solid fa-ellipsis"},null,-1),Th=[Ih],Bh={key:0,class:"col-12 mb-2"},Rh={class:"form-check"},Mh=e("label",{class:"form-check-label",for:"need-show-qr-and-link"}," Показать ссылку на страницу и QR-код ",-1),Dh={key:1,class:"col-12 mb-2"},Eh={class:"d-flex justify-content-center"},Lh={style:{width:"200px",height:"200px"}},Kh={class:"col-12 mb-2"},Nh={class:"form-label",id:"bot-domain"},Yh=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),Jh=e("div",null,"Напишите для себя пояснение для чего нужна данная страница. Это поможет другим менеджерам лучше понять Вас. ",-1),Hh=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),Wh={class:"col-12"},Gh={class:"form-check"},Xh=e("label",{class:"form-check-label",for:"is-external"}," Внешнее управление страницей ",-1),Zh={key:0,class:"alert alert-danger",role:"alert"},xh={key:0,class:"mb-0"},ep=e("strong",null,'"Информация о боте"',-1),tp=e("strong",null,"Другие настройки",-1),sp=e("strong",null,'"Ссылка на внешний сервис обработки данных"',-1),op={class:"col-12"},lp={class:"form-check"},ip=e("label",{class:"form-check-label",for:"need_log_user_action"}," Логгировать действия пользователя в канал при переходе ",-1),np={class:"col-12"},ap={class:"form-check"},dp=e("label",{class:"form-check-label",for:"need-stay-after-save"}," Остаться на текущей странице после сохранения ",-1),rp=e("div",{class:"col-12"},[e("button",{type:"submit",id:"submit-page",class:"btn btn-success w-100 p-3"},"Сохранить ")],-1),cp=e("div",{class:"modal-footer"},[e("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Не сохранять")],-1),up={class:"modal fade",id:"page-list-modal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},mp={class:"modal-dialog"},_p={class:"modal-content"},hp={class:"modal-body"},pp={class:"modal fade",id:"page-preview-modal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},bp={class:"modal-dialog"},fp={class:"modal-content"},gp={class:"modal-body"},vp={key:1},$p={class:"offcanvas offcanvas-end w-25",tabindex:"-1",id:"offcanvas","data-bs-keyboard":"true","data-bs-scroll":"true","data-bs-backdrop":"true"},yp=e("div",{class:"offcanvas-header"},[e("h6",{class:"offcanvas-title d-none d-sm-block",id:"offcanvas"},"Ваши страницы (кнопки)"),e("button",{type:"button",class:"btn-close text-reset","data-bs-dismiss":"offcanvas","aria-label":"Close"})],-1),kp={class:"offcanvas-body"},Fp={class:"row"},wp={class:"col-12"},Cp={data(){return{tab:0,links:[],saveModal:null,pageModal:null,pagePreviewModal:null,page:null,need_show_qr_and_link:!1,need_stay_after_save:!0,need_show_global_slug_list:!1,need_clean:!1,load:!1,photos:[],showReplyTemplateSelector:!1,showInlineTemplateSelector:!1,loaded_page_list:!0,load_slug_simple_list:!0,showMenu:!1,need_page_sticker:!1,need_page_audios:!1,need_page_documents:!1,need_page_video:!1,need_page_images:!1,need_inline_menu:!1,need_reply_menu:!1,need_attach_page:!1,need_attach_dialog:!1,need_attach_slug:!1,need_rules:!1,bot:null,pageForm:{id:null,content:"",command:null,slug:null,comment:null,videos:[],images:[],audios:[],documents:[],sticker:null,reply_keyboard_title:null,reply_keyboard:null,reply_keyboard_settings:null,inline_keyboard:null,is_external:!1,need_log_user_action:!1,next_page_id:null,next_bot_dialog_command_id:null,next_bot_menu_slug_id:null,rules_if:null,rules_else_page_id:null,rules_if_message:null,rules_else_message:null}}},watch:{need_page_images:function(o,t){this.need_page_images||(this.photos=[],this.pageForm.images=[])},need_page_audios:function(o,t){this.need_page_audios||(this.pageForm.audios=[])},need_page_documents:function(o,t){this.need_page_documents||(this.pageForm.documents=[])},need_page_sticker:function(o,t){this.need_page_sticker||(this.pageForm.sticker=null)},need_page_video:function(o,t){this.need_page_video||(this.pageForm.videos=[])},need_inline_menu:function(o,t){this.need_inline_menu||(this.pageForm.inline_keyboard=null,this.pageForm.inline_keyboard_id=null)},need_rules:function(o,t){this.need_rules||(this.pageForm.rules_if=null,this.pageForm.rules_else_page_id=null,this.pageForm.rules_if_message=null,this.pageForm.rules_else_message=null)},need_reply_menu:function(o,t){this.need_reply_menu||(this.pageForm.reply_keyboard=null,this.pageForm.reply_keyboard_id=null)},need_attach_page:function(o,t){this.need_attach_page||(this.pageForm.next_page_id=null)},need_attach_dialog:function(o,t){this.need_attach_dialog||(this.pageForm.next_bot_dialog_command_id=null)},need_attach_slug:function(o,t){this.need_attach_slug||(this.pageForm.next_bot_menu_slug_id=null)},pageForm:{handler:function(o){this.pageForm.reply_keyboard!=null&&(this.need_reply_menu=!0),this.pageForm.inline_keyboard!=null&&(this.need_inline_menu=!0),this.pageForm.images.length>0&&(this.need_page_images=!0),this.pageForm.next_bot_dialog_command_id!=null&&(this.need_attach_dialog=!0),this.pageForm.next_bot_menu_slug_id!=null&&(this.need_attach_slug=!0),this.pageForm.next_page_id!=null&&(this.need_attach_page=!0),this.pageForm.rules_if!=null&&(this.need_rules=!0),this.pageForm.videos.length>0&&(this.need_page_video=!0),this.pageForm.audios.length>0&&(this.need_page_audios=!0),this.pageForm.documents.length>0&&(this.need_page_documents=!0),this.pageForm.sticker&&(this.need_page_sticker=!0),this.need_clean=!0},deep:!0}},computed:{...C(["getCurrentBot"]),qr(){return"https://api.qrserver.com/v1/create-qr-code/?size=450x450&qzone=2&data="+this.link},selectedLinkIds(){let o=this.links.map(t=>t.id);return this.page==null?o:this.page.id!=null?[this.page.id,...o]:o},hasParts(){return this.need_page_sticker||this.need_page_audios||this.need_page_documents||this.need_page_video||this.need_page_images||this.need_inline_menu||this.need_reply_menu||this.need_attach_page||this.need_attach_dialog||this.need_attach_slug||this.need_rules},pageLink(){if(!this.pageForm.id)return"Ссылка недоступна";let o="";for(let t=0;t<10-(""+this.pageForm.id).length;t++)o+="0";return o+=this.pageForm.id,"https://t.me/"+this.getCurrentBot.bot_domain+"?start="+btoa("004"+o)}},mounted(){this.page?this.preparePageForm(this.page):this.clearForm(),this.loadCurrentBot().then(()=>{this.saveModal=new bootstrap.Modal(document.getElementById("save-modal"),{})}),this.pageModal=new bootstrap.Offcanvas(document.getElementById("offcanvas"),{scroll:!0}),this.pagePreviewModal=new bootstrap.Modal(document.getElementById("page-preview-modal"),{}),window.addEventListener("keydown",o=>{if(o.ctrlKey&&o.keyCode==8&&(o.preventDefault(),this.clearForm()),o.ctrlKey&&o.code=="KeyD"&&(o.preventDefault(),this.pagePreviewModal.toggle()),o.ctrlKey&&o.keyCode==32&&(o.preventDefault(),this.pageModal.toggle()),o.ctrlKey&&o.code=="KeyS"){o.preventDefault();const t=document.querySelector("#save-page-btn");t?t.click():this.$notify({title:"Конструктор страниц",text:"Вы еще не начали создавать страницу!",type:"warning"})}o.ctrlKey&&o.keyCode==39&&(o.preventDefault(),this.tab===10?this.tab=0:this.tab++),o.ctrlKey&&o.keyCode==37&&(o.preventDefault(),this.tab===0?this.tab=10:this.tab--)})},methods:{chainCollapseTest(o){return this.page==null?this.links.filter(t=>t.id==o.id).length>1:[this.page,...this.links].filter(t=>t.id==o.id).length>1},loadPageChains(){return this.$store.dispatch("loadPageChains",{dataObject:{start_page_id:this.page.id}}).then(o=>{this.links=o.data})},removeLink(o){this.links.splice(o,1)},loadSlugs(){this.load_slug_simple_list=!1,this.need_show_global_slug_list=!1,this.$nextTick(()=>{this.load_slug_simple_list=!0})},preparePageForm(o){this.links=[],this.page=o,this.photos=[],this.$nextTick(()=>{this.pageForm={id:o.id,slug_id:o.slug?o.slug.id:null,content:o.content,command:o.slug?o.slug.command:null,slug:o.slug?o.slug.slug:null,comment:o.slug?o.slug.comment:null,images:o.images||[],sticker:o.sticker||null,reply_keyboard_title:o.reply_keyboard_title||null,reply_keyboard_id:o.reply_keyboard_id||null,inline_keyboard_id:o.inline_keyboard_id||null,reply_keyboard:o.replyKeyboard||null,inline_keyboard:o.inlineKeyboard||null,next_page_id:o.next_page_id||null,next_bot_dialog_command_id:o.next_bot_dialog_command_id||null,next_bot_menu_slug_id:o.next_bot_menu_slug_id||null,is_external:o.is_external||!1,need_log_user_action:o.need_log_user_action||!1,rules_if:o.rules_if||null,rules_else_page_id:o.rules_else_page_id||null,audios:o.audios||[],documents:o.documents||[],videos:o.videos||[],rules_if_message:o.rules_if_message||null,rules_else_message:o.rules_else_message||null},this.pageForm.id!=null&&this.pageForm.next_page_id!=null&&this.loadPageChains()})},copyToClipBoard(o){navigator.clipboard.writeText(o).then(()=>{this.$notify({title:"Копирование",text:"Ссылка скопирована в буфер"})}).catch(t=>{this.$notify({title:"Копирование",text:"Ошибка копирования",type:"error"})})},associateDialog(o){this.pageForm.next_bot_dialog_command_id=o.id},associateSlug(o){this.pageForm.next_bot_menu_slug_id=o.id},loadCurrentBot(o=null){return this.$store.dispatch("updateCurrentBot",{bot:o}).then(()=>{this.bot=this.getCurrentBot})},clearLinks(){this.links=[],this.pageForm.next_page_id=null},attachPage(o){this.links.length==0&&(o.id!=this.pageForm.id?(this.$notify({title:"Конструктор страниц",text:"Вы успешно связали страницы!",type:"success"}),this.pageForm.next_page_id=o.id):this.$notify({title:"Конструктор страниц",text:"Вы не можете связать данную страницу с собой",type:"error"})),(this.page==null?this.links.findIndex(s=>s.id===o.id)!=-1:this.links.findIndex(s=>s.id===o.id)!=-1||o.id===this.page.id)||this.links.push(o)},injectContent(o){this.pageForm.content?this.pageForm.content+=o.text:this.pageForm.content=o.text},clearForm(){this.photos=[],this.pageForm={id:null,content:null,command:null,slug:null,comment:null,sticker:null,images:[],reply_keyboard:null,inline_keyboard:null,is_external:!1,need_log_user_action:!1,videos:[],audios:[],documents:[],reply_keyboard_title:null,reply_keyboard_id:null,inline_keyboard_id:null,next_page_id:null,next_menu_slug:null,next_bot_dialog_command_id:null,next_bot_menu_slug_id:null,rules_if_message:null,rules_else_message:null},this.photos=[],this.showReplyTemplateSelector=!1,this.showInlineTemplateSelector=!1,this.need_page_images=!1,this.need_page_video=!1,this.need_inline_menu=!1,this.need_reply_menu=!1,this.need_attach_page=!1,this.need_attach_dialog=!1,this.need_attach_slug=!1,this.need_rules=!1,this.need_page_audios=!1,this.need_page_documents=!1,this.need_page_sticker=!1,this.links=[],this.$nextTick(()=>{this.need_clean=!1})},openSaveModal(){(this.pageForm.comment||"").length===0&&(this.pageForm.comment=this.pageForm.command),this.saveModal.show()},submitPage(){let o=new FormData;if(Object.keys(this.pageForm).forEach(t=>{const s=this.pageForm[t]||"";typeof s=="object"?o.append(t,JSON.stringify(s)):o.append(t,s)}),this.bot&&o.append("bot_id",this.bot.id),this.photos.length>0)for(let t=0;t<this.photos.length;t++)o.append("photos[]",this.photos[t]);this.$store.dispatch(this.pageForm.id==null?"createPage":"updatePage",{pageForm:o}).then(t=>{this.pageForm.id==null&&this.preparePageForm(t.data),this.links.length>0&&this.$store.dispatch("storePageChains",{dataObject:{start_page_id:t.data.id,links:this.links.map(s=>s.id)}}),this.need_stay_after_save||(this.load=!0,this.$nextTick(()=>{this.load=!1,this.clearForm()})),this.loaded_page_list=!1,this.$nextTick(()=>{this.loaded_page_list=!0}),this.saveModal.hide(),this.$emit("callback",t.data),this.$notify({title:"Конструктор ботов",text:this.pageForm.id==null?"Страница успешно создана!":"Страница успешно обновлена!",type:"success"}),this.$store.dispatch("loadPages",{dataObject:{botId:this.bot.id,needNewFirst:!0},page:localStorage.getItem(`cashman_pagelist_${this.bot.id}_page_index`)||0})}).catch(t=>{})},saveInlineKeyboard(o){this.pageForm.inline_keyboard=o},selectReplyKeyboard(o){this.pageForm.reply_keyboard=o,this.showReplyTemplateSelector=!1},selectInlineKeyboard(o){this.pageForm.inline_keyboard=o,this.showInlineTemplateSelector=!1},saveReplyKeyboard(o){this.pageForm.reply_keyboard=o},saveReplyKeyboardSettings(o){this.pageForm.reply_keyboard_settings=o},getPhoto(o){return{imageUrl:URL.createObjectURL(o)}},removePhoto(o){this.photos.splice(o,1)},removeImage(o){this.pageForm.images.splice(o,1)},onChangePhotos(o){const t=o.target.files;for(let s=0;s<t.length;s++)this.photos.push(t[s])},onChange(o){this.pageForm.content=o},selectPhoto(o){this.pageForm.images||(this.pageForm.images=[]);let t=this.pageForm.images.indexOf(o.file_id);t!==-1?this.pageForm.images.splice(t,1):this.pageForm.images.push(o.file_id)},selectSticker(o){this.pageForm.sticker=o.file_id},selectVideo(o){this.pageForm.videos||(this.pageForm.videos=[]);let t=this.pageForm.videos.indexOf(o.file_id);t!==-1?this.pageForm.videos.splice(t,1):this.pageForm.videos.push(o.file_id)},selectAudio(o){this.pageForm.audios||(this.pageForm.audios=[]);let t=this.pageForm.audios.indexOf(o.file_id);if(o.type==="voice"){if(t!==-1){this.pageForm.audios.splice(t,1);return}this.pageForm.audios=[o.file_id];return}t!==-1?this.pageForm.audios.splice(t,1):this.pageForm.audios.push(o.file_id)},selectDocument(o){this.pageForm.documents||(this.pageForm.documents=[]);let t=this.pageForm.documents.indexOf(o.file_id);t!==-1?this.pageForm.documents.splice(t,1):this.pageForm.documents.push(o.file_id)},pageListCallback(o){this.$notify("Вы выбрали страницу из списка! Все остальные действия будут производится для этой страницы"),this.load=!0,this.preparePageForm(o),this.$nextTick(()=>{this.load=!1})}}},Sp=Object.assign(Cp,{__name:"Page",setup(o){return(t,s)=>{const n=q("Popper"),a=Q("lazy");return l(),i(v,null,[t.pageForm.id?(l(),i("div",Xd,[e("div",Zd,[e("div",xd,[er,m(" Вы в режиме редактирования страницы (кнопки) "),e("strong",tr,u(t.page.slug?t.page.slug.command:"Без названия"),1),m(", если хотите создать новую нажмите "),e("a",{href:"javascript:void(0)",class:"btn btn-primary ml-2",onClick:s[0]||(s[0]=(...d)=>t.clearForm&&t.clearForm(...d))},"Создать новую страницу")])])])):r("",!0),t.bot?(l(),i("form",{key:1,id:"page-construct",class:"py-3",onSubmit:s[43]||(s[43]=S((...d)=>t.openSaveModal&&t.openSaveModal(...d),["prevent"]))},[t.hasParts?(l(),i("div",sr,[e("div",or,[lr,e("ul",ir,[e("li",{class:_(["mr-1",{active:t.need_page_images}]),title:"Изображения"},ar,2),e("li",{class:_(["mr-1",{active:t.need_page_sticker}]),title:"Стикеры"},rr,2),e("li",{class:_(["mr-1",{active:t.need_page_video}]),title:"Видео"},ur,2),e("li",{class:_(["mr-1",{active:t.need_page_audios}]),title:"Аудио"},_r,2),e("li",{class:_(["mr-1",{active:t.need_page_documents}]),title:"Документы"},pr,2),e("li",{class:_(["mr-1",{active:t.need_attach_page}]),title:"Страницы"},fr,2),e("li",{class:_(["mr-1",{active:t.need_attach_slug}]),title:"Скрипты"},vr,2),e("li",{class:_(["mr-1",{active:t.need_attach_dialog}]),title:"Диалоги"},yr,2),e("li",{class:_(["mr-1",{active:t.need_rules}]),title:"Правила"},Fr,2),e("li",{class:_(["mr-1",{active:t.need_reply_menu}]),title:"Нижнее меню"},Cr,2),e("li",{title:"Текстовое меню",class:_({active:t.need_inline_menu})},jr,2)])])])):r("",!0),e("div",qr,[e("div",zr,[e("label",Or,[p(n,null,{content:h(()=>[Pr]),default:h(()=>[Vr]),_:1}),m(" Команда "),Ar]),c(e("input",{type:"text",class:"form-control",placeholder:"Команда","aria-label":"Команда","onUpdate:modelValue":s[1]||(s[1]=d=>t.pageForm.command=d),maxlength:"255","aria-describedby":"bot-domain",required:""},null,512),[[b,t.pageForm.command]])]),e("div",Qr,[e("div",Ur,[t.pageForm.id||t.need_clean?(l(),i("button",Ir,Br)):r("",!0),t.pageForm.id||t.need_clean?(l(),i("button",{key:1,type:"button",onClick:s[2]||(s[2]=(...d)=>t.clearForm&&t.clearForm(...d)),title:"Очистить \\ Новая страница",class:"btn btn-outline-primary min-menu-btn"},Mr)):r("",!0),Dr])])]),c(e("div",Er,[e("div",Lr,[e("label",Kr,[e("div",null,[p(n,null,{content:h(()=>[Yr]),default:h(()=>[Nr]),_:1}),m(" Текстовое содержимое страницы "),Jr]),p(gt,{param:"content",onCallback:t.injectContent},null,8,["onCallback"])]),e("div",Hr,[c(e("textarea",{class:"form-control","onUpdate:modelValue":s[3]||(s[3]=d=>t.pageForm.content=d),maxlength:"4096",placeholder:"Введите текст",id:"floatingTextarea2",style:{"min-height":"150px"}},null,512),[[b,t.pageForm.content]]),e("label",Wr,[m("Содержимое страницы "),t.pageForm.content?(l(),i("span",Gr,u(t.pageForm.content.length)+"/4096 ",1)):r("",!0)])])]),e("div",Xr,[e("ul",Zr,[e("li",{class:"nav-item",onClick:s[4]||(s[4]=d=>t.tab=0)},[e("a",{class:_([{active:t.tab===0,"primary-mark":t.need_reply_menu},"nav-link d-flex flex-column justify-content-center align-items-center font-12"]),href:"javascript:void(0)"},tc,2)]),e("li",{class:"nav-item",onClick:s[5]||(s[5]=d=>t.tab=1)},[e("a",{class:_([{active:t.tab===1,"primary-mark":t.need_inline_menu},"nav-link d-flex flex-column justify-content-center align-items-center font-12"]),href:"javascript:void(0)"},lc,2)]),e("li",{class:"nav-item",onClick:s[6]||(s[6]=d=>t.tab=2)},[e("a",{class:_([{active:t.tab===2,"primary-mark":t.need_page_images},"nav-link d-flex flex-column justify-content-center align-items-center font-12"]),href:"javascript:void(0)"},ac,2)]),e("li",{class:"nav-item",onClick:s[7]||(s[7]=d=>t.tab=3)},[e("a",{class:_([{active:t.tab===3,"primary-mark":t.need_page_video},"nav-link d-flex flex-column justify-content-center align-items-center font-12"]),href:"javascript:void(0)"},cc,2)]),e("li",{class:"nav-item",onClick:s[8]||(s[8]=d=>t.tab=4)},[e("a",{class:_([{active:t.tab===4,"primary-mark":t.need_page_sticker},"nav-link d-flex flex-column justify-content-center align-items-center font-12"]),href:"javascript:void(0)"},_c,2)]),e("li",{class:"nav-item",onClick:s[9]||(s[9]=d=>t.tab=5)},[e("a",{class:_([{active:t.tab===5,"primary-mark":t.need_page_audios},"nav-link d-flex flex-column justify-content-center align-items-center font-12"]),href:"javascript:void(0)"},bc,2)]),e("li",{class:"nav-item",onClick:s[10]||(s[10]=d=>t.tab=6)},[e("a",{class:_([{active:t.tab===6,"primary-mark":t.need_page_documents},"nav-link d-flex flex-column justify-content-center align-items-center font-12"]),href:"javascript:void(0)"},vc,2)]),e("li",{class:"nav-item",onClick:s[11]||(s[11]=d=>t.tab=7)},[e("a",{class:_([{active:t.tab===7,"primary-mark":t.need_attach_page},"nav-link d-flex flex-column justify-content-center align-items-center font-12"]),href:"javascript:void(0)"},kc,2)]),e("li",{class:"nav-item",onClick:s[12]||(s[12]=d=>t.tab=8)},[e("a",{class:_([{active:t.tab===8,"primary-mark":t.need_attach_slug},"nav-link d-flex flex-column justify-content-center align-items-center font-12"]),href:"javascript:void(0)"},Cc,2)]),e("li",{class:"nav-item",onClick:s[13]||(s[13]=d=>t.tab=9)},[e("a",{class:_([{active:t.tab===9,"primary-mark":t.need_attach_dialog},"nav-link d-flex flex-column justify-content-center align-items-center font-12"]),href:"javascript:void(0)"},qc,2)]),e("li",{class:"nav-item",onClick:s[14]||(s[14]=d=>t.tab=10)},[e("a",{class:_([{active:t.tab===10,"primary-mark":t.need_rules},"nav-link d-flex flex-column justify-content-center align-items-center font-12"]),href:"javascript:void(0)"},Vc,2)])])]),c(e("div",null,[t.need_reply_menu?(l(),i("div",Pc,[e("div",Ac,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[15]||(s[15]=d=>t.need_reply_menu=d),type:"checkbox",id:"need-reply-menu"},null,512),[[k,t.need_reply_menu]]),Qc])])):r("",!0),t.need_reply_menu?(l(),i("div",Uc,[e("div",Ic,[e("div",Tc,[Bc,e("button",{class:_(["btn",{"btn-outline-primary":!t.showReplyTemplateSelector,"btn-primary":t.showReplyTemplateSelector}]),type:"button",onClick:s[16]||(s[16]=d=>t.showReplyTemplateSelector=!t.showReplyTemplateSelector)},[t.showReplyTemplateSelector?(l(),i("span",Mc," Скрыть шаблоны меню")):(l(),i("span",Rc," Открыть шаблоны меню"))],2)]),e("div",Dc,[e("div",Ec,[e("div",Lc,[e("label",Kc,[p(n,null,{content:h(()=>[Yc]),default:h(()=>[Nc]),_:1}),m(" Заголовок ")]),c(e("input",{type:"text",class:"form-control",placeholder:"Заголовок меню","aria-label":"Заголовок меню","onUpdate:modelValue":s[17]||(s[17]=d=>t.pageForm.reply_keyboard_title=d),maxlength:"255","aria-describedby":"bot-domain"},null,512),[[b,t.pageForm.reply_keyboard_title]])])]),t.showReplyTemplateSelector?(l(),$(T,{key:0,class:"mb-2",type:"reply",onSelect:t.selectReplyKeyboard,"select-mode":!0},null,8,["onSelect"])):(l(),$(U,{key:1,type:"reply",onSave:t.saveReplyKeyboard,onSaveSettings:t.saveReplyKeyboardSettings,"edited-keyboard":t.pageForm.reply_keyboard},null,8,["onSave","onSaveSettings","edited-keyboard"]))])])])):(l(),i("div",Jc,[e("div",Hc,[e("div",Wc,[c(e("img",Gc,null,512),[[a,"../images/icon.png"]])]),Xc,Zc,e("div",xc,[e("button",{disabled:t.need_reply_menu,onClick:s[18]||(s[18]=d=>t.need_reply_menu=!0),class:_([{"btn-primary":!t.need_reply_menu,"btn-outline-secondary":t.need_reply_menu},"d-inline-flex align-items-center btn btn-lg px-4 rounded-pill"]),type:"button"}," Добавить ",10,eu),tu])])]))],512),[[z,t.tab===0]]),c(e("div",null,[t.need_inline_menu?(l(),i("div",su,[e("div",ou,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[19]||(s[19]=d=>t.need_inline_menu=d),type:"checkbox",id:"need-inline-menu"},null,512),[[k,t.need_inline_menu]]),lu])])):r("",!0),t.need_inline_menu?(l(),i("div",iu,[e("div",nu,[e("div",au,[du,e("button",{class:_(["btn",{"btn-outline-primary":!t.showInlineTemplateSelector,"btn-primary":t.showInlineTemplateSelector}]),type:"button",onClick:s[20]||(s[20]=d=>t.showInlineTemplateSelector=!t.showInlineTemplateSelector)},[t.showInlineTemplateSelector?(l(),i("span",cu," Скрыть шаблоны меню")):(l(),i("span",ru," Открыть шаблоны меню"))],2)]),e("div",uu,[t.showInlineTemplateSelector?(l(),$(T,{key:0,class:"mb-2",type:"inline",onSelect:t.selectInlineKeyboard,"select-mode":!0},null,8,["onSelect"])):(l(),$(U,{key:1,type:"inline",onSave:t.saveInlineKeyboard,"edited-keyboard":t.pageForm.inline_keyboard},null,8,["onSave","edited-keyboard"]))])])])):(l(),i("div",mu,[e("div",_u,[e("div",hu,[c(e("img",pu,null,512),[[a,"../images/icon.png"]])]),bu,fu,e("div",gu,[e("button",{disabled:t.need_inline_menu,onClick:s[21]||(s[21]=d=>t.need_inline_menu=!0),class:_([{"btn-primary":!t.need_inline_menu,"btn-outline-secondary":t.need_inline_menu},"d-inline-flex align-items-center btn btn-lg px-4 rounded-pill"]),type:"button"}," Добавить ",10,vu),$u])])]))],512),[[z,t.tab===1]]),c(e("div",null,[t.need_page_images?(l(),i("div",yu,[e("div",ku,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[22]||(s[22]=d=>t.need_page_images=d),type:"checkbox",id:"need-page-images"},null,512),[[k,t.need_page_images]]),Fu])])):r("",!0),t.need_page_images?(l(),i("div",wu,[e("div",Cu,[Su,e("div",ju,[e("label",qu,[m(" + "),e("input",{type:"file",id:"photos",multiple:"",accept:"image/*",onChange:s[23]||(s[23]=(...d)=>t.onChangePhotos&&t.onChangePhotos(...d)),style:{display:"none"}},null,32)]),e("div",zu,[t.photos.length>0?(l(),i("div",Ou,[(l(!0),i(v,null,y(t.photos,(d,g)=>(l(),i("div",Vu,[c(e("img",null,null,512),[[a,t.getPhoto(d).imageUrl]]),e("div",Pu,[e("a",{onClick:f=>t.removePhoto(g)},"Удалить",8,Au)])]))),256))])):r("",!0),t.pageForm.images.length>0?(l(),i("h6",Qu,"Ранее загруженные фотографии")):r("",!0),t.pageForm.images.length>0?(l(),i("div",Uu,[(l(!0),i(v,null,y(t.pageForm.images,(d,g)=>(l(),i("div",Iu,[c(e("img",null,null,512),[[a,"/images-by-bot-id/"+t.bot.id+"/"+d]]),e("div",Tu,[e("a",{onClick:f=>t.removeImage(g)},"Удалить",8,Bu)])]))),256))])):r("",!0)])])])])):(l(),i("div",Ru,[e("div",Mu,[e("div",Du,[c(e("img",Eu,null,512),[[a,"../images/icon.png"]])]),Lu,Ku,e("div",Nu,[e("button",{disabled:t.need_page_images,onClick:s[24]||(s[24]=d=>t.need_page_images=!0),class:_([{"btn-primary":!t.need_page_images,"btn-outline-secondary":t.need_page_images},"d-inline-flex align-items-center btn btn-lg px-4 rounded-pill"]),type:"button"}," Добавить ",10,Yu),Ju])])]))],512),[[z,t.tab===2]]),c(e("div",null,[t.need_page_video?(l(),i("div",Hu,[e("div",Wu,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[25]||(s[25]=d=>t.need_page_video=d),type:"checkbox",id:"need-page-video"},null,512),[[k,t.need_page_video]]),Gu])])):r("",!0),t.need_page_video?(l(),i("div",Xu,[p(O,{"need-video":!0,"need-video-note":!0,selected:t.pageForm.videos,onSelect:t.selectVideo},null,8,["selected","onSelect"])])):(l(),i("div",Zu,[e("div",xu,[e("div",em,[c(e("img",tm,null,512),[[a,"../images/icon.png"]])]),sm,om,e("div",lm,[e("button",{disabled:t.need_page_video,onClick:s[26]||(s[26]=d=>t.need_page_video=!0),class:_([{"btn-primary":!t.need_page_video,"btn-outline-secondary":t.need_page_video},"d-inline-flex align-items-center btn btn-lg px-4 rounded-pill"]),type:"button"}," Добавить ",10,im),nm])])]))],512),[[z,t.tab===3]]),c(e("div",null,[t.need_page_sticker?(l(),i("div",am,[e("div",dm,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[27]||(s[27]=d=>t.need_page_sticker=d),type:"checkbox",id:"need-page-sticker"},null,512),[[k,t.need_page_sticker]]),rm])])):r("",!0),t.need_page_sticker?(l(),i("div",cm,[p(O,{"need-sticker":!0,selected:[t.pageForm.sticker],onSelect:t.selectSticker},null,8,["selected","onSelect"])])):(l(),i("div",um,[e("div",mm,[e("div",_m,[c(e("img",hm,null,512),[[a,"../images/icon.png"]])]),pm,bm,e("div",fm,[e("button",{disabled:t.need_page_sticker,onClick:s[28]||(s[28]=d=>t.need_page_sticker=!0),class:_([{"btn-primary":!t.need_page_sticker,"btn-outline-secondary":t.need_page_sticker},"d-inline-flex align-items-center btn btn-lg px-4 rounded-pill"]),type:"button"}," Добавить ",10,gm),vm])])]))],512),[[z,t.tab===4]]),c(e("div",null,[t.need_page_audios?(l(),i("div",$m,[e("div",ym,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[29]||(s[29]=d=>t.need_page_audios=d),type:"checkbox",id:"need-page-audio"},null,512),[[k,t.need_page_audios]]),km])])):r("",!0),t.need_page_audios?(l(),i("div",Fm,[p(O,{"need-audio":!0,selected:t.pageForm.audios,onSelect:t.selectAudio},null,8,["selected","onSelect"])])):(l(),i("div",wm,[e("div",Cm,[e("div",Sm,[c(e("img",jm,null,512),[[a,"../images/icon.png"]])]),qm,zm,e("div",Om,[e("button",{disabled:t.need_page_audios,onClick:s[30]||(s[30]=d=>t.need_page_audios=!0),class:_([{"btn-primary":!t.need_page_audios,"btn-outline-secondary":t.need_page_audios},"d-inline-flex align-items-center btn btn-lg px-4 rounded-pill"]),type:"button"}," Добавить ",10,Vm),Pm])])]))],512),[[z,t.tab===5]]),c(e("div",null,[t.need_page_documents?(l(),i("div",Am,[e("div",Qm,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[31]||(s[31]=d=>t.need_page_documents=d),type:"checkbox",id:"need-page-document"},null,512),[[k,t.need_page_documents]]),Um])])):r("",!0),t.need_page_documents?(l(),i("div",Im,[p(O,{"need-document":!0,selected:t.pageForm.documents,onSelect:t.selectDocument},null,8,["selected","onSelect"])])):(l(),i("div",Tm,[e("div",Bm,[e("div",Rm,[c(e("img",Mm,null,512),[[a,"../images/icon.png"]])]),Dm,Em,e("div",Lm,[e("button",{disabled:t.need_page_documents,onClick:s[32]||(s[32]=d=>t.need_page_documents=!0),class:_([{"btn-primary":!t.need_page_documents,"btn-outline-secondary":t.need_page_documents},"d-inline-flex align-items-center btn btn-lg px-4 rounded-pill"]),type:"button"}," Добавить ",10,Km),Nm])])]))],512),[[z,t.tab===6]]),c(e("div",null,[e("div",Ym,[e("div",Jm,[e("div",Hm,[c(e("img",Wm,null,512),[[a,"../images/icon.png"]])]),Gm,Xm,t.pageForm.next_page_id?(l(),i("p",Zm,"Связано со страницей #"+u(t.pageForm.next_page_id),1)):r("",!0),e("div",xm,[t.pageForm.next_page_id?(l(),i("button",{key:0,class:"d-inline-flex align-items-center btn btn-lg px-4 rounded-pill btn-danger",type:"button",onClick:s[33]||(s[33]=(...d)=>t.clearLinks&&t.clearLinks(...d))},"Очистить ")):(l(),i("button",e_," Связать ")),t_]),s_,e("div",o_,[l_,i_,(l(!0),i(v,null,y(t.links,(d,g)=>(l(),i("div",n_,[e("button",{type:"button",onClick:f=>t.removeLink(g),class:_([{"btn-danger":t.chainCollapseTest(d)},"btn btn-primary position-relative rounded-5"])},[m(u(d.slug.command||"-")+" ",1),e("span",d_," #"+u(d.id),1)],10,a_),g<t.links.length-1?(l(),i("i",r_)):r("",!0)]))),256)),t.links.length>0?(l(),i("i",c_)):r("",!0),u_])])])],512),[[z,t.tab===7]]),c(e("div",null,[t.need_attach_slug?(l(),i("div",m_,[__,e("div",h_,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[34]||(s[34]=d=>t.need_show_global_slug_list=d),type:"checkbox",id:"need-show-global-slug-list"},null,512),[[k,t.need_show_global_slug_list]]),p_]),t.bot&&t.need_show_global_slug_list?(l(),$(J,{key:0,"can-add":!0,bot:t.bot,onCallback:t.loadSlugs},null,8,["bot","onCallback"])):r("",!0)])):r("",!0),t.need_attach_slug?(l(),i("div",b_,[e("div",f_,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[35]||(s[35]=d=>t.need_attach_slug=d),type:"checkbox",id:"need-slug-attach"},null,512),[[k,t.need_attach_slug]]),g_])])):r("",!0),t.need_attach_slug?(l(),i("div",v_,[t.pageForm.next_bot_menu_slug_id?(l(),i("div",$_,[m(" Связано со скриптом #"+u(t.pageForm.next_bot_menu_slug_id)+" ",1),e("a",{class:"btn btn-link text-danger",onClick:s[36]||(s[36]=d=>t.pageForm.next_bot_menu_slug_id=null)},"Очистить")])):r("",!0),t.bot&&t.load_slug_simple_list?(l(),$(il,{key:1,global:!0,selected:[t.pageForm.next_bot_menu_slug_id],onCallback:t.associateSlug,bot:t.bot},null,8,["selected","onCallback","bot"])):r("",!0)])):(l(),i("div",y_,[e("div",k_,[e("div",F_,[c(e("img",w_,null,512),[[a,"../images/icon.png"]])]),C_,S_,e("div",j_,[e("button",{disabled:t.need_attach_slug,onClick:s[37]||(s[37]=d=>t.need_attach_slug=!0),class:_([{"btn-primary":!t.need_attach_slug,"btn-outline-secondary":t.need_attach_slug},"d-inline-flex align-items-center btn btn-lg px-4 rounded-pill"]),type:"button"}," Добавить ",10,q_),z_])])]))],512),[[z,t.tab===8]]),c(e("div",null,[t.need_attach_dialog?(l(),i("div",O_,[e("div",V_,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[38]||(s[38]=d=>t.need_attach_dialog=d),type:"checkbox",id:"need-dialog-attach"},null,512),[[k,t.need_attach_dialog]]),P_])])):r("",!0),t.need_attach_dialog?(l(),i("div",A_,[t.pageForm.next_bot_dialog_command_id?(l(),i("p",Q_,[m("Связано с диалогом #"+u(t.pageForm.next_bot_dialog_command_id)+" ",1),e("a",{class:"btn btn-link",onClick:s[39]||(s[39]=d=>t.pageForm.next_bot_dialog_command_id=null)},"Очистить")])):r("",!0),t.bot?(l(),$(le,{key:1,onSelectDialog:t.associateDialog,bot:t.bot},null,8,["onSelectDialog","bot"])):r("",!0)])):(l(),i("div",U_,[e("div",I_,[e("div",T_,[c(e("img",B_,null,512),[[a,"../images/icon.png"]])]),R_,M_,e("div",D_,[e("button",{disabled:t.need_attach_dialog,onClick:s[40]||(s[40]=d=>t.need_attach_dialog=!0),class:_([{"btn-primary":!t.need_attach_dialog,"btn-outline-secondary":t.need_attach_dialog},"d-inline-flex align-items-center btn btn-lg px-4 rounded-pill"]),type:"button"}," Добавить ",10,E_),L_])])]))],512),[[z,t.tab===9]]),c(e("div",null,[t.need_rules?(l(),i("div",K_,[e("div",N_,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[41]||(s[41]=d=>t.need_rules=d),type:"checkbox",id:"need-rules"},null,512),[[k,t.need_rules]]),Y_])])):r("",!0),t.need_rules?(l(),i("div",J_,[p(Pd,{bot:t.bot,"rules-form":t.pageForm},null,8,["bot","rules-form"])])):(l(),i("div",H_,[e("div",W_,[e("div",G_,[c(e("img",X_,null,512),[[a,"../images/icon.png"]])]),Z_,x_,e("div",eh,[e("button",{disabled:t.need_rules,onClick:s[42]||(s[42]=d=>t.need_rules=!0),class:_([{"btn-primary":!t.need_rules,"btn-outline-secondary":t.need_rules},"d-inline-flex align-items-center btn btn-lg px-4 rounded-pill"]),type:"button"}," Добавить ",10,th),sh])])]))],512),[[z,t.tab===10]])],512),[[z,!t.pageForm.is_external]])],32)):r("",!0),oh,e("div",lh,[e("div",ih,[e("div",nh,[ah,e("div",dh,[t.bot?(l(),i("div",rh,[e("div",ch,[e("h6",uh,[e("span",null,[m("Вы создаете страницу для "),e("a",{href:"https://t.me/"+t.bot.bot_domain,target:"_blank"},u(t.bot.bot_domain),9,mh)])])])])):r("",!0),e("form",{onSubmit:s[50]||(s[50]=S((...d)=>t.submitPage&&t.submitPage(...d),["prevent"])),class:"row"},[e("div",_h,[hh,e("ul",ph,[e("li",{class:_({active:t.need_page_images})},fh,2),e("li",{class:_({active:t.need_page_sticker})},vh,2),e("li",{class:_({active:t.need_page_video})},yh,2),e("li",{class:_({active:t.need_page_audios})},Fh,2),e("li",{class:_({active:t.need_page_documents})},Ch,2),e("li",{class:_({active:t.need_attach_page})},jh,2),e("li",{class:_({active:t.need_attach_slug})},zh,2),e("li",{class:_({active:t.need_attach_dialog})},Vh,2),e("li",{class:_({active:t.need_rules})},Ah,2),e("li",{class:_({active:t.need_reply_menu})},Uh,2),e("li",{class:_({active:t.need_inline_menu})},Th,2)])]),t.pageForm.id?(l(),i("div",Bh,[e("div",Rh,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[44]||(s[44]=d=>t.need_show_qr_and_link=d),type:"checkbox",id:"need-show-qr-and-link"},null,512),[[k,t.need_show_qr_and_link]]),Mh])])):r("",!0),t.pageForm.id&&t.need_show_qr_and_link?(l(),i("div",Dh,[e("p",null,[m("Ссылка на текущую страницу: "),e("span",{class:"bg-secondary font-bold cursor-pointer",onClick:s[45]||(s[45]=d=>t.copyToClipBoard(t.pageLink))},u(t.pageLink),1)]),e("div",Eh,[c(e("img",Lh,null,512),[[a,t.qr]])])])):r("",!0),e("div",Kh,[e("label",Nh,[p(n,null,{content:h(()=>[Jh]),default:h(()=>[Yh]),_:1}),m(" Описание страницы "),Hh]),c(e("textarea",{type:"text",class:"form-control",placeholder:"Описание страницы","aria-label":"Описание страницы","onUpdate:modelValue":s[46]||(s[46]=d=>t.pageForm.comment=d),maxlength:"255","aria-describedby":"bot-domain",required:""},`
            `,512),[[b,t.pageForm.comment]])]),e("div",Wh,[e("div",Gh,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[47]||(s[47]=d=>t.pageForm.is_external=d),type:"checkbox",id:"is-external"},null,512),[[k,t.pageForm.is_external]]),Xh]),t.pageForm.is_external?(l(),i("div",Zh,[m(" Обработка ссылок передана на внешний адрес, указанный в настройках бота! Все запросы по данной кнопке будут отправлены на указанный URL-адрес: "),e("strong",null,u(t.bot.callback_link||"не указано")+".",1),t.bot.callback_link?r("",!0):(l(),i("p",xh,[m("Внешня ссылка не установлена! Перейдите в раздел "),ep,m(", затем "),tp,m(" и установите ссылку для внешнего управления в поле "),sp,m("!")]))])):r("",!0)]),e("div",op,[e("div",lp,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[48]||(s[48]=d=>t.pageForm.need_log_user_action=d),type:"checkbox",id:"need_log_user_action"},null,512),[[k,t.pageForm.need_log_user_action]]),ip])]),e("div",np,[e("div",ap,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[49]||(s[49]=d=>t.need_stay_after_save=d),type:"checkbox",id:"need-stay-after-save"},null,512),[[k,t.need_stay_after_save]]),dp])]),rp],32)]),cp])])]),e("div",up,[e("div",mp,[e("div",_p,[e("div",hp,[p(K,{current:t.pageForm.id,selected:t.selectedLinkIds,onCallback:t.attachPage,editor:!1},null,8,["current","selected","onCallback"])])])])]),e("div",pp,[e("div",bp,[e("div",fp,[e("div",gp,[t.page?(l(),$(Gd,{key:0,page:t.page},null,8,["page"])):(l(),i("p",vp,"Сперва сохраните страницу"))])])])]),m("- "),e("div",$p,[yp,e("div",kp,[e("div",Fp,[e("div",wp,[t.loaded_page_list?(l(),$(K,{key:0,editor:!0,current:t.page,onCallback:t.pageListCallback},null,8,["current","onCallback"])):r("",!0)])])])])],64)}}}),jp={props:["bot","item"],data(){return{sectionForm:{section:null},categoryForm:{label:null},tab:0,types:[{title:"Готовый продукт",value:1},{title:"Товар на вес",value:2},{title:"Конструктор товара",value:3}],productCategories:[],sections:["Общие характеристики","Дополнительная информация"],photos:[],categories:[],removed_options:[],productForm:{article:null,vk_product_id:null,title:null,description:null,images:[],type:1,old_price:null,current_price:null,variants:[],in_stop_list_at:null,bot_id:null,options:[],reviews:[],categories:[]}}},computed:{...C(["getProductCategories"]),filteredCategories(){return this.productCategories.length===0?this.categories:this.categories.filter(o=>this.productCategories.indexOf(o.value)===-1)}},mounted(){this.loadProductCategories(),this.item&&this.$nextTick(()=>{this.productForm={id:this.item.id||null,article:this.item.article||null,vk_product_id:this.item.vk_product_id||null,title:this.item.title||null,description:this.item.description||null,images:this.item.images||null,type:this.item.type||1,old_price:this.item.old_price||null,current_price:this.item.current_price||null,variants:this.item.variants||null,in_stop_list_at:this.item.in_stop_list_at||null,bot_id:this.item.bot_id||null,options:this.item.options||null,reviews:this.item.reviews||null},this.options=[],this.item.categories.forEach(o=>{this.productCategories.push(o.id)})})},methods:{prepareCategoryName(o){let t=this.categories.find(s=>s.value===o);return console.log(t),t?t.label:o},addCategory(){const o=this.categoryForm.label;this.productCategories.push(o),this.categoryForm.label=null},selectCategory(o){this.productCategories.push(o.value)},submit(){let o=new FormData;if(Object.keys(this.productForm).forEach(t=>{const s=this.productForm[t]||"";typeof s=="object"?o.append(t,JSON.stringify(s)):o.append(t,s)}),this.bot&&o.append("bot_id",this.bot.id),this.photos.length>0)for(let t=0;t<this.photos.length;t++)o.append("photos[]",this.photos[t]);this.removed_options.length>0&&o.append("removed_options",JSON.stringify(this.removed_options)),this.productCategories.length>0&&o.append("categories",JSON.stringify(this.productCategories)),this.$store.dispatch("saveProduct",{productForm:o}).then(t=>{this.load=!0,this.$notify({title:"Конструктор ботов",text:"Продукт успешно сохранен!",type:"success"}),this.clearForm(),this.$emit("refresh")}).catch(t=>{})},onChangePhotos(o){const t=o.target.files;for(let s=0;s<t.length;s++)this.photos.push(t[s])},loadProductCategories(){this.$store.dispatch("loadProductCategories",{dataObject:{bot_id:this.bot.id}}).then(()=>{this.getProductCategories.forEach(t=>{this.categories.push({value:t.id,label:t.title})})})},getPhoto(o){return{imageUrl:URL.createObjectURL(o)}},removeSection(o){this.sections.splice(o,1)},addSection(){this.sections.push(this.sectionForm.section),this.sectionForm.section=null},addOption(){this.productForm.options||(this.productForm.options=[]),this.productForm.options.push({id:null,key:null,value:null,title:null,section:null})},addVariant(){this.productForm.variants||(this.productForm.variants=[]),this.productForm.variants.push({key:null,value:null})},removeProductCategory(o){this.productCategories.splice(o,1)},removeVariant(o){this.productForm.variants.splice(o,1)},removeOption(o){this.productForm.options[o].id&&this.removed_options.push(this.productForm.options[o].id),this.productForm.options.splice(o,1)},removeImage(o){this.productForm.images.splice(o,1)},removePhoto(o){this.photos.splice(o,1)},clearForm(){const o={article:null,vk_product_id:null,title:null,description:null,images:[],type:1,old_price:null,current_price:null,variants:[],in_stop_list_at:null,bot_id:null,options:[],reviews:[],categories:[]};this.photos=[],this.removed_options=[],this.productCategories=[],this.productForm=o}}},qp={class:"nav nav-tabs"},zp={class:"nav-item"},Op={class:"nav-item"},Vp={class:"nav-item"},Pp={key:0},Ap={class:"col-md-8 d-flex align-items-center"},Qp={class:"form-check"},Up=e("label",{class:"form-check-label",for:"in-stop-list"}," Товар находится в стоп-листе ",-1),Ip={class:"col-md-4 d-flex justify-content-end"},Tp={class:"col-md-12 mb-3"},Bp=["onClick"],Rp={class:"dropdown"},Mp=e("button",{type:"button",class:"btn btn-outline-info w-100","data-bs-toggle":"dropdown","data-bs-display":"static","aria-expanded":"false"},[e("p",{class:"mb-0"},"Выберите категорию")],-1),Dp={class:"dropdown-menu w-100",style:{"overflow-y":"scroll",height:"300px"}},Ep={class:"p-3"},Lp=e("label",{for:"exampleDropdownFormEmail1",class:"form-label"},"Новая категория",-1),Kp={class:"p-3"},Np=e("li",null,[e("hr",{class:"dropdown-divider"})],-1),Yp=["onClick"],Jp={class:"col-md-6"},Hp={class:"form-floating mb-3"},Wp=e("label",{for:"article"},"Артикул товара",-1),Gp={class:"col-md-6"},Xp={class:"form-floating mb-3"},Zp=e("label",{for:"vk-product-id"},"Идентификатор товара VK",-1),xp={class:"col-md-6"},eb={class:"form-floating mb-3"},tb=e("label",{for:"title"},"Названи товара",-1),sb={class:"col-md-6"},ob={class:"form-floating mb-3"},lb=["value"],ib=e("label",{for:"type"},"Тип товара",-1),nb={class:"col-md-12"},ab={class:"form-floating mb-3"},db=e("label",{for:"description"},"Описание товара",-1),rb={class:"col-md-6"},cb={class:"form-floating mb-3"},ub=e("label",{for:"current-price"},"Актуальная цена",-1),mb={class:"col-md-6"},_b={class:"form-floating mb-3"},hb=e("label",{for:"old-price"},"Старая цена",-1),pb={class:"col-md-12 mb-3"},bb={class:"card"},fb={class:"card-header"},gb={key:0},vb={class:"card-body"},$b={class:"row"},yb={class:"col-12 mb-3"},kb={class:"col-md-6 mb-3"},Fb={class:"card w-100"},wb={class:"card-body"},Cb={class:"form-floating mb-3"},Sb=["onUpdate:modelValue","id"],jb=["for"],qb={class:"form-floating mb-3"},zb=["onUpdate:modelValue","id"],Ob=["for"],Vb={class:"card-footer"},Pb=["onClick"],Ab=e("i",{class:"fa-solid fa-trash-can"},null,-1),Qb=[Ab],Ub={class:"col-md-12 mb-3"},Ib={class:"card"},Tb=e("div",{class:"card-header"},[e("h6",null,"Характеристики товара")],-1),Bb={class:"card-body"},Rb={class:"row mb-3"},Mb={class:"col-12"},Db=e("button",{class:"btn btn-outline-info",type:"submit",id:"button-addon2"},"Добавить секцию ",-1),Eb={class:"badge bg-info mr-1"},Lb=["onClick"],Kb=e("i",{class:"fa-solid fa-xmark"},null,-1),Nb=[Kb],Yb={class:"row"},Jb={class:"col-md-4 mb-3"},Hb={class:"card w-100"},Wb={class:"card-body"},Gb={class:"form-floating mb-3"},Xb=["onUpdate:modelValue","id"],Zb=["for"],xb={class:"form-floating mb-3"},e1=["onUpdate:modelValue","id"],t1=["for"],s1={class:"form-floating mb-3"},o1=["onUpdate:modelValue","id"],l1=e("option",{value:null},"Без секции",-1),i1=["value"],n1=["for"],a1={class:"card-footer"},d1=["onClick"],r1=e("i",{class:"fa-solid fa-trash-can"},null,-1),c1=[r1],u1={class:"row"},m1={class:"col-12"},_1={class:"col-md-12 mb-3"},h1=e("h6",null,"Фотографии товара",-1),p1={class:"photo-preview d-flex justify-content-start flex-wrap w-100"},b1={for:"location-photos",style:{"margin-right":"10px"},class:"photo-loader ml-2"},f1=e("span",null,"+",-1),g1={class:"mb-2 img-preview",style:{"margin-right":"10px"}},v1={class:"remove"},$1=["onClick"],y1={class:"mb-2 img-preview",style:{"margin-right":"10px"}},k1={class:"remove"},F1=["onClick"],w1=e("div",{class:"col-12"},[e("button",{type:"submit",class:"btn btn-outline-primary w-100 p-3"},"Сохранить ")],-1),C1={key:1};function S1(o,t,s,n,a,d){const g=Q("lazy");return l(),i(v,null,[e("ul",qp,[e("li",zp,[e("a",{class:_(["nav-link",{active:a.tab===0}]),onClick:t[0]||(t[0]=f=>a.tab=0),"aria-current":"page",href:"#product-form-info"},"Информация о товаре",2)]),e("li",Op,[e("a",{class:_(["nav-link",{active:a.tab===1}]),onClick:t[1]||(t[1]=f=>a.tab=1),href:"#product-reviews"},"Комментарии",2)]),e("li",Vp,[e("a",{class:_(["nav-link",{active:a.tab===2}]),onClick:t[2]||(t[2]=f=>a.tab=2),href:"#product-reviews"},"Заказы",2)])]),a.tab===0?(l(),i("div",Pp,[e("form",{onSubmit:t[19]||(t[19]=S((...f)=>d.submit&&d.submit(...f),["prevent"])),class:"row"},[e("div",Ap,[e("div",Qp,[c(e("input",{class:"form-check-input","onUpdate:modelValue":t[3]||(t[3]=f=>a.productForm.in_stop_list_at=f),type:"checkbox",value:"false",id:"in-stop-list"},null,512),[[k,a.productForm.in_stop_list_at]]),Up])]),e("div",Ip,[e("a",{href:"#",class:"btn btn-link",onClick:t[4]||(t[4]=(...f)=>d.clearForm&&d.clearForm(...f))},"Новый товар")]),e("div",Tp,[(l(!0),i(v,null,y(a.productCategories,(f,F)=>(l(),i("span",{class:"badge bg-info mr-1 mb-1 cursor-pointer",onClick:w=>d.removeProductCategory(F)},u(d.prepareCategoryName(f)),9,Bp))),256)),e("div",Rp,[Mp,e("ul",Dp,[e("div",Ep,[Lp,c(e("input",{type:"text",class:"form-control","onUpdate:modelValue":t[5]||(t[5]=f=>a.categoryForm.label=f),id:"exampleDropdownFormEmail1",placeholder:"Название категории"},null,512),[[b,a.categoryForm.label]])]),e("div",Kp,[e("button",{class:"btn btn-primary w-100",type:"button",onClick:t[6]||(t[6]=(...f)=>d.addCategory&&d.addCategory(...f))},"Добавить категорию ")]),Np,(l(!0),i(v,null,y(d.filteredCategories,f=>(l(),i("li",null,[e("button",{class:"dropdown-item",type:"button",onClick:F=>d.selectCategory(f)},u(f.label),9,Yp)]))),256))])])]),e("div",Jp,[e("div",Hp,[c(e("input",{type:"text","onUpdate:modelValue":t[7]||(t[7]=f=>a.productForm.article=f),class:"form-control",id:"article",placeholder:"name@example.com"},null,512),[[b,a.productForm.article]]),Wp])]),e("div",Gp,[e("div",Xp,[c(e("input",{type:"text","onUpdate:modelValue":t[8]||(t[8]=f=>a.productForm.vk_product_id=f),disabled:!0,class:"form-control",id:"vk-product-id",placeholder:"name@example.com"},null,512),[[b,a.productForm.vk_product_id]]),Zp])]),e("div",xp,[e("div",eb,[c(e("input",{type:"text","onUpdate:modelValue":t[9]||(t[9]=f=>a.productForm.title=f),class:"form-control",id:"title",placeholder:"name@example.com"},null,512),[[b,a.productForm.title]]),tb])]),e("div",sb,[e("div",ob,[c(e("select",{class:"form-select","onUpdate:modelValue":t[10]||(t[10]=f=>a.productForm.type=f),id:"type","aria-label":"Floating label select example"},[(l(!0),i(v,null,y(a.types,(f,F)=>(l(),i("option",{value:f.value},u(f.title),9,lb))),256))],512),[[I,a.productForm.type]]),ib])]),e("div",nb,[e("div",ab,[c(e("textarea",{class:"form-control","onUpdate:modelValue":t[11]||(t[11]=f=>a.productForm.description=f),placeholder:"Leave a comment here",id:"description"},null,512),[[b,a.productForm.description]]),db])]),e("div",rb,[e("div",cb,[c(e("input",{type:"number","onUpdate:modelValue":t[12]||(t[12]=f=>a.productForm.current_price=f),class:"form-control",id:"current-price",placeholder:"name@example.com"},null,512),[[b,a.productForm.current_price]]),ub])]),e("div",mb,[e("div",_b,[c(e("input",{type:"number","onUpdate:modelValue":t[13]||(t[13]=f=>a.productForm.old_price=f),class:"form-control",id:"old-price",placeholder:"name@example.com"},null,512),[[b,a.productForm.old_price]]),hb])]),e("div",pb,[e("div",bb,[e("div",fb,[e("h6",null,[m("Варианты товара "),a.productForm.variants?(l(),i("span",gb,"("+u(a.productForm.variants.length)+")",1)):r("",!0)])]),e("div",vb,[e("div",$b,[e("div",yb,[e("button",{type:"button",class:"btn btn-outline-info w-100",onClick:t[14]||(t[14]=(...f)=>d.addVariant&&d.addVariant(...f))},"Добавить вариант ")]),(l(!0),i(v,null,y(a.productForm.variants,(f,F)=>(l(),i("div",kb,[e("div",Fb,[e("div",wb,[e("div",Cb,[c(e("input",{type:"text","onUpdate:modelValue":w=>a.productForm.variants[F].key=w,class:"form-control",id:"variant-key-"+F,placeholder:"name@example.com",required:""},null,8,Sb),[[b,a.productForm.variants[F].key]]),e("label",{for:"variant-key-"+F},"Ключ",8,jb)]),e("div",qb,[c(e("input",{type:"text","onUpdate:modelValue":w=>a.productForm.variants[F].value=w,class:"form-control",id:"variant-value-"+F,placeholder:"name@example.com",required:""},null,8,zb),[[b,a.productForm.variants[F].value]]),e("label",{for:"variant-value-"+F},"Значение",8,Ob)])]),e("div",Vb,[e("button",{type:"button",class:"btn btn-outline-danger",onClick:w=>d.removeVariant(F)},Qb,8,Pb)])])]))),256))])])])]),e("div",Ub,[e("div",Ib,[Tb,e("div",Bb,[e("div",Rb,[e("div",Mb,[e("form",{onSubmit:t[16]||(t[16]=S((...f)=>d.addSection&&d.addSection(...f),["prevent"])),class:"input-group mb-3"},[c(e("input",{type:"text","onUpdate:modelValue":t[15]||(t[15]=f=>a.sectionForm.section=f),class:"form-control border-info",placeholder:"Название секции","aria-label":"Recipient's username","aria-describedby":"button-addon2",required:""},null,512),[[b,a.sectionForm.section]]),Db],32),(l(!0),i(v,null,y(a.sections,(f,F)=>(l(),i("span",Eb,[m(u(f)+" ",1),e("strong",{onClick:w=>d.removeSection(F)},Nb,8,Lb)]))),256))])]),e("div",Yb,[(l(!0),i(v,null,y(a.productForm.options,(f,F)=>(l(),i("div",Jb,[e("div",Hb,[e("div",Wb,[e("div",Gb,[c(e("input",{type:"text","onUpdate:modelValue":w=>a.productForm.options[F].title=w,class:"form-control",id:"option-title-"+F,placeholder:"name@example.com"},null,8,Xb),[[b,a.productForm.options[F].title]]),e("label",{for:"option-title-"+F},"Название характеристики",8,Zb)]),e("div",xb,[c(e("input",{type:"text","onUpdate:modelValue":w=>a.productForm.options[F].value=w,class:"form-control",id:"option-value-"+F,placeholder:"name@example.com"},null,8,e1),[[b,a.productForm.options[F].value]]),e("label",{for:"option-value-"+F},"Значение характеристики",8,t1)]),e("div",s1,[c(e("select",{class:"form-select","onUpdate:modelValue":w=>a.productForm.options[F].section=w,id:"option-section-"+F,"aria-label":"Floating label select example"},[l1,(l(!0),i(v,null,y(a.sections,w=>(l(),i("option",{value:w},u(w),9,i1))),256))],8,o1),[[I,a.productForm.options[F].section]]),e("label",{for:"option-section-"+F},"Секция товара",8,n1)])]),e("div",a1,[e("button",{type:"button",class:"btn btn-outline-danger",onClick:w=>d.removeOption(F)},c1,8,d1)])])]))),256))]),e("div",u1,[e("div",m1,[e("button",{type:"button",class:"btn btn-outline-info w-100",onClick:t[17]||(t[17]=(...f)=>d.addOption&&d.addOption(...f))},"Добавить характеристику ")])])])])]),e("div",_1,[h1,e("div",p1,[e("label",b1,[f1,e("input",{type:"file",id:"location-photos",multiple:"",accept:"image/*",onChange:t[18]||(t[18]=(...f)=>d.onChangePhotos&&d.onChangePhotos(...f)),style:{display:"none"}},null,32)]),a.productForm.images?(l(!0),i(v,{key:0},y(a.productForm.images,(f,F)=>(l(),i("div",g1,[c(e("img",null,null,512),[[g,f]]),e("div",v1,[e("a",{onClick:w=>d.removeImage(F)},"Удалить",8,$1)])]))),256)):r("",!0),a.photos.length>0?(l(!0),i(v,{key:1},y(a.photos,(f,F)=>(l(),i("div",y1,[c(e("img",null,null,512),[[g,d.getPhoto(f).imageUrl]]),e("div",k1,[e("a",{onClick:w=>d.removePhoto(F)},"Удалить",8,F1)])]))),256)):r("",!0)])]),w1],32)])):r("",!0),a.tab===1?(l(),i("div",C1," Отзывы ")):r("",!0)],64)}const j1=A(jp,[["render",S1]]),q1={props:["item"],data(){return{bot:null}},methods:{preparedImgUrl(o){return o.toLocaleLowerCase().startsWith("https://")||o.toLocaleLowerCase().startsWith("http://")?o:"/images-by-bot-id/"+this.bot.id+"/"+o},removeProduct(){this.$store.dispatch("removeProduct",this.item.id).then(o=>{this.$notify({title:"Конструктор ботов",text:"Продукт успешно удален!",type:"success"})}).catch(o=>{})},duplicateProduct(){this.$store.dispatch("duplicateProduct",this.item.id).then(o=>{this.$notify({title:"Конструктор ботов",text:"Продукт успешно продублирован!",type:"success"})}).catch(o=>{})}},mounted(){this.bot=this.getCurrentBot},computed:{...C(["getCurrentBot"])}},z1={key:0,class:"card"},O1={class:"card-header"},V1={class:"card-body"},P1=["id"],A1={class:"carousel-inner"},Q1=["src"],U1=["data-bs-target"],I1=e("span",{class:"carousel-control-prev-icon","aria-hidden":"true"},null,-1),T1=e("span",{class:"visually-hidden"},"Previous",-1),B1=[I1,T1],R1=["data-bs-target"],M1=e("span",{class:"carousel-control-next-icon","aria-hidden":"true"},null,-1),D1=e("span",{class:"visually-hidden"},"Next",-1),E1=[M1,D1],L1={class:"card-footer d-flex justify-content-between"},K1=e("i",{class:"fa-regular fa-copy"},null,-1),N1=[K1],Y1=e("i",{class:"fa-solid fa-trash-can"},null,-1),J1=[Y1];function H1(o,t,s,n,a,d){return a.bot?(l(),i("div",z1,[e("div",O1,[e("p",null,"#"+u(s.item.id),1)]),e("div",V1,[e("p",null,u(s.item.title),1),e("div",{id:"image-slider-"+s.item.id,class:"carousel slide","data-bs-ride":"carousel"},[e("div",A1,[(l(!0),i(v,null,y(s.item.images,(g,f)=>(l(),i("div",{class:_(["carousel-item",{active:f===0}]),style:{height:"300px"}},[e("img",{src:d.preparedImgUrl(g),class:"d-block w-100 object-fit-cover",alt:"..."},null,8,Q1)],2))),256))]),e("button",{class:"carousel-control-prev",type:"button","data-bs-target":"#image-slider-"+s.item.id,"data-bs-slide":"prev"},B1,8,U1),e("button",{class:"carousel-control-next",type:"button","data-bs-target":"#image-slider-"+s.item.id,"data-bs-slide":"next"},E1,8,R1)],8,P1)]),e("div",L1,[e("button",{title:"Дублировать товар",onClick:t[0]||(t[0]=(...g)=>d.duplicateProduct&&d.duplicateProduct(...g)),class:"btn btn-outline-info mr-1"},N1),e("button",{title:"Удалить товар",onClick:t[1]||(t[1]=(...g)=>d.removeProduct&&d.removeProduct(...g)),class:"btn btn-outline-danger"},J1)])])):r("",!0)}const W1=A(q1,[["render",H1]]),G1=e("button",{class:"btn btn-outline-info",type:"submit",id:"button-addon2"}," Найти ",-1),X1={key:0},Z1={class:"row"},x1={class:"col-4 mb-2"},ef={props:["bot"],data(){return{search:null,products:[],paginate:null}},computed:{...C(["getProducts","getProductsPaginateObject"]),filteredProducts(){return this.search?this.products.filter(o=>o.title.toLowerCase().trim().indexOf(this.search.toLowerCase().trim())>=0):this.products}},mounted(){this.loadProducts()},methods:{selectProduct(o){this.$emit("select",o)},nextProducts(o){this.loadProducts(o)},loadProducts(o=0){return this.$store.dispatch("loadProducts",{dataObject:{bot_id:this.bot.id,search:this.search},page:o}).then(()=>{this.products=this.getProducts,this.paginate=this.getProductsPaginateObject})}}},tf=Object.assign(ef,{__name:"ProductList",setup(o){return(t,s)=>(l(),i(v,null,[e("form",{class:"input-group mb-3",onSubmit:s[1]||(s[1]=S(n=>t.loadProducts(0),["prevent"]))},[c(e("input",{type:"text",class:"form-control border-info",placeholder:"Поиск товара","aria-label":"Поиск товара","onUpdate:modelValue":s[0]||(s[0]=n=>t.search=n),"aria-describedby":"button-addon2",required:""},null,512),[[b,t.search]]),G1],32),e("p",null,[m("Всего товаров: "),t.paginate?(l(),i("span",X1,u(t.paginate.meta.total||0),1)):r("",!0)]),e("div",Z1,[(l(!0),i(v,null,y(t.filteredProducts,(n,a)=>(l(),i("div",x1,[p(W1,{onClick:d=>t.selectProduct(n),item:n},null,8,["onClick","item"])]))),256))]),t.paginate?(l(),$(j,{key:0,onPagination_page:t.nextProducts,pagination:t.paginate},null,8,["onPagination_page","pagination"])):r("",!0)],64))}}),sf={class:"card mb-2"},of=e("div",{class:"card-header"},[e("h6",null,"Управление магазином")],-1),lf={class:"card-body"},nf={class:"row"},af={class:"col-12"},df={class:"form-label d-flex justify-content-between mt-2",id:"bot-level-3"},rf=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),cf=e("div",null,"Ссылка на страницу ВК с товарами для вашего магазина в боте ",-1),uf=e("a",{href:"https://vk.com/groups?w=groups_create",target:"_blank"},"Создать",-1),mf=["disabled"],_f=e("i",{class:"fa-regular fa-floppy-disk mr-2"},null,-1),hf={class:"row mb-3"},pf={class:"col-md-3"},bf=["href"],ff=me('<div class="col-md-3"><button class="btn btn-outline-info w-100">Экспорт в XLS</button></div><div class="col-md-3"><button class="btn btn-outline-info w-100">Импорт из XLS</button></div><div class="col-md-3"><button class="btn btn-outline-danger w-100">Удалить товары</button></div>',3),gf=e("div",{class:"row"},[e("div",{class:"col-md-3"},[e("button",{class:"btn btn-outline-info w-100"},"Экспортировать заказы")])],-1),vf={class:"card"},$f=e("div",{class:"card-header"},[e("h6",null,"Работа с товаром")],-1),yf={class:"card-body"},kf={class:"card mt-2"},Ff={class:"card-body"},wf={data(){return{load:!1,tab:0,url:null,link:null,bot:null,selectedProduct:null,botForm:{vk_shop_link:null}}},computed:{...C(["getCurrentBot"])},mounted(){this.bot=this.getCurrentBot,this.botForm.vk_shop_link=this.bot.vk_shop_link||null,this.updateProducts()},methods:{updateShopLink(){this.load=!0,this.botForm.bot_id=this.bot.id,this.$store.dispatch("updateShopLink",{botForm:this.botForm}).then(o=>{this.load=!1,this.updateProducts(),this.$notify({title:"Менеджер магазина",text:"Ссылка на источник в ВК обновлена"})}).catch(()=>{this.load=!1})},refresh(){this.load=!0,this.selectedProduct=null,this.$nextTick(()=>{this.load=!1})},selectProduct(o){this.load=!0,this.$nextTick(()=>{this.selectedProduct=o,this.load=!1})},updateProducts(){this.load=!0,this.$store.dispatch("updateProductsFromVk",{dataObject:{bot_domain:this.getCurrentBot.bot_domain}}).then(o=>{this.link=o.data.url,this.load=!1,this.url=null}).catch(()=>{this.load=!1})}}},Cf=Object.assign(wf,{__name:"Shop",setup(o){return(t,s)=>{const n=q("Popper");return l(),i(v,null,[e("div",sf,[of,e("div",lf,[e("div",nf,[e("div",af,[e("form",{onSubmit:s[1]||(s[1]=S((...a)=>t.updateShopLink&&t.updateShopLink(...a),["prevent"])),class:"mb-2"},[e("label",df,[e("div",null,[p(n,null,{content:h(()=>[cf]),default:h(()=>[rf]),_:1}),m(" ВК-группа ")]),uf]),c(e("input",{type:"url",class:"form-control",placeholder:"Ссылка на группу ВК","aria-label":"ссылка на группу ВК","onUpdate:modelValue":s[0]||(s[0]=a=>t.botForm.vk_shop_link=a),"aria-describedby":"vk_shop_link"},null,512),[[b,t.botForm.vk_shop_link]]),e("button",{disabled:t.load,class:"btn btn-outline-primary mt-2 mb-2 w-100"},[_f,m(" Сохранить ")],8,mf)],32)])]),e("div",hf,[e("div",pf,[e("a",{target:"_blank",href:t.link,class:"btn btn-primary w-100"}," Обновить товар ",8,bf)]),ff]),gf])]),e("div",vf,[$f,e("div",yf,[t.bot&&!t.load?(l(),$(j1,{key:0,bot:t.bot,item:t.selectedProduct,onRefresh:t.refresh},null,8,["bot","item","onRefresh"])):r("",!0)])]),e("div",kf,[e("div",Ff,[t.bot&&!t.load?(l(),$(tf,{key:0,bot:t.bot,onSelect:t.selectProduct},null,8,["bot","onSelect"])):r("",!0)])])],64)}}}),Sf={props:["data"],data(){return{hasConnect:!1,bot:null,amoForm:{client_id:null,client_secret:null,auth_code:null,redirect_uri:null,subdomain:null,bot_id:null}}},computed:{...C(["getCurrentBot"])},mounted(){this.bot=this.getCurrentBot,this.data?this.$nextTick(()=>{this.amoForm.client_id=this.data.client_id||null,this.amoForm.client_secret=this.data.client_secret||null,this.amoForm.auth_code=this.data.auth_code||null,this.amoForm.redirect_uri=this.data.redirect_uri||null,this.amoForm.subdomain=this.data.subdomain||null,this.amoForm.bot_id=this.data.bot_id||this.bot.id||null}):this.amoForm.bot_id=this.bot.id||null},methods:{submitAmo(){let o=new FormData;Object.keys(this.amoForm).forEach(t=>{const s=this.amoForm[t]||"";typeof s=="object"?o.append(t,JSON.stringify(s)):o.append(t,s)}),this.$store.dispatch("saveAmoCRM",{amoForm:o}).then(t=>{this.$notify("Данные CRM успешно сохранены")}).catch(t=>{})}}},jf=e("div",{class:"col-12"},[e("p",null,[e("a",{target:"_blank",href:"https://www.amocrm.ru/developers/content/oauth/step-by-step"},"Документация для разработчика "),m(" по шагам")])],-1),qf={class:"col-md-6 col-12 mb-2"},zf={class:"form-label",id:"client_id"},Of=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),Vf=e("div",null,"ID интеграции",-1),Pf=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),Af={class:"col-md-6 col-12 mb-2"},Qf={class:"form-label",id:"client_secret"},Uf=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),If=e("div",null,"Секрет интеграции",-1),Tf=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),Bf={class:"col-md-6 mb-2"},Rf={class:"form-label",id:"auth_code"},Mf=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),Df=e("div",null,"Полученный код авторизации",-1),Ef=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),Lf={class:"col-md-6 col-12 mb-2"},Kf={class:"form-label",id:"subdomain2"},Nf=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),Yf=e("div",null,"Ваш поддомен в системе AMO CRM",-1),Jf=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),Hf=e("div",{class:"col-md-12 col-12"},[e("button",{type:"submit",class:"btn btn-outline-primary p-3 w-100"},[e("i",{class:"fa-solid fa-cloud-arrow-down mr-1"}),m(" Сохранить настройку AMO ")])],-1);function Wf(o,t,s,n,a,d){const g=q("Popper");return l(),i("form",{onSubmit:t[4]||(t[4]=S((...f)=>d.submitAmo&&d.submitAmo(...f),["prevent"])),class:"row"},[jf,e("div",qf,[e("label",zf,[p(g,null,{content:h(()=>[Vf]),default:h(()=>[Of]),_:1}),m(" client_id "),Pf]),c(e("input",{type:"text",class:"form-control",placeholder:"client_id","aria-label":"client_id","onUpdate:modelValue":t[0]||(t[0]=f=>a.amoForm.client_id=f),"aria-describedby":"client_id"},null,512),[[b,a.amoForm.client_id]])]),e("div",Af,[e("label",Qf,[p(g,null,{content:h(()=>[If]),default:h(()=>[Uf]),_:1}),m(" client_secret "),Tf]),c(e("input",{type:"text",class:"form-control",placeholder:"client_secret","aria-label":"client_secret","onUpdate:modelValue":t[1]||(t[1]=f=>a.amoForm.client_secret=f),"aria-describedby":"client_secret"},null,512),[[b,a.amoForm.client_secret]])]),e("div",Bf,[e("label",Rf,[p(g,null,{content:h(()=>[Df]),default:h(()=>[Mf]),_:1}),m(" auth_code "),Ef]),c(e("textarea",{class:"form-control",placeholder:"auth_code","aria-label":"auth_code","onUpdate:modelValue":t[2]||(t[2]=f=>a.amoForm.auth_code=f),"aria-describedby":"auth_code"},`
                                    `,512),[[b,a.amoForm.auth_code]])]),e("div",Lf,[e("label",Kf,[p(g,null,{content:h(()=>[Yf]),default:h(()=>[Nf]),_:1}),m(" subdomain "),Jf]),c(e("input",{type:"text",class:"form-control",placeholder:"subdomain","aria-label":"subdomain","onUpdate:modelValue":t[3]||(t[3]=f=>a.amoForm.subdomain=f),"aria-describedby":"subdomain"},null,512),[[b,a.amoForm.subdomain]])]),Hf],32)}const Gf=A(Sf,[["render",Wf]]),Xf={props:["data"],data(){return{load:!1,bot:null,yClientsForm:{login:null,password:null,partner_token:null,company:null}}},computed:{...C(["getCurrentBot"])},mounted(){this.bot=this.getCurrentBot,this.data&&this.$nextTick(()=>{this.yClientsForm.login=this.data.login||null,this.yClientsForm.password=this.data.password||null,this.yClientsForm.partner_token=this.data.partner_token||null,this.yClientsForm.company=this.data.company||null})},methods:{submitYClients(){let o=new FormData;Object.keys(this.yClientsForm).forEach(t=>{const s=this.yClientsForm[t]||"";typeof s=="object"?o.append(t,JSON.stringify(s)):o.append(t,s)}),o.append("bot_id",this.bot.id),this.$store.dispatch("saveYClients",{yClientsForm:o}).then(t=>{this.$notify({title:"Работа с YClients",text:"Данные YClients успешно сохранены",type:"success"})}).catch(t=>{this.$notify({title:"Работа с YClients",text:"Ошибка сохранения данных",type:"error"})})}}},Zf=e("h6",null,"Настройка YClients",-1),xf={class:"row"},eg={class:"col-md-12"},tg={class:"mb-2"},sg=e("label",{class:"form-label d-flex justify-content-between mt-2",for:"login"},[m(" Логин "),e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно")],-1),og={class:"mb-2"},lg=e("label",{class:"form-label d-flex justify-content-between mt-2",for:"password"},[m(" Пароль "),e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно")],-1),ig={class:"mb-2"},ng=e("label",{class:"form-label d-flex justify-content-between mt-2",for:"partner_token"},[m(" Партнерский тоукен "),e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно")],-1),ag={class:"mb-2"},dg=e("label",{class:"form-label d-flex justify-content-between mt-2",for:"partner_token"},[m(" ID компании, в которую записывать клиентов "),e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно")],-1),rg=e("button",{class:"btn btn-success w-100 r mb-3 text-uppercase font-900"}," Сохранить ",-1);function cg(o,t,s,n,a,d){return l(),i(v,null,[Zf,e("form",{onSubmit:t[4]||(t[4]=S((...g)=>d.submitYClients&&d.submitYClients(...g),["prevent"]))},[e("div",xf,[e("div",eg,[e("div",tg,[sg,c(e("input",{type:"text",id:"login",class:"form-control",placeholder:"Ваш логин","aria-label":"Ваш логин","onUpdate:modelValue":t[0]||(t[0]=g=>a.yClientsForm.login=g),"aria-describedby":"Ваш логин",required:""},null,512),[[b,a.yClientsForm.login]])]),e("div",og,[lg,c(e("input",{type:"text",id:"password",class:"form-control",placeholder:"Ваш пароль","aria-label":"Ваш пароль","onUpdate:modelValue":t[1]||(t[1]=g=>a.yClientsForm.password=g),"aria-describedby":"Ваш пароль",required:""},null,512),[[b,a.yClientsForm.password]])]),e("div",ig,[ng,c(e("input",{type:"text",id:"partner_token",class:"form-control",placeholder:"Ваш партнерский тоукен","aria-label":"Ваш партнерский тоукен","onUpdate:modelValue":t[2]||(t[2]=g=>a.yClientsForm.partner_token=g),"aria-describedby":"Ваш партнерский тоукен",required:""},null,512),[[b,a.yClientsForm.partner_token]])]),e("div",ag,[dg,c(e("input",{type:"number",id:"throttle",class:"form-control",placeholder:"ID компании","aria-label":"ID компании","onUpdate:modelValue":t[3]||(t[3]=g=>a.yClientsForm.company=g),"aria-describedby":"ID компании",required:""},null,512),[[b,a.yClientsForm.company]])])])]),rg],32)],64)}const ug=A(Xf,[["render",cg]]),mg={class:"py-2"},_g={class:"nav nav-tabs"},hg={class:"nav-item"},pg={class:"nav-item"},bg={key:0,class:"row"},fg={class:"col-12 py-2"},gg={key:1,class:"row"},vg={class:"col-12 py-2"},$g={class:"col-12"},yg={props:["bot"],data(){return{tab:1,load:!1,loadMailingTable:!1}},mounted(){},methods:{callbackPersonalMail(){this.loadMailingTable=!0,this.$nextTick(()=>{this.loadMailingTable=!1})}}},kg=Object.assign(yg,{__name:"Mail",setup(o){return(t,s)=>(l(),i("div",mg,[e("ul",_g,[e("li",hg,[e("a",{class:_(["nav-link",{active:t.tab===0}]),onClick:s[0]||(s[0]=n=>t.tab=0),"aria-current":"page",href:"#"},"Рассылка в канал",2)]),e("li",pg,[e("a",{class:_(["nav-link",{active:t.tab===1}]),onClick:s[1]||(s[1]=n=>t.tab=1),href:"#"},"Рассылка в бота",2)])]),t.tab===0?(l(),i("div",bg,[e("div",fg,[p(re)])])):r("",!0),t.tab===1?(l(),i("div",gg,[e("div",vg,[p(ce,{onCallback:t.callbackPersonalMail},null,8,["onCallback"])]),e("div",$g,[t.loadMailingTable?r("",!0):(l(),$(ue,{key:0,bot:o.bot},null,8,["bot"]))])])):r("",!0)]))}}),Fg={data(){return{load:!1,bot:null,fieldTypes:[{title:"Текст",value:0},{title:"Число",value:1},{title:"Логический",value:2},{title:"Дата и время",value:3}],fieldForm:{fields:[]}}},computed:{...C(["getCurrentBot"])},mounted(){this.loadCurrentBot().then(()=>{this.bot=this.getCurrentBot,this.$nextTick(()=>{this.fieldForm.fields=this.bot.field_settings||[]}),this.loadCurrentBotFields()})},methods:{loadCurrentBotFields(){return this.$store.dispatch("loadCurrentBotFields",{bot_id:this.bot.id}).then(o=>{this.fieldForm.fields=o.data||[]})},loadCurrentBot(o=null){return this.$store.dispatch("updateCurrentBot",{bot:o}).then(()=>{this.bot=this.getCurrentBot})},removeField(o){this.fieldForm.fields.splice(o,1)},submit(){let o=new FormData;Object.keys(this.fieldForm).forEach(t=>{const s=this.fieldForm[t]||"";typeof s=="object"?o.append(t,JSON.stringify(s)):o.append(t,s)}),o.append("bot_id",this.bot.id),this.$store.dispatch("storeBotFields",{dataObject:o}).then(t=>{this.$notify({title:"Конструктор ботов",text:"Поля успешно обновлены",type:"success"}),this.fieldForm.fields=[],this.fieldForm.fields=t.data}).catch(t=>{this.$notify({title:"Конструктор ботов",text:"Ошибка обновления полей",type:"error"})})},addField(){if(this.fieldForm.fields||(this.fieldForm.fields=[]),this.fieldForm.fields.length>0&&this.fieldForm.fields.findIndex(t=>t.key==null)!==-1){this.$notify({title:"Настраиваемые поля",text:"У вас есть пустые ключевые поля!",type:"error"});return}this.fieldForm.fields.push({key:null,type:0,label:null,description:null,required:!1,validate_pattern:null})}}},wg={class:"mb-2"},Cg={class:"d-flex justify-content-between"},Sg=e("h6",null,"Настройка полей пользователя бота",-1),jg=e("i",{class:"fa-solid fa-plus mr-2"},null,-1),qg=e("p",null,[e("em",null,"Данные поля будут добавлены пользователю бота и будут автоматически учитываться в условиях страниц, скриптах (в формах заполнения данных), диалогах. Ключи должны быть уникальные для каждого бота. Если ключ дублируется, то будет использовано более позднее его значение. Если поле добавлено и сохранено, то удалить его уже нельзя, только скрыть. "),m(". "),e("br"),e("span",{class:"text-danger"},"*"),m(" - обязательное поле ")],-1),zg={class:"table"},Og=e("thead",null,[e("tr",null,[e("th",{scope:"col"},"#"),e("th",{scope:"col"},[m("Ключ"),e("span",{class:"text-danger"},"*")]),e("th",{scope:"col"},[m("Подпись поля"),e("span",{class:"text-danger"},"*")]),e("th",{scope:"col"},[m("Тип поля"),e("span",{class:"text-danger"},"*")]),e("th",{scope:"col"},"Паттерн"),e("th",{scope:"col"},"Обязательный"),e("th",{scope:"col"},[m("Вопрос для анкеты"),e("span",{class:"text-danger"},"*")]),e("th",{scope:"col"})])],-1),Vg={scope:"row"},Pg={scope:"col"},Ag=["onUpdate:modelValue"],Qg={scope:"col"},Ug=["onUpdate:modelValue"],Ig={scope:"col"},Tg=["onUpdate:modelValue"],Bg=["value"],Rg={scope:"col"},Mg=["disabled","onUpdate:modelValue"],Dg={scope:"col"},Eg={class:"form-check"},Lg=["onUpdate:modelValue","id"],Kg=["for"],Ng={key:0},Yg={key:1},Jg={scope:"col"},Hg=["onUpdate:modelValue"],Wg={scope:"col"},Gg=["onClick"],Xg=e("i",{class:"fa-regular fa-trash-can"},null,-1),Zg=[Xg],xg={key:1,class:"form-check mt-2"},ev=["onUpdate:modelValue","id"],tv=["for"],sv={key:0},ov=e("i",{class:"fa-solid fa-eye text-success"},null,-1),lv=[ov],iv={key:1},nv=e("i",{class:"fa-solid fa-eye-slash text-danger"},null,-1),av=[nv],dv=e("button",{type:"submit",class:"btn btn-success w-100 p-3"}," Сохранить поля ",-1);function rv(o,t,s,n,a,d){return l(),i("div",wg,[e("div",Cg,[Sg,e("button",{type:"button",onClick:t[0]||(t[0]=g=>d.addField()),class:"btn mb-2 rounded-sm btn-outline-info"},[jg,m(" Добавить параметр ")])]),qg,e("form",{onSubmit:t[1]||(t[1]=S((...g)=>d.submit&&d.submit(...g),["prevent"]))},[e("table",zg,[Og,e("tbody",null,[(l(!0),i(v,null,y(a.fieldForm.fields,(g,f)=>(l(),i("tr",null,[e("th",Vg,u(f+1),1),e("th",Pg,[c(e("input",{type:"text",class:"form-control mb-2 w-100",placeholder:"Ключ","aria-label":"Ключ",maxlength:"255","onUpdate:modelValue":F=>a.fieldForm.fields[f].key=F,required:""},null,8,Ag),[[b,a.fieldForm.fields[f].key]])]),e("th",Qg,[c(e("input",{type:"text",class:"form-control mb-2 w-100",placeholder:"Подпись поля","aria-label":"Название поля",maxlength:"255","onUpdate:modelValue":F=>a.fieldForm.fields[f].label=F,required:""},null,8,Ug),[[b,a.fieldForm.fields[f].label]])]),e("th",Ig,[c(e("select",{class:"form-select","onUpdate:modelValue":F=>a.fieldForm.fields[f].type=F},[(l(!0),i(v,null,y(a.fieldTypes,F=>(l(),i("option",{value:F.value},u(F.title||"Не указан"),9,Bg))),256))],8,Tg),[[I,a.fieldForm.fields[f].type]])]),e("th",Rg,[c(e("input",{type:"text",class:"form-control mb-2 w-100",placeholder:"Паттерн","aria-label":"Паттерн",maxlength:"255",disabled:a.fieldForm.fields[f].type===2,"onUpdate:modelValue":F=>a.fieldForm.fields[f].validate_pattern=F},null,8,Mg),[[b,a.fieldForm.fields[f].validate_pattern]])]),e("th",Dg,[e("div",Eg,[c(e("input",{class:"form-check-input","onUpdate:modelValue":F=>a.fieldForm.fields[f].required=F,type:"checkbox",value:"",id:"field-required"+f},null,8,Lg),[[k,a.fieldForm.fields[f].required]]),e("label",{class:"form-check-label",for:"field-required"+f},[a.fieldForm.fields[f].required?(l(),i("span",Ng,"Да")):r("",!0),a.fieldForm.fields[f].required?r("",!0):(l(),i("span",Yg,"Нет"))],8,Kg)])]),e("th",Jg,[c(e("input",{type:"text",class:"form-control mb-2 w-100",placeholder:"Описание вопроса","aria-label":"Описание вопроса",maxlength:"255","onUpdate:modelValue":F=>a.fieldForm.fields[f].description=F,required:""},null,8,Hg),[[b,a.fieldForm.fields[f].description]])]),e("th",Wg,[a.fieldForm.fields[f].id?(l(),i("div",xg,[c(e("input",{class:"form-check-input d-none","onUpdate:modelValue":F=>a.fieldForm.fields[f].is_active=F,type:"checkbox",value:"",id:"field-is_active-"+f},null,8,ev),[[k,a.fieldForm.fields[f].is_active]]),e("label",{class:"form-check-label",for:"field-is_active-"+f},[a.fieldForm.fields[f].is_active?(l(),i("span",sv,lv)):r("",!0),a.fieldForm.fields[f].is_active?r("",!0):(l(),i("span",iv,av))],8,tv)])):(l(),i("button",{key:0,type:"button",onClick:F=>d.removeField(f),class:"btn btn-link text-danger"},Zg,8,Gg))])]))),256))])]),dv],32)])}const cv=A(Fg,[["render",rv]]),uv={class:"row"},mv={class:"input-group mb-3"},_v={key:0,class:"row"},hv={class:"col-12 col-md-12 mb-3"},pv={class:"table"},bv=e("thead",null,[e("tr",null,[e("th",{scope:"col"},"#"),e("th",{scope:"col"},"Тип"),e("th",{scope:"col"},"Подпись"),e("th",{scope:"col"},"File Id"),e("th",{scope:"col"},"Действия")])],-1),fv={scope:"row"},gv={class:"badge bg-info rounded-pill"},vv={style:{"word-break":"break-all"}},$v={style:{"word-break":"break-all"}},yv={style:{"min-width":"200px"}},kv=["onClick"],Fv=e("i",{class:"fa-solid fa-eye"},null,-1),wv=[Fv],Cv=["onClick"],Sv=e("i",{class:"fa-brands fa-telegram"},null,-1),jv=[Sv],qv=["onClick"],zv=e("i",{class:"fa-solid fa-trash"},null,-1),Ov=[zv],Vv={class:"col-12"},Pv={key:1,class:"row"},Av=e("div",{class:"col-12"},[e("div",{class:"alert alert-warning",role:"alert"}," У выбранного бота нет медиа-файлов ")],-1),Qv=[Av],Uv={class:"modal fade",id:"preview-modal",tabindex:"-1","aria-labelledby":"preview-modal-label","aria-hidden":"true"},Iv={class:"modal-dialog"},Tv={class:"modal-content"},Bv={class:"modal-body"},Rv={key:0,class:"d-flex justify-content-center align-items-center"},Mv=e("div",{class:"modal-footer"},[e("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Закрыть")],-1),Dv={data(){return{bot:null,previewContent:null,loading:!0,media:[],search:null,media_paginate_object:null}},computed:{...C(["getMedia","getMediaPaginateObject","getCurrentBot"])},mounted(){this.loadCurrentBot().then(()=>{this.loadMedia()})},methods:{selectMedia(o){this.$emit("select",o)},loadCurrentBot(o=null){return this.$store.dispatch("updateCurrentBot",{bot:o}).then(()=>{this.bot=this.getCurrentBot})},nextMedia(o){this.loadMedia(o)},remove(o){this.$store.dispatch("removeMedia",{dataObject:{mediaId:o}}).then(t=>{this.loadMedia(),this.$notify({title:"Удаление медиа-контента",text:"Медиа контент удален"})}).catch(()=>{})},showPreview(o){this.previewContent=null,this.$nextTick(()=>{this.previewContent=o,new bootstrap.Modal("#preview-modal",{}).show()})},showPreviewInTg(o){this.$store.dispatch("showMediaPreview",{dataObject:{mediaId:o}}).then(t=>{this.$notify({title:"Превью медиа-контента",text:"Отправлено в бота"})}).catch(()=>{})},loadMedia(o=0){this.loading=!0,this.$store.dispatch("loadMedia",{dataObject:{bot_id:this.bot.id||null,search:this.search,needVideo:!0,needVideoNote:!0,needPhoto:!0,needAudio:!0,needDocument:!0,needSticker:!0},page:o}).then(t=>{this.loading=!1,this.media=this.getMedia,this.media_paginate_object=this.getMediaPaginateObject}).catch(()=>{this.loading=!1})}}},Ev=Object.assign(Dv,{__name:"BotMediaTable",setup(o){return(t,s)=>(l(),i(v,null,[e("div",uv,[e("div",mv,[c(e("input",{type:"search",class:"form-control",placeholder:"Поиск файла","aria-label":"Поиск файла","onUpdate:modelValue":s[0]||(s[0]=n=>t.search=n)},null,512),[[b,t.search]]),e("button",{class:"btn btn-outline-secondary",onClick:s[1]||(s[1]=n=>t.loadMedia(0)),type:"button",id:"button-addon2"},"Найти ")])]),t.media.length>0?(l(),i("div",_v,[e("div",hv,[e("table",pv,[bv,e("tbody",null,[(l(!0),i(v,null,y(t.media,(n,a)=>(l(),i("tr",null,[e("th",fv,u(n.id),1),e("td",null,[e("span",gv,u(n.type),1)]),e("td",null,[e("p",vv,u(n.caption??"Без подписи"),1)]),e("td",null,[e("p",$v,u(n.file_id),1)]),e("td",null,[e("div",yv,[e("a",{href:"javascript:void(0)",class:"btn btn-info mr-2",onClick:d=>t.showPreview(n)},wv,8,kv),e("a",{href:"javascript:void(0)",class:"btn btn-info mr-2",onClick:d=>t.showPreviewInTg(n.id)},jv,8,Cv),e("a",{href:"javascript:void(0)",class:"btn btn-outline-danger text-danger",onClick:d=>t.remove(n.id)},Ov,8,qv)])])]))),256))])])]),e("div",Vv,[t.media_paginate_object?(l(),$(j,{key:0,onPagination_page:t.nextMedia,pagination:t.media_paginate_object},null,8,["onPagination_page","pagination"])):r("",!0)])])):(l(),i("div",Pv,Qv)),e("div",Uv,[e("div",Iv,[e("div",Tv,[e("div",Bv,[t.previewContent!=null?(l(),i("div",Rv,[p(N,{type:t.previewContent.type,content:t.previewContent.file_id},null,8,["type","content"])])):r("",!0)]),Mv])])])],64))}}),Lv={class:"row py-3"},Kv={class:"col-12"},Nv={class:"row"},Yv={class:"col-12"},Jv={key:0},Hv={key:1},Wv={key:0,class:"col-12 mb-3"},Gv={class:"col-12 mb-3"},Xv={key:0},Zv={key:1},xv={key:1,class:"col-12 mb-3"},e$={class:"row py-3"},t$=e("div",{class:"col-12"},[e("p",{class:"mb-0"},"Выбор статуса")],-1),s$={class:"col-md-3"},o$=["onClick"],l$={class:"row"},i$={class:"col-12 mb-3"},n$={class:"form-label",id:"service-title"},a$=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),d$=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),r$={class:"col-12 mb-3"},c$={class:"form-label",id:"service-title"},u$=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),m$=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),_$={class:"col-12 mb-3"},h$={class:"form-label",id:"appointment-info"},p$=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),b$=e("div",null," Краткая информация от клиента ",-1),f$=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),g$={key:0,class:"text-gray-400 ml-3",style:{"font-size":"10px"}},v$={class:"row"},$$={class:"col-12"},y$={type:"submit",class:"btn btn-outline-success w-100 p-3"},k$={key:0},F$={key:1},w$={props:["eventId","bot","appointment"],data(){return{step:0,load:!1,selected_schedule_time:null,selected_bot_user:null,need_load_users:!1,need_schedule_time:!1,statuses:[{value:0,title:"Новая запись"},{value:1,title:"Подтверждение записи"},{value:2,title:"Прохождение по записи"},{value:3,title:"Отмена записи"}],days:["понедельник","вторник","среду","четверг","пятницу","субботу","воскресенье"],appointmentForm:{id:null,appointment_event_id:null,appointment_schedule_id:null,bot_user_id:null,status:0,name:null,phone:null,info:null}}},mounted(){this.appointment&&this.$nextTick(()=>{this.appointmentForm={id:this.appointment.id||null,appointment_event_id:this.appointment.appointment_event_id||null,appointment_schedule_id:this.appointment.appointment_schedule_id||null,bot_user_id:this.appointment.bot_user_id||null,status:this.appointment.status||0,name:this.appointment.name||null,phone:this.appointment.phone||null,info:this.appointment.info||null},this.selected_schedule_time=this.appointment.schedule||null,this.selected_bot_user=this.appointment.botUser||null})},methods:{selectScheduleTime(o){if(o.appointment){this.$notify("Данное время уже занято!");return}this.selected_schedule_time=o,this.need_schedule_time=!1},selectBotUser(o){this.selected_bot_user=o,this.need_load_users=!1},clearAppointmentForm(){this.appointmentForm={id:null,appointment_event_id:null,appointment_schedule_id:null,bot_user_id:null,status:0},this.selected_schedule_time=null,this.selected_bot_user=null},submitForm(){this.appointmentForm.bot_user_id=this.selected_bot_user.id,this.appointmentForm.appointment_schedule_id=this.selected_schedule_time.id,this.appointmentForm.appointment_event_id=this.eventId;let o=new FormData;Object.keys(this.appointmentForm).forEach(t=>{const s=this.appointmentForm[t]||"";typeof s=="object"?o.append(t,JSON.stringify(s)):o.append(t,s)}),o.append("bot_id",this.bot.id),this.$store.dispatch("storeAppointment",{dataObject:{appointmentForm:o}}).then(t=>{this.clearAppointmentForm(),this.$emit("callback"),this.$notify("Запись успешно создана")}).catch(t=>{this.$notify("Ошибка создания записи")})}}},C$=Object.assign(w$,{__name:"AppointmentForm",setup(o){return(t,s)=>{const n=q("Popper"),a=Q("mask");return l(),i(v,null,[e("div",Lv,[e("div",Kv,[e("button",{onClick:s[0]||(s[0]=(...d)=>t.clearAppointmentForm&&t.clearAppointmentForm(...d)),class:"btn btn-primary"},"Новая заявка ")])]),e("form",{onSubmit:s[6]||(s[6]=S((...d)=>t.submitForm&&t.submitForm(...d),["prevent"]))},[e("div",Nv,[e("div",Yv,[e("a",{href:"javascript:void(0)",class:"btn btn-link",onClick:s[1]||(s[1]=d=>t.need_load_users=!t.need_load_users)},[t.selected_bot_user==null?(l(),i("span",Jv,"Выберите пользователя")):r("",!0),t.selected_bot_user?(l(),i("span",Hv," Пользователь "+u(t.selected_bot_user.name||t.selected_bot_user.fio_from_telegram||t.selected_bot_user.telegram_chat_id||"-"),1)):r("",!0)])]),t.need_load_users?(l(),i("div",Wv,[p(R,{simple:!0,onSelect:t.selectBotUser},null,8,["onSelect"])])):r("",!0),e("div",Gv,[e("a",{href:"javascript:void(0)",class:"btn btn-link",onClick:s[2]||(s[2]=d=>t.need_schedule_time=!t.need_schedule_time)},[t.selected_schedule_time==null?(l(),i("span",Xv,"Выберите время в расписании")):r("",!0),t.selected_schedule_time?(l(),i("span",Zv," Запись на "+u(t.days[t.selected_schedule_time.day-1]||"-")+" с "+u(t.selected_schedule_time.start_time||"-")+" до "+u(t.selected_schedule_time.end_time||"-"),1)):r("",!0)])]),t.need_schedule_time?(l(),i("div",xv,[p(te,{"event-id":o.eventId,bot:o.bot,onSelect:t.selectScheduleTime},null,8,["event-id","bot","onSelect"])])):r("",!0)]),e("div",e$,[t$,(l(!0),i(v,null,y(t.statuses,d=>(l(),i("div",s$,[e("button",{type:"button",class:_([{"btn-success text-white":t.appointmentForm.status==d.value},"btn btn-outline-success w-100"]),onClick:g=>t.appointmentForm.status=d.value},u(d.title||"не указано"),11,o$)]))),256))]),e("div",l$,[e("div",i$,[e("label",n$,[p(n,{content:"ФИО человека, который посетит запись"},{default:h(()=>[a$]),_:1}),m(" Ф.И.О. посетителя "),d$]),c(e("input",{type:"text",class:"form-control",placeholder:"Иванов Иван Иванович","aria-label":"ФИО","onUpdate:modelValue":s[3]||(s[3]=d=>t.appointmentForm.name=d),maxlength:"255","aria-describedby":"appointment-name",required:""},null,512),[[b,t.appointmentForm.name]])]),e("div",r$,[e("label",c$,[p(n,{content:"Номер телефона человека, который посетит запись"},{default:h(()=>[u$]),_:1}),m(" Телефонный номер "),m$]),c(e("input",{type:"text",class:"form-control",placeholder:"+7(000)000-00-00","aria-label":"номер телефона","onUpdate:modelValue":s[4]||(s[4]=d=>t.appointmentForm.phone=d),maxlength:"255","aria-describedby":"appointment-phone",required:""},null,512),[[a,"+7(###)###-##-##"],[b,t.appointmentForm.phone]])]),e("div",_$,[e("label",h$,[p(n,null,{content:h(()=>[b$]),default:h(()=>[p$]),_:1}),m(" Описание услуги "),f$,t.appointmentForm.info?(l(),i("small",g$," Длина текста "+u(t.appointmentForm.info.length)+" / 255",1)):r("",!0)]),c(e("textarea",{type:"text",class:"form-control",placeholder:"Информация от клиента","aria-label":"Информация от клиента",maxlength:"255","onUpdate:modelValue":s[5]||(s[5]=d=>t.appointmentForm.info=d),"aria-describedby":"appointment-info",required:""},`
                    `,512),[[b,t.appointmentForm.info]])])]),e("div",v$,[e("div",$$,[e("button",y$,[t.appointmentForm.id==null?(l(),i("span",k$,"Записаться")):(l(),i("span",F$,"Обновить запись"))])])])],32)],64)}}}),S$={class:"row"},j$={class:"col-12"},q$={key:0,class:"table"},z$=e("th",{scope:"col"},"Действие",-1),O$=["onClick"],V$={scope:"row"},P$={key:0},A$={key:0,class:"dropdown"},Q$=e("button",{class:"btn btn-outline-secondary",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-solid fa-ellipsis"})],-1),U$={class:"dropdown-menu"},I$={key:0},T$=["onClick"],B$={key:1},R$={class:"col-12"},M$={props:["bot","eventId"],data(){return{direction:"desc",order:"updated_at",show:!0,is_group:!1,loading:!0,services:[],search:null,statuses:["Новая запись","Подтверждение записи","Прохождение по записи","Отмена записи"],days:["понедельник","вторник","среду","четверг","пятницу","субботу","воскресенье"],paginate_object:null}},computed:{...C(["getAppointments","getAppointmentsPaginateObject"])},mounted(){this.loadAppointments()},methods:{nextAppointments(o){this.loadAppointments(o)},selectAppointment(o){this.$emit("select",o)},loadAndOrder(o){this.order=o,this.direction=this.direction==="desc"?"asc":"desc",this.loadAppointments(0)},removeAppointment(o){this.loading=!0,this.$store.dispatch("removeAppointment",{dataObject:{appointmentId:o}}).then(t=>{this.loading=!1,this.loadAppointments(0),this.$notify("Запись успешно удалена")}).catch(()=>{this.loading=!1,this.$notify("Ошибка удаления записи")})},loadAppointments(o=0){this.loading=!0,this.$store.dispatch("loadAppointments",{dataObject:{event_id:this.eventId,bot_id:this.bot.id||null,search:this.search,order:this.order,direction:this.direction},page:o,size:100}).then(t=>{this.loading=!1,this.services=this.getAppointments,this.paginate_object=this.getAppointmentsPaginateObject}).catch(()=>{this.loading=!1})}}},D$=Object.assign(M$,{__name:"AppointmentsTable",setup(o){return(t,s)=>(l(),i("div",S$,[e("div",j$,[t.services.length>0?(l(),i("table",q$,[e("thead",null,[e("tr",null,[e("th",{scope:"col",class:"cursor-pointer",onClick:s[0]||(s[0]=n=>t.loadAndOrder("id"))},"#"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[1]||(s[1]=n=>t.loadAndOrder("bot_user_id"))},"Пользователь"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[2]||(s[2]=n=>t.loadAndOrder("appointment_schedule_id"))},"Дата записи "),e("th",{scope:"col",class:"cursor-pointer",onClick:s[3]||(s[3]=n=>t.loadAndOrder("status"))},"Статус"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[4]||(s[4]=n=>t.loadAndOrder("name"))},"Посетитель"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[5]||(s[5]=n=>t.loadAndOrder("phone"))},"Телефон посетителя"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[6]||(s[6]=n=>t.loadAndOrder("info"))},"Доп.инф"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[7]||(s[7]=n=>t.loadAndOrder("updated_at"))},"Дата изменения"),z$])]),e("tbody",null,[(l(!0),i(v,null,y(t.services,(n,a)=>(l(),i("tr",{onClick:d=>t.selectAppointment(n),class:_({"border-info":n.deleted_at==null,"border-danger":n.deleted_at!=null})},[e("th",V$,u(n.id),1),e("td",null,u(n.botUser.fio_from_telegram||n.botUser.telegram_chat_id||"Не указано"),1),e("td",null,[n.schedule?(l(),i("p",P$," Запись на "+u(t.days[n.schedule.day-1]||"Не указано")+" с "+u(n.schedule.start_time||"Не указано")+" до "+u(n.schedule.end_time||"Не указано"),1)):r("",!0)]),e("td",null,u(t.statuses[n.status]),1),e("td",null,u(t.$filters.current(n.updated_at)),1),e("td",null,u(n.name||"не указано"),1),e("td",null,u(n.phone||"не указано"),1),e("td",null,u(n.info||"не указано"),1),e("td",null,[n.id?(l(),i("div",A$,[Q$,e("ul",U$,[n.deleted_at==null?(l(),i("li",I$,[e("a",{class:"dropdown-item",onClick:d=>t.removeAppointment(n.id),href:"javascript:void(0)"},"Удалить",8,T$)])):r("",!0)])])):r("",!0)])],10,O$))),256))])])):(l(),i("p",B$,"На текущий момент нет ни одного созданного сервиса"))]),e("div",R$,[t.paginate_object?(l(),$(j,{key:0,onPagination_page:t.nextAppointments,pagination:t.paginate_object},null,8,["onPagination_page","pagination"])):r("",!0)])]))}}),E$={class:"row py-2"},L$={class:"col-12"},K$={class:"input-group mb-3"},N$={class:"col-12"},Y$={key:0,class:"table"},J$=e("th",{scope:"col"},"Действие",-1),H$={scope:"row"},W$=["onClick"],G$={key:0,class:"fa-solid fa-chevron-down text-success"},X$={key:1,class:"fa-solid fa-xmark text-danger"},Z$={key:0,class:"dropdown"},x$=e("button",{class:"btn btn-outline-secondary",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-solid fa-ellipsis"})],-1),ey={class:"dropdown-menu"},ty={key:0},sy=["onClick"],oy={key:1},ly={class:"col-12"},iy={props:["bot"],data(){return{direction:"desc",order:"updated_at",show:!0,is_group:!1,loading:!0,events:[],search:null,paginate_object:null}},computed:{...C(["getAppointmentEvents","getAppointmentEventsPaginateObject"])},mounted(){this.loadAppointmentEvents()},methods:{removeAppointmentEvent(o){this.loading=!0,this.$store.dispatch("removeAppointmentEvent",{dataObject:{appointmentEventId:o}}).then(t=>{this.loading=!1,this.loadAppointmentEvents(0),this.$notify("Событие успешно удалено")}).catch(()=>{this.loading=!1,this.$notify("Ошибка удаления события")})},nextAppointmentEvents(o){this.loadAppointmentEvents(o)},selectEvent(o){this.$emit("select",o)},loadAndOrder(o){this.order=o,this.direction=this.direction==="desc"?"asc":"desc",this.loadAppointmentEvents(0)},loadAppointmentEvents(o=0){this.loading=!0,this.$store.dispatch("loadAppointmentEvents",{dataObject:{bot_id:this.bot.id||null,search:this.search,is_group:this.is_group,order:this.order,direction:this.direction},page:o,size:20}).then(t=>{this.loading=!1,this.events=this.getAppointmentEvents,this.paginate_object=this.getAppointmentEventsPaginateObject}).catch(()=>{this.loading=!1})}}},ny=Object.assign(iy,{__name:"AppointmentEventTable",setup(o){return(t,s)=>(l(),i("div",E$,[e("div",L$,[e("div",K$,[c(e("input",{type:"search",class:"form-control",placeholder:"Поиск события","aria-label":"Поиск события","onUpdate:modelValue":s[0]||(s[0]=n=>t.search=n),"aria-describedby":"appointment-search-event"},null,512),[[b,t.search]]),e("button",{class:"btn btn-outline-secondary",onClick:s[1]||(s[1]=n=>t.loadAppointmentEvents(0)),type:"button",id:"appointment-search-event"},"Найти ")])]),e("div",N$,[t.events.length>0?(l(),i("table",Y$,[e("thead",null,[e("tr",null,[e("th",{scope:"col",class:"cursor-pointer",onClick:s[2]||(s[2]=n=>t.loadAndOrder("id"))},"#"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[3]||(s[3]=n=>t.loadAndOrder("title"))},"Название"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[4]||(s[4]=n=>t.loadAndOrder("subtitle"))},"Подзаголовок"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[5]||(s[5]=n=>t.loadAndOrder("address"))},"Адрес"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[6]||(s[6]=n=>t.loadAndOrder("description"))},"Описание"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[7]||(s[7]=n=>t.loadAndOrder("is_group"))},"Групповое"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[8]||(s[8]=n=>t.loadAndOrder("updated_at"))},"Дата изменения"),J$])]),e("tbody",null,[(l(!0),i(v,null,y(t.events,(n,a)=>(l(),i("tr",{class:_({"border-info":n.deleted_at==null,"border-danger":n.deleted_at!=null})},[e("th",H$,u(n.id),1),e("td",{onClick:d=>t.selectEvent(n)},u(n.title||"Не указано"),9,W$),e("td",null,u(n.subtitle||"Не указано"),1),e("td",null,u(n.address||"Не указано"),1),e("td",null,u(n.description||"Не указано"),1),e("td",null,[n.is_group?(l(),i("i",G$)):(l(),i("i",X$))]),e("td",null,u(t.$filters.current(n.updated_at)),1),e("td",null,[n.id?(l(),i("div",Z$,[x$,e("ul",ey,[n.deleted_at==null?(l(),i("li",ty,[e("a",{class:"dropdown-item",onClick:d=>t.removeAppointmentEvent(n.id),href:"javascript:void(0)"},"Удалить",8,sy)])):r("",!0)])])):r("",!0)])],2))),256))])])):(l(),i("p",oy,"На текущий момент нет событий в вашем списке"))]),e("div",ly,[t.paginate_object?(l(),$(j,{key:0,onPagination_page:t.nextAppointmentEvents,pagination:t.paginate_object},null,8,["onPagination_page","pagination"])):r("",!0)])]))}}),ay={class:"row"},dy={class:"col-12"},ry={key:0,class:"table"},cy=e("th",{scope:"col"},"Действие",-1),uy={scope:"row"},my=["onClick"],_y={key:0,class:"fa-solid fa-chevron-down text-success"},hy={key:1,class:"fa-solid fa-xmark text-danger"},py={key:0,class:"dropdown"},by=e("button",{class:"btn btn-outline-secondary",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-solid fa-ellipsis"})],-1),fy={class:"dropdown-menu"},gy={key:0},vy=["onClick"],$y={key:1},yy={class:"col-12"},ky={props:["bot","eventId"],data(){return{direction:"desc",order:"updated_at",show:!0,is_group:!1,loading:!0,services:[],search:null,paginate_object:null}},computed:{...C(["getAppointmentServices","getAppointmentServicesPaginateObject"])},mounted(){this.loadAppointmentServices()},methods:{nextAppointmentService(o){this.loadAppointmentServices(o)},selectService(o){this.$emit("select",o)},removeAppointmentService(o){this.loading=!0,this.$store.dispatch("removeAppointmentService",{dataObject:{appointmentServiceId:o}}).then(t=>{this.loading=!1,this.loadAppointmentServices(0),this.$notify("Сервис успешно удален")}).catch(()=>{this.loading=!1,this.$notify("Ошибка удаления сервиса")})},loadAndOrder(o){this.order=o,this.direction=this.direction==="desc"?"asc":"desc",this.loadAppointmentServices(0)},loadAppointmentServices(o=0){this.loading=!0,this.$store.dispatch("loadAppointmentServices",{dataObject:{event_id:this.eventId,bot_id:this.bot.id||null,search:this.search,order:this.order,direction:this.direction},page:o,size:100}).then(t=>{this.loading=!1,this.services=this.getAppointmentServices,this.paginate_object=this.getAppointmentServicesPaginateObject}).catch(()=>{this.loading=!1})}}},Fy=Object.assign(ky,{__name:"AppointmentServicesTable",setup(o){return(t,s)=>(l(),i("div",ay,[e("div",dy,[t.services.length>0?(l(),i("table",ry,[e("thead",null,[e("tr",null,[e("th",{scope:"col",class:"cursor-pointer",onClick:s[0]||(s[0]=n=>t.loadAndOrder("id"))},"#"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[1]||(s[1]=n=>t.loadAndOrder("title"))},"Название"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[2]||(s[2]=n=>t.loadAndOrder("subtitle"))},"Подзаголовок"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[3]||(s[3]=n=>t.loadAndOrder("description"))},"Описание"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[4]||(s[4]=n=>t.loadAndOrder("is_group"))},"Групповое"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[5]||(s[5]=n=>t.loadAndOrder("updated_at"))},"Дата изменения"),cy])]),e("tbody",null,[(l(!0),i(v,null,y(t.services,(n,a)=>(l(),i("tr",{class:_({"border-info":n.deleted_at==null,"border-danger":n.deleted_at!=null})},[e("th",uy,u(n.id),1),e("td",{onClick:d=>t.selectService(n)},u(n.title||"Не указано"),9,my),e("td",null,u(n.subtitle||"Не указано"),1),e("td",null,u(n.description||"Не указано"),1),e("td",null,[n.is_group?(l(),i("i",_y)):(l(),i("i",hy))]),e("td",null,u(t.$filters.current(n.updated_at)),1),e("td",null,[n.id?(l(),i("div",py,[by,e("ul",fy,[n.deleted_at==null?(l(),i("li",gy,[e("a",{class:"dropdown-item",onClick:d=>t.removeAppointmentService(n.id),href:"javascript:void(0)"},"Удалить",8,vy)])):r("",!0)])])):r("",!0)])],2))),256))])])):(l(),i("p",$y,"На текущий момент нет ни одного созданого сервиса"))]),e("div",yy,[t.paginate_object?(l(),$(j,{key:0,onPagination_page:t.nextAppointmentService,pagination:t.paginate_object},null,8,["onPagination_page","pagination"])):r("",!0)])]))}}),wy={class:"row"},Cy={class:"col-12 mb-3"},Sy={class:"form-label",id:"event-title"},jy=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),qy=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),zy={class:"col-12 mb-3"},Oy={class:"form-label",id:"event-subtitle"},Vy=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),Py=e("div",null,"Подзаголовок события или доп. инфа под названием события ",-1),Ay=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),Qy={class:"col-12 mb-3"},Uy={class:"form-check"},Iy=e("label",{class:"form-check-label",for:"need_add_address"}," Нужно указать адрес и координат мероприятия ",-1),Ty={key:0,class:"col-12 mb-3"},By={class:"form-label",id:"event-address"},Ry=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),My=e("div",null,"Адрес, указывающий точное место проведения события \\ мероприятия ",-1),Dy={key:1,class:"col-12 mb-3"},Ey={class:"form-label",id:"event-coords"},Ly=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),Ky=e("div",null,"Координаты мероприятия ",-1),Ny={class:"col-12 mb-3"},Yy={class:"form-label",id:"event-description"},Jy=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),Hy=e("div",null," Краткая информация о происходящем мероприятии ",-1),Wy=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),Gy={key:0,class:"text-gray-400 ml-3",style:{"font-size":"10px"}},Xy={class:"col-12 mb-3"},Zy={class:"form-label",id:"event-on_start_appointment"},xy=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),e2=e("div",null," Текст, который будет отображен клиенту, когда тот записался ",-1),t2=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),s2={key:0,class:"text-gray-400 ml-3",style:{"font-size":"10px"}},o2={class:"col-12 mb-3"},l2={class:"form-label",id:"event-on_cancel_appointment"},i2=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),n2=e("div",null," Текст, который будет отображен клиенту, когда тот отменил запись ",-1),a2=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),d2={key:0,class:"text-gray-400 ml-3",style:{"font-size":"10px"}},r2={class:"col-12 mb-3"},c2={class:"form-label",id:"event-on_after_appointment"},u2=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),m2=e("div",null," Текст, который будет отображен клиенту, когда тот прошел событие успешно ",-1),_2=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),h2={key:0,class:"text-gray-400 ml-3",style:{"font-size":"10px"}},p2={class:"col-12 mb-3"},b2={class:"form-label",id:"event-on_repeat_appointment"},f2=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),g2=e("div",null," Текст, который будет отображен клиенту, когда тот записывается 2й и более раз ",-1),v2=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),$2={key:0,class:"text-gray-400 ml-3",style:{"font-size":"10px"}},y2={class:"col-12 mb-3"},k2={class:"form-check"},F2=e("label",{class:"form-check-label",for:"need_media"}," Нужно изображение к событию ",-1),w2={key:2,class:"col-12 mb-3"},C2={class:"form-label",id:"event-images"},S2=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),j2=e("div",null," Изображение, которое видит пользователь при выборе события ",-1),q2=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),z2={class:"col-12 mb-3"},O2={class:"form-check"},V2=e("label",{class:"form-check-label",for:"is-group"}," Является групповым мероприятием ",-1),P2={key:3,class:"col-md-6 col-12 mb-3"},A2={class:"form-label",id:"event-min_people"},Q2=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),U2=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),I2={key:4,class:"col-md-6 col-12 mb-3"},T2={class:"form-label",id:"event-max_people"},B2=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),R2=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),M2={class:"row"},D2={class:"col-12"},E2={type:"submit",class:"btn btn-outline-success w-100 p-3"},L2={key:0},K2={key:1},N2={props:["event","bot"],data(){return{step:0,load:!1,need_reset:!1,need_services:!1,need_add_address:!1,need_media:!1,eventForm:{id:null,title:null,subtitle:null,description:null,address:null,coords:null,images:[],services:[],times:[],is_group:!1,max_people:0,min_people:0,on_start_appointment:null,on_cancel_appointment:null,on_after_appointment:null,on_repeat_appointment:null}}},watch:{eventForm:{handler(o){this.need_reset=!0},deep:!0}},mounted(){this.event&&this.$nextTick(()=>{this.eventForm={id:this.event.id||null,title:this.event.title||null,subtitle:this.event.subtitle||null,description:this.event.description||null,images:this.event.images||[],is_group:this.event.is_group||!1,address:this.event.address||null,coords:this.event.coords||null,max_people:this.event.max_people||0,min_people:this.event.min_people||0,on_start_appointment:this.event.on_start_appointment||null,on_cancel_appointment:this.event.on_cancel_appointment||null,on_after_appointment:this.event.on_after_appointment||null,on_repeat_appointment:this.event.on_repeat_appointment||null}})},methods:{selectPhotos(o){this.eventForm.images||(this.eventForm.images=[]);let t=this.eventForm.images.indexOf(o.file_id);t!==-1?this.eventForm.images.splice(t,1):this.eventForm.images.push(o.file_id)},resetForm(){},submitForm(){let o=new FormData;Object.keys(this.eventForm).forEach(t=>{const s=this.eventForm[t]||"";typeof s=="object"?o.append(t,JSON.stringify(s)):o.append(t,s)}),o.append("bot_id",this.bot.id),this.$store.dispatch(this.eventForm.id===null?"addAppointmentEvent":"updateAppointmentEvent",{appointmentEventForm:o}).then(t=>{this.$emit("callback",t.data),this.$nextTick(()=>{this.eventForm={id:null,title:null,subtitle:null,description:null,address:null,coords:null,images:[],services:[],times:[],is_group:!1,max_people:0,min_people:0,on_start_appointment:null,on_cancel_appointment:null,on_after_appointment:null,on_repeat_appointment:null}}),this.$notify("Событие успешно создано")}).catch(t=>{this.$notify("Ошибка создания события")})}}},G=Object.assign(N2,{__name:"AppointmentEventForm",setup(o){return(t,s)=>{const n=q("Popper"),a=Q("mask");return l(),i("form",{onSubmit:s[14]||(s[14]=S((...d)=>t.submitForm&&t.submitForm(...d),["prevent"]))},[e("div",wy,[e("div",Cy,[e("label",Sy,[p(n,{content:"Название вашего события (или специалиста), на которое планируется осуществить запись"},{default:h(()=>[jy]),_:1}),m(" Название события "),qy]),c(e("input",{type:"text",class:"form-control",placeholder:"Название","aria-label":"Название","onUpdate:modelValue":s[0]||(s[0]=d=>t.eventForm.title=d),maxlength:"255","aria-describedby":"event-title",required:""},null,512),[[b,t.eventForm.title]])]),e("div",zy,[e("label",Oy,[p(n,null,{content:h(()=>[Py]),default:h(()=>[Vy]),_:1}),m(" Подзаголовок события "),Ay]),c(e("input",{type:"text",class:"form-control",placeholder:"Подзаголовок","aria-label":"Подзаголовок","onUpdate:modelValue":s[1]||(s[1]=d=>t.eventForm.subtitle=d),maxlength:"255","aria-describedby":"event-subtitle",required:""},null,512),[[b,t.eventForm.subtitle]])]),e("div",Qy,[e("div",Uy,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[2]||(s[2]=d=>t.need_add_address=d),type:"checkbox",id:"need_add_address"},null,512),[[k,t.need_add_address]]),Iy])]),t.need_add_address?(l(),i("div",Ty,[e("label",By,[p(n,null,{content:h(()=>[My]),default:h(()=>[Ry]),_:1}),m(" Адрес события \\ мероприятия ")]),c(e("input",{type:"text",class:"form-control",placeholder:"Адрес события","aria-label":"Адрес события","onUpdate:modelValue":s[3]||(s[3]=d=>t.eventForm.address=d),maxlength:"255","aria-describedby":"event-address",required:""},null,512),[[b,t.eventForm.address]])])):r("",!0),t.need_add_address?(l(),i("div",Dy,[e("label",Ey,[p(n,null,{content:h(()=>[Ky]),default:h(()=>[Ly]),_:1}),m(" Координаты мероприятия: широта, долгота ")]),c(e("input",{type:"text",class:"form-control",placeholder:"00.0000,00.0000","aria-label":"Координаты события","onUpdate:modelValue":s[4]||(s[4]=d=>t.eventForm.coords=d),maxlength:"255","aria-describedby":"event-coords",required:""},null,512),[[b,t.eventForm.coords],[a,"##.####,##.####"]])])):r("",!0),e("div",Ny,[e("label",Yy,[p(n,null,{content:h(()=>[Hy]),default:h(()=>[Jy]),_:1}),m(" Описание события "),Wy,t.eventForm.description?(l(),i("small",Gy," Длина текста "+u(t.eventForm.description.length)+"/255",1)):r("",!0)]),c(e("textarea",{type:"text",class:"form-control",placeholder:"Описание мероприятия","aria-label":"Описание мероприятия",maxlength:"255","onUpdate:modelValue":s[5]||(s[5]=d=>t.eventForm.description=d),"aria-describedby":"event-description",required:""},`
                    `,512),[[b,t.eventForm.description]])]),e("div",Xy,[e("label",Zy,[p(n,null,{content:h(()=>[e2]),default:h(()=>[xy]),_:1}),m(" Текст при записи на событие "),t2,t.eventForm.on_start_appointment?(l(),i("small",s2," Длина текста "+u(t.eventForm.on_start_appointment.length)+"/255",1)):r("",!0)]),c(e("textarea",{type:"text",class:"form-control",placeholder:"Текст при записи на событие","aria-label":"Текст при записи на событие","onUpdate:modelValue":s[6]||(s[6]=d=>t.eventForm.on_start_appointment=d),maxlength:"255","aria-describedby":"event-on_start_appointment",required:""},`
                    `,512),[[b,t.eventForm.on_start_appointment]])]),e("div",o2,[e("label",l2,[p(n,null,{content:h(()=>[n2]),default:h(()=>[i2]),_:1}),m(" Текст при отмене записи на событие "),a2,t.eventForm.on_cancel_appointment?(l(),i("small",d2," Длина текста "+u(t.eventForm.on_cancel_appointment.length)+"/255",1)):r("",!0)]),c(e("textarea",{type:"text",class:"form-control",placeholder:"Текст при отмене записи на событие","aria-label":"Текст при отмене записи на событие","onUpdate:modelValue":s[7]||(s[7]=d=>t.eventForm.on_cancel_appointment=d),maxlength:"255","aria-describedby":"event-on_cancel_appointment",required:""},`
                    `,512),[[b,t.eventForm.on_cancel_appointment]])]),e("div",r2,[e("label",c2,[p(n,null,{content:h(()=>[m2]),default:h(()=>[u2]),_:1}),m(" Текст после прохождения события "),_2,t.eventForm.on_after_appointment?(l(),i("small",h2," Длина текста "+u(t.eventForm.on_after_appointment.length)+"/255",1)):r("",!0)]),c(e("textarea",{type:"text",class:"form-control",placeholder:"Текст после прохождения события","aria-label":"Текст после прохождения события","onUpdate:modelValue":s[8]||(s[8]=d=>t.eventForm.on_after_appointment=d),maxlength:"255","aria-describedby":"event-on_after_appointment",required:""},`
                    `,512),[[b,t.eventForm.on_after_appointment]])]),e("div",p2,[e("label",b2,[p(n,null,{content:h(()=>[g2]),default:h(()=>[f2]),_:1}),m(" Текст при повторной записи на событие "),v2,t.eventForm.on_repeat_appointment?(l(),i("small",$2," Длина текста "+u(t.eventForm.on_repeat_appointment.length)+"/255",1)):r("",!0)]),c(e("textarea",{type:"text",class:"form-control",placeholder:" Текст при повторной записи на событие","aria-label":" Текст при повторной записи на событие","onUpdate:modelValue":s[9]||(s[9]=d=>t.eventForm.on_repeat_appointment=d),maxlength:"255","aria-describedby":"event-on_repeat_appointment",required:""},`
                    `,512),[[b,t.eventForm.on_repeat_appointment]])]),e("div",y2,[e("div",k2,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[10]||(s[10]=d=>t.need_media=d),type:"checkbox",id:"need_media"},null,512),[[k,t.need_media]]),F2])]),t.need_media?(l(),i("div",w2,[e("label",C2,[p(n,null,{content:h(()=>[j2]),default:h(()=>[S2]),_:1}),m(" Изображение к событию "),q2]),p(O,{"need-photo":!0,selected:t.eventForm.images,onSelect:t.selectPhotos},null,8,["selected","onSelect"])])):r("",!0),e("div",z2,[e("div",O2,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[11]||(s[11]=d=>t.eventForm.is_group=d),type:"checkbox",id:"is-group"},null,512),[[k,t.eventForm.is_group]]),V2])]),t.eventForm.is_group?(l(),i("div",P2,[e("label",A2,[p(n,{content:"Минимально необходимое число людей, для начала 1 мероприятия"},{default:h(()=>[Q2]),_:1}),m(" Минимальное число посетителей в группе "),U2]),c(e("input",{type:"number",class:"form-control",placeholder:"Минимальное число посетителей","aria-label":"Название","onUpdate:modelValue":s[12]||(s[12]=d=>t.eventForm.min_people=d),"aria-describedby":"event-min_people",required:""},null,512),[[b,t.eventForm.min_people]])])):r("",!0),t.eventForm.is_group?(l(),i("div",I2,[e("label",T2,[p(n,{content:"Количество людей, которые могут посетить мероприятие за 1 сеанс"},{default:h(()=>[B2]),_:1}),m(" Максимальное число посетителей в группе "),R2]),c(e("input",{type:"number",class:"form-control",placeholder:"Максимальное число посетителей","aria-label":"Название","onUpdate:modelValue":s[13]||(s[13]=d=>t.eventForm.max_people=d),"aria-describedby":"event-max_people",required:""},null,512),[[b,t.eventForm.max_people]])])):r("",!0)]),e("div",M2,[e("div",D2,[e("button",E2,[t.eventForm.id==null?(l(),i("span",L2,"Создать событие")):(l(),i("span",K2,"Обновить событие"))])])])],32)}}}),Y2={class:"row pt-3"},J2={class:"col-md-4"},H2={class:"form-floating mb-3"},W2=e("label",{for:"config-step"},"Шаг, минуты",-1),G2={class:"col-md-4"},X2={class:"form-floating mb-3"},Z2=e("label",{for:"config-start-time"},"Начало, часы",-1),x2={class:"col-md-4"},ek={class:"form-floating mb-3"},tk=["min"],sk=e("label",{for:"config-end-time"},"Конец, часы",-1),ok=e("hr",null,null,-1),lk={key:0,class:"row"},ik={class:"col-12 d-flex justify-content-end pb-3"},nk={class:"row"},ak={class:"col-md-4 text-center"},dk={key:0,class:"fa-solid fa-arrow-down-short-wide"},rk={key:1,class:"fa-solid fa-arrow-up-wide-short"},ck={class:"col-md-4 text-center"},uk={key:0,class:"fa-solid fa-arrow-down-short-wide"},mk={key:1,class:"fa-solid fa-arrow-up-wide-short"},_k={class:"col-md-4 text-center"},hk={key:0,class:"fa-solid fa-arrow-down-short-wide"},pk={key:1,class:"fa-solid fa-arrow-up-wide-short"},bk={class:"col-md-4"},fk={class:"form-floating"},gk=["onUpdate:modelValue","id"],vk=["for"],$k={class:"col-md-4"},yk={class:"form-floating"},kk=["onUpdate:modelValue","id"],Fk=["for"],wk={class:"col-md-4"},Ck={class:"form-floating"},Sk=["onUpdate:modelValue","id"],jk=["for"],qk={class:"row mt-3"},zk={class:"col-12"},Ok={class:"row"},Vk={class:"col-12"},Pk={class:"col-12"},Ak={class:"text-center"},Qk={class:"row d-flex justify-content-center"},Uk={class:"col-md-4"},Ik={class:"table"},Tk=e("th",{scope:"col"},"#",-1),Bk={scope:"col"},Rk={scope:"row"},Mk=["onClick"],Dk={key:0,class:"fa-solid fa-check"},Ek={key:1,class:"fa-solid fa-xmark"},Lk={components:{VueDatePicker:se},props:["eventId","bot"],data(){return{date:null,load:!1,step:30,start:8,end:18,order:null,direction:null,paginate_object:null,years:[2024,2025],months:["Январь","Февраль","Март","Апрель","Май","Июнь","Июль","Август","Сентябрь","октябрь","Ноябрь","Декабрь"],days:["Понедельник","Вторник","Среда","Четверг","Пятница","Суббота","Воскресенье"],schedule:[],added_schedule:[]}},watch:{date:{handler:function(o){this.loadAppointmentSchedules()},deep:!0}},computed:{...C(["getAppointmentSchedules","getAppointmentSchedulesPaginateObject"]),currentWeek(){return new Date().getWeek()},currentMonthWeek(){return new Date().getMonthWeek()},currentMonth(){return new Date().getMonth()},currentYear(){return new Date().getFullYear()},times(){let o=this.step,t=[],s=0,n=0;for(let a=0;s<24*60;a++){let d=Math.floor(s/60);if(d>=this.start&&d<=this.end){let g=s%60;t[n]=("0"+d).slice(-2)+":"+("0"+g).slice(-2),n++}s=s+o}return t}},mounted(){this.date=new Date,this.loadAppointmentSchedules()},methods:{removeAppointmentSchedule(o){this.loading=!0,this.$store.dispatch("removeAppointmentSchedule",{dataObject:{appointmentScheduleId:o}}).then(t=>{this.loading=!1,this.loadAppointmentSchedules(0),this.$notify("Время успешно удалено")}).catch(()=>{this.loading=!1,this.$notify("Ошибка удаления времени")})},loadAndOrder(o){this.order=o,this.direction=this.direction==="desc"?"asc":"desc",this.loadAppointmentSchedules(0)},nextAppointmentSchedule(o){this.loadAppointmentSchedules(o)},loadAppointmentSchedules(o=0){this.loading=!0,this.$store.dispatch("loadAppointmentSchedules",{dataObject:{date:this.date||null,event_id:this.eventId,bot_id:this.bot.id||null,order:this.order,direction:this.direction},page:o,size:20}).then(t=>{this.loading=!1,this.schedule=this.getAppointmentSchedules,this.paginate_object=this.getAppointmentSchedulesPaginateObject}).catch(()=>{this.loading=!1})},storeSchedule(){this.$store.dispatch("storeAppointmentSchedule",{dataObject:{schedule:[...this.schedule,...this.added_schedule],bot_id:this.bot.id,appointment_event_id:this.eventId}}).then(()=>{this.$notify("Расписание успешно сохранено"),this.loadAppointmentSchedules(),this.added_schedule=[]}).catch(()=>{this.$notify("Ошибка сохраения расписания")})},inScheduleRow(o){return this.schedule.findIndex(t=>t.start_time==this.times[o])!=-1||this.added_schedule.findIndex(t=>t.start_time==this.times[o])!=-1},inSchedule(o,t){return this.schedule.findIndex(s=>s.day==t&&s.start_time==this.times[o])!=-1||this.added_schedule.findIndex(s=>s.day==t&&s.start_time==this.times[o])!=-1},setScheduleItem(o,t){let s=this.schedule.findIndex(n=>n.day==t&&n.start_time==this.times[o]);if(s!==-1){this.schedule.splice(s,1);return}if(s=this.added_schedule.findIndex(n=>n.day==t&&n.start_time==this.times[o]),s!==-1){this.added_schedule.splice(s,1);return}this.added_schedule.push({day:t,start_time:this.times[o]||null,end_time:this.times[o+1]||null,week:this.date==null?this.currentWeek:new Date(this.date).getWeek(),month:this.date==null?this.currentMonth:new Date(this.date).getMonth(),year:this.date==null?this.currentYear:new Date(this.date).getFullYear()})}}},Kk=Object.assign(Lk,{__name:"AppointmentScheduleForm",setup(o){return(t,s)=>(l(),i(v,null,[e("div",Y2,[e("div",J2,[e("div",H2,[c(e("input",{type:"number",class:"form-control","onUpdate:modelValue":s[0]||(s[0]=n=>t.step=n),min:"0",id:"config-step",placeholder:"30 минут"},null,512),[[b,t.step]]),W2])]),e("div",G2,[e("div",X2,[c(e("input",{type:"number","onUpdate:modelValue":s[1]||(s[1]=n=>t.start=n),min:"0",max:"23",class:"form-control",id:"config-start-time",placeholder:"Часы"},null,512),[[b,t.start]]),Z2])]),e("div",x2,[e("div",ek,[c(e("input",{type:"number","onUpdate:modelValue":s[2]||(s[2]=n=>t.end=n),min:t.start,max:"23",class:"form-control",id:"config-end-time",placeholder:"Часы"},null,8,tk),[[b,t.end]]),sk])])]),ok,t.schedule.length>0||t.added_schedule.length>0?(l(),i("div",lk,[e("div",ik,[e("button",{onClick:s[3]||(s[3]=(...n)=>t.storeSchedule&&t.storeSchedule(...n)),class:"btn btn-primary"},"Сохранить текущий график ")]),e("div",nk,[e("div",ak,[e("a",{onClick:s[4]||(s[4]=n=>t.loadAndOrder("day")),href:"javascript:void(0)"},[m("День "),t.order==="day"&&t.direction==="asc"?(l(),i("i",dk)):r("",!0),t.order==="day"&&t.direction==="desc"?(l(),i("i",rk)):r("",!0)])]),e("div",ck,[e("a",{onClick:s[5]||(s[5]=n=>t.loadAndOrder("start_time")),href:"javascript:void(0)"},[m("Начало "),t.order==="start_time"&&t.direction==="asc"?(l(),i("i",uk)):r("",!0),t.order==="start_time"&&t.direction==="desc"?(l(),i("i",mk)):r("",!0)])]),e("div",_k,[e("a",{onClick:s[6]||(s[6]=n=>t.loadAndOrder("end_time")),href:"javascript:void(0)"},[m("Конец "),t.order==="end_time"&&t.direction==="asc"?(l(),i("i",hk)):r("",!0),t.order==="end_time"&&t.direction==="desc"?(l(),i("i",pk)):r("",!0)])])])])):r("",!0),(l(!0),i(v,null,y([...t.schedule,...t.added_schedule],(n,a)=>(l(),i("div",{class:_(["row py-2",{"bg-warning":n.id==null}])},[e("div",bk,[e("div",fk,[c(e("input",{type:"text","onUpdate:modelValue":d=>t.days[n.day-1]=d,class:"form-control",id:"day-of-week-"+a,placeholder:"День недели"},null,8,gk),[[b,t.days[n.day-1]]]),e("label",{for:"day-of-week-"+a},"День недели",8,vk)])]),e("div",$k,[e("div",yk,[c(e("input",{type:"text","onUpdate:modelValue":d=>n.start_time=d,class:"form-control",id:"day-of-start-at-"+a,placeholder:"Время начало"},null,8,kk),[[b,n.start_time]]),e("label",{for:"day-of-start-at-"+a},"Начало",8,Fk)])]),e("div",wk,[e("div",Ck,[c(e("input",{type:"text","onUpdate:modelValue":d=>n.end_time=d,class:"form-control",id:"day-of-end-at-"+a,placeholder:"Время окончания"},null,8,Sk),[[b,n.end_time]]),e("label",{for:"day-of-end-at-"+a},"Окончание",8,jk)])])],2))),256)),e("div",qk,[e("div",zk,[t.paginate_object?(l(),$(j,{key:0,onPagination_page:t.nextAppointmentSchedule,pagination:t.paginate_object},null,8,["onPagination_page","pagination"])):r("",!0)])]),e("div",Ok,[e("div",Vk,[e("button",{class:"btn btn-primary",onClick:s[7]||(s[7]=n=>t.schedule=[])},"Очистить таблицу")]),e("div",Pk,[e("p",Ak,[m(" Год: "),e("strong",null,u(t.currentYear),1),m(" Месяц: "),e("strong",null,u(t.months[t.currentMonth]),1),m(" Неделя: "),e("strong",null,u(t.currentWeek),1)])])]),e("div",Qk,[e("div",Uk,[p(Y(se),{modelValue:t.date,"onUpdate:modelValue":s[8]||(s[8]=n=>t.date=n)},null,8,["modelValue"])])]),e("table",Ik,[e("thead",null,[e("tr",null,[Tk,(l(!0),i(v,null,y(t.days,n=>(l(),i("th",Bk,u(n),1))),256))])]),e("tbody",null,[(l(!0),i(v,null,y(t.times,(n,a)=>(l(),i("tr",{class:_({"table-light":t.inScheduleRow(a)})},[e("th",Rk,u(n),1),(l(),i(v,null,y(7,d=>e("td",null,[e("button",{class:_([{"btn-primary text-white":t.inSchedule(a,d)},"btn btn-outline-primary"]),onClick:g=>t.setScheduleItem(a,d)},[t.inSchedule(a,d)?(l(),i("i",Dk)):(l(),i("i",Ek))],10,Mk)])),64))],2))),256))])])],64))}});(function(){try{if(typeof document<"u"){var o=document.createElement("style");o.appendChild(document.createTextNode(".vue3-star-ratings[data-v-7fab3f62]{width:fit-content;overflow:hidden;position:relative;white-space:nowrap}.vue3-star-ratings *[data-v-7fab3f62]{box-sizing:border-box;margin:0;padding:0;line-height:1}.vue3-star-ratings__inner[data-v-7fab3f62],.vue3-star-ratings__outer[data-v-7fab3f62]{height:inherit}.vue3-star-ratings__outer[data-v-7fab3f62]{position:absolute;top:0;left:0;width:var(--vue3StarRatingOuterWidth);max-width:100%;overflow:hidden;color:var(--vue3StarRatingsOuterColor);transition:width .32s cubic-bezier(.075,.82,.165,1)}.vue3-star-ratings__inner[data-v-7fab3f62]{color:var(--vue3StarRatingsInnerColor)}.vue3-star-ratings__icon[data-v-7fab3f62]{fill:currentColor;width:var(--vue3StarRatingIconSize);aspect-ratio:1;cursor:pointer;display:inline-block}")),document.head.appendChild(o)}}catch(t){console.error("vite-plugin-css-injected-by-js",t)}})();const ie=(o,t)=>{const s=o.__vccOpts||o;for(const[n,a]of t)s[n]=a;return s},Nk={},Yk={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512.002 512.002"},Jk=e("path",{d:"M511.267 197.258a14.995 14.995 0 00-12.107-10.209l-158.723-23.065-70.985-143.827a14.998 14.998 0 00-26.901 0l-70.988 143.827-158.72 23.065a14.998 14.998 0 00-8.312 25.585l114.848 111.954-27.108 158.083a14.999 14.999 0 0021.763 15.812l141.967-74.638 141.961 74.637a15 15 0 0021.766-15.813l-27.117-158.081 114.861-111.955a14.994 14.994 0 003.795-15.375z"},null,-1),Hk=[Jk];function Wk(o,t){return l(),i("svg",Yk,Hk)}const X=ie(Nk,[["render",Wk]]),Gk={class:"vue3-star-ratings__outer"},Xk={class:"vue3-star-ratings__inner"},Zk=_e({__name:"Vue3StarRatings",props:{modelValue:{default:0},numberOfStars:{default:5},starColor:{default:"#ff9800"},inactiveColor:{default:"#333333"},starSize:{default:24},disableClick:{type:Boolean},customSvg:{default:X}},emits:["update:modelValue"],setup(o,{emit:t}){const s=o,n=E(()=>s.customSvg||X),a={rounded(w,P){const V=Math.pow(10,P);return Math.round(w*V)/V}},d=he(),g=E({get(){return s.modelValue},set(w){const P=a.rounded(w,1);t("update:modelValue",P)}});function f(w){if(s.disableClick)return;const P=this.getBoundingClientRect(),{pageX:V}=w,D=V-P.left,ne=P.width,ae=s.numberOfStars,de=D/ne*ae;g.value=de}const F=E(()=>(g.value<0?0:g.value>s.numberOfStars?s.numberOfStars:g.value)/s.numberOfStars*100);return pe(()=>{var w;const P={"--vue3StarRatingsInnerColor":s.inactiveColor,"--vue3StarRatingsOuterColor":s.starColor,"--vue3StarRatingOuterWidth":`${F.value}%`,"--vue3StarRatingIconSize":`${s.starSize}px`};for(const[V,D]of Object.entries(P))(w=d.value)==null||w.style.setProperty(V,D)}),be(()=>{var w;(w=d.value)==null||w.addEventListener("click",f)}),fe(()=>{var w;(w=d.value)==null||w.removeEventListener("click",f)}),(w,P)=>(l(),i("div",{class:"vue3-star-ratings",ref_key:"starsContainer",ref:d,style:ge({pointerEvents:w.disableClick?"none":"auto"})},[e("div",Gk,[(l(!0),i(v,null,y(w.numberOfStars,V=>(l(),$(W(n.value),{key:V,class:"vue3-star-ratings__icon"}))),128))]),e("div",Xk,[(l(!0),i(v,null,y(w.numberOfStars,V=>(l(),$(W(n.value),{key:V,class:"vue3-star-ratings__icon"}))),128))])],4))}}),M=ie(Zk,[["__scopeId","data-v-7fab3f62"]]),xk={class:"row py-3"},e0={class:"col-12"},t0={class:"row"},s0={class:"col-12"},o0={key:0},l0={key:1},i0={key:0,class:"col-12 mb-3"},n0={class:"col-12 mb-3"},a0={key:0},d0={key:1},r0={key:1,class:"col-12 mb-3"},c0={class:"col-12 mb-3"},u0={class:"col-12 mb-3"},m0={class:"form-label",id:"event-on_after_appointment"},_0=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),h0=e("div",null," Текст, который пользователь оставляет после прохождения услуги ",-1),p0=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),b0={key:0,class:"text-gray-400 ml-3",style:{"font-size":"10px"}},f0={class:"row"},g0={class:"col-12"},v0={type:"submit",class:"btn btn-outline-success w-100 p-3"},$0={key:0},y0={key:1},k0={props:["eventId","bot","review"],components:{vue3starRatings:M},data(){return{step:0,load:!1,selected_schedule_time:null,selected_bot_user:null,need_load_users:!1,need_schedule_time:!1,days:["понедельник","вторник","среду","четверг","пятницу","субботу","воскресенье"],reviewForm:{id:null,appointment_event_id:null,appointment_schedule_id:null,bot_user_id:null,rating:null,text:null}}},watch:{reviewForm:{handler(o){this.need_reset=!0},deep:!0}},mounted(){this.review&&this.$nextTick(()=>{this.reviewForm={id:this.review.id||null,appointment_event_id:this.review.appointment_event_id||null,appointment_schedule_id:this.review.appointment_schedule_id||null,bot_user_id:this.review.bot_user_id||null,rating:this.review.rating||null,text:this.review.text||null},this.selected_schedule_time=this.review.schedule||null,this.selected_bot_user=this.review.botUser||null})},methods:{selectScheduleTime(o){this.selected_schedule_time=o,this.need_schedule_time=!1},selectBotUser(o){this.selected_bot_user=o,this.need_load_users=!1},clearReviewForm(){this.reviewForm={id:null,appointment_event_id:null,appointment_schedule_id:null,bot_user_id:null,rating:null,text:null},this.selected_schedule_time=null,this.selected_bot_user=null},submitForm(){this.reviewForm.bot_user_id=this.selected_bot_user.id,this.reviewForm.appointment_schedule_id=this.selected_schedule_time.id,this.reviewForm.appointment_event_id=this.eventId;let o=new FormData;Object.keys(this.reviewForm).forEach(t=>{const s=this.reviewForm[t]||"";typeof s=="object"?o.append(t,JSON.stringify(s)):o.append(t,s)}),o.append("bot_id",this.bot.id),this.$store.dispatch("storeAppointmentReview",{dataObject:{appointmentReviewForm:o}}).then(t=>{this.$emit("callback",t.data),this.$notify("Отзыв успешно создан"),this.clearReviewForm()}).catch(t=>{this.$notify("Ошибка создания отзыва")})}}},F0=Object.assign(k0,{__name:"AppointmentReviewForm",setup(o){return(t,s)=>{const n=q("Popper");return l(),i(v,null,[e("div",xk,[e("div",e0,[e("button",{onClick:s[0]||(s[0]=(...a)=>t.clearReviewForm&&t.clearReviewForm(...a)),class:"btn btn-primary"},"Новый отзыв")])]),e("form",{onSubmit:s[5]||(s[5]=S((...a)=>t.submitForm&&t.submitForm(...a),["prevent"]))},[e("div",t0,[e("div",s0,[e("a",{href:"javascript:void(0)",class:"btn btn-link",onClick:s[1]||(s[1]=a=>t.need_load_users=!t.need_load_users)},[t.selected_bot_user==null?(l(),i("span",o0,"Выберите пользователя")):r("",!0),t.selected_bot_user?(l(),i("span",l0," Пользователь "+u(t.selected_bot_user.name||t.selected_bot_user.fio_from_telegram||t.selected_bot_user.telegram_chat_id||"-"),1)):r("",!0)])]),t.need_load_users?(l(),i("div",i0,[p(R,{simple:!0,onSelect:t.selectBotUser},null,8,["onSelect"])])):r("",!0),e("div",n0,[e("a",{href:"javascript:void(0)",class:"btn btn-link",onClick:s[2]||(s[2]=a=>t.need_schedule_time=!t.need_schedule_time)},[t.selected_schedule_time==null?(l(),i("span",a0,"Выберите время в расписании")):r("",!0),t.selected_schedule_time?(l(),i("span",d0," Запись на "+u(t.days[t.selected_schedule_time.day-1]||"-")+" с "+u(t.selected_schedule_time.start_time||"-")+" до "+u(t.selected_schedule_time.end_time||"-"),1)):r("",!0)])]),t.need_schedule_time?(l(),i("div",r0,[p(te,{"event-id":o.eventId,bot:o.bot,onSelect:t.selectScheduleTime},null,8,["event-id","bot","onSelect"])])):r("",!0),e("div",c0,[e("p",null," Рейтинг: "+u(t.reviewForm.rating||0),1),p(Y(M),{modelValue:t.reviewForm.rating,"onUpdate:modelValue":s[3]||(s[3]=a=>t.reviewForm.rating=a)},null,8,["modelValue"])]),e("div",u0,[e("label",m0,[p(n,null,{content:h(()=>[h0]),default:h(()=>[_0]),_:1}),m(" Текст отзыва "),p0,t.reviewForm.text?(l(),i("small",b0," Длина текста "+u(t.reviewForm.text.length)+"/255",1)):r("",!0)]),c(e("textarea",{type:"text",class:"form-control",placeholder:"Текст отзыва","aria-label":"Текст отзыва","onUpdate:modelValue":s[4]||(s[4]=a=>t.reviewForm.text=a),maxlength:"255","aria-describedby":"review-text",required:""},`
                    `,512),[[b,t.reviewForm.text]])])]),e("div",f0,[e("div",g0,[e("button",v0,[t.reviewForm.id==null?(l(),i("span",$0,"Оставить отзыв")):(l(),i("span",y0,"Обновить отзыв"))])])])],32)],64)}}}),w0={class:"row"},C0={class:"col-12"},S0={key:0,class:"table"},j0=e("th",{scope:"col"},"Действие",-1),q0=["onClick"],z0={scope:"row"},O0={class:"d-flex align-items-center"},V0={class:"ml-2"},P0={key:0,class:"dropdown"},A0=e("button",{class:"btn btn-outline-secondary",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-solid fa-ellipsis"})],-1),Q0={class:"dropdown-menu"},U0={key:0},I0=["onClick"],T0={key:1},B0={class:"col-12"},R0={props:["bot","eventId"],components:{vue3starRatings:M},data(){return{direction:"desc",order:"updated_at",show:!0,is_group:!1,loading:!0,reviews:[],search:null,paginate_object:null}},computed:{...C(["getAppointmentReviews","getAppointmentReviewsPaginateObject"])},mounted(){this.loadAppointmentReviews()},methods:{nextAppointmentReviews(o){this.loadAppointmentReviews(o)},selectReview(o){this.$emit("select",o)},loadAndOrder(o){this.order=o,this.direction=this.direction==="desc"?"asc":"desc",this.loadAppointmentReviews(0)},removeAppointmentReview(o){this.loading=!0,this.$store.dispatch("removeAppointmentReview",{dataObject:{appointmentReviewId:o}}).then(t=>{this.loadAppointmentReviews(0),this.$notify("Сервис успешно удален"),this.loading=!1}).catch(()=>{this.loading=!1,this.$notify("Ошибка удаления сервиса")})},loadAppointmentReviews(o=0){this.loading=!0,this.$store.dispatch("loadAppointmentReviews",{dataObject:{event_id:this.eventId,bot_id:this.bot.id||null,search:this.search,order:this.order,direction:this.direction},page:o,size:100}).then(t=>{this.loading=!1,this.reviews=this.getAppointmentReviews,this.paginate_object=this.getAppointmentReviewsPaginateObject}).catch(()=>{this.loading=!1})}}},M0=Object.assign(R0,{__name:"AppointmentReviewsTable",setup(o){return(t,s)=>(l(),i("div",w0,[e("div",C0,[t.reviews.length>0?(l(),i("table",S0,[e("thead",null,[e("tr",null,[e("th",{scope:"col",class:"cursor-pointer",onClick:s[0]||(s[0]=n=>t.loadAndOrder("id"))},"#"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[1]||(s[1]=n=>t.loadAndOrder("bot_user_id"))},"Пользователь"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[2]||(s[2]=n=>t.loadAndOrder("rating"))},"Рейтинг"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[3]||(s[3]=n=>t.loadAndOrder("text"))},"Текст"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[4]||(s[4]=n=>t.loadAndOrder("updated_at"))},"Дата изменения"),j0])]),e("tbody",null,[(l(!0),i(v,null,y(t.reviews,(n,a)=>(l(),i("tr",{onClick:d=>t.selectReview(n),class:_({"border-info":n.deleted_at==null,"border-danger":n.deleted_at!=null})},[e("th",z0,u(n.id),1),e("td",null,u(n.botUser.fio_from_telegram||n.botUser.telegram_chat_id||"Не указано"),1),e("td",null,[e("p",O0,[p(Y(M),{disableClick:!0,modelValue:n.rating,"onUpdate:modelValue":d=>n.rating=d},null,8,["modelValue","onUpdate:modelValue"]),e("span",V0,u(n.rating||0),1)])]),e("td",null,u(n.text||"Не указано"),1),e("td",null,u(t.$filters.current(n.updated_at)),1),e("td",null,[n.id?(l(),i("div",P0,[A0,e("ul",Q0,[n.deleted_at==null?(l(),i("li",U0,[e("a",{class:"dropdown-item",onClick:d=>t.removeAppointmentReview(n.id),href:"javascript:void(0)"},"Удалить",8,I0)])):r("",!0)])])):r("",!0)])],10,q0))),256))])])):(l(),i("p",T0,"На текущий момент нет ни одного созданного отзыва"))]),e("div",B0,[t.paginate_object?(l(),$(j,{key:0,onPagination_page:t.nextAppointmentReviews,pagination:t.paginate_object},null,8,["onPagination_page","pagination"])):r("",!0)])]))}}),D0={key:0,class:"py-2"},E0={class:"row"},L0={class:"col-12"},K0={key:1,class:"py-2"},N0={class:"row"},Y0={class:"col-12"},J0={key:2,class:"py-2"},H0={class:"row"},W0={class:"col-12"},G0={class:"nav nav-tabs justify-content-center"},X0={key:0,class:"row py-3"},Z0={class:"col-12"},x0={key:1,class:"row py-3"},e3={class:"col-12"},t3={class:"col-12 py-3"},s3=e("h4",null,"Доступные сервисы в событии",-1),o3={key:2,class:"row"},l3={class:"col-12"},i3={key:3,class:"row"},n3={class:"col-12"},a3={class:"col-12 py-3"},d3=e("h4",null,"Актуальные записи на событие",-1),r3={key:4,class:"row"},c3={class:"col-12"},u3={class:"col-12 py-3"},m3=e("h4",null,"Отзывы к событию",-1),_3={props:["bot"],data(){return{part:0,tab:0,loadTable:!1,loadService:!1,loadReviewForm:!1,loadAppointments:!1,loadReviews:!1,loadAppointmentForm:!1,loadForm:!1,selectedEvent:null,selectedService:null,selectedAppointment:null,selectedReview:null}},computed:{...C(["getAppointmentEvents","getAppointmentEventsPaginateObject"])},mounted(){},methods:{callbackForm(){this.loadTable=!0,this.$nextTick(()=>{this.loadTable=!1})},callbackAppointment(){this.loadAppointments=!0,this.$nextTick(()=>{this.loadAppointments=!1})},callbackReview(){this.loadReviews=!0,this.$nextTick(()=>{this.loadReviews=!1})},createEvent(){this.part=2},selectAppointment(o){this.loadAppointmentForm=!0,this.selectedAppointment=o,this.$nextTick(()=>{this.loadAppointmentForm=!1})},selectService(o){this.loadService=!0,this.selectedService=o,this.$nextTick(()=>{this.loadService=!1})},selectReview(o){this.loadReviewForm=!0,this.selectedReview=o,this.$nextTick(()=>{this.loadReviewForm=!1})},selectEvent(o){this.loadForm=!0,this.$nextTick(()=>{this.loadForm=!1,this.selectedEvent=o,this.part=1,this.tab=0})}}},h3=Object.assign(_3,{__name:"Appointment",setup(o){return(t,s)=>(l(),i(v,null,[t.part===0?(l(),i("div",D0,[e("div",E0,[e("div",L0,[e("button",{type:"button",onClick:s[0]||(s[0]=(...n)=>t.createEvent&&t.createEvent(...n)),class:"btn btn-primary"}," Создать новое событие ")])]),t.loadTable?r("",!0):(l(),$(ny,{key:0,onSelect:t.selectEvent,bot:o.bot},null,8,["onSelect","bot"]))])):r("",!0),t.part===2?(l(),i("div",K0,[e("div",N0,[e("div",Y0,[e("button",{type:"button",onClick:s[1]||(s[1]=n=>t.part=0),class:"btn btn-outline-primary"}," Назад ")])]),t.loadForm?r("",!0):(l(),$(G,{key:0,onCallback:t.callbackForm,bot:o.bot},null,8,["onCallback","bot"]))])):r("",!0),t.part===1?(l(),i("div",J0,[e("div",H0,[e("div",W0,[e("button",{type:"button",onClick:s[2]||(s[2]=n=>t.part=0),class:"btn btn-outline-primary"}," Назад ")])]),e("ul",G0,[e("li",{class:"nav-item",onClick:s[3]||(s[3]=n=>t.tab=0)},[e("a",{class:_(["nav-link",{active:t.tab===0}]),"aria-current":"page",href:"javascript:void(0)"},"Информация о событии",2)]),e("li",{class:"nav-item",onClick:s[4]||(s[4]=n=>t.tab=1)},[e("a",{class:_(["nav-link",{active:t.tab===1}]),href:"javascript:void(0)"},"Сервисы в событии",2)]),e("li",{class:"nav-item",onClick:s[5]||(s[5]=n=>t.tab=2)},[e("a",{class:_(["nav-link",{active:t.tab===2}]),href:"javascript:void(0)"},"График",2)]),e("li",{class:"nav-item",onClick:s[6]||(s[6]=n=>t.tab=3)},[e("a",{class:_(["nav-link",{active:t.tab===3}]),href:"javascript:void(0)"},"Записи на событие",2)]),e("li",{class:"nav-item",onClick:s[7]||(s[7]=n=>t.tab=4)},[e("a",{class:_(["nav-link",{active:t.tab===4}]),href:"javascript:void(0)"},"Отзывы о событии",2)])]),t.tab===0?(l(),i("div",X0,[e("div",Z0,[t.loadForm?r("",!0):(l(),$(G,{key:0,onCallback:t.callbackForm,event:t.selectedEvent,bot:o.bot},null,8,["onCallback","event","bot"]))])])):r("",!0),t.tab===1?(l(),i("div",x0,[e("div",e3,[t.loadService?r("",!0):(l(),$(ut,{key:0,service:t.selectedService,"event-id":t.selectedEvent.id,bot:o.bot},null,8,["service","event-id","bot"]))]),e("div",t3,[s3,p(Fy,{"event-id":t.selectedEvent.id,onSelect:t.selectService,bot:o.bot},null,8,["event-id","onSelect","bot"])])])):r("",!0),t.tab===2?(l(),i("div",o3,[e("div",l3,[p(Kk,{"event-id":t.selectedEvent.id,bot:o.bot},null,8,["event-id","bot"])])])):r("",!0),t.tab===3?(l(),i("div",i3,[e("div",n3,[t.loadAppointmentForm?r("",!0):(l(),$(C$,{key:0,bot:o.bot,onCallback:t.callbackAppointment,"event-id":t.selectedEvent.id,appointment:t.selectedAppointment},null,8,["bot","onCallback","event-id","appointment"]))]),e("div",a3,[d3,t.loadAppointments?r("",!0):(l(),$(D$,{key:0,"event-id":t.selectedEvent.id,onSelect:t.selectAppointment,bot:o.bot},null,8,["event-id","onSelect","bot"]))])])):r("",!0),t.tab===4?(l(),i("div",r3,[e("div",c3,[t.loadReviewForm?r("",!0):(l(),$(F0,{key:0,review:t.selectedReview,bot:o.bot,onCallback:s[8]||(s[8]=n=>t.callbackReview()),"event-id":t.selectedEvent.id},null,8,["review","bot","event-id"]))]),e("div",u3,[m3,t.loadReviews?r("",!0):(l(),$(M0,{key:0,bot:o.bot,onSelect:t.selectReview,"event-id":t.selectedEvent.id},null,8,["bot","onSelect","event-id"]))])])):r("",!0)])):r("",!0)],64))}}),p3={props:["param"],data(){return{htmlInjections:[{title:"Кнопка синяя",value:"<a href='http://test.com/test' class='w-100 btn btn-primary'>Текст кнопки</a>"},{title:"Кнопка без цвета",value:"<a href='http://test.com/test' class='w-100 btn btn-link'>Текст кнопки</a>"},{title:"Кнопка с синей обводкой",value:"<a href='http://test.com/test' class='w-100 btn btn-outline-primary'>Текст кнопки</a>"}]}},mounted(){},methods:{attachTo(o){this.$emit("callback",{param:this.param||null,value:o})}}},b3={class:"dropdown"},f3=e("button",{class:"btn btn-link dropdown-toggle",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"}," Кнопки ",-1),g3={class:"dropdown-menu"},v3=["onClick"],$3={class:"dropdown-item",href:"javascript:void(0)"};function y3(o,t,s,n,a,d){return l(),i("div",b3,[f3,e("ul",g3,[(l(!0),i(v,null,y(a.htmlInjections,g=>(l(),i("li",{onClick:f=>d.attachTo(g.value)},[e("a",$3,u(g.title||"Не указано"),1)],8,v3))),256))])])}const B=A(p3,[["render",y3]]),k3={class:"row"},F3={class:"col-12 mb-3"},w3={class:"form-label",id:"quiz-title"},C3=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),S3=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),j3={class:"col-12 mb-3"},q3={class:"form-check"},z3=e("label",{class:"form-check-label",for:"need_media"}," Нужен медиа-контент ",-1),O3={key:0,class:"col-12 mb-3"},V3={class:"form-label",id:"quiz-images"},P3=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),A3=e("div",null," Изображение, которое видит пользователь при выборе квиза ",-1),Q3=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),U3={class:"col-12 mb-3"},I3={class:"form-label",id:"quiz-description"},T3=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),B3=e("div",null," Краткая информация о квизе ",-1),R3=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),M3={key:0,class:"text-gray-400 ml-3",style:{"font-size":"10px"}},D3={class:"col-12 mb-3"},E3={class:"form-check"},L3=e("label",{class:"form-check-label",for:"polling_mode"}," Квиз в режиме опроса (без команд и таймеров) ",-1),K3={key:1,class:"col-12 mb-3"},N3={class:"form-label",id:"quiz-time_limit"},Y3=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),J3=e("div",null," Время на ответ ",-1),H3=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),W3={class:"col-12 mb-3"},G3={class:"form-check"},X3=e("label",{class:"form-check-label",for:"is-group"}," Показывать ответы по окончанию раунда ",-1),Z3={class:"col-12 mb-3"},x3={class:"form-check"},e5=e("label",{class:"form-check-label",for:"is_active"}," Квиз виден пользователям ",-1),t5={key:2,class:"col-12 mb-3"},s5={class:"form-check"},o5=e("label",{class:"form-check-label",for:"round_mode"}," Использовать систему раундов ",-1),l5={class:"col-12 mb-3"},i5={class:"form-label",id:"quiz-time_limit"},n5=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),a5=e("div",null," Число попыток прохождения квиза ",-1),d5=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),r5={class:"col-12 mb-3"},c5={class:"form-label",id:"quiz-time_limit"},u5=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),m5=e("div",null," Сколько % нужно ответить чтоб пройти ",-1),_5=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),h5={class:"row"},p5={class:"col-12 py-2"},b5={class:"col-12 mb-3"},f5={class:"row"},g5={class:"col-10"},v5={class:"d-flex justify-content-between"},$5={class:"form-label",id:"quiz-success_message"},y5=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),k5=e("div",null," Текст в случае успешного прохождения квиза ",-1),F5=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),w5={key:0,class:"text-gray-400 ml-3",style:{"font-size":"10px"}},C5=["onUpdate:modelValue"],S5={class:"col-2 d-flex align-items-center justify-content-center"},j5=["disabled","onClick"],q5={class:"row"},z5={class:"col-12 mb-2"},O5={class:"form-check"},V5=e("label",{class:"form-check-label",for:"need_inline_menu_on_success"}," Меню под текстом страницы при выигрыше ",-1),P5={key:0,class:"col-12 mb-2"},A5={class:"card"},Q5={class:"card-header d-flex justify-between align-items-center"},U5=e("h6",null,"Конструктор меню в сообщении",-1),I5={key:0},T5={key:1},B5={class:"card-body"},R5={class:"row"},M5={class:"col-12 py-2"},D5={class:"col-12 mb-3"},E5={class:"row"},L5={class:"col-10"},K5={class:"d-flex justify-content-between"},N5=["id"],Y5=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),J5=e("div",null," Текст в случае неудачного прохождения квиза ",-1),H5=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),W5={key:0,class:"text-gray-400 ml-3",style:{"font-size":"10px"}},G5=["onUpdate:modelValue"],X5={class:"col-2 d-flex align-items-center justify-content-center"},Z5=["disabled","onClick"],x5={class:"row"},eF={class:"col-12 mb-2"},tF={class:"form-check"},sF=e("label",{class:"form-check-label",for:"need_template_selector_on_failure"}," Меню под текстом страницы при проигрыше ",-1),oF={key:0,class:"col-12 mb-2"},lF={class:"card"},iF={class:"card-header d-flex justify-between align-items-center"},nF=e("h6",null,"Конструктор меню в сообщении",-1),aF={key:0},dF={key:1},rF={class:"card-body"},cF={class:"row"},uF={class:"col-12 mb-3"},mF={class:"form-floating"},_F=["value","selected"],hF=e("label",{for:"quiz-display-type"},"Тип вывода вопросов",-1),pF={class:"row"},bF={class:"col-12"},fF={type:"submit",class:"btn btn-outline-success w-100 p-3"},gF={key:0},vF={key:1},$F={props:["quiz","bot"],data(){return{step:0,load:!1,need_reset:!1,need_services:!1,need_media:!1,need_inline_menu_on_success:!1,need_template_selector_on_success:!1,need_template_selector_on_failure:!1,need_inline_menu_on_failure:!1,types:["По порядку","Перемешать всё","Перемешать ответы","Перемешать вопросы"],quizForm:{id:null,title:null,image:null,description:null,completed_at:null,start_at:null,end_at:null,display_type:0,time_limit:30,show_answers:!1,polling_mode:!1,round_mode:!0,is_active:!1,try_count:1,success_percent:50,success_message:["Задание успешно пройдено!"],failure_message:["К сожалению вы не прошли задание!"],success_inline_keyboard_id:null,success_inline_keyboard:null,failure_inline_keyboard_id:null,failure_inline_keyboard:null}}},watch:{quizForm:{handler(o){this.need_reset=!0},deep:!0},"quizForm.polling_mode":{handler(o){this.quizForm.round_mode=!1},deep:!0}},mounted(){this.quiz&&this.$nextTick(()=>{this.quizForm={id:this.quiz.id||null,title:this.quiz.title||null,image:this.quiz.image||null,description:this.quiz.description||null,completed_at:this.quiz.completed_at?this.$filters.currentFull(this.quiz.completed_at):null,start_at:this.quiz.start_at?this.$filters.currentFull(this.quiz.start_at):null,end_at:this.quiz.end_at?this.$filters.currentFull(this.quiz.end_at):null,display_type:this.quiz.display_type||0,time_limit:this.quiz.time_limit||30,show_answers:this.quiz.show_answers||!1,polling_mode:this.quiz.polling_mode||!1,round_mode:this.quiz.round_mode||!1,is_active:this.quiz.is_active||!1,try_count:this.quiz.try_count||1,success_inline_keyboard_id:this.quiz.success_inline_keyboard_id||null,success_inline_keyboard:this.quiz.success_inline_keyboard||null,failure_inline_keyboard_id:this.quiz.failure_inline_keyboard_id||null,failure_inline_keyboard:this.quiz.failure_inline_keyboard||null,success_percent:this.quiz.success_percent||50,success_message:this.quiz.success_message||["Задание успешно пройдено!"],failure_message:this.quiz.failure_message||["К сожалению вы не прошли задание!"]},this.quizForm.success_inline_keyboard&&(this.need_inline_menu_on_success=!0),this.quizForm.failure_inline_keyboard&&(this.need_inline_menu_on_failure=!0)})},methods:{saveInlineKeyboardOnSuccess(o){this.quizForm.success_inline_keyboard=o},saveInlineKeyboardOnFailure(o){this.quizForm.failure_inline_keyboard=o},selectInlineKeyboardOnSuccess(o){this.quizForm.success_inline_keyboard=o,this.need_template_selector_on_success=!1},selectInlineKeyboardOnFailure(o){this.quizForm.failure_inline_keyboard=o,this.need_template_selector_on_failure=!1},attachTo(o,t){this.quizForm[o.param][t]==null?this.quizForm[o.param][t]=o.value:this.quizForm[o.param][t]+=o.value},selectPhoto(o){this.quizForm.image=o.file_id},removeMessage(o,t){this.quizForm[o||"success_message"].splice(t,1)},addMessage(o,t){this.quizForm[o||"success_message"].push(t)},submitForm(){let o=new FormData;Object.keys(this.quizForm).forEach(t=>{const s=this.quizForm[t]||"";typeof s=="object"?o.append(t,JSON.stringify(s)):o.append(t,s)}),o.append("bot_id",this.bot.id),this.$store.dispatch("storeQuiz",{quizForm:o}).then(t=>{this.quizForm={id:null,title:null,image:null,description:null,completed_at:null,start_at:null,end_at:null,display_type:0,time_limit:30,show_answers:!1,polling_mode:!1,round_mode:!1,is_active:!1,try_count:1,success_percent:50,success_inline_keyboard_id:null,success_inline_keyboard:null,failure_inline_keyboard_id:null,failure_inline_keyboard:null,success_message:["Задание успешно пройдено!"],failure_message:["К сожалению вы не прошли задание!"]},this.$emit("callback",t.data),this.$notify("Событие успешно создано")}).catch(t=>{this.$notify("Ошибка создания события")})}}},Z=Object.assign($F,{__name:"QuizForm",setup(o){return(t,s)=>{const n=q("Popper");return l(),i("form",{onSubmit:s[17]||(s[17]=S((...a)=>t.submitForm&&t.submitForm(...a),["prevent"])),class:"py-3"},[e("div",k3,[e("div",F3,[e("label",w3,[p(n,{content:"Название вашего квиза"},{default:h(()=>[C3]),_:1}),m(" Название квиза "),S3]),c(e("input",{type:"text",class:"form-control",placeholder:"Название","aria-label":"Название","onUpdate:modelValue":s[0]||(s[0]=a=>t.quizForm.title=a),maxlength:"255","aria-describedby":"quiz-title",required:""},null,512),[[b,t.quizForm.title]])]),e("div",j3,[e("div",q3,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[1]||(s[1]=a=>t.need_media=a),type:"checkbox",id:"need_media"},null,512),[[k,t.need_media]]),z3])]),t.need_media?(l(),i("div",O3,[e("label",V3,[p(n,null,{content:h(()=>[A3]),default:h(()=>[P3]),_:1}),m(" Изображение к квизу "),Q3]),p(O,{"need-photo":!0,selected:t.quizForm.image,onSelect:t.selectPhoto},null,8,["selected","onSelect"])])):r("",!0),e("div",U3,[e("label",I3,[p(n,null,{content:h(()=>[B3]),default:h(()=>[T3]),_:1}),m(" Описание события "),R3,t.quizForm.description?(l(),i("small",M3," Длина текста "+u(t.quizForm.description.length)+"/255",1)):r("",!0)]),c(e("textarea",{class:"form-control",placeholder:"Описание мероприятия","aria-label":"Описание мероприятия",maxlength:"255","onUpdate:modelValue":s[2]||(s[2]=a=>t.quizForm.description=a),"aria-describedby":"quiz-description",required:""},`
                    `,512),[[b,t.quizForm.description]])]),e("div",D3,[e("div",E3,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[3]||(s[3]=a=>t.quizForm.polling_mode=a),type:"checkbox",id:"polling_mode"},null,512),[[k,t.quizForm.polling_mode]]),L3])]),t.quizForm.polling_mode?r("",!0):(l(),i("div",K3,[e("label",N3,[p(n,null,{content:h(()=>[J3]),default:h(()=>[Y3]),_:1}),m(" Лимит времени на ответ в секундах "),H3]),c(e("input",{type:"number",class:"form-control",placeholder:"Лимит времени на ответ","aria-label":"Лимит времени на ответ",step:"0.1",min:"0","onUpdate:modelValue":s[4]||(s[4]=a=>t.quizForm.time_limit=a),"aria-describedby":"quiz-time_limit",required:""},null,512),[[b,t.quizForm.time_limit]])])),e("div",W3,[e("div",G3,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[5]||(s[5]=a=>t.quizForm.show_answers=a),type:"checkbox",id:"is-group"},null,512),[[k,t.quizForm.show_answers]]),X3])]),e("div",Z3,[e("div",x3,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[6]||(s[6]=a=>t.quizForm.is_active=a),type:"checkbox",id:"is_active"},null,512),[[k,t.quizForm.is_active]]),e5])]),t.quizForm.polling_mode?r("",!0):(l(),i("div",t5,[e("div",s5,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[7]||(s[7]=a=>t.quizForm.round_mode=a),type:"checkbox",id:"round_mode"},null,512),[[k,t.quizForm.round_mode]]),o5])])),e("div",l5,[e("label",i5,[p(n,null,{content:h(()=>[a5]),default:h(()=>[n5]),_:1}),m(" Количество попыток "),d5]),c(e("input",{type:"number",class:"form-control",placeholder:"Число попыток","aria-label":"Число попыток",step:"1",min:"1","onUpdate:modelValue":s[8]||(s[8]=a=>t.quizForm.try_count=a),"aria-describedby":"quiz-try_count",required:""},null,512),[[b,t.quizForm.try_count]])]),e("div",r5,[e("label",c5,[p(n,null,{content:h(()=>[m5]),default:h(()=>[u5]),_:1}),m(" % для прохождения "),_5]),c(e("input",{type:"number",class:"form-control",placeholder:"Процент для победы","aria-label":"Процент для победы",step:"1",min:"0","onUpdate:modelValue":s[9]||(s[9]=a=>t.quizForm.success_percent=a),"aria-describedby":"quiz-success_percent",required:""},null,512),[[b,t.quizForm.success_percent]])])]),e("div",h5,[e("div",p5,[e("button",{class:"btn btn-outline-info rounded-5",type:"button",onClick:s[10]||(s[10]=a=>t.addMessage("success_message",null))},"Добавить еще вариант текста ")]),(l(!0),i(v,null,y(t.quizForm.success_message,(a,d)=>(l(),i("div",b5,[e("div",f5,[e("div",g5,[e("div",v5,[e("label",$5,[p(n,null,{content:h(()=>[k5]),default:h(()=>[y5]),_:1}),m(" Текст при победе "),F5,t.quizForm.success_message[d]?(l(),i("small",w5," Длина текста "+u(t.quizForm.success_message[d].length)+"/255",1)):r("",!0)]),p(B,{param:"success_message",onCallback:g=>t.attachTo(g,d)},null,8,["onCallback"])]),c(e("textarea",{class:"form-control",placeholder:"Текст при победе","aria-label":"Текст при победе",maxlength:"255","onUpdate:modelValue":g=>t.quizForm.success_message[d]=g,"aria-describedby":"quiz-success_message",required:""},`
                    `,8,C5),[[b,t.quizForm.success_message[d]]])]),e("div",S5,[e("button",{class:"btn btn-outline-danger",disabled:t.quizForm.success_message.length<=1,onClick:g=>t.removeMessage("success_message",d)},"Удалить ",8,j5)])])]))),256))]),e("div",q5,[e("div",z5,[e("div",O5,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[11]||(s[11]=a=>t.need_inline_menu_on_success=a),type:"checkbox",id:"need_inline_menu_on_success"},null,512),[[k,t.need_inline_menu_on_success]]),V5])]),t.need_inline_menu_on_success?(l(),i("div",P5,[e("div",A5,[e("div",Q5,[U5,e("button",{class:_(["btn",{"btn-outline-primary":!t.need_template_selector_on_success,"btn-primary":t.need_template_selector_on_success}]),type:"button",onClick:s[12]||(s[12]=a=>t.need_template_selector_on_success=!t.need_template_selector_on_success)},[t.need_template_selector_on_success?(l(),i("span",T5," Скрыть шаблоны меню")):(l(),i("span",I5," Открыть шаблоны меню"))],2)]),e("div",B5,[t.need_template_selector_on_success?(l(),$(T,{key:0,class:"mb-2",type:"inline",onSelect:t.selectInlineKeyboardOnSuccess,"select-mode":!0},null,8,["onSelect"])):(l(),$(U,{key:1,type:"inline",onSave:t.saveInlineKeyboardOnSuccess,"edited-keyboard":t.quizForm.success_inline_keyboard},null,8,["onSave","edited-keyboard"]))])])])):r("",!0)]),e("div",R5,[e("div",M5,[e("button",{class:"btn btn-outline-info rounded-5",type:"button",onClick:s[13]||(s[13]=a=>t.addMessage("failure_message",null))},"Добавить еще вариант текста ")]),(l(!0),i(v,null,y(t.quizForm.failure_message,(a,d)=>(l(),i("div",D5,[e("div",E5,[e("div",L5,[e("div",K5,[e("label",{class:"form-label",id:"quiz-failure_message"+d},[p(n,null,{content:h(()=>[J5]),default:h(()=>[Y5]),_:1}),m(" Текст при проигрыше "),H5,t.quizForm.failure_message[d]?(l(),i("small",W5," Длина текста "+u(t.quizForm.failure_message[d].length)+"/255",1)):r("",!0)],8,N5),p(B,{param:"failure_message",onCallback:g=>t.attachTo(g,d)},null,8,["onCallback"])]),c(e("textarea",{class:"form-control",placeholder:"Текст при проигрыше","aria-label":"Текст при проигрыше",maxlength:"255","onUpdate:modelValue":g=>t.quizForm.failure_message[d]=g,"aria-describedby":"quiz-success_message",required:""},`
                    `,8,G5),[[b,t.quizForm.failure_message[d]]])]),e("div",X5,[e("button",{class:"btn btn-outline-danger",disabled:t.quizForm.failure_message.length<=1,onClick:g=>t.removeMessage("failure_message",d)},"Удалить ",8,Z5)])])]))),256))]),e("div",x5,[e("div",eF,[e("div",tF,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[14]||(s[14]=a=>t.need_inline_menu_on_failure=a),type:"checkbox",id:"need_template_selector_on_failure"},null,512),[[k,t.need_inline_menu_on_failure]]),sF])]),t.need_inline_menu_on_failure?(l(),i("div",oF,[e("div",lF,[e("div",iF,[nF,e("button",{class:_(["btn",{"btn-outline-primary":!t.need_template_selector_on_failure,"btn-primary":t.need_template_selector_on_failure}]),type:"button",onClick:s[15]||(s[15]=a=>t.need_template_selector_on_failure=!t.need_template_selector_on_failure)},[t.need_template_selector_on_failure?(l(),i("span",dF," Скрыть шаблоны меню")):(l(),i("span",aF," Открыть шаблоны меню"))],2)]),e("div",rF,[t.need_template_selector_on_failure?(l(),$(T,{key:0,class:"mb-2",type:"inline",onSelect:t.selectInlineKeyboardOnFailure,"select-mode":!0},null,8,["onSelect"])):(l(),$(U,{key:1,type:"inline",onSave:t.saveInlineKeyboardOnFailure,"edited-keyboard":t.quizForm.failure_inline_keyboard},null,8,["onSave","edited-keyboard"]))])])])):r("",!0)]),e("div",cF,[e("div",uF,[e("div",mF,[c(e("select",{class:"form-select","onUpdate:modelValue":s[16]||(s[16]=a=>t.quizForm.display_type=a),id:"quiz-display-type","aria-label":"quiz-display-type"},[(l(!0),i(v,null,y(t.types,(a,d)=>(l(),i("option",{value:d,selected:d==t.quizForm.display_type},u(a),9,_F))),256))],512),[[I,t.quizForm.display_type]]),hF])])]),e("div",pF,[e("div",bF,[e("button",fF,[t.quizForm.id==null?(l(),i("span",gF,"Создать квиз")):(l(),i("span",vF,"Обновить квиз"))])])])],32)}}}),yF={class:"row py-2"},kF={class:"col-12"},FF={class:"input-group mb-3"},wF={class:"col-12"},CF={key:0,class:"table"},SF=e("th",{scope:"col"},"Число вопросов",-1),jF=e("th",{scope:"col"},"Число команд",-1),qF=e("th",{scope:"col"},"Действие",-1),zF={scope:"row"},OF=["onClick"],VF={key:0,style:{width:"50px",height:"50px"},alt:""},PF={key:1},AF={key:0,class:"mb-0"},QF={key:1},UF={key:0,class:"mb-0"},IF={key:1},TF={key:0,class:"mb-0"},BF={key:1},RF={key:0,class:"fa-solid fa-chevron-down text-success"},MF={key:1,class:"fa-solid fa-xmark text-danger"},DF={key:0,class:"fa-solid fa-chevron-down text-success"},EF={key:1,class:"fa-solid fa-xmark text-danger"},LF={key:0,class:"dropdown"},KF=e("button",{class:"btn btn-outline-secondary",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-solid fa-ellipsis"})],-1),NF={class:"dropdown-menu"},YF={key:0},JF=["onClick"],HF={key:1},WF=e("div",{class:"alert alert-warning alert-dismissible fade show",role:"alert"},[e("strong",null,"Внимание!"),m(" Вы еще не добавили ни одного квиза! "),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"alert","aria-label":"Close"})],-1),GF={class:"position-relative p-5 text-center text-muted bg-body border border-dashed rounded-2"},XF={class:"d-flex justify-content-center mb-3"},ZF={alt:"",width:"100",height:"100"},xF=e("h1",{class:"text-body-emphasis"},"Создание Квиза",-1),ew=e("p",{class:"col-lg-8 mx-auto fs-5 text-muted"}," Квиз - это игра. Создавайте игры и делитесь с клиентами ссылкой на игру. Формируйте команды, начисляйте баллы, меняйте баллы на вкусные призы. Всё в ваших руках. ",-1),tw={class:"d-inline-flex gap-2 mb-5"},sw=e("a",{href:"https://telegra.ph/Sozdanie-Kviza-01-13",target:"_blank",class:"d-inline-flex align-items-center btn btn-outline-secondary btn-lg px-4 rounded-pill"}," Подробнее ",-1),ow={key:0,class:"col-12"},lw={props:["bot"],data(){return{direction:"desc",order:"updated_at",show:!0,loading:!0,quizzes:[],search:null,paginate_object:null}},computed:{...C(["getQuizzes","getQuizzesPaginateObject"])},mounted(){this.loadQuizzes()},methods:{removeQuiz(o){this.loading=!0,this.$store.dispatch("removeQuiz",{quizId:o}).then(t=>{this.loading=!1,this.loadQuizzes(0),this.$notify("Событие успешно удалено")}).catch(()=>{this.loading=!1,this.$notify("Ошибка удаления события")})},createQuiz(){this.$emit("create")},nextQuizzes(o){this.loadQuizzes(o)},selectEvent(o){this.$emit("select",o)},loadAndOrder(o){this.order=o,this.direction=this.direction==="desc"?"asc":"desc",this.loadQuizzes(0)},loadQuizzes(o=0){this.loading=!0,this.$store.dispatch("loadQuizzes",{dataObject:{bot_id:this.bot.id||null,search:this.search,order:this.order,direction:this.direction},page:o,size:20}).then(t=>{this.loading=!1,this.quizzes=this.getQuizzes,this.paginate_object=this.getQuizzesPaginateObject}).catch(()=>{this.loading=!1})}}},iw=Object.assign(lw,{__name:"QuizTable",setup(o){return(t,s)=>{const n=Q("lazy");return l(),i("div",yF,[e("div",kF,[e("div",FF,[c(e("input",{type:"search",class:"form-control",placeholder:"Поиск квиза","aria-label":"Поиск квиза","onUpdate:modelValue":s[0]||(s[0]=a=>t.search=a),"aria-describedby":"quiz-search-quiz"},null,512),[[b,t.search]]),e("button",{class:"btn btn-outline-secondary",onClick:s[1]||(s[1]=a=>t.loadQuizzes(0)),type:"button",id:"quiz-search-quiz"},"Найти ")])]),e("div",wF,[t.quizzes.length>0?(l(),i("table",CF,[e("thead",null,[e("tr",null,[e("th",{scope:"col",class:"cursor-pointer",onClick:s[2]||(s[2]=a=>t.loadAndOrder("id"))},"#"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[3]||(s[3]=a=>t.loadAndOrder("title"))},"Название"),SF,jF,e("th",{scope:"col",class:"cursor-pointer",onClick:s[4]||(s[4]=a=>t.loadAndOrder("image"))},"Изображение к квизу"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[5]||(s[5]=a=>t.loadAndOrder("description"))},"Описание"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[6]||(s[6]=a=>t.loadAndOrder("completed_at"))},"Квиз пройден"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[7]||(s[7]=a=>t.loadAndOrder("start_at"))},"Дата и время начала"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[8]||(s[8]=a=>t.loadAndOrder("end_at"))},"Дата и время завершения"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[9]||(s[9]=a=>t.loadAndOrder("display_type"))},"Тип отображения"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[10]||(s[10]=a=>t.loadAndOrder("show_answers"))},"Показывать ответы по окончанию раунда "),e("th",{scope:"col",class:"cursor-pointer",onClick:s[11]||(s[11]=a=>t.loadAndOrder("is_active"))},"Активный "),e("th",{scope:"col",class:"cursor-pointer",onClick:s[12]||(s[12]=a=>t.loadAndOrder("updated_at"))},"Дата изменения"),qF])]),e("tbody",null,[(l(!0),i(v,null,y(t.quizzes,(a,d)=>(l(),i("tr",{class:_({"border-info":a.deleted_at==null,"border-danger":a.deleted_at!=null})},[e("th",zF,u(a.id),1),e("td",{onClick:g=>t.selectEvent(a)},u(a.title||"Не указано"),9,OF),e("td",null,u((a.questions||[]).length),1),e("td",null,u((a.commands||[]).length),1),e("td",null,[a.image!=null?c((l(),i("img",VF,null,512)),[[n,"/file-by-file-id/"+a.image]]):(l(),i("p",PF,"не указано"))]),e("td",null,u(a.description||"Не указано"),1),e("td",null,[a.completed_at?(l(),i("p",AF,u(t.$filters.currentFull(a.completed_at)),1)):(l(),i("p",QF,"Не задано"))]),e("td",null,[a.start_at?(l(),i("p",UF,u(t.$filters.currentFull(a.start_at)),1)):(l(),i("p",IF,"Не задано"))]),e("td",null,[a.end_at?(l(),i("p",TF,u(t.$filters.currentFull(a.end_at)),1)):(l(),i("p",BF,"Не задано"))]),e("td",null,u(a.display_type),1),e("td",null,u(a.time_limit),1),e("td",null,[a.show_answers?(l(),i("i",RF)):(l(),i("i",MF))]),e("td",null,[a.is_active?(l(),i("i",DF)):(l(),i("i",EF))]),e("td",null,u(t.$filters.current(a.updated_at)),1),e("td",null,[a.id?(l(),i("div",LF,[KF,e("ul",NF,[a.deleted_at==null?(l(),i("li",YF,[e("a",{class:"dropdown-item",onClick:g=>t.removeQuiz(a.id),href:"javascript:void(0)"},"Удалить",8,JF)])):r("",!0)])])):r("",!0)])],2))),256))])])):(l(),i("div",HF,[WF,e("div",GF,[e("div",XF,[c(e("img",ZF,null,512),[[n,"../images/icon.png"]])]),xF,ew,e("div",tw,[e("button",{onClick:s[13]||(s[13]=(...a)=>t.createQuiz&&t.createQuiz(...a)),class:"d-inline-flex align-items-center btn btn-lg px-4 rounded-pill btn-primary",type:"button"}," Добавить "),sw])])]))]),t.quizzes.length>0?(l(),i("div",ow,[t.paginate_object?(l(),$(j,{key:0,onPagination_page:t.nextQuizzes,pagination:t.paginate_object},null,8,["onPagination_page","pagination"])):r("",!0)])):r("",!0)])}}}),nw={props:{type:String,value:String}},aw={class:"d-flex mb-2"},dw={class:"form-floating mb-3"},rw=["value"],cw=e("label",{for:"custom-url-link-for-success"},"Ссылка на файл",-1);function uw(o,t,s,n,a,d){return l(),i(v,null,[e("div",aw,[e("span",{class:_(["badge bg-secondary cursor-pointer mr-1",{"bg-success":s.type=="video"}]),onClick:t[0]||(t[0]=g=>o.$emit("update:type","video"))},"Видео",2),e("span",{class:_(["badge bg-secondary cursor-pointer mr-1",{"bg-success":s.type=="video_note"}]),onClick:t[1]||(t[1]=g=>o.$emit("update:type","video_note"))},"Кружок",2),e("span",{class:_(["badge bg-secondary cursor-pointer mr-1",{"bg-success":s.type=="photo"}]),onClick:t[2]||(t[2]=g=>o.$emit("update:type","photo"))},"Изображение",2),e("span",{class:_(["badge bg-secondary cursor-pointer mr-1",{"bg-success":s.type=="audio"}]),onClick:t[3]||(t[3]=g=>o.$emit("update:type","audio"))},"Звук",2)]),e("div",dw,[e("input",{type:"text",class:"form-control",value:s.value,onInput:t[4]||(t[4]=g=>o.$emit("update:value",g.target.value)),id:"custom-url-link-for-success",placeholder:"https://...."},null,40,rw),cw])],64)}const L=A(nw,[["render",uw]]),mw={class:"row py-3"},_w={class:"col-12"},hw={class:"row"},pw={class:"col-12 mb-3"},bw={key:0},fw=["onClick"],gw={class:"form-label",id:"quiz-round"},vw=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),$w=e("div",null," Раунд, в котором будет отображен вопрос ",-1),yw=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),kw={class:"col-12 mb-3"},Fw={class:"form-label",id:"event-on_after_appointment"},ww=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),Cw=e("div",null," Текст вопроса ",-1),Sw=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),jw={key:0,class:"text-gray-400 ml-3",style:{"font-size":"10px"}},qw={class:"col-12 mb-3"},zw={class:"form-check"},Ow=e("label",{class:"form-check-label",for:"need_media"}," Нужен медиа-контент ",-1),Vw={key:0,class:"col-12 mb-3"},Pw={class:"form-label",id:"quiz-images"},Aw=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),Qw=e("div",null," Изображение, видео, аудио сопровождение вопроса ",-1),Uw={key:0,class:"badge rounded-pill text-bg-info m-0"},Iw=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),Tw=e("h6",null,"Вставьте ссылку на контент...",-1),Bw=e("h6",null,"...или выберите из доступных",-1),Rw={class:"col-12 mb-3"},Mw={class:"form-check"},Dw=e("label",{class:"form-check-label",for:"is_multiply"}," Множественные ответы ",-1),Ew={class:"col-12 mb-3"},Lw={class:"form-check"},Kw=e("label",{class:"form-check-label",for:"is_open"}," Открытый вопрос ",-1),Nw={class:"col-12 mb-3"},Yw={class:"d-flex justify-content-between"},Jw={class:"form-label",id:"quiz-description"},Hw=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),Ww=e("div",null," Текст при выборе правильного ответа ",-1),Gw=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),Xw={key:0,class:"text-gray-400 ml-3",style:{"font-size":"10px"}},Zw={class:"col-12 mb-3"},xw={class:"form-check"},eC=e("label",{class:"form-check-label",for:"need_media_for_success"}," Нужен медиа-контент при правильном ответе ",-1),tC={key:1,class:"col-12 mb-3"},sC=e("h6",null,"Вставьте ссылку на контент...",-1),oC=e("h6",null,"...или выберите из доступных",-1),lC={class:"col-12 mb-3"},iC={class:"d-flex justify-content-between"},nC={class:"form-label",id:"quiz-description"},aC=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),dC=e("div",null," Текст в выбора неправильного ответа ",-1),rC=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),cC={key:0,class:"text-gray-400 ml-3",style:{"font-size":"10px"}},uC={class:"col-12 mb-3"},mC={class:"form-check"},_C=e("label",{class:"form-check-label",for:"need_media_for_failed"}," Нужен медиа-контент при неправильном ответе ",-1),hC={key:2,class:"col-12 mb-3"},pC=e("h6",null,"Вставьте ссылку на контент...",-1),bC=e("h6",null,"...или выберите из доступных",-1),fC={class:"row"},gC={class:"col-12"},vC={class:"col-12"},$C={key:0,class:"table"},yC=e("thead",null,[e("tr",null,[e("th",{scope:"col"},"#"),e("th",{scope:"col"},"Текст вопроса"),e("th",{scope:"col"},"Баллы"),e("th",{scope:"col"},"Контент"),e("th",{scope:"col"},"Тип контента"),e("th",{scope:"col"},"Является верным"),e("th",{scope:"col"},"Действие")])],-1),kC={scope:"row"},FC={class:"form-floating mb-3"},wC=["onUpdate:modelValue","id"],CC=["for"],SC={class:"form-floating mb-3"},jC=["onUpdate:modelValue","id"],qC=["for"],zC=["onClick"],OC={class:"form-check"},VC=["onUpdate:modelValue","id"],PC=["for"],AC={class:"dropdown"},QC=e("button",{class:"btn btn-outline-secondary",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-solid fa-ellipsis"})],-1),UC={class:"dropdown-menu"},IC={key:0},TC=["onClick"],BC={key:1},RC=["onClick"],MC={key:1},DC={class:"row"},EC={class:"col-12"},LC={type:"submit",class:"btn btn-outline-success w-100 p-3"},KC={key:0},NC={key:1},YC={class:"modal fade",id:"chooseMediaContent",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},JC={class:"modal-dialog"},HC={class:"modal-content"},WC={key:0,class:"modal-body"},GC=e("div",{class:"modal-footer"},[e("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Закрыть")],-1),XC={class:"modal fade",id:"chooseSuccessMediaContent",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},ZC={class:"modal-dialog"},xC={class:"modal-content"},e4={class:"modal-body"},t4=e("div",{class:"modal-footer"},[e("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Закрыть")],-1),s4={class:"modal fade",id:"chooseFailureMediaContent",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},o4={class:"modal-dialog"},l4={class:"modal-content"},i4={class:"modal-body"},n4=e("div",{class:"modal-footer"},[e("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Закрыть")],-1),a4={class:"modal fade",id:"chooseBaseMediaContent",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},d4={class:"modal-dialog"},r4={class:"modal-content"},c4={class:"modal-body"},u4=e("div",{class:"modal-footer"},[e("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Закрыть")],-1),m4={props:["quizId","bot","question"],data(){return{step:0,load:!1,selectedQuestionIndex:null,need_media:!1,need_media_for_success:!1,need_media_for_failed:!1,rounds:[],questionForm:{id:null,text:null,round:null,media_content:null,content_type:null,is_multiply:!1,is_open:!1,answers:[],success_message:null,failure_message:null,success_media_content:null,failure_media_content:null,success_media_content_type:null,failure_media_content_type:null}}},watch:{questionForm:{handler(o){this.need_reset=!0},deep:!0},need_media:function(o,t){this.need_page_images||(this.questionForm.media_content=null,this.questionForm.content_type=null)},need_media_for_success:function(o,t){this.need_page_images||(this.questionForm.success_media_content=null,this.questionForm.success_media_content_type=null)},need_media_for_failed:function(o,t){this.need_page_images||(this.questionForm.failure_media_content=null,this.questionForm.failure_media_content_type=null)}},mounted(){this.loadQuizRounds(),this.question&&(this.question.media_content!=null&&(this.need_media=!0),this.question.success_media_content!=null&&(this.need_media_for_success=!0),this.question.failure_media_content!=null&&(this.need_media_for_failed=!0),this.$nextTick(()=>{this.questionForm={id:this.question.id||null,text:this.question.text||null,round:this.question.round||null,media_content:this.question.media_content||null,content_type:this.question.content_type||null,is_multiply:this.question.is_multiply||!1,is_open:this.question.is_open||!1,answers:this.question.answers||[],success_message:this.question.success_message||null,failure_message:this.question.failure_message||null,success_media_content:this.question.success_media_content||null,failure_media_content:this.question.failure_media_content||null,success_media_content_type:this.question.success_media_content_type||null,failure_media_content_type:this.question.failure_media_content_type||null}}))},methods:{attachTo(o){this.questionForm[o.param]==null?this.questionForm[o.param]=o.value:this.questionForm[o.param]+=o.value},loadQuizRounds(){this.$store.dispatch("loadQuizRounds",{dataObject:{bot_id:this.bot.id||null,quiz_id:this.quizId||null}}).then(o=>{this.rounds=o})},chooseBaseMediaContent(o){new bootstrap.Modal(document.getElementById("chooseBaseMediaContent"),{}).show()},chooseSuccessMediaContent(o){new bootstrap.Modal(document.getElementById("chooseSuccessMediaContent"),{}).show()},chooseFailureMediaContent(o){new bootstrap.Modal(document.getElementById("chooseFailureMediaContent"),{}).show()},chooseMediaContent(o){this.selectedQuestionIndex=null,this.$nextTick(()=>{this.selectedQuestionIndex=o}),new bootstrap.Modal(document.getElementById("chooseMediaContent"),{}).show()},selectMediaForFailure(o){this.questionForm.failure_media_content=o.file_id,this.questionForm.failure_media_content_type=o.type},selectMediaForSuccess(o){this.questionForm.success_media_content=o.file_id,this.questionForm.success_media_content_type=o.type},selectMediaForAnswer(o){this.questionForm.answers[this.selectedQuestionIndex].media_content=o.file_id,this.questionForm.answers[this.selectedQuestionIndex].content_type=o.type},selectMedia(o){this.questionForm.media_content=o.file_id,this.questionForm.content_type=o.type},clearQuestionForm(){this.questionForm={id:null,text:null,round:null,media_content:null,content_type:null,is_multiply:!1,is_open:!1,answers:[],success_message:null,failure_message:null,success_media_content:null,failure_media_content:null,success_media_content_type:null,failure_media_content_type:null}},addNewAnswer(){this.questionForm.answers.push({text:null,media_content:null,content_type:null,is_right_answer:!1,points:0})},removeAnswerFromArray(o){this.questionForm.answers.splice(o,1)},removeAnswer(o){this.$store.dispatch("removeQuizAnswer",{quizAnswerId:o}).then(t=>{this.$notify("Вопрос успешно удален");let s=this.questionForm.answers.findIndex(n=>n.id==o);this.questionForm.answers.splice(s,1)}).catch(t=>{this.$notify("Ошибка удаления вопроса")})},submitForm(){let o=new FormData;Object.keys(this.questionForm).forEach(t=>{const s=this.questionForm[t]||"";typeof s=="object"?o.append(t,JSON.stringify(s)):o.append(t,s)}),o.append("bot_id",this.bot.id),o.append("quiz_id",this.quizId),this.$store.dispatch("storeQuizQuestion",{quizQuestionForm:o}).then(t=>{this.$emit("callback",t.data),this.$notify("Вопрос успешно создан"),this.clearQuestionForm(),this.loadQuizRounds()}).catch(t=>{this.$notify("Ошибка создания вопроса")})}}},_4=Object.assign(m4,{__name:"QuizQuestionForm",setup(o){return(t,s)=>{const n=q("Popper");return l(),i(v,null,[e("div",mw,[e("div",_w,[e("button",{onClick:s[0]||(s[0]=(...a)=>t.clearQuestionForm&&t.clearQuestionForm(...a)),class:"btn btn-primary"},"Новый вопрос ")])]),e("form",{onSubmit:s[20]||(s[20]=S((...a)=>t.submitForm&&t.submitForm(...a),["prevent"]))},[e("div",hw,[e("div",pw,[t.rounds.length>0?(l(),i("p",bw,[m(" Ранее созданные раунды: "),(l(!0),i(v,null,y(t.rounds,a=>(l(),i("span",{onClick:d=>t.questionForm.round=a,class:"badge bg-primary mr-1 cursor-pointer"},u(a),9,fw))),256))])):r("",!0),e("label",gw,[p(n,null,{content:h(()=>[$w]),default:h(()=>[vw]),_:1}),m(" Раунд "),yw]),c(e("input",{type:"number",class:"form-control",placeholder:"Раунд","aria-label":"Раундт",step:"1",min:"1","onUpdate:modelValue":s[1]||(s[1]=a=>t.questionForm.round=a),"aria-describedby":"quiz-round",required:""},null,512),[[b,t.questionForm.round]])]),e("div",kw,[e("label",Fw,[p(n,null,{content:h(()=>[Cw]),default:h(()=>[ww]),_:1}),m(" Текст вопроса "),Sw,t.questionForm.text?(l(),i("small",jw," Длина текста "+u(t.questionForm.text.length)+"/255",1)):r("",!0)]),c(e("textarea",{type:"text",class:"form-control",placeholder:"Текст вопроса","aria-label":"Текст вопроса","onUpdate:modelValue":s[2]||(s[2]=a=>t.questionForm.text=a),maxlength:"255","aria-describedby":"review-text",required:""},`
                    `,512),[[b,t.questionForm.text]])]),e("div",qw,[e("div",zw,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[3]||(s[3]=a=>t.need_media=a),type:"checkbox",id:"need_media"},null,512),[[k,t.need_media]]),Ow])]),t.need_media?(l(),i("div",Vw,[e("label",Pw,[p(n,null,{content:h(()=>[Qw]),default:h(()=>[Aw]),_:1}),m(" Медиа контент к вопросу "),t.questionForm.content_type?(l(),i("span",Uw,u(t.questionForm.content_type),1)):r("",!0),Iw]),Tw,p(L,{value:t.questionForm.media_content,type:t.questionForm.content_type,"onUpdate:type":s[4]||(s[4]=a=>t.questionForm.content_type=a),"onUpdate:value":s[5]||(s[5]=a=>t.questionForm.media_content=a)},null,8,["value","type"]),Bw,e("button",{type:"button",onClick:s[6]||(s[6]=(...a)=>t.chooseBaseMediaContent&&t.chooseBaseMediaContent(...a)),class:"btn btn-outline-info rounded-lg"},"Выбрать медиа-файл ")])):r("",!0),e("div",Rw,[e("div",Mw,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[7]||(s[7]=a=>t.questionForm.is_multiply=a),type:"checkbox",id:"is_multiply"},null,512),[[k,t.questionForm.is_multiply]]),Dw])]),e("div",Ew,[e("div",Lw,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[8]||(s[8]=a=>t.questionForm.is_open=a),type:"checkbox",id:"is_open"},null,512),[[k,t.questionForm.is_open]]),Kw])]),e("div",Nw,[e("div",Yw,[e("label",Jw,[p(n,null,{content:h(()=>[Ww]),default:h(()=>[Hw]),_:1}),m(" Текст при выборе правильного ответа "),Gw,t.questionForm.success_message?(l(),i("small",Xw," Длина текста "+u(t.questionForm.success_message.length)+"/255",1)):r("",!0)]),p(B,{param:"success_message",onCallback:t.attachTo},null,8,["onCallback"])]),c(e("textarea",{class:"form-control",placeholder:"Текст при правильном ответе","aria-label":"Текст при правильном ответе",maxlength:"255","onUpdate:modelValue":s[9]||(s[9]=a=>t.questionForm.success_message=a),"aria-describedby":"quiz-question-success_message"},`
                    `,512),[[b,t.questionForm.success_message]])]),e("div",Zw,[e("div",xw,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[10]||(s[10]=a=>t.need_media_for_success=a),type:"checkbox",id:"need_media_for_success"},null,512),[[k,t.need_media_for_success]]),eC])]),t.need_media_for_success?(l(),i("div",tC,[sC,p(L,{type:t.questionForm.success_media_content_type,"onUpdate:type":s[11]||(s[11]=a=>t.questionForm.success_media_content_type=a),value:t.questionForm.success_media_content,"onUpdate:value":s[12]||(s[12]=a=>t.questionForm.success_media_content=a)},null,8,["type","value"]),oC,e("button",{type:"button",onClick:s[13]||(s[13]=(...a)=>t.chooseSuccessMediaContent&&t.chooseSuccessMediaContent(...a)),class:"btn btn-outline-info rounded-lg"},"Выбрать медиа-файл ")])):r("",!0),e("div",lC,[e("div",iC,[e("label",nC,[p(n,null,{content:h(()=>[dC]),default:h(()=>[aC]),_:1}),m(" Текст при выборе неправильного ответа "),rC,t.questionForm.failure_message?(l(),i("small",cC," Длина текста "+u(t.questionForm.failure_message.length)+"/255",1)):r("",!0)]),p(B,{param:"failure_message",onCallback:t.attachTo},null,8,["onCallback"])]),c(e("textarea",{class:"form-control",placeholder:"Текст при неправильном ответе","aria-label":"Текст при неправильном ответе",maxlength:"255","onUpdate:modelValue":s[14]||(s[14]=a=>t.questionForm.failure_message=a),"aria-describedby":"quiz-question-failure-message"},`
                    `,512),[[b,t.questionForm.failure_message]])]),e("div",uC,[e("div",mC,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[15]||(s[15]=a=>t.need_media_for_failed=a),type:"checkbox",id:"need_media_for_failed"},null,512),[[k,t.need_media_for_failed]]),_C])]),t.need_media_for_failed?(l(),i("div",hC,[pC,p(L,{type:t.questionForm.failure_media_content_type,"onUpdate:type":s[16]||(s[16]=a=>t.questionForm.failure_media_content_type=a),value:t.questionForm.failure_media_content,"onUpdate:value":s[17]||(s[17]=a=>t.questionForm.failure_media_content=a)},null,8,["type","value"]),bC,e("button",{type:"button",onClick:s[18]||(s[18]=(...a)=>t.chooseFailureMediaContent&&t.chooseFailureMediaContent(...a)),class:"btn btn-outline-info rounded-lg"},"Выбрать медиа-файл ")])):r("",!0)]),e("div",fC,[e("div",gC,[e("button",{onClick:s[19]||(s[19]=(...a)=>t.addNewAnswer&&t.addNewAnswer(...a)),type:"button",class:"btn btn-outline-success rounded-5"}," Добавить ответы ")]),e("div",vC,[t.questionForm.answers.length>0?(l(),i("table",$C,[yC,e("tbody",null,[(l(!0),i(v,null,y(t.questionForm.answers,(a,d)=>(l(),i("tr",{class:_({"border-info":a.deleted_at==null,"border-danger":a.deleted_at!=null})},[e("th",kC,u(a.id||"Новый"),1),e("td",null,[e("div",FC,[c(e("input",{type:"text","onUpdate:modelValue":g=>t.questionForm.answers[d].text=g,class:"form-control",id:"answer-text-"+d,placeholder:"Текст ответа"},null,8,wC),[[b,t.questionForm.answers[d].text]]),e("label",{for:"answer-text-"+d},"Текст ответа",8,CC)])]),e("td",null,[e("div",SC,[c(e("input",{type:"text","onUpdate:modelValue":g=>t.questionForm.answers[d].points=g,class:"form-control",id:"answer-points-"+d,placeholder:"Текст ответа"},null,8,jC),[[b,t.questionForm.answers[d].points]]),e("label",{for:"answer-points-"+d},"Баллы",8,qC)])]),e("td",null,[e("p",{class:"cursor-pointer",onClick:g=>t.chooseMediaContent(d)},u(a.media_content||"Не указано"),9,zC)]),e("td",null,u(a.content_type||"Не указано"),1),e("td",null,[e("div",OC,[c(e("input",{class:"form-check-input","onUpdate:modelValue":g=>t.questionForm.answers[d].is_right_answer=g,type:"checkbox",id:"answer-is_right_answer-"+d},null,8,VC),[[k,t.questionForm.answers[d].is_right_answer]]),e("label",{class:"form-check-label",for:"answer-is_right_answer-"+d}," Правильный ответ ",8,PC)])]),e("td",null,[e("div",AC,[QC,e("ul",UC,[a.id==null?(l(),i("li",IC,[e("a",{class:"dropdown-item",onClick:g=>t.removeAnswerFromArray(d),href:"javascript:void(0)"},"Удалить",8,TC)])):r("",!0),a.deleted_at==null&&a.id!=null?(l(),i("li",BC,[e("a",{class:"dropdown-item",onClick:g=>t.removeAnswer(a.id),href:"javascript:void(0)"},"Удалить",8,RC)])):r("",!0)])])])],2))),256))])])):(l(),i("p",MC,"На текущий момент нет ни одного созданного ответа"))])]),e("div",DC,[e("div",EC,[e("button",LC,[t.questionForm.id==null?(l(),i("span",KC,"Сохранить вопрос")):(l(),i("span",NC,"Обновить вопрос"))])])])],32),e("div",YC,[e("div",JC,[e("div",HC,[t.selectedQuestionIndex!=null?(l(),i("div",WC,[p(O,{"need-video":!0,"need-video-note":!0,"need-audio":!0,"need-photo":!0,selected:[t.questionForm.answers[t.selectedQuestionIndex||0].media_content||""],onSelect:t.selectMediaForAnswer},null,8,["selected","onSelect"])])):r("",!0),GC])])]),e("div",XC,[e("div",ZC,[e("div",xC,[e("div",e4,[p(O,{"need-video":!0,"need-video-note":!0,"need-audio":!0,"need-photo":!0,selected:[t.questionForm.success_media_content],onSelect:t.selectMediaForSuccess},null,8,["selected","onSelect"])]),t4])])]),e("div",s4,[e("div",o4,[e("div",l4,[e("div",i4,[p(O,{"need-video":!0,"need-video-note":!0,"need-audio":!0,"need-photo":!0,selected:[t.questionForm.failure_media_content],onSelect:t.selectMediaForFailure},null,8,["selected","onSelect"])]),n4])])]),e("div",a4,[e("div",d4,[e("div",r4,[e("div",c4,[p(O,{"need-video":!0,"need-video-note":!0,"need-audio":!0,"need-photo":!0,selected:[t.questionForm.media_content],onSelect:t.selectMedia},null,8,["selected","onSelect"])]),u4])])])],64)}}}),h4={class:"row"},p4={class:"col-12"},b4={key:0,class:"table"},f4=e("th",{scope:"col"},"Число ответов",-1),g4=e("th",{scope:"col"},"Действие",-1),v4={scope:"row"},$4=["onClick"],y4={key:0,class:"fa-solid fa-chevron-down text-success"},k4={key:1,class:"fa-solid fa-xmark text-danger"},F4={key:0,class:"fa-solid fa-chevron-down text-success"},w4={key:1,class:"fa-solid fa-xmark text-danger"},C4={key:0,class:"dropdown"},S4=e("button",{class:"btn btn-outline-secondary",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-solid fa-ellipsis"})],-1),j4={class:"dropdown-menu"},q4={key:0},z4=["onClick"],O4={key:1},V4={class:"col-12"},P4={props:["bot","quizId"],data(){return{direction:"desc",order:"updated_at",show:!0,is_group:!1,loading:!0,questions:[],search:null,paginate_object:null}},computed:{...C(["getQuizQuestions","getQuizQuestionsPaginateObject"])},mounted(){this.loadQuizQuestions()},methods:{nextQuizQuestion(o){this.loadQuizQuestions(o)},selectQuizQuestion(o){this.$emit("select",o),this.$notify("Вопрос успешно выбран")},removeQuizQuestion(o){this.loading=!0,this.$store.dispatch("removeQuizQuestion",{quizQuestionId:o}).then(t=>{this.loading=!1,this.loadQuizQuestions(0),this.$notify("Вопрос успешно удален")}).catch(()=>{this.loading=!1,this.$notify("Вопрос удаления сервиса")})},loadAndOrder(o){this.order=o,this.direction=this.direction==="desc"?"asc":"desc",this.loadQuizQuestions(0)},loadQuizQuestions(o=0){this.loading=!0,this.$store.dispatch("loadQuizQuestions",{dataObject:{quiz_id:this.quizId,bot_id:this.bot.id||null,search:this.search,order:this.order,direction:this.direction},page:o,size:100}).then(t=>{this.loading=!1,this.questions=this.getQuizQuestions,this.paginate_object=this.getQuizQuestionsPaginateObject}).catch(()=>{this.loading=!1})}}},A4=Object.assign(P4,{__name:"QuizQuestionTable",setup(o){return(t,s)=>(l(),i("div",h4,[e("div",p4,[t.questions.length>0?(l(),i("table",b4,[e("thead",null,[e("tr",null,[e("th",{scope:"col",class:"cursor-pointer",onClick:s[0]||(s[0]=n=>t.loadAndOrder("id"))},"#"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[1]||(s[1]=n=>t.loadAndOrder("text"))},"Текст вопроса"),f4,e("th",{scope:"col",class:"cursor-pointer",onClick:s[2]||(s[2]=n=>t.loadAndOrder("round"))},"Раунд"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[3]||(s[3]=n=>t.loadAndOrder("media_content"))},"Контент"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[4]||(s[4]=n=>t.loadAndOrder("content_type"))},"Тип контента"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[5]||(s[5]=n=>t.loadAndOrder("is_multiply"))},"Множественный"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[6]||(s[6]=n=>t.loadAndOrder("is_open"))},"Открытый"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[7]||(s[7]=n=>t.loadAndOrder("updated_at"))},"Дата изменения"),g4])]),e("tbody",null,[(l(!0),i(v,null,y(t.questions,(n,a)=>(l(),i("tr",{class:_({"border-info":n.deleted_at==null,"border-danger":n.deleted_at!=null})},[e("th",v4,u(n.id),1),e("td",{onClick:d=>t.selectQuizQuestion(n)},u(n.text||"Не указано"),9,$4),e("td",null,u((n.answers||[]).length),1),e("td",null,u(n.round||"Не указано"),1),e("td",null,u(n.media_content||"Не указано"),1),e("td",null,u(n.content_type||"Не указано"),1),e("td",null,[n.is_multiply?(l(),i("i",y4)):(l(),i("i",k4))]),e("td",null,[n.is_open?(l(),i("i",F4)):(l(),i("i",w4))]),e("td",null,u(t.$filters.current(n.updated_at)),1),e("td",null,[n.id?(l(),i("div",C4,[S4,e("ul",j4,[n.deleted_at==null?(l(),i("li",q4,[e("a",{class:"dropdown-item",onClick:d=>t.removeQuizQuestion(n.id),href:"javascript:void(0)"},"Удалить",8,z4)])):r("",!0)])])):r("",!0)])],2))),256))])])):(l(),i("p",O4,"На текущий момент нет ни одного созданного вопроса"))]),e("div",V4,[t.paginate_object?(l(),$(j,{key:0,onPagination_page:t.nextQuizQuestion,pagination:t.paginate_object},null,8,["onPagination_page","pagination"])):r("",!0)])]))}}),Q4={class:"row py-3"},U4={class:"col-12"},I4={class:"row"},T4={class:"col-12 mb-3"},B4={class:"form-label",id:"command-title"},R4=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),M4=e("div",null," Название команды ",-1),D4=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),E4={class:"col-12 mb-3"},L4={class:"form-label",id:"event-on_after_appointment"},K4=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),N4=e("div",null," Текст описания команды ",-1),Y4=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),J4={key:0,class:"text-gray-400 ml-3",style:{"font-size":"10px"}},H4=e("div",{class:"col-12 mb-3"},[e("button",{type:"button",class:"btn btn-outline-info rounded-5","data-bs-toggle":"modal","data-bs-target":"#select-players"}," Подобрать участников команды ")],-1),W4={key:0,class:"col-12 mb-3"},G4=e("h4",null,"Пользователи в команде",-1),X4={class:"list-group list-group-numbered"},Z4={class:"list-group-item d-flex justify-content-between align-items-start"},x4={class:"ms-2 me-auto"},e8={class:"fw-bold"},t8={class:"dropdown"},s8=e("button",{class:"btn btn-outline-secondary",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-solid fa-ellipsis"})],-1),o8={class:"dropdown-menu"},l8=["onClick"],i8={class:"row"},n8={class:"col-12"},a8={type:"submit",class:"btn btn-outline-success w-100 p-3"},d8={key:0},r8={key:1},c8={class:"modal fade",id:"select-players",tabindex:"-1","aria-labelledby":"select-players-label","aria-hidden":"true"},u8={class:"modal-dialog modal-fullscreen"},m8={class:"modal-content"},_8=e("div",{class:"modal-header"},[e("h1",{class:"modal-title fs-5",id:"select-players-label"},"Подбор участников команды"),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),h8={class:"modal-body"},p8=e("div",{class:"modal-footer"},[e("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Закрыть")],-1),b8={props:["quizId","bot","command"],data(){return{step:0,load:!1,commandForm:{id:null,title:null,description:null,players:[]}}},watch:{commandForm:{handler(o){this.need_reset=!0},deep:!0}},mounted(){this.command&&this.$nextTick(()=>{this.commandForm={id:this.command.id||null,title:this.command.title||null,description:this.command.description||null,players:this.command.players||[]}})},methods:{removePlayerFromCommand(o){},selectBotUser(o){if(this.commandForm.players.findIndex(s=>s.id==o.id)>=0){this.$notify("Такой пользователь уже есть в списке");return}this.$notify("Пользователь успешно добавлен"),this.commandForm.players.push(o)},clearCommandForm(){this.commandForm={id:null,title:null,description:null,players:[]}},submitForm(){let o=new FormData;Object.keys(this.commandForm).forEach(t=>{const s=this.commandForm[t]||"";typeof s=="object"?o.append(t,JSON.stringify(s)):o.append(t,s)}),o.append("bot_id",this.bot.id),o.append("quiz_id",this.quizId),this.$store.dispatch("storeQuizCommand",{quizCommandForm:o}).then(t=>{this.$emit("callback",t.data),this.$notify("Команда успешно создана"),this.clearCommandForm()}).catch(t=>{this.$notify("Ошибка создания команды")})}}},f8=Object.assign(b8,{__name:"QuizCommandForm",setup(o){return(t,s)=>{const n=q("Popper");return l(),i(v,null,[e("div",Q4,[e("div",U4,[e("button",{onClick:s[0]||(s[0]=(...a)=>t.clearCommandForm&&t.clearCommandForm(...a)),class:"btn btn-primary"},"Новая команда")])]),e("form",{onSubmit:s[3]||(s[3]=S((...a)=>t.submitForm&&t.submitForm(...a),["prevent"]))},[e("div",I4,[e("div",T4,[e("label",B4,[p(n,null,{content:h(()=>[M4]),default:h(()=>[R4]),_:1}),m(" Название команды "),D4]),c(e("input",{type:"text",class:"form-control",placeholder:"Название команды","aria-label":"Название команды",maxlength:"255","onUpdate:modelValue":s[1]||(s[1]=a=>t.commandForm.title=a),"aria-describedby":"command-title",required:""},null,512),[[b,t.commandForm.title]])]),e("div",E4,[e("label",L4,[p(n,null,{content:h(()=>[N4]),default:h(()=>[K4]),_:1}),m(" Описание команды "),Y4,t.commandForm.description?(l(),i("small",J4," Длина текста "+u(t.commandForm.description.length)+"/255",1)):r("",!0)]),c(e("textarea",{type:"text",class:"form-control",placeholder:"Текст описания","aria-label":"Текст описания","onUpdate:modelValue":s[2]||(s[2]=a=>t.commandForm.description=a),maxlength:"255","aria-describedby":"command-text",required:""},`
                    `,512),[[b,t.commandForm.description]])]),H4,t.commandForm.players.length>0?(l(),i("div",W4,[G4,e("ol",X4,[(l(!0),i(v,null,y(t.commandForm.players,a=>(l(),i("li",Z4,[e("div",x4,[e("div",e8,"#"+u(a.id),1),m(" "+u(a.fio_from_telegram||a.telegram_chat_id),1)]),e("div",t8,[s8,e("ul",o8,[e("li",null,[e("a",{class:"dropdown-item",onClick:d=>t.removePlayerFromCommand(a.id),href:"javascript:void(0)"},"Удалить",8,l8)])])])]))),256))])])):r("",!0)]),e("div",i8,[e("div",n8,[e("button",a8,[t.commandForm.id==null?(l(),i("span",d8,"Сохранить команду")):(l(),i("span",r8,"Обновить команду"))])])])],32),e("div",c8,[e("div",u8,[e("div",m8,[_8,e("div",h8,[p(R,{simple:!0,onSelect:t.selectBotUser},null,8,["onSelect"])]),p8])])])],64)}}}),g8={class:"row"},v8={class:"col-12"},$8={key:0,class:"table"},y8=e("th",{scope:"col"},"Число участников",-1),k8=e("th",{scope:"col"},"Действие",-1),F8={scope:"row"},w8=["onClick"],C8={key:0,class:"dropdown"},S8=e("button",{class:"btn btn-outline-secondary",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-solid fa-ellipsis"})],-1),j8={class:"dropdown-menu"},q8={key:0},z8=["onClick"],O8={key:1},V8={class:"col-12"},P8={props:["bot","quizId"],data(){return{direction:"desc",order:"updated_at",show:!0,is_group:!1,loading:!0,commands:[],search:null,paginate_object:null}},computed:{...C(["getQuizCommands","getQuizCommandsPaginateObject"])},mounted(){this.loadQuizCommands()},methods:{nextQuizCommand(o){this.loadQuizCommands(o)},selectQuizCommand(o){this.$emit("select",o),this.$notify("Вопрос успешно выбран")},removeQuizCommand(o){this.loading=!0,this.$store.dispatch("removeQuizCommand",{quizCommandId:o}).then(t=>{this.loading=!1,this.loadQuizCommands(0),this.$notify("Вопрос успешно удален")}).catch(()=>{this.loading=!1,this.$notify("Вопрос удаления сервиса")})},loadAndOrder(o){this.order=o,this.direction=this.direction==="desc"?"asc":"desc",this.loadQuizCommands(0)},loadQuizCommands(o=0){this.loading=!0,this.$store.dispatch("loadQuizCommands",{dataObject:{quiz_id:this.quizId,bot_id:this.bot.id||null,search:this.search,order:this.order,direction:this.direction},page:o,size:100}).then(t=>{this.loading=!1,this.commands=this.getQuizCommands,this.paginate_object=this.getQuizCommandsPaginateObject}).catch(()=>{this.loading=!1})}}},A8=Object.assign(P8,{__name:"QuizCommandTable",setup(o){return(t,s)=>(l(),i("div",g8,[e("div",v8,[t.commands.length>0?(l(),i("table",$8,[e("thead",null,[e("tr",null,[e("th",{scope:"col",class:"cursor-pointer",onClick:s[0]||(s[0]=n=>t.loadAndOrder("id"))},"#"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[1]||(s[1]=n=>t.loadAndOrder("title"))},"Название"),y8,e("th",{scope:"col",class:"cursor-pointer",onClick:s[2]||(s[2]=n=>t.loadAndOrder("description"))},"Описание"),k8])]),e("tbody",null,[(l(!0),i(v,null,y(t.commands,(n,a)=>(l(),i("tr",{class:_({"border-info":n.deleted_at==null,"border-danger":n.deleted_at!=null})},[e("th",F8,u(n.id),1),e("td",{onClick:d=>t.selectQuizCommand(n)},u(n.title||"Не указано"),9,w8),e("td",null,u((n.players||[]).length),1),e("td",null,u(n.description||"Не указано"),1),e("td",null,[n.id?(l(),i("div",C8,[S8,e("ul",j8,[n.deleted_at==null?(l(),i("li",q8,[e("a",{class:"dropdown-item",onClick:d=>t.removeQuizCommand(n.id),href:"javascript:void(0)"},"Удалить",8,z8)])):r("",!0)])])):r("",!0)])],2))),256))])])):(l(),i("p",O8,"На текущий момент нет ни одной созданной команды"))]),e("div",V8,[t.paginate_object?(l(),$(j,{key:0,onPagination_page:t.nextQuizCommand,pagination:t.paginate_object},null,8,["onPagination_page","pagination"])):r("",!0)])]))}}),Q8={class:"row"},U8={class:"col-12"},I8={key:0,class:"table"},T8=e("th",{scope:"col"},"Название квиза",-1),B8=e("th",{scope:"col"},"Название команды",-1),R8=e("th",{scope:"col"},"Число участников",-1),M8=e("th",{scope:"col"},"Результат",-1),D8=e("th",{scope:"col"},"Действие",-1),E8={scope:"row"},L8=["onClick"],K8={key:0},N8=e("td",null,"-",-1),Y8={key:0,class:"dropdown"},J8=e("button",{class:"btn btn-outline-secondary",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-solid fa-ellipsis"})],-1),H8={class:"dropdown-menu"},W8={key:0},G8=["onClick"],X8={key:1},Z8={class:"col-12"},x8={props:["bot","quizId"],data(){return{direction:"desc",order:"updated_at",show:!0,is_group:!1,loading:!0,results:[],search:null,paginate_object:null}},computed:{...C(["getQuizResults","getQuizResultsPaginateObject"])},mounted(){this.loadQuizResults()},methods:{nextQuizResult(o){this.loadQuizResults(o)},selectQuizResult(o){this.$emit("select",o),this.$notify("Вопрос успешно выбран")},removeQuizResult(o){this.loading=!0,this.$store.dispatch("removeQuizResult",{quizResultId:o}).then(t=>{this.loading=!1,this.loadQuizResults(0),this.$notify("Вопрос успешно удален")}).catch(()=>{this.loading=!1,this.$notify("Вопрос удаления сервиса")})},loadAndOrder(o){this.order=o,this.direction=this.direction==="desc"?"asc":"desc",this.loadQuizResults(0)},loadQuizResults(o=0){this.loading=!0,this.$store.dispatch("loadQuizResults",{dataObject:{quiz_id:this.quizId,bot_id:this.bot.id||null,search:this.search,order:this.order,direction:this.direction},page:o,size:100}).then(t=>{this.loading=!1,this.results=this.getQuizResults,this.paginate_object=this.getQuizResultsPaginateObject}).catch(()=>{this.loading=!1})}}},e6=Object.assign(x8,{__name:"QuizResultTable",setup(o){return(t,s)=>(l(),i("div",Q8,[e("div",U8,[t.results.length>0?(l(),i("table",I8,[e("thead",null,[e("tr",null,[e("th",{scope:"col",class:"cursor-pointer",onClick:s[0]||(s[0]=n=>t.loadAndOrder("id"))},"#"),T8,B8,R8,e("th",{scope:"col",class:"cursor-pointer",onClick:s[1]||(s[1]=n=>t.loadAndOrder("points"))},"Баллы"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[2]||(s[2]=n=>t.loadAndOrder("times"))},"Время"),M8,D8])]),e("tbody",null,[(l(!0),i(v,null,y(t.results,(n,a)=>(l(),i("tr",{class:_({"border-info":n.deleted_at==null,"border-danger":n.deleted_at!=null})},[e("th",E8,u(n.id),1),e("td",{onClick:d=>t.selectQuizResult(n)},u(n.quiz.title||"Не указано"),9,L8),e("td",null,[n.command?(l(),i("span",K8,u(n.command.title||"Не указано"),1)):r("",!0)]),e("td",null,u((n.command.players||[]).length),1),e("td",null,u(n.points||"Не указано"),1),e("td",null,u(n.times||"Не указано"),1),N8,e("td",null,[n.id?(l(),i("div",Y8,[J8,e("ul",H8,[n.deleted_at==null?(l(),i("li",W8,[e("a",{class:"dropdown-item",onClick:d=>t.removeQuizResult(n.id),href:"javascript:void(0)"},"Удалить",8,G8)])):r("",!0)])])):r("",!0)])],2))),256))])])):(l(),i("p",X8,"На текущий момент нет ни одного созданного вопроса"))]),e("div",Z8,[t.paginate_object?(l(),$(j,{key:0,onPagination_page:t.nextQuizResult,pagination:t.paginate_object},null,8,["onPagination_page","pagination"])):r("",!0)])]))}}),t6={key:0,class:"py-2"},s6={class:"row"},o6={class:"col-12"},l6={key:1,class:"py-2"},i6={class:"row"},n6={class:"col-12"},a6={key:2,class:"py-2"},d6={class:"row"},r6={class:"col-12"},c6={class:"nav nav-tabs justify-content-center"},u6={key:0,class:"row py-3"},m6={class:"col-12"},_6={key:1,class:"row py-3"},h6={class:"col-12"},p6={class:"col-12 py-3"},b6=e("h4",null,"Доступные вопросы",-1),f6={key:2,class:"row"},g6={class:"col-12"},v6={class:"col-12 py-3"},$6=e("h4",null,"Команды участники квиза",-1),y6={key:3,class:"row"},k6={class:"col-12 py-3"},F6=e("h4",null,"Статистика",-1),w6={key:4,class:"row"},C6=e("div",{class:"col-12"},null,-1),S6=e("div",{class:"col-12 py-3"},[e("h4",null,"Отзывы к событию")],-1),j6=[C6,S6],q6={props:["bot"],data(){return{part:0,tab:0,loadTable:!1,loadQuizCommand:!1,loadQuizQuestion:!1,loadQuizQuestionTable:!1,loadQuizCommandTable:!1,loadQuizResult:!1,loadForm:!1,selectedQuiz:null,selectedQuizQuestion:null,selectedQuizCommand:null,selectedQuizResult:null}},mounted(){},methods:{callbackCommandForm(){this.loadQuizCommandTable=!0,this.$nextTick(()=>{this.loadQuizCommandTable=!1})},callbackQuestionForm(){this.loadQuizQuestionTable=!0,this.$nextTick(()=>{this.loadQuizQuestionTable=!1})},callbackForm(){this.loadTable=!0,this.part=0,this.$nextTick(()=>{this.loadTable=!1})},createQuiz(){this.part=2},selectQuizResult(o){this.loadQuizResult=!0,this.$nextTick(()=>{this.loadQuizResult=!1,this.selectedQuizResult=o})},selectQuizCommand(o){this.loadQuizCommand=!0,this.$nextTick(()=>{this.loadQuizCommand=!1,this.selectedQuizCommand=o})},selectQuizQuestion(o){this.loadQuizQuestion=!0,this.$nextTick(()=>{this.loadQuizQuestion=!1,this.selectedQuizQuestion=o})},selectQuiz(o){this.loadForm=!0,this.$nextTick(()=>{this.loadForm=!1,this.selectedQuiz=o,this.part=1,this.tab=0})}}},z6=Object.assign(q6,{__name:"Quizzes",setup(o){return(t,s)=>(l(),i(v,null,[t.part===0?(l(),i("div",t6,[e("div",s6,[e("div",o6,[e("button",{type:"button",onClick:s[0]||(s[0]=(...n)=>t.createQuiz&&t.createQuiz(...n)),class:"btn btn-primary"}," Создать новый квиз ")])]),t.loadTable?r("",!0):(l(),$(iw,{key:0,onCreate:t.createQuiz,onSelect:t.selectQuiz,bot:o.bot},null,8,["onCreate","onSelect","bot"]))])):r("",!0),t.part===2?(l(),i("div",l6,[e("div",i6,[e("div",n6,[e("button",{type:"button",onClick:s[1]||(s[1]=n=>t.part=0),class:"btn btn-outline-primary"}," Назад ")])]),t.loadForm?r("",!0):(l(),$(Z,{key:0,onCallback:t.callbackForm,bot:o.bot},null,8,["onCallback","bot"]))])):r("",!0),t.part===1?(l(),i("div",a6,[e("div",d6,[e("div",r6,[e("button",{type:"button",onClick:s[2]||(s[2]=n=>t.part=0),class:"btn btn-outline-primary"}," Назад ")])]),e("ul",c6,[e("li",{class:"nav-item",onClick:s[3]||(s[3]=n=>t.tab=0)},[e("a",{class:_(["nav-link",{active:t.tab===0}]),"aria-current":"page",href:"javascript:void(0)"},"Информация о квизе",2)]),e("li",{class:"nav-item",onClick:s[4]||(s[4]=n=>t.tab=1)},[e("a",{class:_(["nav-link",{active:t.tab===1}]),href:"javascript:void(0)"},"Вопросы квиза",2)]),e("li",{class:"nav-item",onClick:s[5]||(s[5]=n=>t.tab=2)},[e("a",{class:_(["nav-link",{active:t.tab===2}]),href:"javascript:void(0)"},"Команды на квизе",2)]),e("li",{class:"nav-item",onClick:s[6]||(s[6]=n=>t.tab=3)},[e("a",{class:_(["nav-link",{active:t.tab===3}]),href:"javascript:void(0)"},"Командная статистика",2)])]),t.tab===0?(l(),i("div",u6,[e("div",m6,[t.loadForm?r("",!0):(l(),$(Z,{key:0,onCallback:t.callbackForm,quiz:t.selectedQuiz,bot:o.bot},null,8,["onCallback","quiz","bot"]))])])):r("",!0),t.tab===1?(l(),i("div",_6,[e("div",h6,[t.loadQuizQuestion?r("",!0):(l(),$(_4,{key:0,question:t.selectedQuizQuestion,"quiz-id":t.selectedQuiz.id,onCallback:t.callbackQuestionForm,bot:o.bot},null,8,["question","quiz-id","onCallback","bot"]))]),e("div",p6,[b6,t.loadQuizQuestionTable?r("",!0):(l(),$(A4,{key:0,"quiz-id":t.selectedQuiz.id,onSelect:t.selectQuizQuestion,bot:o.bot},null,8,["quiz-id","onSelect","bot"]))])])):r("",!0),t.tab===2?(l(),i("div",f6,[e("div",g6,[t.loadQuizCommand?r("",!0):(l(),$(f8,{key:0,command:t.selectedQuizCommand,"quiz-id":t.selectedQuiz.id,onCallback:t.callbackCommandForm,bot:o.bot},null,8,["command","quiz-id","onCallback","bot"]))]),e("div",v6,[$6,t.loadQuizCommandTable?r("",!0):(l(),$(A8,{key:0,"quiz-id":t.selectedQuiz.id,onSelect:t.selectQuizCommand,bot:o.bot},null,8,["quiz-id","onSelect","bot"]))])])):r("",!0),t.tab===3?(l(),i("div",y6,[e("div",k6,[F6,p(e6,{"quiz-id":t.selectedQuiz.id,onSelect:t.selectQuizResult,bot:o.bot},null,8,["quiz-id","onSelect","bot"])])])):r("",!0),t.tab===4?(l(),i("div",w6,j6)):r("",!0)])):r("",!0)],64))}}),O6={class:"row"},V6={class:"col-12 mb-3 d-flex align-items-center"},P6={class:"dropdown mr-2"},A6={class:"btn btn-info dropdown-toggle",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},Q6={key:0},U6={key:1},I6={class:"dropdown-menu"},T6=["onClick"],B6={class:"dropdown-item",href:"#"},R6=e("p",{class:"mb-0"}," - тип пункта меню",-1),M6={class:"col-12 col-md-12 mb-3"},D6={class:"form-label",id:"service-title"},E6=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),L6=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),K6={class:"col-12 mb-3"},N6={class:"form-label",id:"service-description"},Y6=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),J6=e("div",null," Краткая информация о команде ",-1),H6=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),W6={key:0,class:"text-gray-400 ml-3",style:{"font-size":"10px"}},G6={class:"col-12 mb-3"},X6={class:"form-label",id:"service-input_message_content"},Z6=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),x6=e("div",null," Текст, который будет в сообщении после выбора данного пункта меню ",-1),e7=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),t7={key:0,class:"text-gray-400 ml-3",style:{"font-size":"10px"}},s7={class:"col-12 mb-3"},o7={class:"form-check"},l7=e("label",{class:"form-check-label",for:"need_keyboard"}," Нужна клавиатура к тексту ",-1),i7={key:0,class:"col-12 mb-3"},n7={class:"card"},a7={class:"card-body"},d7={class:"form-check"},r7=e("label",{class:"form-check-label",for:"need_show_inline_template_selector"}," Выбрать клавиатуру из шаблона ",-1),c7={class:"col-12 mb-3"},u7={class:"form-check"},m7=e("label",{class:"form-check-label",for:"need_custom_settings"}," Нужны дополнительные настройки ",-1),_7={class:"col-12"},h7={key:0,class:"card mb-2"},p7={class:"card-header d-flex justify-content-between align-items-center"},b7=e("h6",null,"Дополнительная конфигурация",-1),f7={class:"card-body"},g7={class:"row mb-2"},v7={class:"col-5"},$7={class:"form-label",id:"service-title"},y7=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),k7=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),F7=["onUpdate:modelValue"],w7={class:"col-5"},C7={class:"form-label",id:"service-title"},S7=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),j7=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),q7=["onUpdate:modelValue"],z7={class:"col-2 d-flex flex-column justify-content-end align-items-center"},O7=["onClick"],V7={key:1,class:"row mb-2"},P7=e("div",{class:"col-12"},[e("div",{class:"alert alert-info",role:"alert"}," Вы еще не добавили ни одной дополнительной настройки ")],-1),A7=[P7],Q7=e("div",{class:"row"},[e("div",{class:"col-12"},[e("button",{type:"submit",class:"btn btn-outline-primary w-100"},"Сохранить пункт меню ")])],-1),U7={props:["item"],data(){return{need_custom_settings:!1,need_keyboard:!1,need_show_inline_template_selector:!1,types:[{title:"Текст",value:0},{title:"Фото",value:1}],itemForm:{id:null,type:0,title:null,description:null,input_message_content:null,inline_keyboard_id:null,inline_keyboard:{menu:null},custom_settings:[]}}},computed:{preparedTypeTile(){return this.types.filter(o=>o.value==this.itemForm.type)[0]||null},uuid(){return ye()}},watch:{itemForm:{handler(o){this.need_reset=!0},deep:!0}},mounted(){this.item&&this.$nextTick(()=>{console.log("menu",this.item.inline_keyboard),this.itemForm={id:this.item.id||uuid,type:this.item.type||0,title:this.item.title||null,description:this.item.description||null,input_message_content:this.item.input_message_content||null,need_keyboard:this.item.title||!1,inline_keyboard_id:this.item.inline_keyboard_id||null,inline_keyboard:this.item.inline_keyboard?this.item.inline_keyboard:{menu:null},custom_settings:this.item.custom_settings||[]},this.itemForm.inline_keyboard&&(this.need_keyboard=!0),this.itemForm.custom_settings&&(this.need_custom_settings=!0)})},methods:{submitForm(){this.$emit("callback",this.itemForm),this.itemForm={id:null,type:0,title:null,description:null,input_message_content:null,inline_keyboard_id:null,inline_keyboard:{menu:null},custom_settings:[]},this.need_keyboard=!1,this.need_custom_settings=!1,this.need_show_inline_template_selector=!1},addCustomSettings(){this.itemForm.custom_settings.push({key:null,value:null})},removeCustomSetting(o){this.itemForm.custom_settings.splice(o,1)},selectInlineKeyboard(o){console.log("selectInlineKeyboard",o),this.itemForm.inline_keyboard={id:null,menu:o,slug:null},this.need_show_inline_template_selector=!1}}},I7=Object.assign(U7,{__name:"InlineQueryItemForm",setup(o){return(t,s)=>{const n=q("Popper");return l(),i("form",{onSubmit:s[7]||(s[7]=S((...a)=>t.submitForm&&t.submitForm(...a),["prevent"])),class:"mb-2"},[e("div",O6,[e("div",V6,[e("div",P6,[e("button",A6,[t.itemForm.type?(l(),i("span",Q6,u(t.preparedTypeTile.title),1)):(l(),i("span",U6,"Тип поля"))]),e("ul",I6,[(l(!0),i(v,null,y(t.types,a=>(l(),i("li",{onClick:d=>t.itemForm.type=a.value},[e("a",B6,u(a.title||"Не указан"),1)],8,T6))),256))])]),R6]),e("div",M6,[e("label",D6,[p(n,{content:"Заголовок"},{default:h(()=>[E6]),_:1}),m(" Заголовок "),L6]),c(e("input",{type:"text",class:"form-control",placeholder:"Заголовок","aria-label":"Заголовок","onUpdate:modelValue":s[0]||(s[0]=a=>t.itemForm.title=a),"aria-describedby":"title",required:""},null,512),[[b,t.itemForm.title]])]),e("div",K6,[e("label",N6,[p(n,null,{content:h(()=>[J6]),default:h(()=>[Y6]),_:1}),m(" Описание команду "),H6,t.itemForm.description?(l(),i("small",W6," Длина текста "+u(t.itemForm.description.length)+" / 255",1)):r("",!0)]),c(e("textarea",{type:"text",class:"form-control",placeholder:"Описание команды","aria-label":"Описание команды",maxlength:"255","onUpdate:modelValue":s[1]||(s[1]=a=>t.itemForm.description=a),"aria-describedby":"service-description",required:""},`
                    `,512),[[b,t.itemForm.description]])]),e("div",G6,[e("label",X6,[p(n,null,{content:h(()=>[x6]),default:h(()=>[Z6]),_:1}),m(" Текст после выбора "),e7,t.itemForm.input_message_content?(l(),i("small",t7," Длина текста "+u(t.itemForm.input_message_content.length)+" / 255",1)):r("",!0)]),c(e("textarea",{type:"text",class:"form-control",placeholder:"Текст поста","aria-label":"Текст поста",maxlength:"255","onUpdate:modelValue":s[2]||(s[2]=a=>t.itemForm.input_message_content=a),"aria-describedby":"service-input_message_content",required:""},`
                    `,512),[[b,t.itemForm.input_message_content]])]),e("div",s7,[e("div",o7,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[3]||(s[3]=a=>t.need_keyboard=a),type:"checkbox",id:"need_keyboard"},null,512),[[k,t.need_keyboard]]),l7])]),t.need_keyboard?(l(),i("div",i7,[e("div",n7,[e("div",a7,[e("div",d7,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[4]||(s[4]=a=>t.need_show_inline_template_selector=a),type:"checkbox",id:"need_show_inline_template_selector"},null,512),[[k,t.need_show_inline_template_selector]]),r7]),t.need_show_inline_template_selector?(l(),$(T,{key:0,class:"mb-2",type:"inline",onSelect:t.selectInlineKeyboard,"select-mode":!0},null,8,["onSelect"])):(l(),$(U,{key:1,type:"inline",onSave:t.selectInlineKeyboard,"edited-keyboard":t.itemForm.inline_keyboard.menu},null,8,["onSave","edited-keyboard"]))])])])):r("",!0),e("div",c7,[e("div",u7,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[5]||(s[5]=a=>t.need_custom_settings=a),type:"checkbox",id:"need_custom_settings"},null,512),[[k,t.need_custom_settings]]),m7])]),e("div",_7,[t.need_custom_settings?(l(),i("div",h7,[e("div",p7,[b7,e("button",{type:"button",onClick:s[6]||(s[6]=(...a)=>t.addCustomSettings&&t.addCustomSettings(...a)),class:"btn btn-outline-primary"},"Добавить настройку ")]),e("div",f7,[t.itemForm.custom_settings.length>0?(l(!0),i(v,{key:0},y(t.itemForm.custom_settings,(a,d)=>(l(),i("div",g7,[e("div",v7,[e("label",$7,[p(n,{content:"Ключ"},{default:h(()=>[y7]),_:1}),m(" Ключ "),k7]),c(e("input",{type:"text",class:"form-control",placeholder:"Ключ","aria-label":"Ключ",min:"0","onUpdate:modelValue":g=>t.itemForm.custom_settings[d].key=g,"aria-describedby":"price",required:""},null,8,F7),[[b,t.itemForm.custom_settings[d].key]])]),e("div",w7,[e("label",C7,[p(n,{content:"Значение"},{default:h(()=>[S7]),_:1}),m(" Значение "),j7]),c(e("input",{type:"text",class:"form-control",placeholder:"Значение","aria-label":"Значение",min:"0","onUpdate:modelValue":g=>t.itemForm.custom_settings[d].value=g,"aria-describedby":"price",required:""},null,8,q7),[[b,t.itemForm.custom_settings[d].value]])]),e("div",z7,[e("button",{onClick:g=>t.removeCustomSetting(d),class:"btn btn-outline-danger"},"Удалить ",8,O7)])]))),256)):(l(),i("div",V7,A7))])])):r("",!0)])]),Q7],32)}}}),T7={class:"row"},B7={class:"col-12 mb-3"},R7={class:"form-label",id:"service-title"},M7=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),D7=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),E7={class:"col-12 mb-3"},L7={class:"form-label",id:"service-description"},K7=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),N7=e("div",null," Краткая информация о команде ",-1),Y7=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),J7={key:0,class:"text-gray-400 ml-3",style:{"font-size":"10px"}},H7={class:"col-12 mb-2"},W7={key:0},G7={class:"table-responsive"},X7={class:"table"},Z7=e("thead",null,[e("tr",null,[e("th",{scope:"col"},"Название"),e("th",{scope:"col"},"Описание"),e("th",{scope:"col"},"Текст"),e("th",{scope:"col"},"Есть клавиатура"),e("th",{scope:"col"},"Есть доп настройки"),e("th",{scope:"col"},"Действие")])],-1),x7=["onClick"],e9=["onClick"],t9=["onClick"],s9={key:0,class:"fa-solid fa-check text-success"},o9={key:1,class:"fa-solid fa-xmark text-danger"},l9={key:0,class:"fa-solid fa-check text-success"},i9={key:1,class:"fa-solid fa-xmark text-danger"},n9={class:"dropdown"},a9=e("button",{class:"btn btn-link",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-solid fa-bars"})],-1),d9={class:"dropdown-menu"},r9=["onClick"],c9={class:"row"},u9={class:"col-12"},m9={type:"submit",class:"btn btn-outline-success w-100 p-3"},_9={key:0},h9={key:1},p9={class:"modal fade",id:"inline-query-item-editor",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},b9={class:"modal-dialog modal-lg"},f9={class:"modal-content"},g9={class:"modal-body"},v9={props:["bot","inlineQuery"],data(){return{load:!1,selectedInlineQueryItem:null,inlineQueryModal:null,inlineQueryForm:{id:null,command:null,description:null,items:[]}}},watch:{inlineQueryForm:{handler(o){this.need_reset=!0},deep:!0}},mounted(){this.inlineQueryModal=new bootstrap.Modal(document.getElementById("inline-query-item-editor"),{}),this.inlineQuery&&this.$nextTick(()=>{this.inlineQueryForm={id:this.inlineQuery.id||null,command:this.inlineQuery.command||null,description:this.inlineQuery.description||null,items:this.inlineQuery.items||[]}})},methods:{removeInlineQueryItem(o){const t=this.inlineQueryForm.items[o];this.inlineQueryForm.items.splice(o,1),this.$store.dispatch("removeInlineQueryItem",{queryItemId:t.id}).then(s=>{this.$notify("Команда успешно удалена")}).catch(s=>{this.$notify("Ошибка удаления команды")})},openModal(){this.load=!0,this.$nextTick(()=>{this.selectedInlineQueryItem=null,this.load=!1,this.inlineQueryModal.show()})},addInlineQueryItem(o){let t=this.inlineQueryForm.items.findIndex(s=>s.id===o.id);t===-1?this.inlineQueryForm.items.push(o):this.inlineQueryForm.items[t]=o},selectInlineQueryItem(o){this.load=!0,this.$nextTick(()=>{this.selectedInlineQueryItem=o,this.load=!1,this.inlineQueryModal.show()})},submitForm(){let o=new FormData;Object.keys(this.inlineQueryForm).forEach(t=>{const s=this.inlineQueryForm[t]||"";typeof s=="object"?o.append(t,JSON.stringify(s)):o.append(t,s)}),o.append("bot_id",this.bot.id),this.$store.dispatch("storeInlineQuery",{inlineQueryForm:o}).then(t=>{this.inlineQueryForm={id:null,command:null,description:null,items:[]},this.$emit("callback",t.data),this.$notify("Команда успешно создана")}).catch(t=>{this.$notify("Ошибка создания команды"),this.$emit("callback",response.data)})}}},$9=Object.assign(v9,{__name:"InlineQueryForm",setup(o){return(t,s)=>{const n=q("Popper");return l(),i(v,null,[e("form",{onSubmit:s[3]||(s[3]=S((...a)=>t.submitForm&&t.submitForm(...a),["prevent"]))},[e("div",T7,[e("div",B7,[e("label",R7,[p(n,{content:"Название оказываемой услуги"},{default:h(()=>[M7]),_:1}),m(" Название команды "),D7]),c(e("input",{type:"text",class:"form-control",placeholder:"Команда","aria-label":"Команда","onUpdate:modelValue":s[0]||(s[0]=a=>t.inlineQueryForm.command=a),maxlength:"255","aria-describedby":"service-title",required:""},null,512),[[b,t.inlineQueryForm.command]])]),e("div",E7,[e("label",L7,[p(n,null,{content:h(()=>[N7]),default:h(()=>[K7]),_:1}),m(" Описание команду "),Y7,t.inlineQueryForm.description?(l(),i("small",J7," Длина текста "+u(t.inlineQueryForm.description.length)+" / 255",1)):r("",!0)]),c(e("textarea",{type:"text",class:"form-control",placeholder:"Описание команды","aria-label":"Описание команды",maxlength:"255","onUpdate:modelValue":s[1]||(s[1]=a=>t.inlineQueryForm.description=a),"aria-describedby":"service-description",required:""},`
                    `,512),[[b,t.inlineQueryForm.description]])]),e("div",H7,[e("button",{type:"button",class:"btn btn-outline-primary",onClick:s[2]||(s[2]=(...a)=>t.openModal&&t.openModal(...a))}," Добавление пункта меню ")]),t.inlineQueryForm.items.length>0?(l(),i("div",W7,[e("div",G7,[e("table",X7,[Z7,e("tbody",null,[(l(!0),i(v,null,y(t.inlineQueryForm.items,(a,d)=>(l(),i("tr",null,[e("td",{onClick:g=>t.selectInlineQueryItem(a)},u(a.title||"-"),9,x7),e("td",{onClick:g=>t.selectInlineQueryItem(a)},u(a.description||"-"),9,e9),e("td",{onClick:g=>t.selectInlineQueryItem(a)},u(a.input_message_content||"-"),9,t9),e("td",null,[a.inline_keyboard?(l(),i("i",s9)):(l(),i("i",o9))]),e("td",null,[(a.custom_settings||[]).length>0?(l(),i("i",l9)):(l(),i("i",i9))]),e("td",null,[e("div",n9,[a9,e("ul",d9,[e("li",null,[e("a",{class:"dropdown-item",onClick:g=>t.removeInlineQueryItem(d),href:"#"},"Удалить",8,r9)])])])])]))),256))])])])])):r("",!0)]),e("div",c9,[e("div",u9,[e("button",m9,[t.inlineQueryForm.id===null?(l(),i("span",_9,"Создать встроенное меню")):(l(),i("span",h9,"Обновить встроенное меню"))])])])],32),e("div",p9,[e("div",b9,[e("div",f9,[e("div",g9,[t.load?r("",!0):(l(),$(I7,{key:0,item:t.selectedInlineQueryItem,onCallback:t.addInlineQueryItem},null,8,["item","onCallback"]))])])])])],64)}}}),y9={class:"row"},k9={class:"col-12"},F9={key:0,class:"table"},w9=e("th",{scope:"col",class:"cursor-pointer"},"Кол-во пунктов меню",-1),C9=e("th",{scope:"col"},"Действие",-1),S9={scope:"row"},j9=["onClick"],q9={key:0,class:"dropdown"},z9=e("button",{class:"btn btn-outline-secondary",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-solid fa-ellipsis"})],-1),O9={class:"dropdown-menu"},V9={key:0},P9=["onClick"],A9={key:1},Q9={class:"col-12"},U9={props:["bot"],data(){return{direction:"desc",order:"updated_at",show:!0,loading:!0,queries:[],search:null,paginate_object:null}},computed:{...C(["getInlineQueries","getInlineQueriesPaginateObject"])},mounted(){this.loadInlineQueries()},methods:{nextInlineQuery(o){this.loadInlineQueries(o)},selectInlineQuery(o){this.$emit("select",o),this.$notify("Встроенное меню успешно выбрано")},removeInlineQuery(o){this.loading=!0,this.$store.dispatch("removeInlineQuery",{queryId:o}).then(t=>{this.loading=!1,this.loadInlineQueries(0),this.$notify("Встроенное меню успешно удалено")}).catch(()=>{this.loading=!1,this.$notify("Ошибка удаления встроенного меню")})},loadAndOrder(o){this.order=o,this.direction=this.direction==="desc"?"asc":"desc",this.loadInlineQueries(0)},loadInlineQueries(o=0){this.loading=!0,this.$store.dispatch("loadInlineQueries",{dataObject:{bot_id:this.bot.id||null,search:this.search,order:this.order,direction:this.direction},page:o,size:100}).then(t=>{this.loading=!1,this.queries=this.getInlineQueries,this.paginate_object=this.getInlineQueriesPaginateObject}).catch(()=>{this.loading=!1})}}},I9=Object.assign(U9,{__name:"InlineQueryTable",setup(o){return(t,s)=>(l(),i("div",y9,[e("div",k9,[t.queries.length>0?(l(),i("table",F9,[e("thead",null,[e("tr",null,[e("th",{scope:"col",class:"cursor-pointer",onClick:s[0]||(s[0]=n=>t.loadAndOrder("id"))},"#"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[1]||(s[1]=n=>t.loadAndOrder("command"))},"Команда"),w9,e("th",{scope:"col",class:"cursor-pointer",onClick:s[2]||(s[2]=n=>t.loadAndOrder("description"))},"Описание"),C9])]),e("tbody",null,[(l(!0),i(v,null,y(t.queries,(n,a)=>(l(),i("tr",{class:_({"border-info":n.deleted_at==null,"border-danger":n.deleted_at!=null})},[e("th",S9,u(n.id),1),e("td",{onClick:d=>t.selectInlineQuery(n)},u(n.command||"Не указано"),9,j9),e("td",null,u(n.items.length),1),e("td",null,u(n.description||"Не указано"),1),e("td",null,[n.id?(l(),i("div",q9,[z9,e("ul",O9,[n.deleted_at==null?(l(),i("li",V9,[e("a",{class:"dropdown-item",onClick:d=>t.removeInlineQuery(n.id),href:"javascript:void(0)"},"Удалить",8,P9)])):r("",!0)])])):r("",!0)])],2))),256))])])):(l(),i("p",A9,"На текущий момент нет ни одной созданной команды"))]),e("div",Q9,[t.paginate_object?(l(),$(j,{key:0,onPagination_page:t.nextInlineQuery,pagination:t.paginate_object},null,8,["onPagination_page","pagination"])):r("",!0)])]))}}),T9={class:"my-2"},B9={key:0,class:"row mb-2"},R9={class:"col-12"},M9={key:3,class:"spinner-border",role:"status"},D9=e("span",{class:"visually-hidden"},"Loading...",-1),E9=[D9],L9={props:["bot"],data(){return{load:!1,selectedInlineQuery:null}},mounted(){},methods:{selectInlineQuery(o){this.load=!0,this.$nextTick(()=>{this.selectedInlineQuery=o,this.load=!1})},reloadTable(){this.load=!0,this.$nextTick(()=>{this.load=!1})}}},K9=Object.assign(L9,{__name:"InlineQuery",setup(o){return(t,s)=>(l(),i("div",T9,[t.selectedInlineQuery!=null?(l(),i("div",B9,[e("div",R9,[e("button",{type:"button",onClick:s[0]||(s[0]=n=>t.selectInlineQuery(null)),class:"btn btn-primary"}," Добавить новое встроенное меню")])])):r("",!0),t.load?r("",!0):(l(),$($9,{key:1,bot:o.bot,onCallback:t.reloadTable,"inline-query":t.selectedInlineQuery},null,8,["bot","onCallback","inline-query"])),t.load?r("",!0):(l(),$(I9,{key:2,bot:o.bot,onSelect:t.selectInlineQuery},null,8,["bot","onSelect"])),t.load?(l(),i("div",M9,E9)):r("",!0)]))}}),N9={class:"row"},Y9={class:"col-12 mb-3"},J9={class:"form-label",id:"quiz-title"},H9=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),W9=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),G9={class:"col-12 mb-3"},X9={class:"form-label",id:"quiz-description"},Z9=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),x9=e("div",null," Краткая информация о назначении промокода ",-1),eS=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),tS={key:0,class:"text-gray-400 ml-3",style:{"font-size":"10px"}},sS={class:"col-12 mb-3"},oS={class:"form-check"},lS=e("label",{class:"form-check-label",for:"is_active"}," Доступен для активации ",-1),iS={class:"col-12 mb-3"},nS={class:"form-label",id:"promoCodeForm-max_activation_count"},aS=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),dS=e("div",null," Максимальное число активация кода ",-1),rS=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),cS={class:"col-12 mb-3"},uS={class:"form-check"},mS=e("label",{class:"form-check-label",for:"promoCodeForm-cashback_amount"}," Нужно начислить CashBack по промокоду ",-1),_S={key:0,class:"col-12 mb-3"},hS={class:"form-label",id:"quiz-time_limit"},pS=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),bS=e("div",null," Сколько % нужно ответить чтоб пройти ",-1),fS=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),gS={key:1,class:"col-12 mb-3"},vS={class:"form-check"},$S=e("label",{class:"form-check-label",for:"promoCodeForm-need_slots"}," Нужны слоты для активации ",-1),yS={key:2,class:"col-12 mb-3"},kS={class:"form-label",id:"promoCodeForm-slot_amount"},FS=e("i",{class:"fa-regular fa-circle-question mr-1"},null,-1),wS=e("div",null," Укажите количество слотов, которые получит пользователь при активации (внимание, доступно только для администраторов) ",-1),CS=e("span",{class:"badge rounded-pill text-bg-danger m-0"},"Нужно",-1),SS={key:0,class:"col-12 mb-3"},jS={class:"form-check"},qS=e("label",{class:"form-check-label",for:"promoCodeForm-need_attach_scripts"}," Нужно добавить скрипты ",-1),zS={key:1,class:"col-12 mb-3"},OS=["onClick"],VS={class:"row"},PS={class:"col-12"},AS={type:"submit",class:"btn btn-outline-success w-100 p-3"},QS={key:0},US={key:1},IS={props:["code","bot"],data(){return{step:0,load:!1,need_reset:!1,need_cashback:!1,need_slots:!1,need_attach_scripts:!1,promoCodeForm:{id:null,code:null,description:null,slot_amount:0,cashback_amount:0,max_activation_count:1,is_active:!1,scripts:[]}}},computed:{getSelf(){return window.profile}},watch:{promoCodeForm:{handler(o){this.need_reset=!0},deep:!0}},mounted(){this.code&&this.$nextTick(()=>{this.promoCodeForm={id:this.code.id||null,description:this.code.description||null,code:this.code.code||null,slot_amount:this.code.slot_amount||0,cashback_amount:this.code.cashback_amount||0,max_activation_count:this.code.max_activation_count||1,is_active:this.code.is_active||!1,scripts:this.code.scripts||[]},this.promoCodeForm.slot_amount>0&&(this.need_slots=!0),this.promoCodeForm.cashback_amount>0&&(this.need_slots=!0),this.promoCodeForm.scripts.length>0&&(this.need_attach_scripts=!0)})},methods:{removeSlug(o){this.promoCodeForm.scripts.splice(o,1)},selectSlugsCallback(o){this.promoCodeForm.scripts.findIndex(s=>s.id===o.id)===-1&&this.promoCodeForm.scripts.push(o)},submitForm(){let o=new FormData;Object.keys(this.promoCodeForm).forEach(t=>{const s=this.promoCodeForm[t]||"";typeof s=="object"?o.append(t,JSON.stringify(s)):o.append(t,s)}),o.append("bot_id",this.bot.id),this.$store.dispatch("storePromoCodes",{promoCodeForm:o}).then(t=>{this.promoCodeForm={id:null,code:null,description:null,slot_amount:0,cashback_amount:0,max_activation_count:1,scripts:[],is_active:!1},this.$emit("callback",t.data),this.$notify("Промокод успешно создан")}).catch(t=>{this.$notify("Ошибка создания промокода")})}}},x=Object.assign(IS,{__name:"PromoCodesForm",setup(o){return(t,s)=>{const n=q("Popper");return l(),i("form",{onSubmit:s[9]||(s[9]=S((...a)=>t.submitForm&&t.submitForm(...a),["prevent"])),class:"py-3"},[e("div",N9,[e("div",Y9,[e("label",J9,[p(n,{content:"Название вашего квиза"},{default:h(()=>[H9]),_:1}),m(" Промокод (вписать или сгенерировать) "),W9]),c(e("input",{type:"text",class:"form-control",placeholder:"Название","aria-label":"Название","onUpdate:modelValue":s[0]||(s[0]=a=>t.promoCodeForm.code=a),maxlength:"255","aria-describedby":"quiz-title",required:""},null,512),[[b,t.promoCodeForm.code]])]),e("div",G9,[e("label",X9,[p(n,null,{content:h(()=>[x9]),default:h(()=>[Z9]),_:1}),m(" Назначение промокода "),eS,t.promoCodeForm.description?(l(),i("small",tS," Длина текста "+u(t.promoCodeForm.description.length)+"/255",1)):r("",!0)]),c(e("textarea",{class:"form-control",placeholder:"Описание промокода","aria-label":"Описание промокода",maxlength:"255","onUpdate:modelValue":s[1]||(s[1]=a=>t.promoCodeForm.description=a),"aria-describedby":"quiz-description",required:""},`
                    `,512),[[b,t.promoCodeForm.description]])]),e("div",sS,[e("div",oS,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[2]||(s[2]=a=>t.promoCodeForm.is_active=a),type:"checkbox",id:"is_active"},null,512),[[k,t.promoCodeForm.is_active]]),lS])]),e("div",iS,[e("label",nS,[p(n,null,{content:h(()=>[dS]),default:h(()=>[aS]),_:1}),m(" Количество активация кода "),rS]),c(e("input",{type:"number",class:"form-control",placeholder:"Число попыток","aria-label":"Число попыток",step:"1",min:"1","onUpdate:modelValue":s[3]||(s[3]=a=>t.promoCodeForm.max_activation_count=a),"aria-describedby":"promoCodeForm-max_activation_count",required:""},null,512),[[b,t.promoCodeForm.max_activation_count]])]),e("div",cS,[e("div",uS,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[4]||(s[4]=a=>t.need_cashback=a),type:"checkbox",id:"promoCodeForm-cashback_amount"},null,512),[[k,t.need_cashback]]),mS])]),t.need_cashback?(l(),i("div",_S,[e("label",hS,[p(n,null,{content:h(()=>[bS]),default:h(()=>[pS]),_:1}),m(" Сколько CashBack начислить по промокоду? "),fS]),c(e("input",{type:"number",class:"form-control",placeholder:"Процент для победы","aria-label":"Процент для победы",step:"1",min:"0","onUpdate:modelValue":s[5]||(s[5]=a=>t.promoCodeForm.cashback_amount=a),"aria-describedby":"promoCodeForm-cashback_amount",required:""},null,512),[[b,t.promoCodeForm.cashback_amount]])])):r("",!0),t.getSelf.is_admin?(l(),i("div",gS,[e("div",vS,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[6]||(s[6]=a=>t.need_slots=a),type:"checkbox",id:"promoCodeForm-need_slots"},null,512),[[k,t.need_slots]]),$S])])):r("",!0),t.need_slots?(l(),i("div",yS,[e("label",kS,[p(n,null,{content:h(()=>[wS]),default:h(()=>[FS]),_:1}),m(" Сколько нужно добавить слотов? "),CS]),c(e("input",{type:"number",class:"form-control",placeholder:"Количество слотов","aria-label":"Количество слотов",step:"1",min:"0","onUpdate:modelValue":s[7]||(s[7]=a=>t.promoCodeForm.slot_amount=a),"aria-describedby":"promoCodeForm-slot_amount",required:""},null,512),[[b,t.promoCodeForm.slot_amount]])])):r("",!0)]),t.getSelf.is_admin?(l(),i("div",SS,[e("div",jS,[c(e("input",{class:"form-check-input","onUpdate:modelValue":s[8]||(s[8]=a=>t.need_attach_scripts=a),type:"checkbox",id:"promoCodeForm-need_attach_scripts"},null,512),[[k,t.need_attach_scripts]]),qS])])):r("",!0),t.need_attach_scripts?(l(),i("div",zS,[e("p",null,[(l(!0),i(v,null,y(t.promoCodeForm.scripts,(a,d)=>(l(),i("span",{class:"badge bg-primary mr-2 mb-2 cursor-pointer",onClick:g=>t.removeSlug(d)},u(a.command||"-"),9,OS))),256))]),o.bot?(l(),$(J,{key:0,"can-add":!0,bot:o.bot,"hide-add-modal":!0,onSelect:t.selectSlugsCallback},null,8,["bot","onSelect"])):r("",!0)])):r("",!0),e("div",VS,[e("div",PS,[e("button",AS,[t.promoCodeForm.id==null?(l(),i("span",QS,"Создать промокод")):(l(),i("span",US,"Обновить промокод"))])])])],32)}}}),TS={class:"row py-2"},BS={class:"col-12"},RS={class:"input-group mb-3"},MS={class:"col-12"},DS={key:0,class:"table"},ES=e("th",{scope:"col",class:"cursor-pointer"},"Число активаций",-1),LS=e("th",{scope:"col"},"Действие",-1),KS={scope:"row"},NS=["onClick"],YS={key:0},JS={key:0,class:"fa-solid fa-chevron-down text-success"},HS={key:1,class:"fa-solid fa-xmark text-danger"},WS={key:0,class:"dropdown"},GS=e("button",{class:"btn btn-outline-secondary",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-solid fa-ellipsis"})],-1),XS={class:"dropdown-menu"},ZS={key:0},xS=["onClick"],ej={key:1},tj=e("div",{class:"alert alert-warning alert-dismissible fade show",role:"alert"},[e("strong",null,"Внимание!"),m(" Вы еще не добавили ни одного промокода! "),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"alert","aria-label":"Close"})],-1),sj={class:"position-relative p-5 text-center text-muted bg-body border border-dashed rounded-2"},oj={class:"d-flex justify-content-center mb-3"},lj={alt:"",width:"100",height:"100"},ij=e("h1",{class:"text-body-emphasis"},"Создание промокода",-1),nj=e("p",{class:"col-lg-8 mx-auto fs-5 text-muted"}," Промокод - это инструмент мотивации пользователей пользоваться вашим сервисом. Он позволяет клиентам получать некоторые бонусы за активацию кода, а вы в свою очередь будете видеть статистику активация прмокода. ",-1),aj={class:"d-inline-flex gap-2 mb-5"},dj=e("a",{href:"#",target:"_blank",class:"d-inline-flex align-items-center btn btn-outline-secondary btn-lg px-4 rounded-pill"}," Подробнее ",-1),rj={key:0,class:"col-12"},cj={props:["bot"],data(){return{direction:"desc",order:"updated_at",show:!0,loading:!0,codes:[],search:null,paginate_object:null}},computed:{...C(["getPromoCodes","getPromoCodesPaginateObject"]),getSelf(){return window.profile}},mounted(){this.loadPromoCodes()},methods:{removeQuiz(o){this.loading=!0,this.$store.dispatch("removePromoCodes",{promoCodeId:o}).then(t=>{this.loading=!1,this.loadPromoCodes(0),this.$notify("Промокод успешно удален")}).catch(()=>{this.loading=!1,this.$notify("Ошибка удаления промокода")})},createPromoCode(){this.$emit("create")},nextPromoCodes(o){this.loadPromoCodes(o)},selectEvent(o){this.$emit("select",o)},loadAndOrder(o){this.order=o,this.direction=this.direction==="desc"?"asc":"desc",this.loadPromoCodes(0)},loadPromoCodes(o=0){this.loading=!0,this.$store.dispatch("loadPromoCodes",{dataObject:{bot_id:this.bot.id||null,search:this.search,order:this.order,direction:this.direction},page:o,size:20}).then(t=>{this.loading=!1,this.codes=this.getPromoCodes,this.paginate_object=this.getPromoCodesPaginateObject}).catch(()=>{this.loading=!1})}}},uj=Object.assign(cj,{__name:"PromoCodesTable",setup(o){return(t,s)=>{const n=Q("lazy");return l(),i("div",TS,[e("div",BS,[e("div",RS,[c(e("input",{type:"search",class:"form-control",placeholder:"Поиск кода","aria-label":"Поиск кода","onUpdate:modelValue":s[0]||(s[0]=a=>t.search=a),"aria-describedby":"promocode-search-and-filter"},null,512),[[b,t.search]]),e("button",{class:"btn btn-outline-secondary",onClick:s[1]||(s[1]=a=>t.loadPromoCodes(0)),type:"button",id:"promocode-search-and-filter"},"Найти ")])]),e("div",MS,[t.codes.length>0?(l(),i("table",DS,[e("thead",null,[e("tr",null,[e("th",{scope:"col",class:"cursor-pointer",onClick:s[2]||(s[2]=a=>t.loadAndOrder("id"))},"#"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[3]||(s[3]=a=>t.loadAndOrder("code"))},"Код"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[4]||(s[4]=a=>t.loadAndOrder("description"))},"Описание"),t.getSelf.is_admin?(l(),i("th",{key:0,scope:"col",class:"cursor-pointer",onClick:s[5]||(s[5]=a=>t.loadAndOrder("slot_amount"))},"Число слотов ")):r("",!0),e("th",{scope:"col",class:"cursor-pointer",onClick:s[6]||(s[6]=a=>t.loadAndOrder("cashback_amount"))},"Величина CashBack-а, руб "),e("th",{scope:"col",class:"cursor-pointer",onClick:s[7]||(s[7]=a=>t.loadAndOrder("max_activation_count"))},"Максимальное число активаций "),ES,e("th",{scope:"col",class:"cursor-pointer",onClick:s[8]||(s[8]=a=>t.loadAndOrder("is_active"))},"Активный"),LS])]),e("tbody",null,[(l(!0),i(v,null,y(t.codes,(a,d)=>(l(),i("tr",{class:_({"border-info":a.deleted_at==null,"border-danger":a.deleted_at!=null})},[e("th",KS,u(a.id),1),e("td",{onClick:g=>t.selectEvent(a)},u(a.code||"Не указано"),9,NS),e("td",null,u(a.description||"Не указано"),1),t.getSelf.is_admin?(l(),i("td",YS,u(a.slot_amount),1)):r("",!0),e("td",null,u(a.cashback_amount),1),e("td",null,u(a.max_activation_count),1),e("td",null,u(a.current_activation_count||0),1),e("td",null,[a.is_active?(l(),i("i",JS)):(l(),i("i",HS))]),e("td",null,[a.id?(l(),i("div",WS,[GS,e("ul",XS,[a.deleted_at==null?(l(),i("li",ZS,[e("a",{class:"dropdown-item",onClick:g=>t.removeQuiz(a.id),href:"javascript:void(0)"},"Удалить",8,xS)])):r("",!0)])])):r("",!0)])],2))),256))])])):(l(),i("div",ej,[tj,e("div",sj,[e("div",oj,[c(e("img",lj,null,512),[[n,"../images/icon.png"]])]),ij,nj,e("div",aj,[e("button",{onClick:s[9]||(s[9]=(...a)=>t.createPromoCode&&t.createPromoCode(...a)),class:"d-inline-flex align-items-center btn btn-lg px-4 rounded-pill btn-primary",type:"button"}," Добавить "),dj])])]))]),t.codes.length>0?(l(),i("div",rj,[t.paginate_object?(l(),$(j,{key:0,onPagination_page:t.nextPromoCodes,pagination:t.paginate_object},null,8,["onPagination_page","pagination"])):r("",!0)])):r("",!0)])}}}),mj={key:0,class:"py-2"},_j={class:"row"},hj={class:"col-12"},pj={key:1,class:"py-2"},bj={class:"row"},fj={class:"col-12"},gj={key:2,class:"py-2"},vj={class:"row"},$j={class:"col-12"},yj={class:"nav nav-tabs justify-content-center"},kj={key:0,class:"row py-3"},Fj={class:"col-12"},wj={key:1,class:"row py-3"},Cj=e("div",{class:"col-12 py-3"},[e("h4",null,"Статистика")],-1),Sj=[Cj],jj={props:["bot"],data(){return{part:0,tab:0,selectedPromoCode:null,loadForm:!1,loadTable:!1}},methods:{callbackForm(){this.loadTable=!0,this.selectedPromoCode=null,this.part=0,this.$nextTick(()=>{this.loadTable=!1})},createPromoCode(){this.part=2},selectPromoCode(o){this.loadForm=!0,this.$nextTick(()=>{this.loadForm=!1,this.selectedPromoCode=o,this.part=1,this.tab=0})}}},qj=Object.assign(jj,{__name:"PromoCodes",setup(o){return(t,s)=>(l(),i(v,null,[t.part===0?(l(),i("div",mj,[e("div",_j,[e("div",hj,[e("button",{type:"button",onClick:s[0]||(s[0]=(...n)=>t.createPromoCode&&t.createPromoCode(...n)),class:"btn btn-primary"}," Создать новый промокод ")])]),t.loadTable?r("",!0):(l(),$(uj,{key:0,onCreate:t.createPromoCode,onSelect:t.selectPromoCode,bot:o.bot},null,8,["onCreate","onSelect","bot"]))])):r("",!0),t.part===2?(l(),i("div",pj,[e("div",bj,[e("div",fj,[e("button",{type:"button",onClick:s[1]||(s[1]=n=>t.part=0),class:"btn btn-outline-primary"}," Назад ")])]),t.loadForm?r("",!0):(l(),$(x,{key:0,onCallback:t.callbackForm,bot:o.bot},null,8,["onCallback","bot"]))])):r("",!0),t.part===1?(l(),i("div",gj,[e("div",vj,[e("div",$j,[e("button",{type:"button",onClick:s[2]||(s[2]=n=>t.part=0),class:"btn btn-outline-primary"}," Назад ")])]),e("ul",yj,[e("li",{class:"nav-item",onClick:s[3]||(s[3]=n=>t.tab=0)},[e("a",{class:_(["nav-link",{active:t.tab===0}]),"aria-current":"page",href:"javascript:void(0)"},"Информация о Промокоде",2)]),e("li",{class:"nav-item",onClick:s[4]||(s[4]=n=>t.tab=1)},[e("a",{class:_(["nav-link",{active:t.tab===1}]),href:"javascript:void(0)"},"Статистика использования",2)])]),t.tab===0?(l(),i("div",kj,[e("div",Fj,[t.loadForm?r("",!0):(l(),$(x,{key:0,onCallback:t.callbackForm,code:t.selectedPromoCode,bot:o.bot},null,8,["onCallback","code","bot"]))])])):r("",!0),t.tab===1?(l(),i("div",wj,Sj)):r("",!0)])):r("",!0)],64))}});const zj={class:"d-flex custom-dropdown justify-content-between align-items-center"},Oj={class:"btn-group"},Vj=e("i",{class:"fa-solid fa-info mr-2"},null,-1),Pj=e("i",{class:"fa-solid fa-file mr-2"},null,-1),Aj={key:0,class:"dropdown"},Qj=e("button",{type:"button",class:"btn btn-primary dropdown-toggle text-primary p-2",href:"#",role:"button",id:"dropdownMenuLink","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-solid fa-screwdriver-wrench mr-2"})],-1),Uj={class:"dropdown-menu","aria-labelledby":"dropdownMenuLink"},Ij=e("i",{class:"fa-regular fa-newspaper mr-2"},null,-1),Tj=e("i",{class:"fa-regular fa-calendar-days mr-2"},null,-1),Bj=e("i",{class:"fa-solid fa-q mr-2"},null,-1),Rj=e("i",{class:"fa-solid fa-q mr-2"},null,-1),Mj=e("i",{class:"fa-solid fa-clipboard-list mr-2"},null,-1),Dj=e("i",{class:"fa-solid fa-code mr-2"},null,-1),Ej=e("i",{class:"fa-solid fa-keyboard mr-2"},null,-1),Lj=e("i",{class:"fa-solid fa-scroll mr-2"},null,-1),Kj=e("i",{class:"fa-solid fa-comment-dots mr-2"},null,-1),Nj=e("i",{class:"fa-solid fa-users mr-2"},null,-1),Yj=e("i",{class:"fa-solid fa-list-check mr-2"},null,-1),Jj=e("i",{class:"fa-solid fa-list-check mr-2"},null,-1),Hj=e("i",{class:"fa-brands fa-shopify mr-2"},null,-1),Wj=e("i",{class:"fa-brands fa-shopify mr-2"},null,-1),Gj={key:0,class:"pb-5 mb-5"},Xj={key:1,class:"pb-5 mb-5"},Zj={key:2,class:"pb-5 mb-5"},xj={key:3,class:"pb-5 mb-5"},eq={key:4,class:"pb-5 mb-5"},tq={key:5,class:"pb-5 mb-5"},sq={key:6,class:"pb-5 mb-5"},oq={key:7,class:"pb-5 pt-2 mb-5"},lq={key:8,class:"pb-5 mb-5"},iq={key:9,class:"pb-5 mb-5 pt-2"},nq={key:10,class:"pb-5 mb-5"},aq={key:11,class:"pb-5 mb-5 pt-2"},dq={key:12,class:"pb-5 mb-5 pt-2"},rq={key:13,class:"pb-5 mb-5 pt-2"},cq={key:14,class:"row pb-5 mb-5"},uq={key:0,class:"col-12 col-md-12"},mq={key:15,class:"pb-5 mb-5"},_q={props:["bot"],data(){return{page:null,step:0,load:!1,loadPage:!1}},mounted(){this.setStep(localStorage.getItem("cashman_set_botform_step_index")||0)},methods:{botCallbackUpdate(o){this.$store.dispatch("updateCurrentBot",{bot:o}).then(()=>{})},hasRole(o){return window.hasRole(o)||!1},setStep(o){this.step=parseInt(o),localStorage.setItem("cashman_set_botform_step_index",o)},pageListCallback(o){this.loadPage=!0,this.page=o,this.$nextTick(()=>{this.loadPage=!1})},pageCallback(o){this.page=o,this.loadPageList=!0,this.$nextTick(()=>{this.loadPageList=!1})},loadCurrentCompany(o=null){this.$store.dispatch("updateCurrentCompany",{company:o}).then(()=>{this.company=this.getCurrentCompany})},companyListCallback(o){this.load=!0,this.loadCurrentCompany(o),this.$nextTick(()=>{this.load=!1})}}},dO=Object.assign(_q,{__name:"BotSection",setup(o){return(t,s)=>(l(),i(v,null,[e("div",zj,[e("div",Oj,[e("button",{type:"button",class:_(["btn btn-primary text-primary",{"bg-primary text-white":t.step==0}]),onClick:s[0]||(s[0]=n=>t.setStep(0))},[Vj,m("Информация о боте ")],2),e("button",{type:"button",class:_(["btn btn-primary text-primary",{"bg-primary text-white":t.step==4}]),onClick:s[1]||(s[1]=n=>t.setStep(4))},[Pj,m("Страницы (кнопки бота) ")],2)]),t.hasRole("admin")?(l(),i("div",Aj,[Qj,e("ul",Uj,[e("li",null,[e("a",{class:"dropdown-item",href:"#bot-news",onClick:s[2]||(s[2]=n=>t.setStep(9))},[Ij,m(" Рассылки")])]),e("li",null,[e("a",{class:"dropdown-item",href:"#bot-appointments",onClick:s[3]||(s[3]=n=>t.setStep(13))},[Tj,m("Запись на событие (прием)")])]),e("li",null,[e("a",{class:"dropdown-item",href:"#bot-quizzes",onClick:s[4]||(s[4]=n=>t.setStep(14))},[Bj,m("Квизы")])]),e("li",null,[e("a",{class:"dropdown-item",href:"#bot-promo-codes",onClick:s[5]||(s[5]=n=>t.setStep(16))},[Rj,m("Промокоды")])]),e("li",null,[e("a",{class:"dropdown-item",href:"#bot-inline-queries",onClick:s[6]||(s[6]=n=>t.setStep(15))},[Mj,m("Встраиваемые запросы")])]),e("li",null,[e("a",{class:"dropdown-item",href:"#bot-custom-fields",onClick:s[7]||(s[7]=n=>t.setStep(10))},[Dj,m("Настраиваемые поля")])]),e("li",null,[e("a",{class:"dropdown-item",href:"#bot-menu-template",onClick:s[8]||(s[8]=n=>t.setStep(1))},[Ej,m("Все клавиатуры в боте")])]),e("li",null,[e("a",{class:"dropdown-item",href:"#bot-slugs",onClick:s[9]||(s[9]=n=>t.setStep(2))},[Lj,m("Все скрипты в боте")])]),e("li",null,[e("a",{class:"dropdown-item",href:"#bot-dialogs",onClick:s[10]||(s[10]=n=>t.setStep(6))},[Kj,m("Все диалоги в боте")])]),e("li",null,[e("a",{class:"dropdown-item",href:"#bot-users",onClick:s[11]||(s[11]=n=>t.setStep(3))},[Nj,m("Все пользователи в боте")])]),e("li",null,[e("a",{class:"dropdown-item",href:"#bot-amo",onClick:s[12]||(s[12]=n=>t.setStep(7))},[Yj,m(" AMO CRM")])]),e("li",null,[e("a",{class:"dropdown-item",href:"#bot-y-clients",onClick:s[13]||(s[13]=n=>t.setStep(12))},[Jj,m(" YClients")])]),e("li",null,[e("a",{class:"dropdown-item",href:"#bot-shop",onClick:s[14]||(s[14]=n=>t.setStep(8))},[Hj,m(" Магазин")])]),e("li",null,[e("a",{class:"dropdown-item",href:"#bot-media",onClick:s[15]||(s[15]=n=>t.setStep(11))},[Wj,m(" Медиа файлы бота")])])])])):r("",!0)]),t.step===14?(l(),i("div",Gj,[t.load?r("",!0):(l(),$(z6,{key:0,bot:o.bot},null,8,["bot"]))])):r("",!0),t.step===16?(l(),i("div",Xj,[t.load?r("",!0):(l(),$(qj,{key:0,bot:o.bot},null,8,["bot"]))])):r("",!0),t.step===13?(l(),i("div",Zj,[t.load?r("",!0):(l(),$(h3,{key:0,bot:o.bot},null,8,["bot"]))])):r("",!0),t.step===0?(l(),i("div",xj,[t.load?r("",!0):(l(),$($e,{key:0,onCallback:t.botCallbackUpdate,bot:o.bot},null,8,["onCallback","bot"]))])):r("",!0),t.step===15?(l(),i("div",eq,[t.load?r("",!0):(l(),$(K9,{key:0,bot:o.bot},null,8,["bot"]))])):r("",!0),t.step===7?(l(),i("div",tq,[t.load?r("",!0):(l(),$(Gf,{key:0,data:o.bot.amo},null,8,["data"]))])):r("",!0),t.step===12?(l(),i("div",sq,[t.load?r("",!0):(l(),$(ug,{key:0,data:o.bot.y_clients},null,8,["data"]))])):r("",!0),t.step===11?(l(),i("div",oq,[t.load?r("",!0):(l(),$(Ev,{key:0}))])):r("",!0),t.step===8?(l(),i("div",lq,[t.load?r("",!0):(l(),$(Cf,{key:0}))])):r("",!0),t.step===10?(l(),i("div",iq,[t.load?r("",!0):(l(),$(cv,{key:0}))])):r("",!0),t.step===1?(l(),i("div",nq,[t.load?r("",!0):(l(),$(T,{key:0,"select-mode":!1}))])):r("",!0),t.step===6?(l(),i("div",aq,[t.load?r("",!0):(l(),$(le,{key:0}))])):r("",!0),t.step===2?(l(),i("div",dq,[t.load?r("",!0):(l(),$(Wo,{key:0}))])):r("",!0),t.step===3?(l(),i("div",rq,[t.load?r("",!0):(l(),$(R,{key:0}))])):r("",!0),t.step===4?(l(),i("div",cq,[t.load?r("",!0):(l(),i("div",uq,[t.loadPage?r("",!0):(l(),$(Sp,{key:0,page:t.page,onCallback:t.pageCallback},null,8,["page","onCallback"]))]))])):r("",!0),t.step===9?(l(),i("div",mq,[p(kg,{bot:o.bot},null,8,["bot"])])):r("",!0)],64))}}),hq={key:0},pq={key:0,class:"row"},bq={class:"col-md-12"},fq=e("h4",null,"Боты в работе",-1),gq={class:"mb-0"},vq={class:"table mb-5"},$q=e("thead",null,[e("tr",null,[e("th",{scope:"col"},"#"),e("th",{scope:"col"},"Домен"),e("th",{scope:"col"},"Название"),e("th",{scope:"col"},"Шаблон"),e("th",{scope:"col"},"Дата изменения"),e("th",{scope:"col"},"Действие")])],-1),yq={scope:"row"},kq=["onClick"],Fq=["onClick"],wq={key:0,class:"badge bg-primary"},Cq={key:1},Sq={class:"d-flex"},jq=["onClick"],qq=e("i",{class:"fa-regular fa-star"},null,-1),zq=[qq],Oq=["onClick"],Vq=e("i",{class:"fa-solid fa-chevron-down"},null,-1),Pq=[Vq],Aq=["onClick"],Qq=e("i",{class:"fa-solid fa-chevron-up"},null,-1),Uq=[Qq],Iq=e("hr",null,null,-1),Tq={class:"row"},Bq={class:"col-md-12 d-flex flex-column"},Rq={class:"d-flex"},Mq={class:"dropdown mr-2"},Dq=e("button",{class:"btn btn-outline-primary dropdown-toggle",type:"button",id:"dropdownMenuButton1","data-bs-toggle":"dropdown","aria-expanded":"false"}," Фильтры ",-1),Eq={class:"dropdown-menu","aria-labelledby":"dropdownMenuButton1"},Lq=["onClick"],Kq={class:"input-group mb-3"},Nq={key:0,class:"mt-2"},Yq={class:"badge bg-primary mr-1"},Jq=["onClick"],Hq=e("i",{class:"fa-solid fa-xmark"},null,-1),Wq=[Hq],Gq={key:1,class:"row"},Xq={class:"col-12"},Zq=e("h4",null,"Все боты",-1),xq={class:"mb-0"},ez={class:"mb-0"},tz={key:2,class:"row"},sz={class:"col-12 mb-3"},oz={key:0,class:"col-12 mb-3"},lz={class:"table"},iz=e("th",{scope:"col"},"Действие",-1),nz={scope:"row"},az=["onClick"],dz=["onClick"],rz={key:0,class:"badge bg-primary"},cz={key:1},uz={class:"d-flex"},mz=["onClick"],_z=e("i",{class:"fa-regular fa-star"},null,-1),hz=[_z],pz=["onClick"],bz=e("i",{class:"fa-regular fa-copy"},null,-1),fz=[bz],gz=["onClick"],vz=e("i",{class:"fa-solid fa-boxes-packing"},null,-1),$z=[vz],yz=["onClick"],kz=e("i",{class:"fa-solid fa-box-open"},null,-1),Fz=[kz],wz=["onClick"],Cz=e("i",{class:"fa-solid fa-trash-can text-white"},null,-1),Sz=[Cz],jz={class:"col-lg-4 col-12 mb-3"},qz={class:"card-body"},zz=["onClick"],Oz={key:0,class:"badge bg-info"},Vz={class:"card-footer d-flex"},Pz=["onClick"],Az=e("i",{class:"fa-regular fa-star"},null,-1),Qz=[Az],Uz=["onClick"],Iz=e("i",{class:"fa-regular fa-copy"},null,-1),Tz=[Iz],Bz=["onClick"],Rz=e("i",{class:"fa-solid fa-boxes-packing"},null,-1),Mz=[Rz],Dz=["onClick"],Ez=e("i",{class:"fa-solid fa-box-open"},null,-1),Lz=[Ez],Kz=["onClick"],Nz=e("i",{class:"fa-solid fa-trash-can text-white"},null,-1),Yz=[Nz],Jz={class:"col-12"},Hz={key:3,class:"row"},Wz=e("div",{class:"col-12"},[e("div",{class:"alert alert-warning",role:"alert"}," У выбранной компании нет созданных ботов! ")],-1),Gz=[Wz],Xz={props:["companyId","editor"],data(){return{displayType:1,direction:"desc",order:"updated_at",filters:[{name:"Активные",icon:"fa-brands fa-telegram",slug:"active"},{name:"Архивные",icon:"fa-solid fa-box-archive",slug:"archive"}],selectedFilters:[],show:!0,loading:!0,bots:[],favorites:[],search:null,bots_paginate_object:null}},watch:{displayType:function(o,t){localStorage.setItem("cashman_set_botlist_display_type",this.displayType)},selectedFilters:{handler:function(o){this.loadBots()},deep:!0}},computed:{...C(["getBots","getBotsPaginateObject","getCurrentCompany","getBotFavorites","inBotFav"]),filteredBots(){if(!this.bots)return[];if(this.selectedFilters.length===0&&this.search==null)return this.bots;if(this.selectedFilters.length===0&&this.search!=null)return this.bots.filter(t=>(t.bot_domain||"").trim().toLowerCase().indexOf(this.search.trim().toLowerCase())!==-1);let o=[];return this.selectedFilters.forEach(t=>{switch(t.slug){case"active":this.bots.filter(s=>s.deleted_at==null).forEach(s=>{o.push(s)});break;case"archive":this.bots.filter(s=>s.deleted_at!=null).forEach(s=>{o.push(s)});break}}),this.search==null?o:o.filter(t=>(t.bot_domain||"").trim().toLowerCase().indexOf(this.search.trim().toLowerCase())!==-1)}},mounted(){this.selectFilter("active"),this.displayType=parseInt(localStorage.getItem("cashman_set_botlist_display_type")||0)},methods:{hasRole(o){return window.hasRole(o)||!1},loadBotsByIds(){if(this.getBotFavorites.length==0){this.favorites=[];return}this.loading=!0,this.$store.dispatch("loadBotsByIds",{ids:this.getBotFavorites}).then(o=>{this.loading=!1,this.favorites=o}).catch(()=>{this.loading=!1})},prepareFavorites(){this.$store.dispatch("loadBotFavs").then(o=>{this.loadBotsByIds()})},moveOrderFavBot(o,t){this.$store.dispatch("swapBotInFav",{id:o,direction:t}).then(s=>{this.loadBotsByIds()})},addToFavorite(o){if(this.inBotFav(o)){this.$store.dispatch("removeFromBotFavorites",o).then(t=>{this.$notify("Указанный бот успешно удален из избранного"),this.loadBotsByIds()});return}this.$store.dispatch("addBotToFavorites",o).then(t=>{this.$notify("Указанный бот успешно добавлен в избранное"),this.loadBotsByIds()})},duplicate(o){if(!this.getCurrentCompany){this.$notify("У Вас не выбран клиент!");return}this.$store.dispatch("duplicateBot",{dataObject:{bot_id:o,company_id:this.getCurrentCompany.id}}).then(t=>{let s=this.bots_paginate_object.meta.current_page||0;this.loadBots(s),this.$notify("Указанный бот успешно продублирован")})},addToArchive(o){this.$store.dispatch("removeBot",{botId:o}).then(t=>{let s=this.bots_paginate_object.meta.current_page||0;this.$store.dispatch("resetCurrentBot"),this.loadBots(s),this.$notify("Указанный бот успешно перемещен в архив")})},forceDelete(o){this.$store.dispatch("forceDeleteBot",{botId:o}).then(t=>{let s=this.bots_paginate_object.meta.current_page||0;this.$store.dispatch("resetCurrentBot"),this.loadBots(s),this.$notify("Указанный бот успешно перемещен из архива")})},extractFromArchive(o){this.$store.dispatch("restoreBot",{botId:o}).then(t=>{let s=this.bots_paginate_object.meta.current_page||0;this.loadBots(s),this.$notify("Указанный бот успешно перемещен из архива")})},selectFilter(o){let t=this.filters.find(s=>s.slug===o);t&&this.selectedFilters.filter(s=>s.slug===o).length===0&&this.selectedFilters.push(t)},removeSelectedFilter(o){let t=this.selectedFilters.findIndex(s=>s.slug===o);this.selectedFilters.splice(t,1)},selectBot(o){this.$emit("callback",o),this.show=!1,this.$notify("Вы выбрали бота из списка! Все остальные действия будут производится для этого бота.")},nextBots(o){this.loadBots(o)},loadAndOrder(o){this.order=o,this.direction=this.direction==="desc"?"asc":"desc",this.loadBots(0)},loadBots(o=0){this.loading=!0,this.$store.dispatch("loadBots",{dataObject:{companyId:this.companyId||null,search:this.search,order:this.order,direction:this.direction,filters:this.selectedFilters.map(t=>t.slug)},page:o,size:20}).then(t=>{this.loading=!1,this.bots=this.getBots,this.bots_paginate_object=this.getBotsPaginateObject,this.prepareFavorites()}).catch(()=>{this.loading=!1})}}},rO=Object.assign(Xz,{__name:"BotList",setup(o){return(t,s)=>t.show?(l(),i("div",hq,[t.favorites.length>0?(l(),i("div",pq,[e("div",bq,[fq,e("p",gq,"Количество ботов в работе "+u(t.favorites.length||0),1),e("table",vq,[$q,e("tbody",null,[(l(!0),i(v,null,y(t.favorites,(n,a)=>(l(),i("tr",{class:_({"border-info":n.deleted_at==null,"border-danger":n.deleted_at!=null})},[e("th",yq,u(n.id),1),e("td",{onClick:d=>t.selectBot(n)},[e("i",{class:_([{"text-danger":n.deleted_at!=null},"fa-solid fa-robot mr-2"])},null,2),m(" "+u(n.bot_domain||"Не указано"),1)],8,kq),e("td",{onClick:d=>t.selectBot(n)},u(n.title||"Не указано"),9,Fq),e("td",null,[n.is_template?(l(),i("span",wq,u(n.template_description||"Не указано"),1)):(l(),i("span",Cq,"Не является шаблоном"))]),e("td",null,u(t.$filters.current(n.updated_at)),1),e("td",null,[e("div",Sq,[e("button",{class:_(["btn btn-outline-danger mr-2",{"btn-danger text-white":t.inBotFav(n.id)}]),type:"button",onClick:d=>t.addToFavorite(n.id),title:"Добавить в избранное"},zq,10,jq),t.favorites.length>1?(l(),i("button",{key:0,class:"btn btn-outline-primary mr-2",type:"button",onClick:d=>t.moveOrderFavBot(n.id,1),title:"Переместить вниз"},Pq,8,Oq)):r("",!0),t.favorites.length>1?(l(),i("button",{key:1,class:"btn btn-outline-primary mr-2",type:"button",onClick:d=>t.moveOrderFavBot(n.id,0),title:"Переместить вверх"},Uq,8,Aq)):r("",!0)])])],2))),256))])]),Iq])])):r("",!0),e("div",Tq,[e("div",Bq,[e("div",Rq,[e("div",Mq,[Dq,e("ul",Eq,[(l(!0),i(v,null,y(t.filters,n=>(l(),i("li",null,[e("a",{class:"dropdown-item",onClick:a=>t.selectFilter(n.slug),href:"#filter"},[e("i",{class:_([n.icon,"mr-2"])},null,2),m(" "+u(n.name||"Не указано"),1)],8,Lq)]))),256))])]),e("div",Kq,[c(e("input",{type:"search",class:"form-control",placeholder:"Поиск бота","aria-label":"Поиск бота","onUpdate:modelValue":s[0]||(s[0]=n=>t.search=n),onKeydown:s[1]||(s[1]=ve((...n)=>t.loadBots&&t.loadBots(...n),["enter"])),"aria-describedby":"button-addon2"},null,544),[[b,t.search]]),e("button",{class:"btn btn-outline-secondary",onClick:s[2]||(s[2]=(...n)=>t.loadBots&&t.loadBots(...n)),type:"button",id:"button-addon2"},"Найти ")])]),t.selectedFilters.length>0?(l(),i("p",Nq,[(l(!0),i(v,null,y(t.selectedFilters,n=>(l(),i("span",Yq,[m(u(n.name||"не указан")+" ",1),e("a",{onClick:a=>t.removeSelectedFilter(n.slug),class:"ml-1 text-white",href:"#filter"},Wq,8,Jq)]))),256))])):r("",!0)])]),t.bots_paginate_object?(l(),i("div",Gq,[e("div",Xq,[Zq,e("p",xq,"Количество найденных ботов "+u(t.bots_paginate_object.meta.total||0),1),e("p",ez,"Количество результатов на странице "+u(t.bots.length||0),1),e("p",null,[m(" Тип отображения списка: "),e("span",{onClick:s[3]||(s[3]=n=>t.displayType=0),class:_([{"bg-primary":t.displayType===0,"bg-secondary":t.displayType!==0},"badge cursor-pointer mr-2"])},"Карточки",2),e("span",{class:_([{"bg-primary":t.displayType===1,"bg-secondary":t.displayType!==1},"badge cursor-pointer mr-2"]),onClick:s[4]||(s[4]=n=>t.displayType=1)},"Таблица",2)])])])):r("",!0),t.bots.length>0?(l(),i("div",tz,[e("div",sz,[o.editor?r("",!0):(l(),i("button",{key:0,type:"button",class:"btn btn-outline-info",onClick:s[5]||(s[5]=n=>t.selectBot(null))},"Создать нового бота "))]),t.displayType===1?(l(),i("div",oz,[e("table",lz,[e("thead",null,[e("tr",null,[e("th",{scope:"col",class:"cursor-pointer",onClick:s[6]||(s[6]=n=>t.loadAndOrder("id"))},"#"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[7]||(s[7]=n=>t.loadAndOrder("bot_domain"))},"Домен"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[8]||(s[8]=n=>t.loadAndOrder("title"))},"Название"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[9]||(s[9]=n=>t.loadAndOrder("template_description"))},"Шаблон"),e("th",{scope:"col",class:"cursor-pointer",onClick:s[10]||(s[10]=n=>t.loadAndOrder("updated_at"))},"Дата изменения"),iz])]),e("tbody",null,[(l(!0),i(v,null,y(t.bots,(n,a)=>(l(),i("tr",{class:_({"border-info":n.deleted_at==null,"border-danger":n.deleted_at!=null})},[e("th",nz,u(n.id),1),e("td",{onClick:d=>t.selectBot(n)},[e("i",{class:_([{"text-danger":n.deleted_at!=null},"fa-solid fa-robot mr-2"])},null,2),m(" "+u(n.bot_domain||"Не указано"),1)],8,az),e("td",{onClick:d=>t.selectBot(n)},u(n.title||"Не указано"),9,dz),e("td",null,[n.is_template?(l(),i("span",rz,u(n.template_description||"Не указано"),1)):(l(),i("span",cz,"Не является шаблоном"))]),e("td",null,u(t.$filters.current(n.updated_at)),1),e("td",null,[e("div",uz,[e("button",{class:_(["btn btn-outline-danger mr-2",{"btn-danger text-white":t.inBotFav(n.id)}]),type:"button",onClick:d=>t.addToFavorite(n.id),title:"Добавить в избранное"},hz,10,mz),e("button",{class:"btn btn-outline-info mr-2",type:"button",onClick:d=>t.duplicate(n.id),title:"Дублировать"},fz,8,pz),n.deleted_at==null&&t.hasRole("admin")?(l(),i("button",{key:0,class:"btn btn-outline-info",type:"button",onClick:d=>t.addToArchive(n.id),title:"В архив"},$z,8,gz)):r("",!0),n.deleted_at!=null&&t.hasRole("admin")?(l(),i("button",{key:1,class:"btn btn-outline-info mr-2",onClick:d=>t.extractFromArchive(n.id),title:"Из архива"},Fz,8,yz)):r("",!0),n.deleted_at!=null&&t.hasRole("admin")?(l(),i("button",{key:2,class:"btn btn-danger mr-2",onClick:d=>t.forceDelete(n.id),title:"Удалить на совсем"},Sz,8,wz)):r("",!0)])])],2))),256))])])])):r("",!0),t.displayType===0?(l(!0),i(v,{key:1},y(t.bots,(n,a)=>(l(),i("div",jz,[e("div",{class:_(["card w-100",{"border-info":n.deleted_at==null,"border-secondary":n.deleted_at!=null}])},[e("div",qz,[e("p",{class:"d-flex justify-content-between",onClick:d=>t.selectBot(n),style:{"word-wrap":"break-word"}},[e("span",null,[e("i",{class:_([{"text-danger":n.deleted_at!=null},"fa-solid fa-robot mr-2"])},null,2),m(" "+u(n.bot_domain||"Не указано"),1)]),n.is_template?(l(),i("span",Oz,u(n.template_description||"Шаблон без названия"),1)):r("",!0)],8,zz)]),e("div",Vz,[e("button",{class:_(["btn btn-outline-danger mr-2",{"btn-danger text-white":t.inBotFav(n.id)}]),type:"button",onClick:d=>t.addToFavorite(n.id),title:"Добавить в избранное"},Qz,10,Pz),e("button",{class:"btn btn-outline-info mr-2",type:"button",onClick:d=>t.duplicate(n.id),title:"Дублировать"},Tz,8,Uz),n.deleted_at==null&&t.hasRole("admin")?(l(),i("button",{key:0,class:"btn btn-outline-info",type:"button",onClick:d=>t.addToArchive(n.id),title:"В архив"},Mz,8,Bz)):r("",!0),n.deleted_at!=null&&t.hasRole("admin")?(l(),i("button",{key:1,class:"btn btn-outline-info mr-2",onClick:d=>t.extractFromArchive(n.id),title:"Из архива"},Lz,8,Dz)):r("",!0),n.deleted_at!=null&&t.hasRole("admin")?(l(),i("button",{key:2,class:"btn btn-danger mr-2",onClick:d=>t.forceDelete(n.id),title:"Удалить на совсем"},Yz,8,Kz)):r("",!0)])],2)]))),256)):r("",!0),e("div",Jz,[t.bots_paginate_object?(l(),$(j,{key:0,onPagination_page:t.nextBots,pagination:t.bots_paginate_object},null,8,["onPagination_page","pagination"])):r("",!0)])])):(l(),i("div",Hz,Gz))])):r("",!0)}});export{rO as _,dO as a,Sp as b,le as c};
